# Remember the Word

## 题意翻译

# Uva1401 Remember the Word (记单词) 翻译

## 题目描述

- Neal 对有关组合的问题很感兴趣，现在他有一个关于单词的有趣问题要解决：

- 他知道大佬Ray的记忆力像存储器一样好，这样的问题肯定难不倒他，于是Neal把问题给了蒟蒻Jiejie。Jiejie经常记不住数字，他就用火柴棒来帮助自己记忆。Jiejie最多只能用20071027根火柴棒（因为他只有那么多），所以Jiejie数出来的数量需要**关于20071027取模**。

- 问题如下： 一个长单词需要被分割成几个小单词（当然小单词都在字典当中）。**比如有包含4个单词的字典：{a, b, cd, ab}，则长单词abcd有两种分解方法： a+b+cd和ab+cd。**

- 现给定一个由s个不同单词组成的字典和一个长字符串，Jiejie需要把这个长字符串按字典分解成若干个单词，问有**多少种分解方法**？

## 输入

- 每个输入文件中有**多组测试数据**，对于每组测试数据：

- **第一行是长单词，单词的长度不会超过300,000**

- **第二行是整数s，1≤s≤4000。**

- 接下来的s行，每行是字典中的一个单词，每个**单词长度不超过100**，所有单词字母都是**小写**的，且**不会有相同单词**。

- 每组测试数据间都会有一个空行

- 你的程序必须处理到**文件结束（即EOF）**为止

## 输出

- 对于每组测试数据，输出总数对20071027取模后的值，格式参考样例。

## 样例输入

abcd

4

a

b

cd

ab

## 样例输出

Case 1: 2

### 原题链接 [pdf](https://uva.onlinejudge.org/external/14/p1401.pdf)

感谢@dasxxx 提供的翻译

## 题目描述

[problemUrl]: https://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&category=447&page=show_problem&problem=4147

[PDF](https://uva.onlinejudge.org/external/14/p1401.pdf)

## 输入输出格式

### 输入格式

### 输出格式

## 输入输出样例

暂无测试点

