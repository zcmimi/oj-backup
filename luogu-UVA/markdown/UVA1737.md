# Branch Assignment

## 题意翻译

 有一个n个点r条边的有向带权强连通图，图没有重边，这n个点中前b个点为b个部门，第b+1个点为监管处(监管处不是部门)，其他点起到中继作用。部门之间可能希望传递信息。如果部门a希望传递信息到部门b，那么他必须先把信息传递到监管处，然后再由监管处发到部门b。你可以选择把这b个部门按照你的意愿分成恰好s组，而每一组内部的所有部门两两之间都需要互相传递信息，所以每一种分组的代价是：所有组代价的和，每一组的代价是：所有组内部门互相传递一次信息的代价的和。

你希望你的分组代价最少，求这个最小代价。

in

所有输入为正整数

第一行为四个数 n b s r 用空格隔开

其中(2<=n<=5000),(1<=b<=n-1),(1<=s<=b),(1<=r<=50000)

接下来r行每行三个数 u v l,描述一条从u到v长度为l（0<=l<=10000）的单项边，保证没有重边，图强连通

out

输出最小代价

（来源：好像是world final 2016）

（有$nlog^2$级的算法）

翻译提供者：djy213

## 题目描述

[problemUrl]: https://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&category=859&page=show_problem&problem=5004

[PDF](https://uva.onlinejudge.org/external/17/p1737.pdf)

## 输入输出格式

### 输入格式

### 输出格式

## 输入输出样例

暂无测试点

