# Route Finding

## 题意翻译

###### 许多城市提供综合公共交通系统。此类系统通常将公交线路、郊区通勤列车服务和地铁整合在一起。此类系统上的线路可以根据其沿线站点进行分类。我们通常将其视为普通线（车辆从路线的一端穿梭到另一端并返回）、环线（左右“分支”的端点相同且车辆在两个方向上环绕系统）和连接线（其每一端都连接到另一条线路）。显然，所有这些都可以被认为是非常相似的，并且可以在它们的路线上的不同点相互连接。请注意，车辆可以沿所有路线双向行驶，并且只能在换乘站的路线之间换乘。

###### 为了简化问题，我们给每条线路都指定一个“A”到“Z”之间字母，并且一条线上的每个车站都指定另一个“a”到“z”之间的字母。换乘站将有多个名称。因此，一个可能的例子是：

######

######

###### 这种系统中的一个常见问题是在两个车站之间找到一条路线。我们希望找到“最佳”路线，也就是“用时最短”的路线。

###### 请编写一个能读取此类系统的详细信息，然后在给定的两个站之间找到最快的路线的程序。可以假设（相邻）站点之间的行程始终需要1个时间单位，而在换乘站的线路之间换乘需要3个时间单位。

# 输入

###### 输入将由两部分组成。第一部分包括对系统的描述，第二部分包括成对的站点。系统描述将以1到26之间的数字n开始，表示系统中有多少条线路。后面是n行，每行描述一条线路。每一行将依次以线路标识符开始，后跟“：”和该线路沿线的站点。换乘站用“=”符号后面接完整名称的形式表示。所有换乘站至少标识一次，如果一个换乘站有两条以上的线路交汇，则可同时标识部分或全部名称。也就是说，可能会出现如‘...hc=Bg=Cc=Abd...’这样的序列。如果线路是环线，则最后一个站将与第一个站相同。这是唯一一种重复站点字母的情况。

###### 输入文件的下一部分将由一系列行组成，每行包含两个站点名。文件将以只包含一个‘#’的行结束。

# 输出

###### 输出将由一系列路线组成，每条对应每对站点。每条线路将包括连接两个站点的最快路线的时间，在宽度为3的字段中右对齐，然后是冒号和空格，以及代表最短路线的站点序列。请看下方的示例。请注意，对于任何给定的两个站点，总是只有一条最快的路径，并且该路径必须在指定的站点开始和结束（而不能是站点的同义别名，例如换乘站），因此，该路径的时间必须包括任何站内换乘的时间。

###### 注意：下面的样例输入参照的是上面给出的图表。

# 样例输入

```c

4

A:fgmpnxzabjd=Dbf

D:b=Adac=Ccf

B:acd=Azefg=Cbh

C:bac

AgAa

AbBh

BhDf

#

```

# 样例输出(其中的?表示空格)

```c

??5: Agfdjba

??9: Abaz=Bdefgh

?10: Bhg=Cbac=Dcf

```

## 题目描述

[problemUrl]: https://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&category=3&page=show_problem&problem=93

[PDF](https://uva.onlinejudge.org/external/1/p157.pdf)

![](https://cdn.luogu.com.cn/upload/vjudge_pic/UVA157/77cf77ec718af2b613ba60a39597ef7235f24247.png)

## 输入输出格式

### 输入格式

![](https://cdn.luogu.com.cn/upload/vjudge_pic/UVA157/c136d252554be59062e6a6aff607484881dc9905.png)

### 输出格式

![](https://cdn.luogu.com.cn/upload/vjudge_pic/UVA157/0424d2d17bc2dc80cc5a62a66f5d92395f61f061.png)

## 输入输出样例

### 输入样例 #1

```cpp
4
A:fgmpnxzabjd=Dbf
D:b=Adac=Ccf
B:acd=Azefg=Cbh
C:bac
AgAa
AbBh
BhDf
#
```


### 输出样例 #1

```cpp
5: Agfdjba
9: Abaz=Bdefgh
10: Bhg=Cbac=Dcf
```


