<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>GNY07F - Monkey Vines - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449744:SVL4nwegOoyMU0mPAwzSRj6T65e3G0UOzSqW86KtEXk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Deep%20in%20the%20Amazon%20jungle%2C%20exceptionally%20tall%20trees%20grow%20that%20support%20a%20rich%20biosphere%20of%20figs%20and%20juniper%20bugs%2C%20which%20happen%20to%20be%20the%20culinary%20delight%20of%20brown%20monkeys.%5Cn%5CnReaching%20the%20canopy%20of%20these%20trees%20requires%20the%20monkeys%20to%20perform%20careful%20navigation%20through%20the%20tall%20tree%5Cu2019s%20fragile%20vine%20system.%20These%20vines%20operate%20like%20a%20see-saw%3A%20an%20unbalancing%20of%20weight%20at%20any%20vine%20junction%20would%20snap%20the%20vine%20from%20the%20tree%2C%20and%20the%20monkeys%20would%20plummet%20to%20the%20ground%20below.%20The%20monkeys%20have%20figured%20out%20that%20if%20they%20work%20together%20to%20keep%20the%20vines%20properly%20balanced%2C%20they%20can%20_all_%20feast%20on%20the%20figs%20and%20juniper%20bugs%20in%20the%20canopy%20of%20the%20trees.%5Cn%5CnA%20_vine%20junction_%20supports%20exactly%20two%20_sub-vines_%2C%20each%20of%20which%20must%20contain%20the%20same%20number%20of%20monkeys%2C%20or%20else%20the%20vine%20will%20break%2C%20leaving%20a%20pile%20of%20dead%20monkeys%20on%20the%20jungle%20ground.%20For%20purposes%20of%20this%20problem%2C%20a%20_vine%20junction_%20is%20denoted%20by%20a%20pair%20of%20matching%20square%20brackets%20%5C%5C%5B%20%5C%5C%5D%2C%20which%20may%20contain%20nested%20information%20about%20junctions%20further%20down%20its%20_sub-vines_.%20The%20nesting%20of%20vines%20will%20go%20no%20further%20than%20%2A%2A25%2A%2A%20levels%20deep.%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP2528%5C%2Fe4fc0930824f1792cfca17d1699513d8e92add88.png%29%5Cn%5CnYou%20will%20write%20a%20program%20that%20calculates%20the%20_minimum_%20number%20of%20monkeys%20required%20to%20balance%20a%20particular%20vine%20configuration.%20There%20is%20%2A%2Aalways%2A%2A%20at%20least%20one%20monkey%20needed%2C%20and%2C%20multiple%20monkeys%20may%20hang%20from%20the%20same%20vine.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20a%20single%20integer%20N%2C%20%281%20Each%20dataset%20consists%20of%20a%20single%20line%20of%20input%20containing%20a%20vine%20configuration%20consisting%20of%20a%20string%20of%20%5C%5C%5B%20and%20%5C%5C%5D%20characters%20as%20described%20above.%20The%20length%20of%20the%20string%20of%20%5C%5C%5B%20and%20%5C%5C%5D%20will%20be%20greater%20than%20or%20equal%20to%20zero%2C%20and%20less%20than%20or%20equal%20to%20150.%22%2C%22outputFormat%22%3A%22For%20each%20dataset%2C%20you%20should%20generate%20one%20line%20of%20output%20with%20the%20following%20values%3A%20The%20dataset%20number%20as%20a%20decimal%20integer%20%28start%20counting%20at%20one%29%2C%20a%20space%2C%20and%20the%20minimum%20number%20of%20monkeys%20required%20to%20reach%20the%20canopy%20successfully.%20Assume%20that%20all%20the%20hanging%20vines%20are%20reachable%20from%20the%20jungle%20floor%2C%20and%20that%20all%20monkeys%20jump%20on%20the%20vines%20at%20the%20same%20time.%22%2C%22samples%22%3A%5B%5B%223%5Cr%5Cn%5B%5D%5Cr%5Cn%5Cr%5Cn%5B%5B%5D%5B%5B%5D%5D%5D%22%2C%221%202%5Cr%5Cn2%201%5Cr%5Cn3%208%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B12850%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F2528%22%2C%22id%22%3A%222528%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A3%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP2528%22%2C%22title%22%3A%22GNY07F%20-%20Monkey%20Vines%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22GNY07F%20-%20Monkey%20Vines%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>GNY07F - Monkey Vines</h1>
<h2>题目描述</h2>
<div>Deep in the Amazon jungle, exceptionally tall trees grow that support a rich biosphere of figs and juniper bugs, which happen to be the culinary delight of brown monkeys.
Reaching the canopy of these trees requires the monkeys to perform careful navigation through the tall tree’s fragile vine system. These vines operate like a see-saw: an unbalancing of weight at any vine junction would snap the vine from the tree, and the monkeys would plummet to the ground below. The monkeys have figured out that if they work together to keep the vines properly balanced, they can _all_ feast on the figs and juniper bugs in the canopy of the trees.
A _vine junction_ supports exactly two _sub-vines_, each of which must contain the same number of monkeys, or else the vine will break, leaving a pile of dead monkeys on the jungle ground. For purposes of this problem, a _vine junction_ is denoted by a pair of matching square brackets \[ \], which may contain nested information about junctions further down its _sub-vines_. The nesting of vines will go no further than **25** levels deep.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/SP2528/e4fc0930824f1792cfca17d1699513d8e92add88.png)
You will write a program that calculates the _minimum_ number of monkeys required to balance a particular vine configuration. There is **always** at least one monkey needed, and, multiple monkeys may hang from the same vine.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains a single integer N, (1 Each dataset consists of a single line of input containing a vine configuration consisting of a string of \[ and \] characters as described above. The length of the string of \[ and \] will be greater than or equal to zero, and less than or equal to 150.</div>
<h3>输出格式</h3>
<br />
<div>For each dataset, you should generate one line of output with the following values: The dataset number as a decimal integer (start counting at one), a space, and the minimum number of monkeys required to reach the canopy successfully. Assume that all the hanging vines are reachable from the jungle floor, and that all monkeys jump on the vines at the same time.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3
[]

[[][[]]]</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1 2
2 1
3 8</code></pre>
</article>
</div>
</div>
</body>
</html>
