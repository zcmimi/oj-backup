<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>TREESIM - Tree Similarity - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449813:sIX2K6UkiThv188u7sJKJsZyGl6FyglNRcT7aOD9G28=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20are%20given%20two%20labeled%20and%20ordered%20rooted%20trees%20T%20and%20T%27%20and%20would%20like%20to%20calculate%20the%20_distance_%20from%20T%20to%20T%27%2C%20which%20is%20the%20minimum%20number%20of%20operations%20you%20can%20perform%20on%20T%20to%20make%20it%20_equivalent_%20to%20T%27.%20For%20each%20operation%20you%20can%20choose%20to%20do%20one%20of%20three%20things%3A%5Cn%5Cn1.%20change%20the%20label%20of%20one%20node%20in%20T%5Cn2.%20delete%20a%20non-root%20node%20in%20T%5Cn3.%20insert%20a%20new%20node%20in%20T%20at%20a%20position%20somewhere%20below%20its%20root%5Cn%5CnRecall%20the%20trees%20T%20and%20T%27%20are%20ordered%2C%20which%20means%20that%20if%20a%20non-leaf%20node%20has%20c%20children%2C%20its%20children%20are%20ordered%20from%201%20to%20c.%20That%20is%2C%20there%20is%20a%201st%20child%2C%20a%202nd%20child%2C%20etc.%2C%20all%20the%20way%20up%20to%20a%20cth%20child.%20When%20we%20say%20a%20tree%20X%20is%20equivalent%20to%20a%20tree%20Y%2C%20we%20mean%20the%20root%20of%20X%20should%20have%20the%20same%20label%20as%20the%20root%20of%20Y%2C%20their%20roots%20should%20have%20the%20same%20number%20of%20children%20%28call%20it%20c%29%2C%20and%20the%20subtree%20rooted%20at%20the%20ith%20child%20of%20the%20root%20of%20X%20should%20be%20equivalent%20to%20the%20subtree%20rooted%20at%20the%20ith%20child%20of%20the%20root%20of%20Y%20for%20i%3D1%2C2%2C...%2Cc.%20We%20now%20describe%20what%20we%20mean%20by%20deletion%20and%20insertion%20of%20non-root%20nodes%20in%20T.%20When%20deleting%20a%20non-root%20node%20w%20with%20d%20children%2C%20let%20u%20be%20its%20parent%20and%20suppose%20w%20is%20u%27s%20ith%20child.%20Then%20the%20first%20child%20of%20w%20becomes%20u%27s%20ith%20child%2C%20the%20second%20child%20of%20w%20becomes%20u%27s%20%28i%2B1%29st%20child%2C%20etc.%20For%20j%20%3C%20i%2C%20the%20jth%20child%20of%20u%20remains%20the%20same%2C%20but%20for%20all%20j%20%3E%20i%2C%20the%20child%20which%20was%20formerly%20the%20jth%20child%20of%20u%20now%20becomes%20its%20%28j%2Bd-1%29st%20child%20%28they%20get%20%5C%22shifted%20over%5C%22%20due%20to%20the%20insertion%20of%20w%27s%20children%20into%20u%27s%20child%20list%29.%20To%20insert%20a%20non-root%20node%20w%20into%20the%20tree%2C%20we%20can%20choose%20any%20node%20u%20to%20be%20its%20parent%2C%20and%20we%20can%20choose%20any%20contiguous%20subsequence%20%28possibly%20empty%29%20of%20u%27s%20children%20to%20become%20w%27s%20children%2C%20putting%20w%20in%20their%20place.%20When%20inserting%20a%20node%2C%20we%20can%20give%20it%20any%20label%20we%20want%20at%20the%20time%20of%20insertion.%20The%20root%20of%20T%20can%20never%20be%20deleted%2C%20and%20you%20can%20never%20insert%20a%20new%20node%20above%20the%20root%20to%20become%20the%20old%20root%27s%20parent.%20You%20can%2C%20however%2C%20change%20the%20label%20of%20the%20root.%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP3581%5C%2F0c2cdad699e012c26f0e22197c39aa118d7360fa.png%29%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20n%20and%20m%20separated%20by%20a%20space%2C%20the%20sizes%20of%20the%20trees%20T%20and%20T%27%2C%20respectively%20%281%20%5Cu2264%20n%2Cm%20%5Cu2264%2060%29.%20The%20next%20n%20lines%20describe%20T.%20On%20the%20ith%20line%20is%20a%20description%20of%20the%20ith%20node%20in%20the%20tree%3A%20its%20label%2C%20the%20number%20of%20children%20it%20has%2C%20then%20a%20list%20of%20its%20children%20in%20order%20from%20first%20to%20last%2C%20all%20space-separated.%20The%20next%20m%20lines%20similarly%20describe%20T%27.%20Labels%20are%20nonnegative%20integers%20fitting%20in%20a%2032-bit%20signed%20integer.%20The%20root%20of%20each%20tree%20is%20the%20node%20which%20is%20not%20the%20child%20of%20any%20other%20node%20in%20the%20tree.%22%2C%22outputFormat%22%3A%22On%20a%20single%20line%20output%20the%20minimum%20number%20of%20operations%20that%20can%20be%20performed%20on%20T%20to%20make%20it%20equivalent%20to%20T%27%2C%20followed%20by%20a%20newline.%22%2C%22samples%22%3A%5B%5B%223%202%5Cr%5Cn6%200%5Cr%5Cn1%202%200%202%5Cr%5Cn4%200%5Cr%5Cn2%201%201%5Cr%5Cn4%200%22%2C%222%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B213%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F3581%22%2C%22id%22%3A%223581%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP3581%22%2C%22title%22%3A%22TREESIM%20-%20Tree%20Similarity%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22TREESIM%20-%20Tree%20Similarity%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>TREESIM - Tree Similarity</h1>
<h2>题目描述</h2>
<div>You are given two labeled and ordered rooted trees T and T' and would like to calculate the _distance_ from T to T', which is the minimum number of operations you can perform on T to make it _equivalent_ to T'. For each operation you can choose to do one of three things:
1. change the label of one node in T
2. delete a non-root node in T
3. insert a new node in T at a position somewhere below its root
Recall the trees T and T' are ordered, which means that if a non-leaf node has c children, its children are ordered from 1 to c. That is, there is a 1st child, a 2nd child, etc., all the way up to a cth child. When we say a tree X is equivalent to a tree Y, we mean the root of X should have the same label as the root of Y, their roots should have the same number of children (call it c), and the subtree rooted at the ith child of the root of X should be equivalent to the subtree rooted at the ith child of the root of Y for i=1,2,...,c. We now describe what we mean by deletion and insertion of non-root nodes in T. When deleting a non-root node w with d children, let u be its parent and suppose w is u's ith child. Then the first child of w becomes u's ith child, the second child of w becomes u's (i+1)st child, etc. For j < i, the jth child of u remains the same, but for all j > i, the child which was formerly the jth child of u now becomes its (j+d-1)st child (they get "shifted over" due to the insertion of w's children into u's child list). To insert a non-root node w into the tree, we can choose any node u to be its parent, and we can choose any contiguous subsequence (possibly empty) of u's children to become w's children, putting w in their place. When inserting a node, we can give it any label we want at the time of insertion. The root of T can never be deleted, and you can never insert a new node above the root to become the old root's parent. You can, however, change the label of the root.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/SP3581/0c2cdad699e012c26f0e22197c39aa118d7360fa.png)</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains n and m separated by a space, the sizes of the trees T and T', respectively (1 ≤ n,m ≤ 60). The next n lines describe T. On the ith line is a description of the ith node in the tree: its label, the number of children it has, then a list of its children in order from first to last, all space-separated. The next m lines similarly describe T'. Labels are nonnegative integers fitting in a 32-bit signed integer. The root of each tree is the node which is not the child of any other node in the tree.</div>
<h3>输出格式</h3>
<br />
<div>On a single line output the minimum number of operations that can be performed on T to make it equivalent to T', followed by a newline.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 2
6 0
1 2 0 2
4 0
2 1 1
4 0</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2</code></pre>
</article>
</div>
</div>
</body>
</html>
