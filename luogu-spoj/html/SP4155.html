<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>OTOCI - OTOCI - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449857:KLHH0jtWTnfwGM2TBMfOd+qX8WA2GqcGXEg6fooA/aw=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22%5BEnglish%5D%28%5C%2Fproblems%5C%2FOTOCI%5C%2Fen%5C%2F%29%20%5BVietnamese%5D%28%5C%2Fproblems%5C%2FOTOCI%5C%2Fvn%5C%2F%29Some%20time%20ago%20Mirko%20founded%20a%20new%20tourist%20agency%20named%20%5C%22Dreams%20of%20Ice%5C%22.%20The%20agency%20purchased%20N%20icy%20islands%20near%20the%20South%20Pole%20and%20now%20offers%20excursions.%20Especially%20popular%20are%20the%20emperor%20penguins%2C%20which%20can%20be%20found%20in%20large%20numbers%20on%20the%20islands.%5Cn%5CnMirko%27s%20agency%20has%20become%20a%20huge%20hit%3B%20so%20big%20that%20it%20is%20no%20longer%20cost-effective%20to%20use%20boats%20for%20the%20excursions.%20The%20agency%20will%20build%20bridges%20between%20islands%20and%20transport%20tourists%20by%20buses.%20Mirko%20wants%20to%20introduce%20a%20computer%20program%20to%20manage%20the%20bridge%20building%20process%20so%20that%20fewer%20mistakes%20are%20made.%5Cn%5CnThe%20islands%20are%20numbered%201%20through%20N.%20No%20two%20islands%20are%20initially%20connected%20by%20bridges.%20The%20initial%20number%20of%20penguins%20on%20each%20island%20is%20known.%20That%20number%20may%20change%2C%20but%20will%20always%20be%20between%200%20and%201000%20%28inclusive%29.%5Cn%5CnYour%20program%20must%20handle%20the%20following%20three%20types%20of%20commands%3A%5Cn%5Cn-%20%5C%22bridge%20A%20B%5C%22%20%5Cu2013%20an%20offer%20was%20received%20to%20build%20a%20bridge%20between%20islands%20A%20and%20B%20%28A%20and%20B%20will%20be%20different%29.%20To%20limit%20costs%2C%20your%20program%20must%20accept%20the%20offer%20only%20if%20there%20isn%27t%20already%20a%20way%20to%20get%20from%20one%20island%20to%20the%20other%20using%20previously%20built%20bridges.%20If%20the%20offer%20is%20accepted%2C%20the%20program%20should%20output%20%5C%22yes%5C%22%2C%20after%20which%20the%20bridge%20is%20built.%20If%20the%20offer%20is%20rejected%2C%20the%20program%20should%20output%20%5C%22no%5C%22.%5Cn-%20%5C%22penguins%20A%20X%5C%22%20%5Cu2013%20the%20penguins%20on%20island%20A%20have%20been%20recounted%20and%20there%20are%20now%20X%20of%20them.%20This%20is%20an%20informative%20command%20and%20your%20program%20does%20not%20need%20to%20respond.%5Cn-%20%5C%22excursion%20A%20B%5C%22%20%5Cu2013%20a%20group%20of%20tourists%20wants%20an%20excursion%20from%20island%20A%20to%20island%20B.%20If%20the%20excursion%20is%20possible%20%28it%20is%20possible%20to%20get%20from%20island%20A%20to%20B%29%2C%20the%20program%20should%20output%20the%20total%20number%20of%20penguins%20the%20tourists%20would%20see%20on%20the%20excursion%20%28including%20islands%20A%20and%20B%29.%20Otherwise%2C%20your%20program%20should%20output%20%5C%22impossible%5C%22.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20the%20integer%20N%20%281%20%5Cu2264%20N%20%5Cu2264%2030%20000%29%2C%20the%20number%20of%20islands.%5Cn%5CnThe%20second%20line%20contains%20N%20integers%20between%200%20and%201000%2C%20the%20initial%20number%20of%20penguins%20on%20each%20of%20the%20islands.%5Cn%5CnThe%20third%20line%20contains%20an%20integer%20Q%20%281%20%5Cu2264%20Q%20%5Cu2264%20300%20000%29%2C%20the%20number%20of%20commands.%5Cn%5CnQ%20commands%20follow%2C%20each%20on%20its%20own%20line.%22%2C%22outputFormat%22%3A%22Output%20the%20responses%20to%20commands%20%5C%22bridge%5C%22%20and%20%5C%22excursion%5C%22%2C%20each%20on%20its%20own%20line.%22%2C%22samples%22%3A%5B%5B%225%5Cn4%202%204%205%206%5Cn10%5Cnexcursion%201%201%5Cnexcursion%201%202%5Cnbridge%201%202%5Cnexcursion%201%202%5Cnbridge%203%204%5Cnbridge%203%205%5Cnexcursion%204%205%5Cnbridge%201%203%5Cnexcursion%202%204%5Cnexcursion%202%205%22%2C%224%5Cnimpossible%5Cnyes%5Cn6%5Cnyes%5Cnyes%5Cn15%5Cnyes%5Cn15%5Cn16%5Cn%5Cn%5CnInput%3A%5Cn6%5Cn1%202%203%204%205%206%5Cn10%5Cnbridge%201%202%5Cnbridge%202%203%5Cnbridge%204%205%5Cnexcursion%201%203%5Cnexcursion%201%205%5Cnbridge%203%204%5Cnexcursion%201%205%5Cnpenguins%203%2010%5Cnexcursion%201%203%5Cnbridge%201%205%5Cn%5CnOutput%3A%5Cnyes%5Cnyes%5Cnyes%5Cn6%5Cnimpossible%5Cnyes%5Cn15%5Cn13%5Cnno%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1197%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F4155%22%2C%22id%22%3A%224155%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A79%2C%22totalAccepted%22%3A55%2C%22pid%22%3A%22SP4155%22%2C%22title%22%3A%22OTOCI%20-%20OTOCI%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A48210%2C%22title%22%3A%22%5Cu540c%5Cu9898%20Luogu%20P4312%20COCI%202009%20OTOCI%22%2C%22forum%22%3A%7B%22id%22%3A14030%2C%22name%22%3A%22SP4155%20OTOCI%20-%20OTOCI%22%2C%22slug%22%3A%22SP4155%22%7D%7D%2C%7B%22id%22%3A48171%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A14030%2C%22name%22%3A%22SP4155%20OTOCI%20-%20OTOCI%22%2C%22slug%22%3A%22SP4155%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1501%22%2C%22title%22%3A%22%5B%5Cu56fd%5Cu5bb6%5Cu96c6%5Cu8bad%5Cu961f%5DTree%20II%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2387%22%2C%22title%22%3A%22%5BNOI2014%5D%5Cu9b54%5Cu6cd5%5Cu68ee%5Cu6797%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3203%22%2C%22title%22%3A%22%5BHNOI2010%5D%5Cu5f39%5Cu98de%5Cu7ef5%5Cu7f8a%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3285%22%2C%22title%22%3A%22%5BSCOI2014%5D%5Cu65b9%5Cu4f2f%5Cu4f2f%5Cu7684OJ%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4312%22%2C%22title%22%3A%22%5BCOCI%202009%5D%20OTOCI%20%5C%2F%20%5Cu6781%5Cu5730%5Cu65c5%5Cu884c%5Cu793e%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22OTOCI%20-%20OTOCI%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>OTOCI - OTOCI</h1>
<h2>题目描述</h2>
<div>[English](/problems/OTOCI/en/) [Vietnamese](/problems/OTOCI/vn/)Some time ago Mirko founded a new tourist agency named "Dreams of Ice". The agency purchased N icy islands near the South Pole and now offers excursions. Especially popular are the emperor penguins, which can be found in large numbers on the islands.
Mirko's agency has become a huge hit; so big that it is no longer cost-effective to use boats for the excursions. The agency will build bridges between islands and transport tourists by buses. Mirko wants to introduce a computer program to manage the bridge building process so that fewer mistakes are made.
The islands are numbered 1 through N. No two islands are initially connected by bridges. The initial number of penguins on each island is known. That number may change, but will always be between 0 and 1000 (inclusive).
Your program must handle the following three types of commands:
- "bridge A B" – an offer was received to build a bridge between islands A and B (A and B will be different). To limit costs, your program must accept the offer only if there isn't already a way to get from one island to the other using previously built bridges. If the offer is accepted, the program should output "yes", after which the bridge is built. If the offer is rejected, the program should output "no".
- "penguins A X" – the penguins on island A have been recounted and there are now X of them. This is an informative command and your program does not need to respond.
- "excursion A B" – a group of tourists wants an excursion from island A to island B. If the excursion is possible (it is possible to get from island A to B), the program should output the total number of penguins the tourists would see on the excursion (including islands A and B). Otherwise, your program should output "impossible".</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains the integer N (1 ≤ N ≤ 30 000), the number of islands.
The second line contains N integers between 0 and 1000, the initial number of penguins on each of the islands.
The third line contains an integer Q (1 ≤ Q ≤ 300 000), the number of commands.
Q commands follow, each on its own line.</div>
<h3>输出格式</h3>
<br />
<div>Output the responses to commands "bridge" and "excursion", each on its own line.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5
4 2 4 5 6
10
excursion 1 1
excursion 1 2
bridge 1 2
excursion 1 2
bridge 3 4
bridge 3 5
excursion 4 5
bridge 1 3
excursion 2 4
excursion 2 5</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4
impossible
yes
6
yes
yes
15
yes
15
16


Input:
6
1 2 3 4 5 6
10
bridge 1 2
bridge 2 3
bridge 4 5
excursion 1 3
excursion 1 5
bridge 3 4
excursion 1 5
penguins 3 10
excursion 1 3
bridge 1 5

Output:
yes
yes
yes
6
impossible
yes
15
13
no</code></pre>
</article>
</div>
</div>
</body>
</html>
