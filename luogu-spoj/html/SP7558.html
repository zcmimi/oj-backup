<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>HAALPHA - D - Alphabetomials - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450043:AJlPuSXb2ESuLVy/9K7P+o5NrRsVIk/SY9/LYOhGxNM=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%2A%2AAlphabetomials%2A%2A%5Cn%5CnAs%20we%20all%20know%2C%20there%20is%20a%20big%20difference%20between%20polynomials%20of%20degree%204%20and%20those%20of%20degree%205.%20The%20question%20of%20the%20non-existence%20of%20a%20closed%20formula%20for%20the%20roots%20of%20general%20degree%205%20polynomials%20produced%20the%20famous%20Galois%20theory%2C%20which%2C%20as%20far%20as%20the%20author%20sees%2C%20bears%20no%20relation%20to%20our%20problem%20here.%5Cn%5CnWe%20consider%20only%20the%20multi-variable%20polynomials%20of%20degree%20up%20to%204%2C%20over%2026%20variables%2C%20represented%20by%20the%20set%20of%2026%20lowercase%20English%20letters.%20Here%20is%20one%20such%20polynomial%3A%5Cn%5Cn%20%60%60%60%5Cnaber%2Baab%2Bc%5Cn%60%60%60%5CnGiven%20a%20string%20_s_%2C%20we%20evaluate%20the%20polynomial%20on%20it.%20The%20evaluation%20gives%20_p_%28_S_%29%20as%20follows%3A%20Each%20variable%20is%20substituted%20with%20the%20number%20of%20appearances%20of%20that%20letter%20in%20_S_.%20%20%5Cn%20For%20example%2C%20take%20the%20polynomial%20above%2C%20and%20let%20_S_%20%3D%20%5C%22abracadabra%20edgar%5C%22.%20There%20are%20six%20a%27s%2C%20two%20b%27s%2C%20one%20c%2C%20one%20e%2C%20and%20three%20r%27s.%20So%5Cn%5Cn%20%60%60%60%5Cnp%28S%29%20%3D%206%20%2A%202%20%2A%201%20%2A%203%20%2B%206%20%2A%206%20%2A%202%20%2B%201%20%3D%20109.%5Cn%60%60%60%5CnGiven%20a%20dictionary%20of%20distinct%20words%20that%20consist%20of%20only%20lower%20case%20letters%2C%20we%20call%20a%20string%20_S_%20a%20_d-phrase_%20if%5Cn%5Cn%20%60%60%60%5CnS%20%3D%20%5C%22S1%20S2%20S3%20...%20Sd%5C%22%2C%5Cn%60%60%60%5Cnwhere%20S%20%24%20_%7Bi%7D%20%24%20is%20any%20word%20in%20the%20dictionary%2C%20for%201%20S%20is%20in%20the%20form%20of%20_d_%20dictionary%20words%20separated%20with%20spaces.%20Given%20a%20number%20%2A%2AK%2A%2A%20d%20K%2C%20to%20compute%20the%20sum%20of%20_p_%28_S_%29%20over%20all%20the%20_d_-phrases.%20Since%20the%20answers%20might%20be%20big%2C%20you%20are%20asked%20to%20compute%20the%20remainder%20when%20the%20answer%20is%20divided%20by%2010009.%5Cn%5CnInput%5Cn%5CnThe%20first%20line%20contains%20the%20number%20of%20cases%20%2A%2AT%2A%2A.%20%2A%2AT%2A%2A%20test%20cases%20follow.%20The%20format%20of%20each%20test%20case%20is%3A%20%20%5Cn%20A%20line%20containing%20an%20expression%20_p_%20for%20the%20multi-variable%20polynomial%2C%20as%20described%20below%20in%20this%20section%2C%20then%20a%20space%2C%20then%20follows%20an%20integer%20%2A%2AK%2A%2A.%20%20%5Cn%20A%20line%20with%20an%20integer%20%2A%2An%2A%2A%2C%20the%20number%20of%20words%20in%20the%20dictionary.%20%20%5Cn%20Then%20%2A%2An%2A%2A%20lines%2C%20each%20with%20a%20word%2C%20consists%20of%20only%20lower%20case%20letters.%20No%20word%20will%20be%20repeated%20in%20the%20same%20test%20case.%5Cn%5CnWe%20always%20write%20a%20polynomial%20in%20the%20form%20of%20a%20sum%20of%20terms%3B%20each%20term%20is%20a%20product%20of%20variables.%20We%20write%20_a_%20%24%20%5E%7Bt%7D%20%24%20simply%20as%20_t_%20_a_%27s%20concatenated%20together.%20For%20example%2C%20_a_%20%24%20%5E%7B2%7D%20%24%20_b_%20is%20written%20as%20_aab_.%20Variables%20in%20each%20term%20are%20always%20lexicographically%20non-decreasing.%5Cn%5CnOutput%5Cn%5CnFor%20each%20test%20case%2C%20output%20a%20single%20line%20in%20the%20form%5Cn%5Cn%20%60%60%60%5CnCase%20%23X%3A%20sum1%20sum2%20...%20sumK%5Cn%60%60%60%5Cnwhere%20_X_%20is%20the%20case%20number%20starting%20from%201%2C%20and%20sum%20%24%20_%7Bi%7D%20%24%20is%20the%20sum%20of%20_p_%28_S_%29%2C%20where%20_S_%20ranges%20over%20all%20i-phrases%2C%20modulo%2010009.%5Cn%5CnLimits%5Cn%5Cn1%20T%20The%20string%20_p_%20consists%20of%20one%20or%20more%20terms%20joined%20by%20%27%2B%27.%20It%20will%20not%20start%20nor%20end%20with%20a%20%27%2B%27.%20There%20will%20be%20at%20most%205%20terms%20for%20each%20_p_.%20Each%20term%20consists%20at%20least%201%20and%20at%20most%204%20lower%20case%20letters%2C%20sorted%20in%20non-decreasing%20order.%20No%20two%20terms%20in%20the%20same%20polynomial%20will%20be%20the%20same.%20%20%5Cn%20Each%20word%20is%20non-empty%2C%20consists%20only%20of%20lower%20case%20English%20letters%2C%20and%20will%20not%20be%20longer%20than%2050%20characters.%20No%20word%20will%20be%20repeated%20in%20the%20same%20dictionary.%5Cn%5CnSmall%20dataset%5Cn%5Cn1%20n%201%20K%5Cn%5CnLarge%20dataset%5Cn%5Cn1%20n%201%20K%5Cn%5CnSample%5Cn%5Cn%20%20%20%5CnInput%20%20%20%5Cn%20%20%20%20%5CnOutput%20%20%20%5Cn%20%20%60%202%3Cbr%3E%3C%5C%2Fbr%3E%20ehw%2Bhwww%205%3Cbr%3E%3C%5C%2Fbr%3E%206%3Cbr%3E%3C%5C%2Fbr%3E%20where%3Cbr%3E%3C%5C%2Fbr%3E%20when%3Cbr%3E%3C%5C%2Fbr%3E%20what%3Cbr%3E%3C%5C%2Fbr%3E%20whether%3Cbr%3E%3C%5C%2Fbr%3E%20who%3Cbr%3E%3C%5C%2Fbr%3E%20whose%3Cbr%3E%3C%5C%2Fbr%3E%20a%2Be%2Bi%2Bo%2Bu%203%3Cbr%3E%3C%5C%2Fbr%3E%204%3Cbr%3E%3C%5C%2Fbr%3E%20apple%3Cbr%3E%3C%5C%2Fbr%3E%20orange%3Cbr%3E%3C%5C%2Fbr%3E%20watermelon%3Cbr%3E%3C%5C%2Fbr%3E%20banana%3Cbr%3E%3C%5C%2Fbr%3E%3Cbr%3E%3C%5C%2Fbr%3E%60%20%60%20Case%20%231%3A%2015%201032%207522%206864%20253%3Cbr%3E%3C%5C%2Fbr%3E%20Case%20%232%3A%2012%2096%20576%3Cbr%3E%3C%5C%2Fbr%3E%60%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B709%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F7558%22%2C%22id%22%3A%227558%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP7558%22%2C%22title%22%3A%22HAALPHA%20-%20D%20-%20Alphabetomials%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22HAALPHA%20-%20D%20-%20Alphabetomials%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>HAALPHA - D - Alphabetomials</h1>
<h2>题目描述</h2>
<div>**Alphabetomials**
As we all know, there is a big difference between polynomials of degree 4 and those of degree 5. The question of the non-existence of a closed formula for the roots of general degree 5 polynomials produced the famous Galois theory, which, as far as the author sees, bears no relation to our problem here.
We consider only the multi-variable polynomials of degree up to 4, over 26 variables, represented by the set of 26 lowercase English letters. Here is one such polynomial:
```
aber+aab+c
```
Given a string _s_, we evaluate the polynomial on it. The evaluation gives _p_(_S_) as follows: Each variable is substituted with the number of appearances of that letter in _S_.
For example, take the polynomial above, and let _S_ = "abracadabra edgar". There are six a's, two b's, one c, one e, and three r's. So
```
p(S) = 6 * 2 * 1 * 3 + 6 * 6 * 2 + 1 = 109.
```
Given a dictionary of distinct words that consist of only lower case letters, we call a string _S_ a _d-phrase_ if
```
S = "S1 S2 S3 ... Sd",
```
where S $ _{i} $ is any word in the dictionary, for 1 S is in the form of _d_ dictionary words separated with spaces. Given a number **K** d K, to compute the sum of _p_(_S_) over all the _d_-phrases. Since the answers might be big, you are asked to compute the remainder when the answer is divided by 10009.
Input
The first line contains the number of cases **T**. **T** test cases follow. The format of each test case is:
A line containing an expression _p_ for the multi-variable polynomial, as described below in this section, then a space, then follows an integer **K**.
A line with an integer **n**, the number of words in the dictionary.
Then **n** lines, each with a word, consists of only lower case letters. No word will be repeated in the same test case.
We always write a polynomial in the form of a sum of terms; each term is a product of variables. We write _a_ $ ^{t} $ simply as _t_ _a_'s concatenated together. For example, _a_ $ ^{2} $ _b_ is written as _aab_. Variables in each term are always lexicographically non-decreasing.
Output
For each test case, output a single line in the form
```
Case #X: sum1 sum2 ... sumK
```
where _X_ is the case number starting from 1, and sum $ _{i} $ is the sum of _p_(_S_), where _S_ ranges over all i-phrases, modulo 10009.
Limits
1 T The string _p_ consists of one or more terms joined by '+'. It will not start nor end with a '+'. There will be at most 5 terms for each _p_. Each term consists at least 1 and at most 4 lower case letters, sorted in non-decreasing order. No two terms in the same polynomial will be the same.
Each word is non-empty, consists only of lower case English letters, and will not be longer than 50 characters. No word will be repeated in the same dictionary.
Small dataset
1 n 1 K
Large dataset
1 n 1 K
Sample
Input
Output
` 2<br></br> ehw+hwww 5<br></br> 6<br></br> where<br></br> when<br></br> what<br></br> whether<br></br> who<br></br> whose<br></br> a+e+i+o+u 3<br></br> 4<br></br> apple<br></br> orange<br></br> watermelon<br></br> banana<br></br><br></br>` ` Case #1: 15 1032 7522 6864 253<br></br> Case #2: 12 96 576<br></br>`</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
