<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>VPL0_A - Another Gift Problem - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450333:kj1viT30nHZdaFrOIuBCWBtvPkk5O4cw6n1qbOmBawQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%20Luis%20is%20becoming%20mad%20because%20his%20family%20hid%20all%20the%20christmas%20gift%20in%20the%20family%5Cu2019s%20apartment%2C%20as%20his%20family%20is%20wealth%2C%20they%20own%20a%20giant%20skyscrapper%20that%20has%20many%20floors%2C%20by%20using%20elevators%2C%20he%20wants%20to%20find%20all%20the%20gifts.%5Cn%5Cn%20Luis%5Cu2019%20parents%20went%20out%20and%20this%20is%20the%20perfect%20opportunity%20he%20has%20to%20sneak%20and%20view%20the%20christmas%20gifts%20before%20christmas%20eve%21%20Luis%20earned%20a%20map%20of%20the%20building%20and%20marked%20the%20places%20where%20he%20can%20find%20the%20gifts.%20An%20elevator%20of%20the%20building%20can%20only%20go%20up%20and%20go%20down%2C%20now%2C%20you%20can%20assume%20that%20the%20elevators%20will%20always%20be%20on%20any%20floor%20and%20will%20be%20able%20to%20take%20it%2C%20however%2C%20the%20elevator%20takes%20one%20unit%20of%20time%20to%20bring%20Luis%20to%20any%20floor%20Ai%20%2C%20Luis%20should%20never%20leave%20the%20building%20at%20any%20moment%20using%20the%20elevators.%5Cn%5Cn%20When%20Luis%20gets%20to%20any%20floor%2C%20he%20will%20start%20seeking%20the%20gift%20from%20the%20position%20%280%2C0%29%2C%20after%20seeing%20all%20the%20room%20he%20will%20return%20to%20the%20elevator%20and%20keep%20his%20way.%20his%20searching%20ends%20when%20he%20finds%20all%20the%20gifts.%20Luis%20can%20ignore%20places%20that%20aren%5Cu2019t%20marked%2C%20so%20for%20example%2C%20if%20he%20knows%20that%20in%20a%20floor%20Fi%20there%20is%20no%20gifts%2C%20he%20can%20continue%20his%20way%20through%20the%20elevators.%20You%20can%20assume%20some%20things%20out%20of%20Luis%5Cu2019%20skyscrapper%20building.%5Cn%5Cn%20%5Cu2022%20He%20lives%20on%20the%20first%20floor%20of%20the%20skyscrapper%20%28floor%200%2C%20position%200%2C0%29.%5Cn%5Cn%5Cu2022%20Luis%20must%20be%20in%20each%20floor%20in%20the%20position%20%280%2C0%29%20in%20order%20to%20use%20an%20elevator.%5Cn%5Cn%20%5Cu2022%20There%20will%20no%20gifts%20in%20his%20floor%2C%20because%20his%20parents%20try%20to%20hide%20it%20from%20him.%5Cn%5Cn%20%5Cu2022%20He%20will%20never%20leave%20the%20building%20at%20any%20moment%20using%20elevators%5Cn%5Cn%20%5Cu2022%20Every%20floor%20of%20the%20skyscrapper%20is%20perfectly%20the%20same%20one%20from%20another%20and%20can%20be%20represented%20as%20a%20NxN%20matrix%5Cn%5Cn%20%5Cu2022%20The%20elevators%20will%20be%20always%20available%20and%20can%20go%20up%20or%20down%2C%20never%20both.%20%28You%20can%20assume%20that%20the%20elevators%20will%20be%20always%20moving%29.%5Cn%5Cn%20%5Cu2022%20The%20coordinates%20of%20the%20gift%20are%20uniques%2C%20that%20is%2C%20you%20can%20safely%20assume%20that%20no%20gift%20will%20overlap%20another%20one.%5Cn%5Cn%5Cu2022%20Luis%20can%20only%20walk%20in%20a%20floor%20from%20point%20%28a%2Cb%29%20through%20point%20%28c%2Cd%29%20going%20into%20vertical%20and%20horizontal%20directions%2C%20that%20is%2C%20for%20each%20unit%20of%20time%2C%20he%20can%20move%20north%2C%20east%2C%20west%20or%20south.%5Cn%5Cn%20%5Cu2022%20The%20transition%20of%20one%20elevator%20through%20another%20takes%20one%20unit%20of%20time%2C%20the%20time%20inside%20the%20elevator%20is%20immediate.%5Cn%5Cn%20Finally%2C%20knowing%20the%20number%20of%20floors%2C%20the%20number%20of%20elevators%20and%20their%20values%2C%20the%20number%20of%20gifts%20and%20the%20position%20of%20each%20gift%2C%20and%20then%20the%20size%20NxN%20of%20every%20floor%20in%20the%20apartment%2C%20determine%20the%20minimum%20time%20that%20Luis%20can%20delay%20checking%20all%20his%20gifts%20and%20returning%20to%20the%20point%200%2C0%20on%20the%20last%20gift%27s%20floor%20after%20he%20sees%20the%20last%20one.%5Cn%5CnIt%20is%20guaranteed%20that%20a%20solution%20will%20always%20exist.%5Cn%5Cn%2A%2AInput%2A%2A%5Cn%5Cn%20The%20first%20line%20contains%20an%20integer%20T%2C%20which%20specifies%20the%20number%20of%20test%20cases.%20Then%2C%20will%20follow%20the%20descriptions%20of%20T%20test%20cases.%5Cn%5Cn%20Four%20integers%20will%20begin%20every%20test%20case%3B%20M%2C%20E%2C%20K%20and%20N%20%2C%20denoting%2C%20respectively%2C%20the%20number%20of%20floors%2C%20the%20number%20of%20elevators%2C%20the%20number%20of%20gifts%20and%20the%20size%20for%20every%20floor%20in%20the%20skyscrapper.%5Cn%5Cn%20Then%2C%20E%20lines%20will%20follow%2C%20meaning%20that%20the%20i-th%20elevator%20goes%20%5Cu201dup%5Cu201d%20Ei%20floors.%20%28If%20the%20number%20is%20negative%2C%20then%20it%20goes%20down%20Ei%20floors.%5Cn%5Cn%20After%20that%2C%20K%20lines%20will%20follow%2C%20each%20one%20of%20them%20with%20three%20integers%20denoting%20that%20the%20i-th%20gift%20is%20on%20floor%20f%20at%20the%20position%20%28r%2Cc%29.%5Cn%5Cn_The%20input%20must%20be%20read%20from%20standard%20input._%5Cn%5Cn%2A%2AOutput%2A%2A%5Cn%5Cn%20For%20each%20input%20case%20you%20must%20print%20the%20string%20%5C%22Scenario%20%23i%3A%20%5C%22%20where%20i%20represent%20the%20case%20you%5Cu2019re%20analyzing%20%28starting%20from%201%29%2C%20followed%20by%20the%20minimum%20units%20of%20time%20that%20takes%20Luis%20to%20check%20all%20the%20gifts.%5Cn%5Cn_The%20output%20must%20be%20written%20to%20standard%20output._%5Cn%5Cn%20%2A%2AInput%2A%2A%5Cn%5Cn%20%20%2A%2AOutput%20for%20the%20sample%20input%2A%2A%5Cn%5Cn%20%205%5Cn%5Cn5%201%201%201%5Cn%5Cn1%5Cn%5Cn3%200%200%5Cn%5Cn5%203%201%201%5Cn%5Cn1%5Cn%5Cn4%5Cn%5Cn-1%5Cn%5Cn3%200%200%5Cn%5Cn5%201%202%201%5Cn%5Cn1%5Cn%5Cn2%200%200%5Cn%5Cn4%200%200%5Cn%5Cn10%203%202%201%5Cn%5Cn1%5Cn%5Cn8%5Cn%5Cn-2%5Cn%5Cn4%200%200%5Cn%5Cn6%200%200%5Cn%5Cn5%203%203%205%5Cn%5Cn1%5Cn%5Cn2%5Cn%5Cn-1%5Cn%5Cn2%201%203%5Cn%5Cn2%204%201%5Cn%5Cn2%203%204%5Cn%5Cn%20%20Scenario%20%231%3A%203%5Cn%5CnScenario%20%232%3A%202%5Cn%5CnScenario%20%233%3A%204%5Cn%5CnScenario%20%234%3A%203%5Cn%5CnScenario%20%235%3A%2017%5Cn%5Cn%20Explanation%20of%20the%20last%20case%3A%5Cn%5CnLuis%20starts%20in%20floor%200%2C%20takes%20an%20elevator%20to%20floor%202%2C%20lets%20call%20the%20three%20gift%20on%20the%20second%20floor%20%28A%2CB%2CC%29%20with%20A%3D%7B1%2C3%7D%2C%20B%3D%7B4%2C1%7D%2C%20C%3D%7B3%2C4%7D%2C%20he%20can%20pick%20the%20gifts%20in%20several%20ways%3B%20A%2CB%2CC%3B%20B%2CC%2CA%3B%20C%2CA%2CB%3B%20C%2CB%2CA%3B%20A%2CC%2CB%3B%20B%2CA%2CC%3B%20However%2C%20the%20minimal%20combination%20is%20B%2CA%2CC%20and%20return%20to%20the%20origin%20%280%2C0%29%20that%20is%2016%20steps%20used%20plus%20the%20unit%20of%20time%20in%20the%20elevator%2C%20total%20%3D%2017.%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%2A%2ASubtask%201%20-%205%25%2A%2A%5Cn%5Cn%20%5Cu2022%202%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%2A%2ASubtask%202%20-%205%25%2A%2A%5Cn%5Cn%20%5Cu2022%202%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%2A%2ASubtask%203%20-%2010%25%2A%2A%5Cn%5Cn%20%5Cu2022%202%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%20%5Cu2022%202%5Cn%5Cn%2A%2ASubtask%204%20-%2010%25%2A%2A%5Cn%5Cn%20%5Cu2022%202%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%20%5Cu2022%202%5Cn%5Cn%2A%2ASubtask%205%20-%2020%25%2A%2A%5Cn%5Cn%20%5Cu2022%202%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%20%5Cu2022%202%5Cn%5Cn%2A%2ASubtask%206%20-%2020%25%2A%2A%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%2A%2ASubtask%207%20-%2030%25%2A%2A%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%20%5Cu2022%201%5Cn%5Cn%20%5Cu2022%201%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F12958%22%2C%22id%22%3A%2212958%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP12958%22%2C%22title%22%3A%22VPL0_A%20-%20Another%20Gift%20Problem%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22VPL0_A%20-%20Another%20Gift%20Problem%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>VPL0_A - Another Gift Problem</h1>
<h2>题目描述</h2>
<div> Luis is becoming mad because his family hid all the christmas gift in the family’s apartment, as his family is wealth, they own a giant skyscrapper that has many floors, by using elevators, he wants to find all the gifts.
Luis’ parents went out and this is the perfect opportunity he has to sneak and view the christmas gifts before christmas eve! Luis earned a map of the building and marked the places where he can find the gifts. An elevator of the building can only go up and go down, now, you can assume that the elevators will always be on any floor and will be able to take it, however, the elevator takes one unit of time to bring Luis to any floor Ai , Luis should never leave the building at any moment using the elevators.
When Luis gets to any floor, he will start seeking the gift from the position (0,0), after seeing all the room he will return to the elevator and keep his way. his searching ends when he finds all the gifts. Luis can ignore places that aren’t marked, so for example, if he knows that in a floor Fi there is no gifts, he can continue his way through the elevators. You can assume some things out of Luis’ skyscrapper building.
• He lives on the first floor of the skyscrapper (floor 0, position 0,0).
• Luis must be in each floor in the position (0,0) in order to use an elevator.
• There will no gifts in his floor, because his parents try to hide it from him.
• He will never leave the building at any moment using elevators
• Every floor of the skyscrapper is perfectly the same one from another and can be represented as a NxN matrix
• The elevators will be always available and can go up or down, never both. (You can assume that the elevators will be always moving).
• The coordinates of the gift are uniques, that is, you can safely assume that no gift will overlap another one.
• Luis can only walk in a floor from point (a,b) through point (c,d) going into vertical and horizontal directions, that is, for each unit of time, he can move north, east, west or south.
• The transition of one elevator through another takes one unit of time, the time inside the elevator is immediate.
Finally, knowing the number of floors, the number of elevators and their values, the number of gifts and the position of each gift, and then the size NxN of every floor in the apartment, determine the minimum time that Luis can delay checking all his gifts and returning to the point 0,0 on the last gift's floor after he sees the last one.
It is guaranteed that a solution will always exist.
**Input**
The first line contains an integer T, which specifies the number of test cases. Then, will follow the descriptions of T test cases.
Four integers will begin every test case; M, E, K and N , denoting, respectively, the number of floors, the number of elevators, the number of gifts and the size for every floor in the skyscrapper.
Then, E lines will follow, meaning that the i-th elevator goes ”up” Ei floors. (If the number is negative, then it goes down Ei floors.
After that, K lines will follow, each one of them with three integers denoting that the i-th gift is on floor f at the position (r,c).
_The input must be read from standard input._
**Output**
For each input case you must print the string "Scenario #i: " where i represent the case you’re analyzing (starting from 1), followed by the minimum units of time that takes Luis to check all the gifts.
_The output must be written to standard output._
**Input**
**Output for the sample input**
5
5 1 1 1
1
3 0 0
5 3 1 1
1
4
-1
3 0 0
5 1 2 1
1
2 0 0
4 0 0
10 3 2 1
1
8
-2
4 0 0
6 0 0
5 3 3 5
1
2
-1
2 1 3
2 4 1
2 3 4
Scenario #1: 3
Scenario #2: 2
Scenario #3: 4
Scenario #4: 3
Scenario #5: 17
Explanation of the last case:
Luis starts in floor 0, takes an elevator to floor 2, lets call the three gift on the second floor (A,B,C) with A={1,3}, B={4,1}, C={3,4}, he can pick the gifts in several ways; A,B,C; B,C,A; C,A,B; C,B,A; A,C,B; B,A,C; However, the minimal combination is B,A,C and return to the origin (0,0) that is 16 steps used plus the unit of time in the elevator, total = 17.
• 1
**Subtask 1 - 5%**
• 2
• 1
• 1
• 1
**Subtask 2 - 5%**
• 2
• 1
• 1
• 1
**Subtask 3 - 10%**
• 2
• 1
• 1
• 2
**Subtask 4 - 10%**
• 2
• 1
• 1
• 2
**Subtask 5 - 20%**
• 2
• 1
• 1
• 2
**Subtask 6 - 20%**
• 1
• 1
• 1
• 1
**Subtask 7 - 30%**
• 1
• 1
• 1
• 1</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
