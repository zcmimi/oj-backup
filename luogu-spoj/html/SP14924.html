<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>GRAFFTOL - King Graffs Tolls - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450397:mBYrhx5fF9e2EoDcKafjnvFvfxyuc8otNRq94tWzmn8=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22King%20Graff%2C%20the%20ruler%20of%20the%20land%20of%20Feerie%2C%20feels%20that%20he%20is%20not%20quite%20rich%20enough.%20As%20such%2C%20he%20would%20like%20to%20impose%20travel%20tolls%20on%20his%20people%21%20After%20all%2C%20why%20should%20they%20get%20to%20walk%20around%20his%20kingdom%20for%20free%3F%5Cn%5CnFeerie%20consists%20of%20%24%20N%20%24%20%28%20%24%201%20%5C%5Cleq%20N%20%5C%5Cleq%2010%5E5%20%24%20%29%20towns%20%28numbered%20%24%201..N%20%24%20%29%2C%20and%20%24%20N-1%20%24%20roads.%20The%20%24%20i%20%24%20th%20road%20runs%20between%20distinct%20towns%20%24%20A_i%20%24%20and%20%24%20B_i%20%24%20%2C%20in%20both%20directions.%20Every%20pair%20of%20towns%20is%20connected%20by%20exactly%20one%20path%20of%20connected%20roads.%20Currently%2C%20all%20travel%20is%20free%2C%20but%20King%20Graff%20is%20interested%20in%20charging%20for%20passage%20through%20certain%20towns.%5Cn%5CnHe%20is%20planning%20to%20have%20a%20meeting%20with%20the%20royal%20computer%20scientest%20-%20that%20would%20be%20you.%20The%20meeting%20will%20last%20%24%20M%20%24%20%28%20%24%201%20%5C%5Cleq%20M%20%5C%5Cleq%2010%5E5%20%24%20%29%20minutes%2C%20and%20in%20the%20%24%20i%20%24%20th%20minute%2C%20one%20of%20two%20things%20will%20occur%2C%20described%20by%20%24%20T_i%20%24%20.%20If%20%24%20T_i%3D%20%24%20%5C%22T%5C%22%2C%20Graff%20will%20proclaim%20that%20town%20%24%20X_i%20%24%20shall%20henceforth%20cost%20%24%20Y_i%20%24%20%28%20%24%200%20%5C%5Cleq%20Y_i%20%5C%5Cleq%2010%5E9%20%24%20%29%20dollars%20to%20pass%20through%2C%20and%20you%27ll%20update%20the%20map%20accordingly.%20Otherwise%2C%20if%20%24%20T_i%3D%20%24%20%5C%22Q%5C%22%2C%20he%20will%20ask%20you%20how%20much%20a%20trip%20from%20town%20%24%20X_i%20%24%20to%20a%20different%20town%20%24%20Y_i%20%24%20would%20currently%20cost%20a%20commoner%2C%20in%20order%20to%20gauge%20the%20effectiveness%20of%20his%20tolls%20-%20and%20you%20had%20better%20answer%20quickly%21%20Note%20that%20neither%20the%20starting%20nor%20the%20ending%20town%27s%20tolls%20are%20included%20in%20a%20trip%27s%20cost%2C%20as%20they%20are%20not%20passed%20through.%20Note%20also%20that%20a%20town%27s%20toll%20may%20be%20modified%20by%20Graff%20mutiple%20times%20throughout%20the%20meeting%2C%20in%20which%20case%20the%20most%20recent%20modification%20at%20any%20point%20will%20stand.%22%2C%22inputFormat%22%3A%22First%20line%3A%201%20integer%2C%20%24%20N%20%24%5Cn%5CnNext%20%24%20N-1%20%24%20lines%3A%202%20integers%2C%20%24%20A_i%20%24%20and%20%24%20B_i%20%24%20%2C%20for%20%24%20i%20%3D%201..N-1%20%24%5Cn%5CnNext%20line%3A%201%20integer%2C%20%24%20M%20%24%5Cn%5CnNext%20%24%20M%20%24%20lines%3A%201%20character%2C%20%24%20T_i%20%24%20%2C%20and%202%20integers%2C%20%24%20X_i%20%24%20and%20%24%20Y_i%20%24%20%2C%20for%20%24%20i%20%3D%201..M%20%24%22%2C%22outputFormat%22%3A%22%20%24%20X%20%24%20lines%20%28where%20%24%20X%20%24%20is%20the%20number%20of%20questions%20asked%20by%20King%20Graff%29%3A%201%20integer%2C%20the%20cost%20of%20the%20%24%20i%20%24%20th%20trip%20asked%20for%20%28in%20dollars%29%2C%20for%20%24%20i%20%3D%201..X%20%24%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F14924%22%2C%22id%22%3A%2214924%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP14924%22%2C%22title%22%3A%22GRAFFTOL%20-%20King%20Graffs%20Tolls%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22GRAFFTOL%20-%20King%20Graffs%20Tolls%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>GRAFFTOL - King Graffs Tolls</h1>
<h2>题目描述</h2>
<div>King Graff, the ruler of the land of Feerie, feels that he is not quite rich enough. As such, he would like to impose travel tolls on his people! After all, why should they get to walk around his kingdom for free?
Feerie consists of $ N $ ( $ 1 \leq N \leq 10^5 $ ) towns (numbered $ 1..N $ ), and $ N-1 $ roads. The $ i $ th road runs between distinct towns $ A_i $ and $ B_i $ , in both directions. Every pair of towns is connected by exactly one path of connected roads. Currently, all travel is free, but King Graff is interested in charging for passage through certain towns.
He is planning to have a meeting with the royal computer scientest - that would be you. The meeting will last $ M $ ( $ 1 \leq M \leq 10^5 $ ) minutes, and in the $ i $ th minute, one of two things will occur, described by $ T_i $ . If $ T_i= $ "T", Graff will proclaim that town $ X_i $ shall henceforth cost $ Y_i $ ( $ 0 \leq Y_i \leq 10^9 $ ) dollars to pass through, and you'll update the map accordingly. Otherwise, if $ T_i= $ "Q", he will ask you how much a trip from town $ X_i $ to a different town $ Y_i $ would currently cost a commoner, in order to gauge the effectiveness of his tolls - and you had better answer quickly! Note that neither the starting nor the ending town's tolls are included in a trip's cost, as they are not passed through. Note also that a town's toll may be modified by Graff mutiple times throughout the meeting, in which case the most recent modification at any point will stand.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>First line: 1 integer, $ N $
Next $ N-1 $ lines: 2 integers, $ A_i $ and $ B_i $ , for $ i = 1..N-1 $
Next line: 1 integer, $ M $
Next $ M $ lines: 1 character, $ T_i $ , and 2 integers, $ X_i $ and $ Y_i $ , for $ i = 1..M $</div>
<h3>输出格式</h3>
<br />
<div> $ X $ lines (where $ X $ is the number of questions asked by King Graff): 1 integer, the cost of the $ i $ th trip asked for (in dollars), for $ i = 1..X $</div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
