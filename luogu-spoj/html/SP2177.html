<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>GALOU - Galou is back! - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449724:F654oA+meQ+d7S9ofzNwfVFitIh5pbP6t0ShtjUdzR0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20famous%20witch%20is%20back.%20After%20killing%20an%20incredible%20amount%20of%20monsters%20in%20order%20to%20find%20a%20hidden%20treasure%2C%20Zak%20Galou%20decided%20to%20buy%20vineyards%20in%20Burgundy%20and%20retired.%20Everything%20was%20calm%20in%20his%20new%20life%2C%20until%20the%20day%20that%20his%20farm%20tractor%20stopped%20working.%5Cn%5Cn%20His%20tractor%5Cu2019s%20engine%20works%20based%20on%20a%20mechanism%20of%20gears.%20The%20engine%20can%20be%20represented%20by%20a%20bidimensional%20grid.%20At%20most%20one%20gear%20can%20be%20attached%20to%20each%20position%20of%20the%20grid.%20All%20the%20gears%20are%20identical%20and%20can%20mesh%20with%20adjacent%20gears.%20In%20this%20grid%2C%20a%20gear%20can%20have%20up%20to%20six%20other%20adjacent%20gears%2C%20see%20figure%20below%3A%5Cn%5Cn%21%5Bsubir%20imagenes%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP2177%5C%2Feef80a82b116f01731fc55e26a33d7f5d1534496.png%29%20Under%20normal%20utilization%2C%20when%20the%20tractor%20is%20started%2C%20some%20of%20the%20gears%20are%20initially%20activated%20and%20try%20to%20turn%20clockwise.%20When%20a%20gear%20tries%20to%20turn%20in%20one%20direction%2C%20all%20the%20adjacent%20gears%20try%20to%20turn%20in%20the%20opposite%20direction.%5Cn%5Cn%20When%20Zak%20Galou%20opened%20his%20engine%20he%20noticed%20that%20it%20had%20been%20sabotaged%20%28probably%20by%20a%20jealous%20treasure%20hunter%20who%20was%20not%20able%20to%20find%20the%20treasure%29.%20Some%20of%20the%20gears%20were%20removed%20from%20the%20engine%20and%20others%20have%20been%20added%20to%20it.%20As%20a%20consequence%2C%20some%20of%20the%20gears%20were%20immobile.%20A%20gear%20can%20be%20immobile%20either%20if%20it%20is%20free%20or%20if%20it%20is%20blocked.%20A%20gear%20is%20free%20when%20it%20is%20not%20an%20initially%20activated%20gear%20and%20no%20adjacent%20gear%20is%20trying%20to%20turn.%20A%20gear%20is%20blocked%20when%20it%20is%20trying%20to%20turn%20in%20both%20directions%20at%20the%20same%20time.%20For%20example%2C%20consider%20that%20there%20are%20three%20gears%20in%20the%20engine%20as%20shown%20in%20the%20figure%20below.%20If%20any%20of%20the%20gears%20is%20initially%20activated%20when%20the%20tractor%20is%20started%2C%20all%20of%20them%20will%20be%20blocked.%20If%20none%20of%20the%20gears%20are%20initially%20activated%2C%20all%20of%20them%20will%20be%20free.%5Cn%5Cn%21%5Bsubir%20imagenes%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP2177%5C%2Fa79f7b5951977cefb0f5fe9282bddab7c94fad5b.png%29%20As%20a%20part%20of%20the%20work%20of%20fixing%20his%20tractor%2C%20Zak%20Galou%20asks%20for%20your%20help%20to%20solve%20the%20following%20problem.%20Given%20the%20description%20of%20the%20engine%20and%20the%20gears%20that%20are%20initially%20activated%20in%20the%20clockwise%20direction%2C%20he%20wants%20to%20know%20for%20each%20gear%2C%20what%20is%20its%20state%20when%20the%20tractor%20is%20started%3A%20turn%20clockwise%2C%20turn%20counter-clockwise%2C%20free%20or%20blocked.%22%2C%22inputFormat%22%3A%22The%20input%20contains%20several%20test%20cases.%20The%20first%20line%20of%20a%20test%20case%20contains%20two%20integers%20R%20and%20C%2C%20separated%20by%20a%20single%20space%2C%20representing%20respectively%20the%20number%20of%20rows%20and%20columns%20of%20the%20engine%20grid%20%281%20%3C%3D%20R%2CC%20%3C%3D%20100%29.%20The%20next%20R%20lines%20describe%20the%20engine.%20The%20i-th%20line%20represents%20the%20i-th%20row%20of%20the%20engine%20and%20contains%20C%20characters.%20The%20character%20%5Cu201c.%5Cu201d%20indicates%20that%20there%20is%20no%20gear%20in%20the%20corresponding%20position%2C%20the%20character%20%5Cu201c%5C%5C%2A%5Cu201d%20indicates%20that%20there%20is%20a%20gear%20that%20_is%20not_%20initially%20activated%20when%20the%20engine%20is%20started%20and%20an%20%5Cu201cI%5Cu201d%20indicates%20that%20there%20is%20a%20gear%20that%20_is_%20initially%20activated%20when%20the%20engine%20is%20started.%20Notice%20that%2C%20for%20simplicity%20reasons%2C%20the%20parallelogram%20representing%20the%20engine%20grid%20is%20described%20in%20the%20input%20as%20if%20it%20was%20a%20rectangle%20with%20each%20row%20left%20aligned.%20The%20end%20of%20input%20is%20indicated%20by%20R%20%3D%20C%20%3D%200%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20your%20program%20must%20output%20R%20%2B%201%20lines.%20The%20first%20line%20must%20be%20empty%3B%20each%20of%20the%20following%20R%20lines%20must%20have%20C%20characters.%20The%20characters%20printed%20must%20represent%20the%20state%20of%20each%20position%20of%20the%20grid%20when%20the%20engine%20is%20started.%20Print%20a%20%5Cu201c.%5Cu201d%20if%20there%20is%20no%20gear%20in%20the%20position%3B%20a%20%5Cu201c%28%5Cu201d%20if%20there%20is%20a%20gear%20turning%20in%20the%20clockwise%20direction%3B%20a%20%5Cu201c%29%5Cu201d%20if%20there%20is%20a%20gear%20turning%20in%20the%20counter-clockwise%20direction%2C%20an%20uppercase%20%5Cu201cF%5Cu201d%20if%20there%20is%20a%20gear%20that%20is%20free%20and%20an%20uppercase%20%5Cu201cB%5Cu201d%20if%20there%20is%20a%20blocked%20gear.%22%2C%22samples%22%3A%5B%5B%224%203%5Cr%5Cn...%5Cr%5Cn.%2A.%5Cr%5Cn.I.%5Cr%5Cn...%5Cr%5Cn4%204%5Cr%5Cn....%5Cr%5Cn.%2A%2A.%5Cr%5Cn.I..%5Cr%5Cn..%2A.%5Cr%5Cn0%200%22%2C%22...%5Cr%5Cn.%29.%5Cr%5Cn.%28.%5Cr%5Cn...%5Cr%5Cn....%5Cr%5Cn.BB.%5Cr%5Cn.B..%5Cr%5Cn..F.%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B138%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F2177%22%2C%22id%22%3A%222177%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP2177%22%2C%22title%22%3A%22GALOU%20-%20Galou%20is%20back%21%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22GALOU%20-%20Galou%20is%20back%21%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>GALOU - Galou is back!</h1>
<h2>题目描述</h2>
<div>The famous witch is back. After killing an incredible amount of monsters in order to find a hidden treasure, Zak Galou decided to buy vineyards in Burgundy and retired. Everything was calm in his new life, until the day that his farm tractor stopped working.
His tractor’s engine works based on a mechanism of gears. The engine can be represented by a bidimensional grid. At most one gear can be attached to each position of the grid. All the gears are identical and can mesh with adjacent gears. In this grid, a gear can have up to six other adjacent gears, see figure below:
![subir imagenes](https://cdn.luogu.com.cn/upload/vjudge_pic/SP2177/eef80a82b116f01731fc55e26a33d7f5d1534496.png) Under normal utilization, when the tractor is started, some of the gears are initially activated and try to turn clockwise. When a gear tries to turn in one direction, all the adjacent gears try to turn in the opposite direction.
When Zak Galou opened his engine he noticed that it had been sabotaged (probably by a jealous treasure hunter who was not able to find the treasure). Some of the gears were removed from the engine and others have been added to it. As a consequence, some of the gears were immobile. A gear can be immobile either if it is free or if it is blocked. A gear is free when it is not an initially activated gear and no adjacent gear is trying to turn. A gear is blocked when it is trying to turn in both directions at the same time. For example, consider that there are three gears in the engine as shown in the figure below. If any of the gears is initially activated when the tractor is started, all of them will be blocked. If none of the gears are initially activated, all of them will be free.
![subir imagenes](https://cdn.luogu.com.cn/upload/vjudge_pic/SP2177/a79f7b5951977cefb0f5fe9282bddab7c94fad5b.png) As a part of the work of fixing his tractor, Zak Galou asks for your help to solve the following problem. Given the description of the engine and the gears that are initially activated in the clockwise direction, he wants to know for each gear, what is its state when the tractor is started: turn clockwise, turn counter-clockwise, free or blocked.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The input contains several test cases. The first line of a test case contains two integers R and C, separated by a single space, representing respectively the number of rows and columns of the engine grid (1 <= R,C <= 100). The next R lines describe the engine. The i-th line represents the i-th row of the engine and contains C characters. The character “.” indicates that there is no gear in the corresponding position, the character “\*” indicates that there is a gear that _is not_ initially activated when the engine is started and an “I” indicates that there is a gear that _is_ initially activated when the engine is started. Notice that, for simplicity reasons, the parallelogram representing the engine grid is described in the input as if it was a rectangle with each row left aligned. The end of input is indicated by R = C = 0</div>
<h3>输出格式</h3>
<br />
<div>For each test case, your program must output R + 1 lines. The first line must be empty; each of the following R lines must have C characters. The characters printed must represent the state of each position of the grid when the engine is started. Print a “.” if there is no gear in the position; a “(” if there is a gear turning in the clockwise direction; a “)” if there is a gear turning in the counter-clockwise direction, an uppercase “F” if there is a gear that is free and an uppercase “B” if there is a blocked gear.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 3
...
.*.
.I.
...
4 4
....
.**.
.I..
..*.
0 0</code></pre>
<h3>输出样例 #1</h3>
<pre><code>...
.).
.(.
...
....
.BB.
.B..
..F.</code></pre>
</article>
</div>
</div>
</body>
</html>
