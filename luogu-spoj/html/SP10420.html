<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>IOPC1200 - Hardware upgrade - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450214:5L+XOq41UmV/Sid0rFj3Zrz/+U1OwQ5PHpHWi6R02wc=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22It%20is%20after%20years%20that%20Dystopian%20Institute%20of%20Technology%20has%20got%20funds%20for%20upgrading%20their%20computers.%20However%2C%20the%20people%20in%20charge%20of%20the%20upgrade%20have%20decided%20to%20make%20this%20a%20chance%20to%20fill%20their%20own%20pockets%20rather.%5Cn%5CnThere%20are%20N%20computers%20in%20the%20DIT%20network%2C%20numbered%200%20to%20N-1.%20Computer%200%20is%20the%20main%20server%20which%20connects%20the%20network%20to%20the%20outer%20world.%20Some%20pairs%20of%20the%20computers%20are%20directly%20connected%20in%20the%20network.%20For%20other%20pair%20of%20computers%20to%20communicate%20with%20each%20other%2C%20they%20have%20to%20do%20it%20via%20some%20other%20computer.%20For%20example%2C%20if%20there%20are%20only%203%20computers%20in%20the%20network%20and%20the%20only%20direct%20connections%20are%200-1%20and%200-2%2C%20then%201%20communicates%20with%202%20using%200%20as%20intermediate.%20There%20is%20no%20limit%20on%20the%20number%20of%20intermediate%20computers%20to%20be%20used%20for%20communication%20between%20a%20pair.%20Now%2C%20since%20the%20DIT%20network%20was%20built%20on%20the%20principle%20of%20minimum%20expenditure%2C%20the%20N%20computers%20have%20been%20made%20pairwise%20connected%20by%20using%20the%20minimum%20number%20of%20direct%20connections%20-%20ie%2C%20N-1.%5Cn%5CnThe%20upgrade%20contractor%20has%20decided%20to%20not%20do%20the%20work%20properly%20but%20pocket%20the%20entire%20funds%20instead.%20However%2C%20to%20show%20that%20he%20has%20done%20something%2C%20he%20will%20rearrange%20the%20computers.%20For%20example%20he%20could%20move%20the%20computer%20number%203%20to%20where%202%20was%20earlier%2C%202%20to%201%2C%201%20to%203%2C%204%20to%205%20and%205%20to%204.%20The%20computer%20number%200%20is%20special%20and%20cannot%20be%20moved.%20Direct%20connections%20between%20computers%20depend%20on%20the%20locations%20though.%20Hence%20if%20there%20was%20a%20direct%20connection%20earlier%20between%203%20and%205%2C%20it%20will%20now%20be%20between%201%20and%204%20%28since%20they%20have%20been%20placed%20at%20the%20locations%203%20and%205%20were%20at%20earlier%29.%20However%2C%20he%20has%20noticed%20something%20strange%20%3A%20the%20new%20direct%20connection%20between%20computers%20i%20and%20j%20works%20if%20and%20only%20if%20there%20was%20a%20direct%20connection%20between%20i%20and%20j%20earlier.%20Hence%20he%20wants%20to%20rearrange%20the%20computers%20in%20such%20a%20way%20that%20the%20pairs%20of%20computers%20which%20are%20connected%20directly%20now%20are%20the%20same%20pairs%20which%20were%20connected%20earlier.%5Cn%5CnGiven%20the%20computer%20network%2C%20count%20the%20number%20of%20ways%20the%20computers%20can%20be%20rearranged%20satisfying%20the%20conditions.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20T%2C%20the%20number%20of%20test%20cases%20%28T%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20output%20the%20number%20of%20rearrangements%20of%20the%20computers.%20A%20rearrangement%20%28p%20%24%20_%7B0%7D%20%24%20%2Cp%20%24%20_%7B1%7D%20%24%20%2Cp%20%24%20_%7B2%7D%20%24%20...p%20%24%20_%7BN-1%7D%20%24%20%29%20of%20%280%2C1%2C2...N-1%29%20is%20valid%20if%20the%20following%20conditions%20are%20satisfied%3A%5Cn%5Cn-%20p%20%24%20_%7B0%7D%20%24%20%3D0%5Cn-%20If%20there%20is%20a%20direct%20connection%20between%20i%20and%20j%2C%20there%20should%20also%20be%20a%20direct%20connection%20between%20p%20%24%20_%7Bi%7D%20%24%20and%20p%20%24%20_%7Bj%7D%20%24%5Cn%5CnNotice%20that%20%280%2C1%2C2...N-1%29%20is%20considered%20a%20valid%20rearrangement%20of%20itself.%20Also%2C%20since%20the%20answer%20could%20be%20very%20big%2C%20output%20it%20modulo%201000000007%22%2C%22samples%22%3A%5B%5B%221%5Cr%5Cn6%5Cr%5Cn0%201%5Cr%5Cn0%202%5Cr%5Cn0%203%5Cr%5Cn3%204%5Cr%5Cn3%205%22%2C%224%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B100%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F10420%22%2C%22id%22%3A%2210420%22%7D%2C%22translation%22%3A%22%5Cu7ecf%5Cu8fc7%5Cu53cd%5Cu4e4c%5Cu6258%5Cu90a6%5Cu6280%5Cu672f%5Cu5b66%5Cu9662%5Cu7684%5Cu4e0d%5Cu61c8%5Cu52aa%5Cu529b%5Cuff0c%5Cu4ed6%5Cu4eec%5Cu5df2%5Cu7ecf%5Cu8d5a%5Cu5230%5Cu4e86%5Cu5347%5Cu7ea7%5Cu8ba1%5Cu7b97%5Cu673a%5Cu7684%5Cu8d44%5Cu91d1%5Cu3002%5Cu7136%5Cu800c%5Cuff0c%5Cu8d1f%5Cu8d23%5Cu5347%5Cu7ea7%5Cu7684%5Cu627f%5Cu5305%5Cu5546%5Cu51b3%5Cu5b9a%5Cu5229%5Cu7528%5Cu8fd9%5Cu4e2a%5Cu673a%5Cu4f1a%5Cu586b%5Cu6ee1%5Cu4ed6%5Cu4eec%5Cu81ea%5Cu5df1%5Cu7684%5Cu53e3%5Cu888b%5Cu3002%5Cr%5Cn%5Cr%5CnDIT%5Cu7f51%5Cu7edc%5Cu4e2d%5Cu6709N%5Cu53f0%5Cu8ba1%5Cu7b97%5Cu673a%5Cuff0c%5Cu7f16%5Cu53f7%5Cu4e3a0%5Cu5230N-1%5Cu3002%5Cu8ba1%5Cu7b97%5Cu673a0%5Cu662f%5Cu5c06%5Cu7f51%5Cu7edc%5Cu8fde%5Cu63a5%5Cu5230%5Cu5916%5Cu90e8%5Cu4e16%5Cu754c%5Cu7684%5Cu4e3b%5Cu670d%5Cu52a1%5Cu5668%5Cu3002%5Cu4e00%5Cu4e9b%5Cu8ba1%5Cu7b97%5Cu673a%5Cu5bf9%5Cu76f4%5Cu63a5%5Cu8fde%5Cu63a5%5Cu5728%5Cu7f51%5Cu7edc%5Cu4e2d%5Cu3002%5Cu5982%5Cu679c%5Cu5176%5Cu4ed6%5Cu4e00%5Cu5bf9%5Cu8ba1%5Cu7b97%5Cu673a%5Cu76f8%5Cu4e92%5Cu901a%5Cu4fe1%5Cuff0c%5Cu5b83%5Cu4eec%5Cu5c06%5Cu5fc5%5Cu987b%5Cu901a%5Cu8fc7%5Cu5176%5Cu4ed6%5Cu8ba1%5Cu7b97%5Cu673a%5Cu8fdb%5Cu884c%5Cu901a%5Cu4fe1%5Cu3002%5Cu4f8b%5Cu5982%5Cuff0c%5Cu5982%5Cu679c%5Cu7f51%5Cu7edc%5Cu4e2d%5Cu53ea%5Cu67093%5Cu53f0%5Cu8ba1%5Cu7b97%5Cu673a%5Cuff0c%5Cu5e76%5Cu4e14%5Cu552f%5Cu4e00%5Cu7684%5Cu8fde%5Cu63a5%5Cu662f0-1%5Cu548c0-2%5Cuff0c%5Cu52191%5Cu4f7f%5Cu75280%5Cu4f5c%5Cu4e3a%5Cu5171%5Cu540c%5Cu7684%5Cu6570%5Cu4e0e2%5Cu8fdb%5Cu884c%5Cu901a%5Cu4fe1%5Cu3002%5Cu7528%5Cu4e8e%5Cu4e00%5Cu5bf9%5Cu4e4b%5Cu95f4%5Cu7684%5Cu901a%5Cu4fe1%5Cu7684%5Cu4e2d%5Cu95f4%5Cu8ba1%5Cu7b97%5Cu673a%5Cu7684%5Cu6570%5Cu91cf%5Cu6ca1%5Cu6709%5Cu9650%5Cu5236%5Cu3002%5Cu73b0%5Cu5728%5Cuff0c%5Cu56e0%5Cu4e3aDIT%5Cu7f51%5Cu7edc%5Cu5efa%5Cu7acb%5Cu5728%5Cu6700%5Cu5c0f%5Cu652f%5Cu51fa%5Cu539f%5Cu5219%5Cu7684%5Cu57fa%5Cu7840%5Cu4e0a%5Cuff0c%5Cu6240%5Cu4ee5N%5Cu53f0%5Cu8ba1%5Cu7b97%5Cu673a%5Cu901a%5Cu8fc7%5Cu4f7f%5Cu7528%5Cu6700%5Cu5c11%5Cu6570%5Cu91cf%5Cu7684%5Cu8fde%5Cu63a5%5Cuff08%5Cu5373N-1%5Cuff09%5Cu6210%5Cu5bf9%5Cu76f4%5Cu63a5%5Cu8fde%5Cu63a5%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5347%5Cu7ea7%5Cu627f%5Cu5305%5Cu5546%5Cu51b3%5Cu5b9a%5Cu4e0d%5Cu5e2e%5Cu6280%5Cu672f%5Cu5b66%5Cu9662%5Cu5347%5Cu7ea7%5Cuff0c%5Cu800c%5Cu662f%5Cu5c06%5Cu6574%5Cu7b14%5Cu8d44%5Cu91d1%5Cu653e%5Cu5165%5Cu53e3%5Cu888b%5Cu3002%5Cu7136%5Cu800c%5Cuff0c%5Cu4e3a%5Cu4e86%5Cu8868%5Cu660e%5Cu4ed6%5Cu5df2%5Cu7ecf%5Cu505a%5Cu4e86%5Cu4e00%5Cu4e9b%5Cu4e8b%5Cu60c5%5Cuff0c%5Cu4ed6%5Cu5c06%5Cu91cd%5Cu65b0%5Cu5b89%5Cu6392%5Cu8ba1%5Cu7b97%5Cu673a%5Cu3002%5Cu4f8b%5Cu5982%5Cuff0c%5Cu4ed6%5Cu53ef%5Cu4ee5%5Cu5c06%5Cu8ba1%5Cu7b97%5Cu673a%5Cu7f16%5Cu53f73%5Cu79fb%5Cu52a8%5Cu52302%5Cuff0c2%5Cu52301%5Cuff0c1%5Cu52303%2C4%5Cu52305%5Cu548c5%5Cu52304%5Cu3002%5Cu7f16%5Cu53f7%5Cu4e3a0%5Cu7684%5Cu8ba1%5Cu7b97%5Cu673a%5Cu5f88%5Cu7279%5Cu6b8a%5Cuff0c%5Cu4e0d%5Cu80fd%5Cu79fb%5Cu52a8%5Cu3002%5Cu8ba1%5Cu7b97%5Cu673a%5Cu4e4b%5Cu95f4%5Cu7684%5Cu76f4%5Cu63a5%5Cu8fde%5Cu63a5%5Cu53d6%5Cu51b3%5Cu4e8e%5Cu4f4d%5Cu7f6e%5Cu3002%5Cu56e0%5Cu6b64%5Cuff0c%5Cu5982%5Cu679c%5Cu57283%5Cu548c5%5Cu4e4b%5Cu95f4%5Cu5b58%5Cu5728%5Cu76f4%5Cu63a5%5Cu8fde%5Cu63a5%5Cuff0c%5Cu5219%5Cu5b83%5Cu73b0%5Cu5728%5Cu5c06%5Cu4ecb%5Cu4e8e1%5Cu548c4%5Cu4e4b%5Cu95f4%5Cuff08%5Cu56e0%5Cu4e3a%5Cu5b83%5Cu4eec%5Cu5df2%5Cu7ecf%5Cu653e%5Cu7f6e%5Cu5728%5Cu4f4d%5Cu7f6e3%5Cu548c5%5Cu4e4b%5Cu524d%5Cuff09%5Cu3002%5Cu7136%5Cu800c%5Cuff0c%5Cu4ed6%5Cu6ce8%5Cu610f%5Cu5230%5Cu4e00%5Cu4ef6%5Cu5947%5Cu602a%5Cu7684%5Cu4e8b%5Cu60c5%5Cuff1a%5Cu5f53%5Cu4e4b%5Cu524di%5Cu548cj%5Cu4e4b%5Cu95f4%5Cu5b58%5Cu5728%5Cu76f4%5Cu63a5%5Cu8fde%5Cu63a5%5Cu65f6%5Cuff0c%5Cu8ba1%5Cu7b97%5Cu673ai%5Cu548cj%5Cu4e4b%5Cu95f4%5Cu7684%5Cu65b0%5Cu7684%5Cu76f4%5Cu63a5%5Cu8fde%5Cu63a5%5Cu662f%5Cu6709%5Cu6548%5Cu7684%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu7ed9%5Cu5b9a%5Cu8ba1%5Cu7b97%5Cu673a%5Cu7f51%5Cu7edc%5Cuff0c%5Cu8ba1%5Cu7b97%5Cu6ee1%5Cu8db3%5Cu6761%5Cu4ef6%5Cu7684%5Cu8ba1%5Cu7b97%5Cu673a%5Cu53ef%5Cu4ee5%5Cu91cd%5Cu65b0%5Cu6392%5Cu5217%5Cu7684%5Cu65b9%5Cu5f0f%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP10420%22%2C%22title%22%3A%22IOPC1200%20-%20Hardware%20upgrade%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22IOPC1200%20-%20Hardware%20upgrade%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>IOPC1200 - Hardware upgrade</h1>
<h2>题意翻译</h2>
<div>经过反乌托邦技术学院的不懈努力，他们已经赚到了升级计算机的资金。然而，负责升级的承包商决定利用这个机会填满他们自己的口袋。
DIT网络中有N台计算机，编号为0到N-1。计算机0是将网络连接到外部世界的主服务器。一些计算机对直接连接在网络中。如果其他一对计算机相互通信，它们将必须通过其他计算机进行通信。例如，如果网络中只有3台计算机，并且唯一的连接是0-1和0-2，则1使用0作为共同的数与2进行通信。用于一对之间的通信的中间计算机的数量没有限制。现在，因为DIT网络建立在最小支出原则的基础上，所以N台计算机通过使用最少数量的连接（即N-1）成对直接连接。
升级承包商决定不帮技术学院升级，而是将整笔资金放入口袋。然而，为了表明他已经做了一些事情，他将重新安排计算机。例如，他可以将计算机编号3移动到2，2到1，1到3,4到5和5到4。编号为0的计算机很特殊，不能移动。计算机之间的直接连接取决于位置。因此，如果在3和5之间存在直接连接，则它现在将介于1和4之间（因为它们已经放置在位置3和5之前）。然而，他注意到一件奇怪的事情：当之前i和j之间存在直接连接时，计算机i和j之间的新的直接连接是有效的。
给定计算机网络，计算满足条件的计算机可以重新排列的方式。</div>
<h2>题目描述</h2>
<div>It is after years that Dystopian Institute of Technology has got funds for upgrading their computers. However, the people in charge of the upgrade have decided to make this a chance to fill their own pockets rather.
There are N computers in the DIT network, numbered 0 to N-1. Computer 0 is the main server which connects the network to the outer world. Some pairs of the computers are directly connected in the network. For other pair of computers to communicate with each other, they have to do it via some other computer. For example, if there are only 3 computers in the network and the only direct connections are 0-1 and 0-2, then 1 communicates with 2 using 0 as intermediate. There is no limit on the number of intermediate computers to be used for communication between a pair. Now, since the DIT network was built on the principle of minimum expenditure, the N computers have been made pairwise connected by using the minimum number of direct connections - ie, N-1.
The upgrade contractor has decided to not do the work properly but pocket the entire funds instead. However, to show that he has done something, he will rearrange the computers. For example he could move the computer number 3 to where 2 was earlier, 2 to 1, 1 to 3, 4 to 5 and 5 to 4. The computer number 0 is special and cannot be moved. Direct connections between computers depend on the locations though. Hence if there was a direct connection earlier between 3 and 5, it will now be between 1 and 4 (since they have been placed at the locations 3 and 5 were at earlier). However, he has noticed something strange : the new direct connection between computers i and j works if and only if there was a direct connection between i and j earlier. Hence he wants to rearrange the computers in such a way that the pairs of computers which are connected directly now are the same pairs which were connected earlier.
Given the computer network, count the number of ways the computers can be rearranged satisfying the conditions.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains T, the number of test cases (T</div>
<h3>输出格式</h3>
<br />
<div>For each test case, output the number of rearrangements of the computers. A rearrangement (p $ _{0} $ ,p $ _{1} $ ,p $ _{2} $ ...p $ _{N-1} $ ) of (0,1,2...N-1) is valid if the following conditions are satisfied:
- p $ _{0} $ =0
- If there is a direct connection between i and j, there should also be a direct connection between p $ _{i} $ and p $ _{j} $
Notice that (0,1,2...N-1) is considered a valid rearrangement of itself. Also, since the answer could be very big, output it modulo 1000000007</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1
6
0 1
0 2
0 3
3 4
3 5</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4</code></pre>
</article>
</div>
</div>
</body>
</html>
