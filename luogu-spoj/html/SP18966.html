<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>VACATION - Vacation Planning - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450521:ncdncv0kKG6bwMQjJWfjnDeeCImuHtyXqhEA+us1GTQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%20%5BEnglish%5D%28%5C%2Fproblems%5C%2FVACATION%5C%2Fen%5C%2F%29%20%5BVietnamese%5D%28%5C%2Fproblems%5C%2FVACATION%5C%2Fvn%5C%2F%29Air%20Bovinia%20is%20planning%20to%20connect%20the%20N%20farms%20%281%20%3C%3D%20N%20%3C%3D%20200%29%20that%20the%20cows%20live%20on.%20As%20with%20any%20airline%2C%20K%20of%20these%20farms%20%281%20%3C%3D%20K%20%3C%3D%20100%2C%20K%20%3C%3D%20N%29%20have%20been%20selected%20as%20hubs.%20The%20farms%20are%20conveniently%20numbered%201..N%2C%20with%20farms%201..K%20being%20the%20hubs.%5Cn%5CnCurrently%20there%20are%20M%20%281%20%3C%3D%20M%20%3C%3D%2010%2C000%29%20one-way%20flights%20connecting%20these%20farms.%20Flight%20i%20travels%20from%20farm%20u%5C%5C_i%20to%20farm%20v%5C%5C_i%2C%20and%20costs%20d%5C%5C_i%20dollars%20%281%20%3C%3D%20d%5C%5C_i%20%3C%3D%201%2C000%2C000%29.%5Cn%5CnThe%20airline%20recently%20received%20a%20request%20for%20Q%20%281%20%3C%3D%20Q%20%3C%3D%2010%2C000%29%20one-way%20trips.%20The%20ith%20trip%20is%20from%20farm%20a%5C%5C_i%20to%20farm%20b%5C%5C_i.%20In%20order%20to%20get%20from%20a%5C%5C_i%20to%20b%5C%5C_i%2C%20the%20trip%20may%20include%20any%20sequence%20of%20direct%20flights%20%28possibly%20even%20visiting%20the%20same%20farm%20multiple%20times%29%2C%20but%20it%20must%20include%20at%20least%20one%20hub%20%28which%20may%20or%20may%20not%20be%20be%20the%20start%20or%20the%20destination%29.%20This%20requirement%20may%20result%20in%20there%20being%20no%20valid%20route%20from%20a%5C%5C_i%20to%20b%5C%5C_i.%20For%20all%20other%20trip%20requests%2C%20however%2C%20your%20goal%20is%20to%20help%20Air%20Bovinia%20determine%20the%20minimum%20cost%20of%20a%20valid%20route.%5Cn%5Cn%2A%2AInput%20%3A%2A%2A%5Cn%5Cn%20%5C%5C%2A%20Line%201%3A%20Four%20integers%3A%20N%2C%20M%2C%20K%2C%20and%20Q.%5Cn%5Cn%20%5C%5C%2A%20Lines%202..1%2BM%3A%20Line%20i%2B1%20contains%20u%5C%5C_i%2C%20v%5C%5C_i%2C%20and%20d%5C%5C_i%20for%20flight%20i.%5Cn%5Cn%20%5C%5C%2A%20Lines%202%2BM..1%2BM%2BQ%3A%20Line%201%2BM%2Bi%20describes%20the%20ith%20trip%20in%20terms%20of%20a%5C%5C_i%20and%20b%5C%5C_i%5Cn%5Cn%2A%2AOutput%20%3A%2A%2A%5Cn%5Cn%20%5C%5C%2A%20Line%201%3A%20The%20number%20of%20trips%20%28out%20of%20Q%29%20for%20which%20a%20valid%20route%20is%20possible.%5Cn%5Cn%20%5C%5C%2A%20Line%202%3A%20The%20sum%2C%20over%20all%20trips%20for%20which%20a%20valid%20route%20is%20possible%2C%20of%20the%20minimum%20possible%20route%20cost.%5Cn%5CnSAMPLE%20INPUT%20%3A%5Cn%5Cn%203%203%201%203%5Cn%5Cn%203%201%2010%5Cn%5Cn%201%203%2010%5Cn%5Cn%201%202%207%5Cn%5Cn%203%202%5Cn%5Cn%202%203%5Cn%5Cn%201%202%5Cn%5CnSAMPLE%20OUTPUT%20%3A%5Cn%5Cn%202%5Cn%5Cn%2024%5Cn%5CnINPUT%20DETAILS%20%3A%20There%20are%20three%20farms%20%28numbered%201..3%29%3B%20farm%201%20is%20a%20hub.%20There%20is%20a%20%2410%20flight%20from%20farm%203%20to%20farm%201%2C%20and%20so%20on.%20We%20wish%20to%20look%20for%20trips%20from%20farm%203%20to%20farm%202%2C%20from%202-%3E3%2C%20and%20from%201-%3E2.%5Cn%5CnOUTPUT%20DETAILS%20%3A%20The%20trip%20from%203-%3E2%20has%20only%20one%20possible%20route%2C%20of%20cost%2010%2B7.%20The%20trip%20from%202-%3E3%20has%20no%20valid%20route%2C%20since%20there%20is%20no%20flight%20leaving%20farm%202.%20The%20trip%20from%201-%3E2%20has%20only%20one%20valid%20route%20again%2C%20of%20cost%207.%5Cn%5Cn%20%60%60%60%5Cn%3Cpre%20style%3D%5C%22word-wrap%3A%20break-word%3B%20white-space%3A%20pre-wrap%3B%5C%22%3E%5Cn%60%60%60%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F18966%22%2C%22id%22%3A%2218966%22%7D%2C%22translation%22%3A%22%23%23%23%23%23%23%20Bovinia%5Cu8bbe%5Cu8ba1%5Cu4e86%5Cu8fde%5Cu63a5N%20%281%20%3C%20%3D%20N%20%3C%20%3D%2020%2C000%29%5Cu4e2a%5Cu519c%5Cu573a%5Cu7684%5Cu822a%5Cu73ed%5Cu3002%5Cu5bf9%5Cu4e8e%5Cu4efb%5Cu4f55%5Cu822a%5Cu73ed%5Cuff0c%5Cu6307%5Cu5b9a%5Cu4e86%5Cu5176%5Cu4e2d%5Cu7684%5Cu524dk%5Cu4e2a%5Cu519c%5Cu573a%5Cu4f5c%5Cu4e3a%5Cu67a2%5Cu7ebd%5Cu3002%20%281%20%3C%20%3D%20K%20%3C%3D%20200%20%2C%20K%20%3C%20%3D%20N%29%5Cu3002%20%20%5Cr%5Cn%23%23%23%23%23%23%20%5Cu76ee%5Cu524d%5Cuff0c%5Cu5171%5Cu6709M%5Cu79cd%5Cu5355%5Cu5411%5Cu822a%5Cu73ed%5Cuff08%201%20%3C%20%3D%20M%20%3C%20%3D%2020%2C000%20%5Cuff09%5Cuff0c%5Cu7b2ci%5Cu4e2a%5Cu822a%5Cu73ed%5Cu4ece%5Cu519c%5Cu573au_i%5Cu81f3%5Cu519c%5Cu573av_i%5Cu82b1%5Cu8d39d_i%20%28%201%20%3C%20%3D%20d_i%20%3C%20%3D10%2C000%20%29%5Cu7f8e%5Cu5143%5Cu3002%5Cu822a%5Cu73ed%5Cu4fdd%5Cu8bc1u_i%5Cu6216%5Cu8005v_i%5Cu81f3%5Cu5c11%5Cu6709%5Cu4e00%5Cu4e2a%5Cu662f%5Cu67a2%5Cu7ebd%5Cuff0c%5Cu4efb%5Cu610f%5Cu4e24%5Cu4e2a%5Cu519c%5Cu573a%5Cu81f3%5Cu591a%5Cu53ea%5Cu6709%5Cu4e00%5Cu4e2a%5Cu822a%5Cu73ed%5Cuff0c%5Cu4fdd%5Cu8bc1u_i%5Cu2260v_i%5Cu3002%20%20%5Cr%5Cn%23%23%23%23%23%23%20Bessie%5Cu8d1f%5Cu8d23%5Cu7968%5Cu52a1%5Cu670d%5Cu52a1%5Cu3002%5Cu5171%5Cu6536%5Cu5230Q%5Cu4e2a%5Cu5ea6%5Cu5047%5Cu8bf7%5Cu6c42%5Cuff0c%281%20%3C%20%3D%20Q%20%3C%20%3D%2050%2C000%29%5Cuff0c%5Cu5176%5Cu4e2d%5Cu7b2ci%5Cu4e2a%5Cu8bf7%5Cu6c42%5Cu662f%5Cu4ece%5Cu519c%5Cu573aa_i%5Cu81f3%5Cu519c%5Cu573ab_i%20%5Cu3002%5Cu8bf7%5Cu5e2e%5Cu52a9%5Cu5979%5Cu8ba1%5Cu7b97%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu8bf7%5Cu6c42%5Cu662f%5Cu5426%5Cu6ee1%5Cu8db3%20%5Cuff0c%5Cu5e76%5Cu8ba1%5Cu7b97%5Cuff1a%5Cu80fd%5Cu6ee1%5Cu8db3%5Cu7684%5Cu5ea6%5Cu5047%5Cu8bf7%5Cu6c42%5Cu7684%5Cu6700%5Cu5c0f%5Cu8d39%5Cu7528%5Cu603b%5Cu548c%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A42%2C%22totalAccepted%22%3A15%2C%22pid%22%3A%22SP18966%22%2C%22title%22%3A%22VACATION%20-%20Vacation%20Planning%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A131495%2C%22title%22%3A%22%5Cu7f16%5Cu8bd1%5Cu9519%5Cu8bef%5Cuff1f%5Cuff1f%5Cuff1f%5Cuff01%5Cuff01%5Cuff01%22%2C%22forum%22%3A%7B%22id%22%3A16313%2C%22name%22%3A%22SP18966%20VACATION%20-%20Vacation%20Planning%22%2C%22slug%22%3A%22SP18966%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22VACATION%20-%20Vacation%20Planning%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>VACATION - Vacation Planning</h1>
<h2>题意翻译</h2>
<div>###### Bovinia设计了连接N (1 < = N < = 20,000)个农场的航班。对于任何航班，指定了其中的前k个农场作为枢纽。 (1 < = K <= 200 , K < = N)。
###### 目前，共有M种单向航班（ 1 < = M < = 20,000 ），第i个航班从农场u_i至农场v_i花费d_i ( 1 < = d_i < =10,000 )美元。航班保证u_i或者v_i至少有一个是枢纽，任意两个农场至多只有一个航班，保证u_i≠v_i。
###### Bessie负责票务服务。共收到Q个度假请求，(1 < = Q < = 50,000)，其中第i个请求是从农场a_i至农场b_i 。请帮助她计算，每个请求是否满足 ，并计算：能满足的度假请求的最小费用总和。</div>
<h2>题目描述</h2>
<div> [English](/problems/VACATION/en/) [Vietnamese](/problems/VACATION/vn/)Air Bovinia is planning to connect the N farms (1 <= N <= 200) that the cows live on. As with any airline, K of these farms (1 <= K <= 100, K <= N) have been selected as hubs. The farms are conveniently numbered 1..N, with farms 1..K being the hubs.
Currently there are M (1 <= M <= 10,000) one-way flights connecting these farms. Flight i travels from farm u\_i to farm v\_i, and costs d\_i dollars (1 <= d\_i <= 1,000,000).
The airline recently received a request for Q (1 <= Q <= 10,000) one-way trips. The ith trip is from farm a\_i to farm b\_i. In order to get from a\_i to b\_i, the trip may include any sequence of direct flights (possibly even visiting the same farm multiple times), but it must include at least one hub (which may or may not be be the start or the destination). This requirement may result in there being no valid route from a\_i to b\_i. For all other trip requests, however, your goal is to help Air Bovinia determine the minimum cost of a valid route.
**Input :**
\* Line 1: Four integers: N, M, K, and Q.
\* Lines 2..1+M: Line i+1 contains u\_i, v\_i, and d\_i for flight i.
\* Lines 2+M..1+M+Q: Line 1+M+i describes the ith trip in terms of a\_i and b\_i
**Output :**
\* Line 1: The number of trips (out of Q) for which a valid route is possible.
\* Line 2: The sum, over all trips for which a valid route is possible, of the minimum possible route cost.
SAMPLE INPUT :
3 3 1 3
3 1 10
1 3 10
1 2 7
3 2
2 3
1 2
SAMPLE OUTPUT :
2
24
INPUT DETAILS : There are three farms (numbered 1..3); farm 1 is a hub. There is a $10 flight from farm 3 to farm 1, and so on. We wish to look for trips from farm 3 to farm 2, from 2->3, and from 1->2.
OUTPUT DETAILS : The trip from 3->2 has only one possible route, of cost 10+7. The trip from 2->3 has no valid route, since there is no flight leaving farm 2. The trip from 1->2 has only one valid route again, of cost 7.
```
<pre style="word-wrap: break-word; white-space: pre-wrap;">
```</div>

    <h2>输入输出格式</h2>
    <h3>输入格式</h3>
    <br />
    <div></div>
    <h3>输出格式</h3>
    <br />
    <div></div>

    <h2>输入输出样例</h2>
            <i>暂无测试点</i>
    
    </article>
    </div>
</div>
<!-- <script src="//www.recaptcha.net/recaptcha/api.js?hl=zh-CN&render=explicit&onload=renderCaptcha" async defer></script> -->
</body>
</html>
