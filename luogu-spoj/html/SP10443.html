<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>BRDGS - Bridges - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450217:fCQY7jNGIX242i7HtD0dc8EPl1IM5yFuRf3QOmifbtc=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22A%20new%20planet%20full%20of%20rivers%20was%20discovered%20and%20is%20being%20prepared%20for%20colonization.%20We%20want%20to%20connect%20every%20piece%20of%20land%20by%20bridges%2C%20the%20cost%20of%20building%20a%20bridge%20is%20its%20width.%22%2C%22inputFormat%22%3A%22The%20first%20number%20in%20the%20input%20file%20is%20T%20%3C%20200%2C%20the%20number%20of%20test%20cases.%20Each%20test%20case%20starts%20with%20a%20line%20with%20a%20integer%2C%20N%20%3C%3D%20500%2C%20the%20number%20of%20rivers.%20N%20lines%20are%20followed%20with%205%20integers%20each%2C%20Di1%2C%20Fi1%2C%20Di2%2C%20Fi2%20and%20Wi%20%3C%3D%201000000%2C%20the%20coordinates%20of%20the%20extremities%20and%20the%20width%20of%20the%20i-th%20river.%20Every%20D%20is%20between%20-90%20and%2090%2C%20and%20every%20F%20is%20between%200%20and%20359%2C%20they%20are%20measured%20in%20degrees%20and%20correspond%20to%20the%20spherical%20coordinates%20%28latitude%20and%20longitude%20respectively%29.%20%20%5CnThe%20two%20extremities%20of%20a%20river%20can%20be%20seen%20from%20above%20in%20a%20distance%20less%20than%20infinite%2C%20a%20course%20of%20a%20river%20is%20always%20the%20smallest%20possible%20and%20two%20rivers%20intersect%20in%20at%20most%201%20point.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%20print%20a%20single%20line%20with%20%5C%22Case%20%23X%3A%20C%5C%22%20where%20X%20is%20the%20number%20of%20the%20test%20case%20%28starting%20from%201%29%20and%20C%20is%20the%20minimum%20cost%20to%20build%20the%20bridges%20so%20the%20islands%20and%20continents%20are%20connected%20directly%20or%20indirectly%20to%20each%20other.%22%2C%22samples%22%3A%5B%5B%22%5C%5Cn%5C%5Cn3%5C%5Cn4%5C%5Cn0%200%2090%200%204%5C%5Cn90%200%200%20179%202%5C%5Cn0%200%20-90%200%201%5C%5Cn-90%200%200%20179%201%5C%5Cn6%5C%5Cn0%200%2010%2090%203%5C%5Cn0%200%20-20%2090%203%5C%5Cn0%20179%2010%2090%205%5C%5Cn0%20179%20-20%2090%201%5C%5Cn0%200%200%20179%2010%5C%5Cn-20%2090%2020%2090%201%5C%5Cn1%5C%5Cn0%202%200%203%201%22%2C%22%5C%5CnCase%20%231%3A%201%5C%5CnCase%20%232%3A%206%5C%5CnCase%20%233%3A%200%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B11270%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F10443%22%2C%22id%22%3A%2210443%22%7D%2C%22translation%22%3A%22%5Cu7528%5Cu6865%5Cu6881%5Cu8fde%5Cu63a5%5Cu6bcf%5Cu4e00%5Cu5757%5Cu571f%5Cu5730%5Cuff0c%5Cu6865%5Cu6881%5Cu7684%5Cu6210%5Cu672c%5Cu5c31%5Cu662f%5Cu5b83%5Cu7684%5Cu5bbd%5Cu5ea6%5Cu3002%5Cr%5Cn%5Cr%5CnT%3C200%5Cu4e3a%5Cu6d4b%5Cu8bd5%5Cu6570%5Cu636e%5Cu6570%5Cu91cf%5Cu3002N%20%3C%3D%20500%5Cu4e3a%5Cu6cb3%5Cu6d41%5Cu7684%5Cu6570%5Cu91cf%5Cu3002N%5Cu884c%5Cu4e4b%5Cu540e%5Cu5206%5Cu522b%5Cu662f5%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0cDi1%2C%20Fi1%2C%20Di2%2C%20Fi2%5Cu548cWi%20%3C%3D%201000000%5Cuff0c%5Cu662f%5Cu7b2ci%5Cu6761%5Cu6cb3%5Cu6d41%5Cu7684%5Cu6781%5Cu503c%5Cu5750%5Cu6807%5Cu548c%5Cu5bbd%5Cu5ea6%5Cu3002%5Cu6bcf%5Cu4e00%5Cu4e2aD%5Cu5728-90%5Cu548c90%5Cu4e4b%5Cu95f4%5Cuff0c%5Cu6bcf%5Cu4e00%5Cu4e2aF%5Cu57280%5Cu548c359%5Cu4e4b%5Cu95f4%5Cuff0c%5Cu5b83%5Cu4eec%5Cu662f%5Cu7528%5Cu5ea6%5Cu6570%5Cu6d4b%5Cu91cf%5Cu7684%5Cuff0c%5Cu5bf9%5Cu5e94%5Cu4e8e%5Cu7403%5Cu5750%5Cu6807%28%5Cu7eac%5Cu5ea6%5Cu548c%5Cu7ecf%5Cu5ea6%29%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4ece%5Cu4e0a%5Cu9762%5Cu770b%5Cuff0c%5Cu4e00%5Cu6761%5Cu6cb3%5Cu7684%5Cu957f%5Cu4e3a%5Cu65e0%5Cu7a77%5Cuff0c%5Cu4e00%5Cu6761%5Cu6cb3%5Cu7684%5Cu6cb3%5Cu9053%5Cu603b%5Cu662f%5Cu6700%5Cu5c0f%5Cu7684%5Cuff0c%5Cu4e24%5Cu6761%5Cu6cb3%5Cu7684%5Cu4ea4%5Cu70b9%5Cu6700%5Cu591a%5Cu5728%5Cu4e00%5Cu70b9%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e2a%5Cu6d4b%5Cu8bd5%5Cu7528%5Cu4f8b%5Cuff0c%5Cu6253%5Cu5370%5Cu4e00%5Cu884c%5Cu5e26%5Cu6709%5Cu201ccase%20%23X%3A%20C%5Cu201d%5Cu7684%5Cu4ee3%5Cu7801%5Cuff0c%5Cu5176%5Cu4e2dX%5Cu662f%5Cu6d4b%5Cu8bd5%5Cu7528%5Cu4f8b%5Cu7684%5Cu6570%5Cu91cf%28%5Cu4ece1%5Cu5f00%5Cu59cb%29%5Cuff0cC%5Cu662f%5Cu6784%5Cu5efa%5Cu6865%5Cu6881%5Cu7684%5Cu6700%5Cu4f4e%5Cu6210%5Cu672c%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP10443%22%2C%22title%22%3A%22BRDGS%20-%20Bridges%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22BRDGS%20-%20Bridges%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>BRDGS - Bridges</h1>
<h2>题意翻译</h2>
<div>用桥梁连接每一块土地，桥梁的成本就是它的宽度。
T<200为测试数据数量。N <= 500为河流的数量。N行之后分别是5个整数，Di1, Fi1, Di2, Fi2和Wi <= 1000000，是第i条河流的极值坐标和宽度。每一个D在-90和90之间，每一个F在0和359之间，它们是用度数测量的，对应于球坐标(纬度和经度)。
从上面看，一条河的长为无穷，一条河的河道总是最小的，两条河的交点最多在一点。
对于每个测试用例，打印一行带有“case #X: C”的代码，其中X是测试用例的数量(从1开始)，C是构建桥梁的最低成本。</div>
<h2>题目描述</h2>
<div>A new planet full of rivers was discovered and is being prepared for colonization. We want to connect every piece of land by bridges, the cost of building a bridge is its width.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first number in the input file is T < 200, the number of test cases. Each test case starts with a line with a integer, N <= 500, the number of rivers. N lines are followed with 5 integers each, Di1, Fi1, Di2, Fi2 and Wi <= 1000000, the coordinates of the extremities and the width of the i-th river. Every D is between -90 and 90, and every F is between 0 and 359, they are measured in degrees and correspond to the spherical coordinates (latitude and longitude respectively).
The two extremities of a river can be seen from above in a distance less than infinite, a course of a river is always the smallest possible and two rivers intersect in at most 1 point.</div>
<h3>输出格式</h3>
<br />
<div>For each test case print a single line with "Case #X: C" where X is the number of the test case (starting from 1) and C is the minimum cost to build the bridges so the islands and continents are connected directly or indirectly to each other.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>\n\n3\n4\n0 0 90 0 4\n90 0 0 179 2\n0 0 -90 0 1\n-90 0 0 179 1\n6\n0 0 10 90 3\n0 0 -20 90 3\n0 179 10 90 5\n0 179 -20 90 1\n0 0 0 179 10\n-20 90 20 90 1\n1\n0 2 0 3 1</code></pre>
<h3>输出样例 #1</h3>
<pre><code>\nCase #1: 1\nCase #2: 6\nCase #3: 0</code></pre>
</article>
</div>
</div>
</body>
</html>
