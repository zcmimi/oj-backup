<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>MORSE - Decoding Morse Sequences - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449530:QO5dtPneZFFzepwM6vqD+VjHmN8jH6mBs4HI3OtuiNY=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%20Before%20the%20digital%20age%2C%20the%20most%20common%20%5C%22binary%5C%22%20code%20for%20radio%20communication%20was%20the%20Morse%20code.%20In%20Morse%20code%2C%20symbols%20are%20encoded%20as%20sequences%20of%20short%20and%20long%20pulses%20%28called%20dots%20and%20dashes%20respectively%29.%20The%20following%20table%20reproduces%20the%20Morse%20code%20for%20the%20alphabet%2C%20where%20dots%20and%20dashes%20are%20represented%20as%20ASCII%20characters%20%5C%22.%5C%22%20and%20%5C%22-%5C%22%3A%5Cn%5Cn%60%60%60%5CnA%20.-%20%20%20B%20-...%20C%20-.-.%20D%20-..%20%5CnE%20.%20%20%20%20F%20..-.%20G%20--.%20%20H%20....%20%5CnI%20..%20%20%20J%20.---%20K%20-.-%20%20L%20.-..%20%5CnM%20--%20%20%20N%20-.%20%20%20O%20---%20%20P%20.--.%20%5CnQ%20--.-%20R%20.-.%20%20S%20...%20%20T%20-%20%5CnU%20..-%20%20V%20...-%20W%20.--%20%20X%20-..-%20%5CnY%20-.--%20Z%20--..%5Cn%60%60%60%5Cn%20Notice%20that%20in%20the%20absence%20of%20pauses%20between%20letters%20there%20might%20be%20multiple%20interpretations%20of%20a%20Morse%20sequence.%20For%20example%2C%20the%20sequence%20-.-..--%20could%20be%20decoded%20both%20as%20CAT%20or%20NXT%20%28among%20others%29.%20A%20human%20Morse%20operator%20would%20use%20other%20context%20information%20%28such%20as%20a%20language%20dictionary%29%20to%20decide%20the%20appropriate%20decoding.%20But%20even%20provided%20with%20such%20dictionary%20one%20can%20obtain%20multiple%20phrases%20from%20a%20single%20Morse%20sequence.%5Cn%5Cn%20%20%20%5Cn%23%23%23%20Task%5Cn%5CnWrite%20a%20program%20that%3A%5Cn%5Cn-%20reads%20a%20Morse%20sequence%20and%20a%20list%20of%20words%20%28a%20dictionary%29%2C%5Cn-%20computes%20the%20number%20of%20distinct%20phrases%20that%20can%20be%20obtained%20from%20the%20given%20Morse%20sequence%20using%20words%20from%20the%20dictionary%2C%5Cn-%20writes%20the%20result.%22%2C%22inputFormat%22%3A%22%20The%20first%20line%20of%20the%20input%20contains%20exactly%20one%20positive%20integer%20d%20equal%20to%20the%20number%20of%20data%20sets%2C%201%20%3C%3D%20d%20%3C%3D%2020.%20The%20data%20sets%20follow.%5Cn%5Cn%20The%20first%20line%20of%20each%20data%20set%20contains%20a%20Morse%20sequence%20-%20a%20nonempty%20sequence%20of%20at%20most%2010000%20characters%20%5C%22.%5C%22%20and%20%5C%22-%5C%22%20with%20no%20spaces%20in%20between.%5Cn%5Cn%20The%20second%20line%20contains%20exactly%20one%20integer%20n%2C%201%20%3C%3D%20n%20%3C%3D%2010000%2C%20equal%20to%20the%20number%20of%20words%20in%20a%20dictionary.%20Each%20of%20the%20following%20n%20lines%20contains%20one%20dictionary%20word%20-%20a%20nonempty%20sequence%20of%20at%20most%2020%20capital%20letters%20from%20%5C%22A%5C%22%20to%20%5C%22Z%5C%22.%20No%20word%20occurs%20in%20the%20dictionary%20more%20than%20once.%22%2C%22outputFormat%22%3A%22%20The%20output%20should%20consist%20of%20exactly%20d%20lines%2C%20one%20line%20for%20each%20data%20set.%20Line%20i%20should%20contain%20one%20integer%20equal%20to%20the%20number%20of%20distinct%20phrases%20into%20which%20the%20Morse%20sequence%20from%20the%20i-th%20data%20set%20can%20be%20parsed.%20You%20may%20assume%20that%20this%20number%20is%20at%20most%202%5C%5C%2A10%20%24%20%5E%7B9%7D%20%24%20for%20every%20single%20data%20set.%22%2C%22samples%22%3A%5B%5B%221%20%5Cr%5Cn.---.--.-.-.-.---...-.---.%20%5Cr%5Cn6%20%5Cr%5CnAT%20%5Cr%5CnTACK%20%5Cr%5CnTICK%20%5Cr%5CnATTACK%20%5Cr%5CnDAWN%20%5Cr%5CnDUSK%22%2C%222%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B7000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F108%22%2C%22id%22%3A%22108%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP108%22%2C%22title%22%3A%22MORSE%20-%20Decoding%20Morse%20Sequences%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22MORSE%20-%20Decoding%20Morse%20Sequences%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>MORSE - Decoding Morse Sequences</h1>
<h2>题目描述</h2>
<div> Before the digital age, the most common "binary" code for radio communication was the Morse code. In Morse code, symbols are encoded as sequences of short and long pulses (called dots and dashes respectively). The following table reproduces the Morse code for the alphabet, where dots and dashes are represented as ASCII characters "." and "-":
```
A .- B -... C -.-. D -..
E . F ..-. G --. H ....
I .. J .--- K -.- L .-..
M -- N -. O --- P .--.
Q --.- R .-. S ... T -
U ..- V ...- W .-- X -..-
Y -.-- Z --..
```
Notice that in the absence of pauses between letters there might be multiple interpretations of a Morse sequence. For example, the sequence -.-..-- could be decoded both as CAT or NXT (among others). A human Morse operator would use other context information (such as a language dictionary) to decide the appropriate decoding. But even provided with such dictionary one can obtain multiple phrases from a single Morse sequence.
### Task
Write a program that:
- reads a Morse sequence and a list of words (a dictionary),
- computes the number of distinct phrases that can be obtained from the given Morse sequence using words from the dictionary,
- writes the result.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div> The first line of the input contains exactly one positive integer d equal to the number of data sets, 1 <= d <= 20. The data sets follow.
The first line of each data set contains a Morse sequence - a nonempty sequence of at most 10000 characters "." and "-" with no spaces in between.
The second line contains exactly one integer n, 1 <= n <= 10000, equal to the number of words in a dictionary. Each of the following n lines contains one dictionary word - a nonempty sequence of at most 20 capital letters from "A" to "Z". No word occurs in the dictionary more than once.</div>
<h3>输出格式</h3>
<br />
<div> The output should consist of exactly d lines, one line for each data set. Line i should contain one integer equal to the number of distinct phrases into which the Morse sequence from the i-th data set can be parsed. You may assume that this number is at most 2\*10 $ ^{9} $ for every single data set.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1 
.---.--.-.-.-.---...-.---. 
6 
AT 
TACK 
TICK 
ATTACK 
DAWN 
DUSK</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2</code></pre>
</article>
</div>
</div>
</body>
</html>
