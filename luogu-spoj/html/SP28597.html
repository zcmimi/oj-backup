<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>BDOI16A - Guess the Queue - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450686:zL4HNCR7eNZ5prOzfBxuyh+lX5dfjX84zU3frcpMYRE=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%2A%2AGuess%20the%20Queue%2A%2A%5Cn%5CnBusland%20is%20a%20city%20where%20the%20only%20means%20of%20transportation%20are%20buses.%20To%20get%20on%20a%20bus%20in%20Busland%2C%20people%20have%20to%20wait%20in%20queue.%20Each%20person%20has%20a%20%2A%2Aunique%2A%2A%20bus%20%2A%2AID%2A%2A.%20The%20person%20at%20the%20front%20is%20considered%20the%20first%20person%20and%20the%20person%20at%20the%20back%20is%20considered%20the%20last%20person%20in%20the%20queue.%20Trivially%2C%20the%20first%20person%20will%20get%20on%20the%20bus%20first%20and%20the%20last%20person%20will%20get%20on%20last.%5Cn%5CnIt%20is%20well%20known%20that%20you%20should%20enter%20at%20the%20back%20of%20the%20queue.%20However%2C%20some%20people%20are%20very%20late%20and%20even%20though%20it%20is%20considered%20very%20rude%2C%20they%20try%20to%20enter%20in%20an%20alternative%20way.%20Since%20the%20sides%20of%20the%20queue%20are%20barricaded%2C%20the%20only%20alternative%20way%20is%20to%20enter%20from%20the%20front%20of%20the%20queue.%20Sometimes%20there%20are%20also%20people%20at%20the%20back%20of%20the%20queue%2C%20who%20become%20tired%20of%20waiting.%20They%20exit%20the%20queue%20from%20the%20back%20and%20just%20start%20walking%20to%20their%20destination%20instead.%5Cn%5CnYour%20task%20is%20to%20deal%20with%20three%20types%20of%20operations%20as%20follows%3A%5Cn%5Cn1%5C%5C.%20%5Cu2018%2A%2A1%2A%2A%20_%2A%2Ax%20y%2A%2A_%5Cu2019%20The%20person%20with%20%2A%2AID%2A%2A%20_%2A%2Ay%2A%2A_%20enters%20from%20the%20back%20or%20front%2C%20if%20_%2A%2Ax%2A%2A_%20is%20%5Cu2018%2A%2AB%2A%2A%5Cu2019%20or%20%5Cu2018%2A%2AF%2A%2A%5Cu2019%20respectively.%5Cn%5Cn2%5C%5C.%20%5Cu2018%2A%2A2%2A%2A%20_%2A%2Ax%5Cu2019%2A%2A_%20The%20person%20in%20the%20back%20or%20front%20exits%20the%20queue%2C%20if%20_%2A%2Ax%2A%2A_%20is%20%5Cu2018%2A%2AB%2A%2A%5Cu2019%20or%20%5Cu2018%2A%2AF%2A%2A%5Cu2019%20respectively.%5Cn%5Cn3%5C%5C.%20%5Cu2018%2A%2A3%2A%2A%20_%2A%2Ax%20y%5Cu2019%2A%2A_%20Find%20the%20%2A%2AID%2A%2A%20of%20the%20person%20in%20the%20_%2A%2Ay%2A%2A_th%20position%20of%20the%20queue%20or%20the%20position%20of%20the%20queue%2C%20where%20the%20person%20with%20%2A%2AID%2A%2A%20_%2A%2Ay%2A%2A_%20is%20currently%20situated%2C%20if%20_%2A%2Ax%2A%2A_%20is%20%5Cu2018%2A%2AD%2A%2A%5Cu2019%20or%20%5Cu2018%2A%2AP%2A%2A%5Cu2019%20respectively.%5Cn%5Cn%2A%2AInput%3A%2A%2A%5Cn%5Cn%3Ca%20name%3D%5C%22_GoBack%5C%22%3E%3C%5C%2Fa%3EThe%20first%20line%20of%20input%20will%20contain%20the%20number%20of%20test%20cases%2C%20_%2A%2AT%2A%2A_%20%2A%2A%281%20%3C%3D%2A%2A%20_%2A%2AT%2A%2A_%20%2A%2A%3C%3D%205%29%2A%2A.%20Then%20_%2A%2AT%2A%2A_%20cases%20follow.%5Cn%5CnEach%20case%20starts%20with%20an%20integer%20_%2A%2AN%2A%2A_%2C%20denoting%20the%20total%20number%20of%20operations.%20The%20following%20_%2A%2AN%2A%2A_%20lines%20will%20contain%20one%20of%20the%20three%20types%20described%20previously.%20The%20operations%20are%20in%20chronological%20order.%5Cn%5CnIt%20is%20guaranteed%20that%20the%20given%20input%20is%20always%20valid.%20Thus%2C%20for%20the%20second%20type%20operation%2C%20the%20queue%20will%20always%20be%20non-empty%20and%20for%20the%20third%20type%2C%20the%20given%20position%20or%20%2A%2AID%2A%2A%20will%20always%20exist%20in%20the%20queue.%20Also%2C%20a%20person%20who%20has%20already%20exited%2C%20will%20not%20enter%20the%20queue%20again.%5Cn%5Cn%2A%2AConstraints%3A%2A%2A%5Cn%5CnFor%20the%20%2A%2Aeasy%2A%2A%20version%2C%20%2A%2A1%20%3C%3D%2A%2A%20_%2A%2AN%2A%2A_%20%2A%2A%3C%3D%202000%2A%2A%5Cn%5CnFor%20the%20%2A%2Ahard%2A%2A%20version%2C%20%2A%2A1%20%3C%3D%2A%2A%20_%2A%2AN%2A%2A_%20%2A%2A%3C%3D%20200000%2A%2A%5Cn%5CnIn%20general%2C%5Cn%5Cn%2A%2A1%20%3C%3D%20each%20ID%20%3C%3D%2010%5E9%2C%2A%2A%20IDs%20are%20%2A%2Aunique%2A%2A%20for%20each%20person%5Cn%5Cn%2A%2A1%20%3C%3D%20each%20position%20%3C%3D%20current%20size%20of%20the%20queue%2A%2A%5Cn%5Cn%2A%2AOutput%3A%2A%2A%5Cn%5CnFor%20each%20case%2C%20print%20the%20case%20number%20on%20a%20single%20line%2C%20in%20the%20format%20%5Cu201c%2A%2ACase%20x%3A%2A%2A%5Cu201d%2C%20where%20_%2A%2Ax%2A%2A_%20is%20the%20case%20number.%5Cn%5CnFor%20each%20operation%20of%20the%20third%20type%2C%20output%20a%20single%20integer%2C%20which%20denotes%20the%20answer%20of%20the%20query.%5Cn%5Cn%20%2A%2ASample%20Input%2A%2A%5Cn%5Cn%20%20%2A%2ASample%20Output%2A%2A%5Cn%5Cn%20%201%5Cn%5Cn7%5Cn%5Cn1%20B%201%5Cn%5Cn1%20B%202%5Cn%5Cn1%20F%203%5Cn%5Cn3%20D%203%5Cn%5Cn2%20B%5Cn%5Cn1%20F%204%5Cn%5Cn3%20D%202%5Cn%5Cn%20%20Case%201%3A%5Cn%5Cn2%5Cn%5Cn3%5Cn%5Cn%20%2A%2AExplanation%20of%20the%20Sample%3A%2A%2A%5Cn%5CnThere%20is%20only%201%20test%20case%2C%20in%20which%20we%20have%20to%20perform%20a%20total%20of%207%20operations.%5Cn%5CnAt%20first%2C%20the%20queue%20is%20empty.%20A%20person%20with%20%2A%2AID%201%2A%2A%20and%20%2A%2A2%2A%2A%20enters%20from%20the%20back.%20After%20that%2C%20a%20person%20with%20%2A%2AID%203%2A%2A%20enters%20from%20the%20front.%20Now%20there%20are%20%2A%2A3%2A%2A%20people%20in%20the%20queue%20and%20the%20%2A%2AID%2A%2A%20of%20the%20%2A%2A3%2A%2A%20%24%20%5E%7Brd%7D%20%24%20%20person%20in%20the%20queue%20is%20%2A%2A2%2A%2A.%5Cn%5CnThe%20person%20in%20the%20back%20%28who%20has%20%2A%2AID%202%2A%2A%29%20exits%20the%20queue.%20This%20leaves%20only%20two%20people%20remaining.%5Cn%5CnFinally%2C%20a%20person%20with%20%2A%2AID%204%2A%2A%20enters%20from%20the%20front.%20Now%20there%20are%20again%20%2A%2A3%2A%2A%20people%20in%20the%20queue%20and%20the%20%2A%2AID%2A%2A%20of%20the%20%2A%2A2%2A%2A%20%24%20%5E%7Bnd%7D%20%24%20person%20of%20the%20queue%20is%20%2A%2A3%2A%2A.%20%20%5Cn%20%20%5Cn%2A%2AProblem%20Setter%3A%20Aninda%20Majumder%2A%2A%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F28597%22%2C%22id%22%3A%2228597%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP28597%22%2C%22title%22%3A%22BDOI16A%20-%20Guess%20the%20Queue%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22BDOI16A%20-%20Guess%20the%20Queue%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>BDOI16A - Guess the Queue</h1>
<h2>题目描述</h2>
<div>**Guess the Queue**
Busland is a city where the only means of transportation are buses. To get on a bus in Busland, people have to wait in queue. Each person has a **unique** bus **ID**. The person at the front is considered the first person and the person at the back is considered the last person in the queue. Trivially, the first person will get on the bus first and the last person will get on last.
It is well known that you should enter at the back of the queue. However, some people are very late and even though it is considered very rude, they try to enter in an alternative way. Since the sides of the queue are barricaded, the only alternative way is to enter from the front of the queue. Sometimes there are also people at the back of the queue, who become tired of waiting. They exit the queue from the back and just start walking to their destination instead.
Your task is to deal with three types of operations as follows:
1\. ‘**1** _**x y**_’ The person with **ID** _**y**_ enters from the back or front, if _**x**_ is ‘**B**’ or ‘**F**’ respectively.
2\. ‘**2** _**x’**_ The person in the back or front exits the queue, if _**x**_ is ‘**B**’ or ‘**F**’ respectively.
3\. ‘**3** _**x y’**_ Find the **ID** of the person in the _**y**_th position of the queue or the position of the queue, where the person with **ID** _**y**_ is currently situated, if _**x**_ is ‘**D**’ or ‘**P**’ respectively.
**Input:**
<a name="_GoBack"></a>The first line of input will contain the number of test cases, _**T**_ **(1 <=** _**T**_ **<= 5)**. Then _**T**_ cases follow.
Each case starts with an integer _**N**_, denoting the total number of operations. The following _**N**_ lines will contain one of the three types described previously. The operations are in chronological order.
It is guaranteed that the given input is always valid. Thus, for the second type operation, the queue will always be non-empty and for the third type, the given position or **ID** will always exist in the queue. Also, a person who has already exited, will not enter the queue again.
**Constraints:**
For the **easy** version, **1 <=** _**N**_ **<= 2000**
For the **hard** version, **1 <=** _**N**_ **<= 200000**
In general,
**1 <= each ID <= 10^9,** IDs are **unique** for each person
**1 <= each position <= current size of the queue**
**Output:**
For each case, print the case number on a single line, in the format “**Case x:**”, where _**x**_ is the case number.
For each operation of the third type, output a single integer, which denotes the answer of the query.
**Sample Input**
**Sample Output**
1
7
1 B 1
1 B 2
1 F 3
3 D 3
2 B
1 F 4
3 D 2
Case 1:
2
3
**Explanation of the Sample:**
There is only 1 test case, in which we have to perform a total of 7 operations.
At first, the queue is empty. A person with **ID 1** and **2** enters from the back. After that, a person with **ID 3** enters from the front. Now there are **3** people in the queue and the **ID** of the **3** $ ^{rd} $ person in the queue is **2**.
The person in the back (who has **ID 2**) exits the queue. This leaves only two people remaining.
Finally, a person with **ID 4** enters from the front. Now there are again **3** people in the queue and the **ID** of the **2** $ ^{nd} $ person of the queue is **3**.
**Problem Setter: Aninda Majumder**</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
