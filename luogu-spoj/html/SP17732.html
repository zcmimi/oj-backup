<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>SALMAN - Salary Management - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450488:he9MHXnkrW4EJ3YRGk1vv/K0pJ6mX9lgfLf4VZCWe1E=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%2A%2ASalary%20Management%2A%2A%5Cn%5CnYou%20are%20working%20as%20a%20software%20engineer%20of%20Moogle%21%20Now%20the%20boss%20of%20Moogle%20wants%20you%20to%20create%20a%20program%20which%20will%20efficiently%20handle%20some%20operations.%20At%20first%2C%20we%20should%20tell%20you%20about%20the%20structure%20of%20the%20employees%20at%20Moogle%21%20Each%20employee%20has%20an%20integer%20id%20from%201%20to%20N.%20Where%201%20is%20the%20id%20of%20the%20Managing%20Director%20of%20Moogle%21%20%2C%20who%20is%20the%20greatest%20boss%20of%20all%20the%20employees.%20Then%20except%20the%20Managing%20Director%2C%20each%20employee%20has%20an%20immediate%20boss.%20No%20employees%20have%20more%20than%20one%20immediate%20boss.%20Now%20your%20boss%20wants%20to%20have%20some%20operation%20like%20this%20%5Cu2013%5Cn%5Cn1.%20He%20will%20give%20you%20an%20ID%20of%20an%20employee%3B%20you%20need%20to%20find%20the%20sum%20of%20salary%20of%20all%20the%20employees%20under%20that%20employee%20including%20him%5C%2Fherself.%5Cn2.%20He%20will%20give%20you%20an%20ID%20of%20an%20employee%3B%20you%20need%20to%20increase%20the%20salary%20of%20all%20the%20employees%20under%20that%20employee%20including%20him%5C%2Fherself%20by%20the%20minimum%20of%20minimum%20salary%20of%20all%20the%20employees%20under%20that%20employee%20including%20him%5C%2Fher%20and%201000.%5Cn%5CnLet%5Cu2019s%20see%20the%20structure%2C%20hope%20you%20will%20get%20a%20clear%20idea%20about%20the%20problem.%5Cn%5Cn%20%21%5BEmployee%20Hiearchy%5D%28http%3A%5C%2F%5C%2Fdl.dropboxusercontent.com%5C%2Fu%5C%2F34972503%5C%2Fdraw.png%29%5Cn%5CnEmployee%20Hierarchy%5Cn%5CnSalary%20Table%3A%5Cn%5Cn%20ID%5Cn%5Cn%20%201%5Cn%5Cn%20%202%5Cn%5Cn%20%203%5Cn%5Cn%20%204%5Cn%5Cn%20%205%5Cn%5Cn%20%206%5Cn%5Cn%20%207%5Cn%5Cn%20%20Salary%20%28BDT%29%5Cn%5Cn%20%20500%5Cn%5Cn%20%20300%5Cn%5Cn%20%20200%5Cn%5Cn%20%20100%5Cn%5Cn%20%2010%5Cn%5Cn%20%20200%5Cn%5Cn%20%20100%5Cn%5Cn%20Now%20if%20your%20boss%20wants%20to%20do%20the%20first%20operation%20for%20Employee%20ID%202.%20Then%20the%20output%20will%20be%5Cn%5Cn300%2B100%2B200%3D%20600%20BDT%5Cn%5CnIf%20your%20boss%20wants%20to%20do%20the%20second%20operation%20for%20the%20Employee%20ID%201%2C%20then%20the%20salary%20table%20becomes%20-%5Cn%5Cn%20ID%5Cn%5Cn%20%201%5Cn%5Cn%20%202%5Cn%5Cn%20%203%5Cn%5Cn%20%204%5Cn%5Cn%20%205%5Cn%5Cn%20%206%5Cn%5Cn%20%207%5Cn%5Cn%20%20Salary%20%28BDT%29%5Cn%5Cn%20%20510%5Cn%5Cn%20%20310%5Cn%5Cn%20%20210%5Cn%5Cn%20%20110%5Cn%5Cn%20%2020%5Cn%5Cn%20%20210%5Cn%5Cn%20%20110%5Cn%5Cn%20As%20minimum%20salary%20is%2010%20for%20Employee%20id%205%20and%20which%20is%20less%20than%201000.%5Cn%5Cn%2A%2AInput%2A%2A%5Cn%5CnInput%20starts%20with%20an%20integer%20%2A%2AT%20%28%2C%20denoting%20the%20number%20of%20test%20cases.%2A%2A%5Cn%5CnThe%20first%20line%20of%20a%20case%20is%20a%20blank%20line.%20The%20next%20line%20contains%20two%20integers%20%2A%2AN%20%281%20%2C%20%2A%2Aq%20%281%20where%20%2A%2AN%2A%2A%20denotes%20the%20number%20of%20nodes%20and%20%2A%2Aq%2A%2A%20denotes%20the%20number%20of%20queries.%20The%20nodes%20are%20numbered%20from%20%2A%2A1%2A%2A%20to%20%2A%2AN%2A%2A.%2A%2A%2A%2A%5Cn%5CnThen%20there%20will%20be%20%2A%2AN%2A%2A%20lines.%20The%20%2A%2Ai%20%24%20%5E%7Bth%7D%20%24%20%281%20line%20contains%20two%20integers%20%2A%2Ap%20%24%20_%7Bi%7D%20%24%2A%2A%20%20and%20%2A%2As%20%24%20_%7Bi%7D%20%24%2A%2A%20%20%2A%2A%280%20.%20%2A%2Ap%20%24%20_%7Bi%7D%20%24%2A%2A%20%20denotes%20the%20parent%20and%20%2A%2As%20%24%20_%7Bi%7D%20%24%2A%2A%20%20denotes%20the%20salary%20of%20the%20%2A%2Ai%20%24%20%5E%7Bth%7D%20%24%2A%2A%20%20employee%2C%20respectively.%20You%20can%20assume%20that%20the%20employee%20id%20with%201%20is%20the%20managing%20director%20and%20only%20its%20parent%20is%200.%2A%2A%2A%2A%5Cn%5CnEach%20of%20the%20next%20%2A%2Aq%2A%2A%20lines%20contains%20a%20query.%20Each%20query%20contains%20two%20integers%3A%20%2A%2Ac%2A%2A%20and%20%2A%2Av%20%281%20%2C%20where%20c%20denotes%20operation%20type%2C%20and%20v%20denotes%20the%20employee%20id.%20If%20the%20c%20%3D%201%2C%20then%20it%20means%20to%20do%20the%20first%20operation.%20If%20c%3D2%2C%20then%20the%20second%20operation.%2A%2A%5Cn%5CnYou%20can%20assume%20that%20the%20input%20builds%20a%20valid%20rooted%20tree.%5Cn%5Cn%2A%2AOutput%2A%2A%5Cn%5CnFor%20each%20case%2C%20print%20the%20case%20number%20in%20a%20line.%20Then%20for%20each%20query%20type%201%2C%20print%20the%20sum%20of%20the%20salary.%5Cn%5Cn%20%2A%2ASample%20Input%2A%2A%5Cn%5Cn%20%20%2A%2AOutput%20for%20Sample%20Input%2A%2A%5Cn%5Cn%20%201%5Cn%5Cn7%203%5Cn%5Cn0%20500%5Cn%5Cn1%20300%5Cn%5Cn1%20200%5Cn%5Cn1%20100%5Cn%5Cn3%2010%5Cn%5Cn2%20200%5Cn%5Cn2%20100%5Cn%5Cn1%202%5Cn%5Cn2%201%5Cn%5Cn1%202%5Cn%5Cn%20%20Case%201%3A%5Cn%5Cn600%5Cn%5Cn630%5Cn%5Cn%20%2A%2ANote%2A%2A%5Cn%5CnDataset%20is%20huge.%20Use%20faster%20I%5C%2FO%20methods.%5Cn%5CnProblem%20Setter%3A%20Ahmad%20Faiyaz%5Cn%5CnSpecial%20Thanks%3A%20Syed%20Shahriar%20Manjur%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F17732%22%2C%22id%22%3A%2217732%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP17732%22%2C%22title%22%3A%22SALMAN%20-%20Salary%20Management%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22SALMAN%20-%20Salary%20Management%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>SALMAN - Salary Management</h1>
<h2>题目描述</h2>
<div>**Salary Management**
You are working as a software engineer of Moogle! Now the boss of Moogle wants you to create a program which will efficiently handle some operations. At first, we should tell you about the structure of the employees at Moogle! Each employee has an integer id from 1 to N. Where 1 is the id of the Managing Director of Moogle! , who is the greatest boss of all the employees. Then except the Managing Director, each employee has an immediate boss. No employees have more than one immediate boss. Now your boss wants to have some operation like this –
1. He will give you an ID of an employee; you need to find the sum of salary of all the employees under that employee including him/herself.
2. He will give you an ID of an employee; you need to increase the salary of all the employees under that employee including him/herself by the minimum of minimum salary of all the employees under that employee including him/her and 1000.
Let’s see the structure, hope you will get a clear idea about the problem.
![Employee Hiearchy](http://dl.dropboxusercontent.com/u/34972503/draw.png)
Employee Hierarchy
Salary Table:
ID
1
2
3
4
5
6
7
Salary (BDT)
500
300
200
100
10
200
100
Now if your boss wants to do the first operation for Employee ID 2. Then the output will be
300+100+200= 600 BDT
If your boss wants to do the second operation for the Employee ID 1, then the salary table becomes -
ID
1
2
3
4
5
6
7
Salary (BDT)
510
310
210
110
20
210
110
As minimum salary is 10 for Employee id 5 and which is less than 1000.
**Input**
Input starts with an integer **T (, denoting the number of test cases.**
The first line of a case is a blank line. The next line contains two integers **N (1 , **q (1 where **N** denotes the number of nodes and **q** denotes the number of queries. The nodes are numbered from **1** to **N**.****
Then there will be **N** lines. The **i $ ^{th} $ (1 line contains two integers **p $ _{i} $** and **s $ _{i} $** **(0 . **p $ _{i} $** denotes the parent and **s $ _{i} $** denotes the salary of the **i $ ^{th} $** employee, respectively. You can assume that the employee id with 1 is the managing director and only its parent is 0.****
Each of the next **q** lines contains a query. Each query contains two integers: **c** and **v (1 , where c denotes operation type, and v denotes the employee id. If the c = 1, then it means to do the first operation. If c=2, then the second operation.**
You can assume that the input builds a valid rooted tree.
**Output**
For each case, print the case number in a line. Then for each query type 1, print the sum of the salary.
**Sample Input**
**Output for Sample Input**
1
7 3
0 500
1 300
1 200
1 100
3 10
2 200
2 100
1 2
2 1
1 2
Case 1:
600
630
**Note**
Dataset is huge. Use faster I/O methods.
Problem Setter: Ahmad Faiyaz
Special Thanks: Syed Shahriar Manjur</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
