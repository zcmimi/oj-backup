<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>CTOI10D3 - A HUGE TOWER - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450008:qYVWV6xosIiUHgmnuZGqn0vSLfx5tARRdoJdpdvX0nA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20ancient%20Babylonians%20decided%20to%20build%20a%20huge%20tower.%20The%20tower%20consists%20of%20_N_%20cubic%20building%20blocks%20that%20are%20stacked%20one%20onto%20another.%20The%20Babylonians%20gathered%20many%20building%20blocks%20of%20various%20sizes%20from%20all%20over%20the%20country.%20From%20their%20last%20unsuccessful%20attempt%20they%20have%20learned%20that%20if%20they%20put%20a%20large%20block%20directly%20onto%20a%20much%20smaller%20block%2C%20the%20tower%20will%20fall.%5Cn%5Cn%3Ca%20id%3D%5C%22Task_specification%5C%22%20name%3D%5C%22Task_specification%5C%22%3E%3C%5C%2Fa%3E%5Cn%5Cn%20%20%20%5Cn%2A%2ATask%20specification%2A%2A%5Cn----------------------%5Cn%5CnEach%20two%20building%20blocks%20are%20different%2C%20even%20if%20they%20have%20the%20same%20size.%20For%20each%20building%20block%20you%20are%20given%20its%20side%20length.%20You%20are%20also%20given%20an%20integer%20_D_%20with%20the%20following%20meaning%3A%20you%20are%20not%20allowed%20to%20put%20block%20A%20directly%20onto%20block%20B%20if%20the%20side%20length%20of%20A%20is%20strictly%20larger%20than%20_D_%20plus%20the%20side%20length%20of%20B.%5Cn%5CnCompute%20the%20number%20of%20different%20ways%20in%20which%20it%20is%20possible%20to%20build%20the%20tower%20using%20%2A%2Aall%2A%2A%20the%20building%20blocks.%20Since%20this%20number%20can%20be%20very%20large%2C%20output%20the%20result%20modulo%2010%20%24%20%5E%7B9%7D%20%24%20%2B%209.%5Cn%5Cn%3Ca%20id%3D%5C%22Input_specification%5C%22%20name%3D%5C%22Input_specification%5C%22%3E%3C%5C%2Fa%3E%5Cn%5Cn%20%20%20%5Cn%2A%2AInput%20specification%2A%2A%5Cn-----------------------%5Cn%5CnThe%20first%20line%20of%20the%20input%20contains%20two%20positive%20integers%20_N_%20and%20_D_%3A%20the%20number%20of%20building%20blocks%20and%20the%20tolerance%20respectively.%5Cn%5CnThe%20second%20line%20contains%20_N_%20space-separated%20integers%3B%20each%20represents%20the%20size%20of%20one%20building%20block.%5Cn%5Cn%3Ca%20id%3D%5C%22Constraints%5C%22%20name%3D%5C%22Constraints%5C%22%3E%3C%5C%2Fa%3E%5Cn%5Cn%20%20%20%5Cn%2A%2AConstraints%2A%2A%5Cn---------------%5Cn%5CnAll%20numbers%20in%20the%20input%20files%20are%20positive%20integers%20not%20exceeding%2010%20%24%20%5E%7B9%7D%20%24%20.%5Cn%5Cn_N_%20is%20always%20at%20least%202.%5Cn%5CnIn%20test%20cases%20worth%2070%20points%20_N_%20will%20be%20at%20most%2070.%5Cn%5CnOut%20of%20those%2C%20in%20test%20cases%20worth%2045%20points%2C%20_N_%20will%20be%20at%20most%2020.%5Cn%5CnOut%20of%20those%2C%20in%20test%20cases%20worth%2010%20points%2C%20_N_%20will%20be%20at%20most%2010.%5Cn%5CnFor%20some%20of%20the%20test%20cases%20the%20total%20number%20of%20valid%20towers%20will%20not%20exceed%20%21%5B1%5C%5C%2C000%5C%5C%2C000%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP6950%5C%2F89288aa34b4a1951a9a8ed1e05fdc1d4fb9d587d.png%29.%20These%20test%20cases%20are%20worth%2030%20points%20in%20total.%5Cn%5CnFor%20the%20last%20six%20test%20cases%20%28worth%2030%20points%29%20the%20value%20of%20_N_%20is%20larger%20than%2070.%20No%20upper%20bound%20on%20_N_%20is%20given%20for%20these%20test%20cases.%5Cn%5Cn%3Ca%20id%3D%5C%22Output_specification%5C%22%20name%3D%5C%22Output_specification%5C%22%3E%3C%5C%2Fa%3E%5Cn%5Cn%20%20%20%5Cn%2A%2AOutput%20specification%2A%2A%5Cn------------------------%5Cn%5CnOutput%20a%20single%20line%20containing%20a%20single%20integer%3A%20the%20number%20of%20towers%20that%20can%20be%20built%2C%20modulo%20%21%5B1%5C%5C%2C000%5C%5C%2C000%5C%5C%2C009%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP6950%5C%2F735aa441cba04be10387f746fa4fb3a0430205f2.png%29.%5Cn%5Cn%3Ca%20id%3D%5C%22Examples%5C%22%20name%3D%5C%22Examples%5C%22%3E%3C%5C%2Fa%3E%5Cn%5Cn%20%20%20%5Cn%2A%2AExamples%2A%2A%5Cn------------%5Cn%5Cn%2A%2A%2A%2Ainput%3A%2A%2A%2A%2A%5Cn%5Cn%20%60%60%60%5Cn4%201%5Cn1%202%203%20100%5Cn%60%60%60%5Cn%2A%2A%2A%2Aoutput%3A%2A%2A%2A%2A%5Cn%5Cn%20%60%60%60%5Cn4%5Cn%60%60%60%5Cn_We%20can%20arrange%20the%20first%20three%20blocks%20in%20any%20order%2C%20except%20for%202%2C1%2C3%20or%201%2C3%2C2.%20The%20last%20block%20has%20to%20be%20at%20the%20bottom._%5Cn%5Cn%2A%2A%2A%2Ainput%3A%2A%2A%2A%2A%5Cn%5Cn%20%60%60%60%5Cn6%209%5Cn10%2020%2020%2010%2010%2020%5Cn%60%60%60%5Cn%2A%2Aoutput%3A%2A%2A%5Cn%5Cn%20%60%60%60%5Cn36%5Cn%60%60%60%5Cn_We%20are%20not%20allowed%20to%20put%20a%20cube%20of%20size%2020%20onto%20a%20cube%20of%20size%2010.%20There%20are%20six%20ways%20to%20order%20the%20cubes%20of%20size%2010%2C%20and%20six%20ways%20to%20order%20the%20cubes%20of%20size%2020._%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B196%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F6950%22%2C%22id%22%3A%226950%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A8%2C%22totalAccepted%22%3A8%2C%22pid%22%3A%22SP6950%22%2C%22title%22%3A%22CTOI10D3%20-%20A%20HUGE%20TOWER%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22CTOI10D3%20-%20A%20HUGE%20TOWER%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>CTOI10D3 - A HUGE TOWER</h1>
<h2>题目描述</h2>
<div>The ancient Babylonians decided to build a huge tower. The tower consists of _N_ cubic building blocks that are stacked one onto another. The Babylonians gathered many building blocks of various sizes from all over the country. From their last unsuccessful attempt they have learned that if they put a large block directly onto a much smaller block, the tower will fall.
<a id="Task_specification" name="Task_specification"></a>
**Task specification**
----------------------
Each two building blocks are different, even if they have the same size. For each building block you are given its side length. You are also given an integer _D_ with the following meaning: you are not allowed to put block A directly onto block B if the side length of A is strictly larger than _D_ plus the side length of B.
Compute the number of different ways in which it is possible to build the tower using **all** the building blocks. Since this number can be very large, output the result modulo 10 $ ^{9} $ + 9.
<a id="Input_specification" name="Input_specification"></a>
**Input specification**
-----------------------
The first line of the input contains two positive integers _N_ and _D_: the number of building blocks and the tolerance respectively.
The second line contains _N_ space-separated integers; each represents the size of one building block.
<a id="Constraints" name="Constraints"></a>
**Constraints**
---------------
All numbers in the input files are positive integers not exceeding 10 $ ^{9} $ .
_N_ is always at least 2.
In test cases worth 70 points _N_ will be at most 70.
Out of those, in test cases worth 45 points, _N_ will be at most 20.
Out of those, in test cases worth 10 points, _N_ will be at most 10.
For some of the test cases the total number of valid towers will not exceed ![1\,000\,000](https://cdn.luogu.com.cn/upload/vjudge_pic/SP6950/89288aa34b4a1951a9a8ed1e05fdc1d4fb9d587d.png). These test cases are worth 30 points in total.
For the last six test cases (worth 30 points) the value of _N_ is larger than 70. No upper bound on _N_ is given for these test cases.
<a id="Output_specification" name="Output_specification"></a>
**Output specification**
------------------------
Output a single line containing a single integer: the number of towers that can be built, modulo ![1\,000\,000\,009](https://cdn.luogu.com.cn/upload/vjudge_pic/SP6950/735aa441cba04be10387f746fa4fb3a0430205f2.png).
<a id="Examples" name="Examples"></a>
**Examples**
------------
****input:****
```
4 1
1 2 3 100
```
****output:****
```
4
```
_We can arrange the first three blocks in any order, except for 2,1,3 or 1,3,2. The last block has to be at the bottom._
****input:****
```
6 9
10 20 20 10 10 20
```
**output:**
```
36
```
_We are not allowed to put a cube of size 20 onto a cube of size 10. There are six ways to order the cubes of size 10, and six ways to order the cubes of size 20._</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
