<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>SERVICE - Mobile Service - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449611:LYrOFnkFLo5x9x+yGVf/wdlQrhB54c67iFq8aMRDSiw=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22%20A%20company%20provides%20service%20for%20its%20partners%20that%20are%20located%20in%20different%20towns.%20The%20company%20has%20three%20mobile%20service%20staff%20employees.%20If%20a%20request%20occurs%20at%20some%20location%2C%20an%20employee%20of%20the%20service%20staff%20must%20move%20from%20his%20current%20location%20to%20the%20location%20of%20the%20request%20%28if%20no%20employee%20is%20there%29%20in%20order%20to%20satisfy%20the%20request.%20Only%20one%20employee%20can%20move%20at%20any%20moment.%20They%20can%20move%20only%20on%20request%20and%20are%20not%20allowed%20to%20be%20at%20the%20same%20location.%20Moving%20an%20employee%20from%20location%20p%20to%20location%20q%20incurs%20a%20given%20cost%20C%28p%2Cq%29.%20The%20cost%20function%20is%20not%20necessarily%20symmetric%2C%20but%20the%20cost%20of%20not%20moving%20is%200%2C%20i.e.%20C%28p%2Cp%29%3D0.%20The%20company%20must%20satisfy%20the%20received%20requests%20in%20a%20strict%20first-come%2C%20first-serve%20basis.%20The%20goal%20is%20to%20minimize%20the%20total%20cost%20of%20serving%20a%20given%20sequence%20of%20requests.%5Cn%5Cn%20Task%5Cn%5Cn%20You%20are%20to%20write%20a%20program%20that%20decides%20which%20employee%20of%20the%20service%20staff%20is%20to%20move%20for%20each%20request%20such%20that%20the%20total%20cost%20of%20serving%20the%20given%20sequence%20of%20requests%20is%20as%20small%20as%20possible.%22%2C%22inputFormat%22%3A%22%20The%20first%20line%20of%20input%20contains%20the%20number%20of%20test%20cases%20-%20nTest.%20Each%20test%20case%20contains%3A%5Cn%5Cn%20The%20first%20line%20of%20each%20test%20cases%20contains%20two%20integers%2C%20L%20and%20N.%20L%20%283%20%3C%3D%20L%20%3C%3D%20200%29%20is%20the%20number%20of%20locations%20and%20N%20%281%20%3C%3D%20N%20%3C%3D%201000%29%20is%20the%20number%20of%20requests.%20Locations%20are%20identified%20by%20the%20integers%20from%201%20to%20L.%20Each%20of%20the%20next%20L%20lines%20contains%20L%20non-negative%20integers.%20The%20jth%20number%20in%20the%20line%20i%2B1%20is%20the%20cost%20C%28i%2Cj%29%2C%20and%20it%20is%20less%20than%202000.%5Cn%5Cn%20The%20last%20of%20each%20test%20cases%20contains%20N%20integers%2C%20the%20list%20of%20the%20requests.%20A%20request%20is%20identified%20by%20the%20identifier%20of%20the%20location%20where%20the%20request%20occurs.%20Initially%2C%20the%20three%20service%20staff%20employees%20are%20located%20at%20location%201%2C%202%20and%203%2C%20respectively.%22%2C%22outputFormat%22%3A%22%20For%20each%20test%20case%20write%20the%20minimal%20total%20cost%20in%20a%20separate%20line.%22%2C%22samples%22%3A%5B%5B%221%5Cn5%209%5Cn0%201%201%201%201%5Cn1%200%202%203%202%5Cn1%201%200%204%201%5Cn2%201%205%200%201%5Cn4%202%203%204%200%5Cn4%202%204%201%205%204%203%202%201%22%2C%225%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2448%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F703%22%2C%22id%22%3A%22703%22%7D%2C%22translation%22%3A%22Description%5Cn%5Cu3000%5Cu3000%5Cu4e00%5Cu4e2a%5Cu516c%5Cu53f8%5Cu6709%5Cu4e09%5Cu4e2a%5Cu79fb%5Cu52a8%5Cu670d%5Cu52a1%5Cu5458%5Cu3002%5Cu5982%5Cu679c%5Cu67d0%5Cu4e2a%5Cu5730%5Cu65b9%5Cu6709%5Cu4e00%5Cu4e2a%5Cu8bf7%5Cu6c42%5Cuff0c%5Cu67d0%5Cu4e2a%5Cu5458%5Cu5de5%5Cu5fc5%5Cu987b%5Cu8d76%5Cu5230%5Cu90a3%5Cu4e2a%5Cu5730%5Cu65b9%5Cu53bb%5Cuff08%5Cu90a3%5Cu4e2a%5Cu5730%5Cu65b9%5Cu6ca1%5Cu6709%5Cu5176%5Cu4ed6%5Cu5458%5Cu5de5%5Cuff09%5Cuff0c%5Cu67d0%5Cu4e00%5Cu65f6%5Cu523b%5Cu53ea%5Cu6709%5Cu4e00%5Cu4e2a%5Cu5458%5Cu5de5%5Cu80fd%5Cu79fb%5Cu52a8%5Cu3002%5Cu53ea%5Cu6709%5Cu88ab%5Cu8bf7%5Cu6c42%5Cu540e%5Cuff0c%5Cu4ed6%5Cu624d%5Cu80fd%5Cu79fb%5Cu52a8%5Cuff0c%5Cu4e0d%5Cu5141%5Cu8bb8%5Cu5728%5Cu540c%5Cu6837%5Cu7684%5Cu4f4d%5Cu7f6e%5Cu51fa%5Cu73b0%5Cu4e24%5Cu4e2a%5Cu5458%5Cu5de5%5Cu3002%5Cu4ece%5Cu4f4d%5Cu7f6eP%5Cu5230Q%5Cu79fb%5Cu52a8%5Cu4e00%5Cu4e2a%5Cu5458%5Cu5de5%5Cu7684%5Cu8d39%5Cu7528%5Cu662fC%28P%2C%20Q%29%5Cu3002%5Cu8fd9%5Cu4e2a%5Cu51fd%5Cu6570%5Cu6ca1%5Cu6709%5Cu5fc5%5Cu8981%5Cu5bf9%5Cu79f0%5Cuff0c%5Cu4f46%5Cu662fC%28P%2C%20P%29%20%3D%200%5Cu3002%5Cu4e00%5Cu5f00%5Cu59cb%5Cu4e09%5Cu4e2a%5Cu670d%5Cu52a1%5Cu5458%5Cu5206%5Cu522b%5Cu5728%5Cu4f4d%5Cu7f6e1%5Cuff0c2%5Cuff0c3%5Cuff0c%5Cu516c%5Cu53f8%5Cu5fc5%5Cu987b%5Cu6ee1%5Cu8db3%5Cu6240%5Cu6709%5Cu7684%5Cu8bf7%5Cu6c42%5Cu3002%20%5Cu76ee%5Cu6807%5Cu662f%5Cu6700%5Cu5c0f%5Cu5316%5Cu516c%5Cu53f8%5Cu7684%5Cu8d39%5Cu7528%5Cu3002%5CnInput%5Cn%5Cu3000%5Cu3000%5Cu7b2c1%5Cu884c%5Cuff1a2%5Cu4e2a%5Cu6574%5Cu6570L%5Cuff0cN%283%3C%3DL%3C%3D200%2C%201%3C%3DN%3C%3D1000%29.%20L%5Cu662f%5Cu4f4d%5Cu7f6e%5Cu6570%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu4f4d%5Cu7f6e%5Cu4ece1%5Cu5230L%5Cu7f16%5Cu53f7%5Cuff0cN%5Cu662f%5Cu8bf7%5Cu6c42%5Cu6570%5Cu3002%5Cn%5Cu3000%5Cu3000%5Cu63a5%5Cu4e0b%5Cu6765L%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu5305%5Cu542bL%5Cu4e2a%5Cu975e%5Cu8d1f%5Cu6574%5Cu6570%5Cuff0c%5Cu7b2ci%2B1%5Cu884c%5Cu7684%5Cu7b2cj%5Cu4e2a%5Cu6570%5Cu8868%5Cu793aC%28i%2C%20j%29%5Cuff0c%5Cu5e76%5Cu4e14%5Cu5b83%5Cu5c0f%5Cu4e8e2000.%5Cn%5Cu3000%5Cu3000%5Cu6700%5Cu540e%5Cu4e00%5Cu884c%5Cu5305%5Cu542bN%5Cu4e2a%5Cu6570%5Cuff0c%5Cu662f%5Cu8bf7%5Cu6c42%5Cu5217%5Cu8868%5Cu3002%5CnOutput%20%5Cu3000%5Cu3000%20%5Cu7b2c1%5Cu884c%5Cuff1a%5Cu4e00%5Cu4e2a%5Cu6570M%5Cuff0c%5Cu8868%5Cu793a%5Cu6700%5Cu5c0f%5Cu7684%5Cu670d%5Cu52a1%5Cu82b1%5Cu8d39%5Cn%5CnTranslated%20by%20%40lvpeiyuan_G2020%20%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A919%2C%22totalAccepted%22%3A278%2C%22pid%22%3A%22SP703%22%2C%22title%22%3A%22SERVICE%20-%20Mobile%20Service%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A163938%2C%22title%22%3A%22%5Cu4e3a%5Cu4ec0%5Cu4e48%5Cu4e0d%5Cu5148%5Cu5904%5Cu7406%5Cu4e24%5Cu70b9%5Cu95f4%5Cu6700%5Cu77ed%5Cu8def%5Cu5462%22%2C%22forum%22%3A%7B%22id%22%3A13206%2C%22name%22%3A%22SP703%20SERVICE%20-%20Mobile%20Service%22%2C%22slug%22%3A%22SP703%22%7D%7D%2C%7B%22id%22%3A159022%2C%22title%22%3A%22%5Cu6837%5Cu4f8b%5Cu597d%5Cu50cf%5Cu6709%5Cu95ee%5Cu9898%5Cu2026%5Cu2026%22%2C%22forum%22%3A%7B%22id%22%3A13206%2C%22name%22%3A%22SP703%20SERVICE%20-%20Mobile%20Service%22%2C%22slug%22%3A%22SP703%22%7D%7D%2C%7B%22id%22%3A136770%2C%22title%22%3A%22%5Cu849f%5Cu84bb%5Cu6c42%5Cu52a9%22%2C%22forum%22%3A%7B%22id%22%3A13206%2C%22name%22%3A%22SP703%20SERVICE%20-%20Mobile%20Service%22%2C%22slug%22%3A%22SP703%22%7D%7D%2C%7B%22id%22%3A126253%2C%22title%22%3A%22%5Cu849f%5Cu84bb%5Cu840c%5Cu65b0%20%20%5Cu6c42%5Cu6551%20%20%5Cu53e6%5Cu4e00%5Cu9053%5Cu76f8%5Cu540c%5Cu7684%5Cu9898%5Cu8fc7%5Cu4e86%20%20%20%5Cu8fd9%5Cu4e2a%20RE%22%2C%22forum%22%3A%7B%22id%22%3A13206%2C%22name%22%3A%22SP703%20SERVICE%20-%20Mobile%20Service%22%2C%22slug%22%3A%22SP703%22%7D%7D%2C%7B%22id%22%3A103181%2C%22title%22%3A%22%5Cu6c42%5Cu52a9%22%2C%22forum%22%3A%7B%22id%22%3A13206%2C%22name%22%3A%22SP703%20SERVICE%20-%20Mobile%20Service%22%2C%22slug%22%3A%22SP703%22%7D%7D%2C%7B%22id%22%3A61713%2C%22title%22%3A%22%5Cu6c42%5Cu52a9%22%2C%22forum%22%3A%7B%22id%22%3A13206%2C%22name%22%3A%22SP703%20SERVICE%20-%20Mobile%20Service%22%2C%22slug%22%3A%22SP703%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1006%22%2C%22title%22%3A%22%5Cu4f20%5Cu7eb8%5Cu6761%22%2C%22difficulty%22%3A4%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4046%22%2C%22title%22%3A%22%5BJSOI2010%5D%5Cu5feb%5Cu9012%5Cu670d%5Cu52a1%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22SP15637%22%2C%22title%22%3A%22GNYR04H%20-%20Mr%20Youngs%20Picture%20Permutations%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22SP%22%7D%2C%7B%22pid%22%3A%22UVA323%22%2C%22title%22%3A%22Jury%20Compromise%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22UVA%22%7D%2C%7B%22pid%22%3A%22P4342%22%2C%22title%22%3A%22%5BIOI1998%5DPolygon%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22SERVICE%20-%20Mobile%20Service%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>SERVICE - Mobile Service</h1>
<h2>题意翻译</h2>
<div>Description
　　一个公司有三个移动服务员。如果某个地方有一个请求，某个员工必须赶到那个地方去（那个地方没有其他员工），某一时刻只有一个员工能移动。只有被请求后，他才能移动，不允许在同样的位置出现两个员工。从位置P到Q移动一个员工的费用是C(P, Q)。这个函数没有必要对称，但是C(P, P) = 0。一开始三个服务员分别在位置1，2，3，公司必须满足所有的请求。 目标是最小化公司的费用。
Input
　　第1行：2个整数L，N(3<=L<=200, 1<=N<=1000). L是位置数，每个位置从1到L编号，N是请求数。
　　接下来L行，每行包含L个非负整数，第i+1行的第j个数表示C(i, j)，并且它小于2000.
　　最后一行包含N个数，是请求列表。
Output 　　 第1行：一个数M，表示最小的服务花费
Translated by @lvpeiyuan_G2020 </div>
<h2>题目描述</h2>
<div> A company provides service for its partners that are located in different towns. The company has three mobile service staff employees. If a request occurs at some location, an employee of the service staff must move from his current location to the location of the request (if no employee is there) in order to satisfy the request. Only one employee can move at any moment. They can move only on request and are not allowed to be at the same location. Moving an employee from location p to location q incurs a given cost C(p,q). The cost function is not necessarily symmetric, but the cost of not moving is 0, i.e. C(p,p)=0. The company must satisfy the received requests in a strict first-come, first-serve basis. The goal is to minimize the total cost of serving a given sequence of requests.
Task
You are to write a program that decides which employee of the service staff is to move for each request such that the total cost of serving the given sequence of requests is as small as possible.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div> The first line of input contains the number of test cases - nTest. Each test case contains:
The first line of each test cases contains two integers, L and N. L (3 <= L <= 200) is the number of locations and N (1 <= N <= 1000) is the number of requests. Locations are identified by the integers from 1 to L. Each of the next L lines contains L non-negative integers. The jth number in the line i+1 is the cost C(i,j), and it is less than 2000.
The last of each test cases contains N integers, the list of the requests. A request is identified by the identifier of the location where the request occurs. Initially, the three service staff employees are located at location 1, 2 and 3, respectively.</div>
<h3>输出格式</h3>
<br />
<div> For each test case write the minimal total cost in a separate line.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1
5 9
0 1 1 1 1
1 0 2 3 2
1 1 0 4 1
2 1 5 0 1
4 2 3 4 0
4 2 4 1 5 4 3 2 1</code></pre>
<h3>输出样例 #1</h3>
<pre><code>5</code></pre>
</article>
</div>
</div>
</body>
</html>
