<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>MKTHNUM - K-th Number - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449840:+b3PsvINOxWAY0y43Od5S865Fv4n0hyzu1WubZ+c1hg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22%5BEnglish%5D%28%5C%2Fproblems%5C%2FMKTHNUM%5C%2Fen%5C%2F%29%20%5BVietnamese%5D%28%5C%2Fproblems%5C%2FMKTHNUM%5C%2Fvn%5C%2F%29%20You%20are%20working%20for%20Macrohard%20company%20in%20data%20structures%20department.%20After%20failing%20your%20previous%20task%20about%20key%20insertion%20you%20were%20asked%20to%20write%20a%20new%20data%20structure%20that%20would%20be%20able%20to%20return%20quickly%20k-th%20order%20statistics%20in%20the%20array%20segment.%5Cn%5Cn%20That%20is%2C%20given%20an%20array%20a%5C%5C%5B1%20...%20n%5C%5C%5D%20of%20different%20integer%20numbers%2C%20your%20program%20must%20answer%20a%20series%20of%20questions%20Q%28i%2C%20j%2C%20k%29%20in%20the%20form%3A%20%5C%22What%20would%20be%20the%20k-th%20number%20in%20a%5C%5C%5Bi%20...%20j%5C%5C%5D%20segment%2C%20if%20this%20segment%20was%20sorted%3F%5C%22%5Cn%5Cn%20For%20example%2C%20consider%20the%20array%20a%20%3D%20%281%2C%205%2C%202%2C%206%2C%203%2C%207%2C%204%29.%20Let%20the%20question%20be%20Q%282%2C%205%2C%203%29.%20The%20segment%20a%5C%5C%5B2%20...%205%5C%5C%5D%20is%20%285%2C%202%2C%206%2C%203%29.%20If%20we%20sort%20this%20segment%2C%20we%20get%20%282%2C%203%2C%205%2C%206%29%2C%20the%20third%20number%20is%205%2C%20and%20therefore%20the%20answer%20to%20the%20question%20is%205.%22%2C%22inputFormat%22%3A%22%20The%20first%20line%20of%20the%20input%20contains%20n%20%5Cu2014%20the%20size%20of%20the%20array%2C%20and%20m%20%5Cu2014%20the%20number%20of%20questions%20to%20answer%20%281%20%5Cu2264%20n%20%5Cu2264%20100000%2C%201%20%5Cu2264%20m%20%5Cu2264%205000%29.%5Cn%5Cn%20The%20second%20line%20contains%20n%20different%20integer%20numbers%20not%20exceeding%2010%5E9%20by%20their%20absolute%20values%20%5Cu2014%20the%20array%20for%20which%20the%20answers%20should%20be%20given.%5Cn%5Cn%20The%20following%20m%20lines%20contain%20question%20descriptions%2C%20each%20description%20consists%20of%20three%20numbers%3A%20i%2C%20j%2C%20and%20k%20%281%20%5Cu2264%20i%20%5Cu2264%20j%20%5Cu2264%20n%2C%201%20%5Cu2264%20k%20%5Cu2264%20j%20-%20i%20%2B%201%29%20and%20represents%20the%20question%20Q%28i%2C%20j%2C%20k%29.%5Cn%5Cn%20%60%60%60%5Cn%5CnSAMPLE%20INPUT%5Cn7%203%5Cn1%205%202%206%203%207%204%5Cn2%205%203%5Cn4%204%201%5Cn1%207%203%5Cn%5Cn%60%60%60%22%2C%22outputFormat%22%3A%22%60%60%60%5Cn%20%5CnFor%20each%20question%20output%20the%20answer%20to%20it%20%5Cu2014%20the%20k-th%20number%20in%20sorted%20%5Cna%5Bi%20...%20j%5D%20segment.%20%5Cn%5CnSAMPLE%20OUTPUT%5Cn5%5Cn6%5Cn3%5Cn%60%60%60%5Cn%20%2A%2ANote%20%3A%20naive%20solution%20will%20not%20work%21%21%21%2A%2A%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B667%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F3946%22%2C%22id%22%3A%223946%22%7D%2C%22translation%22%3A%22%5Cu9898%5Cu76ee%5Cu5927%5Cu610f%5Cuff1a%5Cn%5Cn%5Cu7ed9%5Cu4f60n%5Cu4e2a%5Cu6570%5Cuff0c%5Cu591a%5Cu6b21%5Cu8be2%5Cu95ee%5Cu67d0%5Cu6bb5%5Cu533a%5Cu95f4%5Cu7b2ck%5Cu5c0f%5Cu7684%5Cu6570%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6570n%5Cu3001m%5Cuff0cn%5Cu4ee3%5Cu8868%5Cu6709%5Cu591a%5Cu5c11%5Cu4e2a%5Cu6570%5Cuff0cm%5Cu4ee3%5Cu8868%5Cu8be2%5Cu95ee%5Cu6570%5Cu3002%5Cn%5Cn%5Cu7b2c%5Cu4e8c%5Cu884cn%5Cu4e2a%5Cu6570%5Cu7ed9%5Cu51fa%5Cuff0c%5Cu4e0d%5Cu8d85%5Cu8fc710%5E9%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765m%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e09%5Cu4e2a%5Cu6570i%2Cj%2Ck%5Cuff0c%5Cu8be2%5Cu95ee%5Cu7b2ci%5Cu4e2a%5Cu6570%5Cu5230%5Cu7b2cj%5Cu4e2a%5Cu6570%5Cu4e2d%5Cu7b2ck%5Cu5c0f%5Cu7684%5Cu6570%5Cu662f%5Cu4ec0%5Cu4e48%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cn%5Cn%5Cu8f93%5Cu51fa%5Cu5171m%5Cu884c%5Cuff0c%5Cu5bf9%5Cu6bcf%5Cu6b21%5Cu8be2%5Cu95ee%5Cu7684%5Cu56de%5Cu7b54%5Cu3002%5Cn%5Cn%5Cu6570%5Cu636e%5Cu8303%5Cu56f4%5Cuff1a%5Cn%5Cn1%3C%3Dn%3C%3D100000%2C1%3C%3Dm%3C%3D5000%5Cu3002%5Cn%5Cn~~%5Cu6ce8%5Cu610f%5Cuff1a%5Cu7b80%5Cu5355%5Cu7684%5Cu505a%5Cu6cd5%5Cu53ef%5Cu662f%5Cu8fc7%5Cu4e0d%5Cu4e86%5Cu7684%5Cu3002~~%5Cn%5Cn%20%5Cu611f%5Cu8c22%20%40gjc1124646822%20%20%5Cu63d0%5Cu4f9b%5Cu7684%5Cu7ffb%5Cu8bd1%5Cu3002%22%2C%22tags%22%3A%5B42%2C233%2C234%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A1104%2C%22totalAccepted%22%3A656%2C%22pid%22%3A%22SP3946%22%2C%22title%22%3A%22MKTHNUM%20-%20K-th%20Number%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A141270%2C%22title%22%3A%22%5Cu840c%5Cu65b0%5Cu521a%5Cu5b66OI%5Cuff0c%5Cu83ab%5Cu540dUKE%5Cuff0c%5Cu6c42%5Cu52a9%22%2C%22forum%22%3A%7B%22id%22%3A13982%2C%22name%22%3A%22SP3946%20MKTHNUM%20-%20K-th%20Number%22%2C%22slug%22%3A%22SP3946%22%7D%7D%2C%7B%22id%22%3A101600%2C%22title%22%3A%22%5Cu8bf7%5Cu95ee%5Cu662f%5Cu6211%5Cu628a%5Cu677f%5Cu5b50%5Cu5199%5Cu4e11%5Cu4e86%5Cu5417%5Cuff1f%5Cuff08%5Cu6c42%5Cu67e5%5Cu9519%5Cuff09%22%2C%22forum%22%3A%7B%22id%22%3A13982%2C%22name%22%3A%22SP3946%20MKTHNUM%20-%20K-th%20Number%22%2C%22slug%22%3A%22SP3946%22%7D%7D%2C%7B%22id%22%3A34664%2C%22title%22%3A%22%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A13982%2C%22name%22%3A%22SP3946%20MKTHNUM%20-%20K-th%20Number%22%2C%22slug%22%3A%22SP3946%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2617%22%2C%22title%22%3A%22Dynamic%20Rankings%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2633%22%2C%22title%22%3A%22Count%20on%20a%20tree%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3567%22%2C%22title%22%3A%22%5BPOI2014%5DKUR-Couriers%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3834%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu53ef%5Cu6301%5Cu4e45%5Cu5316%5Cu7ebf%5Cu6bb5%5Cu6811%201%5Cuff08%5Cu4e3b%5Cu5e2d%5Cu6811%5Cuff09%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3919%22%2C%22title%22%3A%22%5Cu3010%5Cu6a21%5Cu677f%5Cu3011%5Cu53ef%5Cu6301%5Cu4e45%5Cu5316%5Cu6570%5Cu7ec4%5Cuff08%5Cu53ef%5Cu6301%5Cu4e45%5Cu5316%5Cu7ebf%5Cu6bb5%5Cu6811%5C%2F%5Cu5e73%5Cu8861%5Cu6811%5Cuff09%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22MKTHNUM%20-%20K-th%20Number%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>MKTHNUM - K-th Number</h1>
<h2>题意翻译</h2>
<div>题目大意：
给你n个数，多次询问某段区间第k小的数。
输入格式：
第一行两个数n、m，n代表有多少个数，m代表询问数。
第二行n个数给出，不超过10^9。
接下来m行，每行三个数i,j,k，询问第i个数到第j个数中第k小的数是什么。
输出格式：
输出共m行，对每次询问的回答。
数据范围：
1<=n<=100000,1<=m<=5000。
~~注意：简单的做法可是过不了的。~~
感谢 @gjc1124646822 提供的翻译。</div>
<h2>题目描述</h2>
<div>[English](/problems/MKTHNUM/en/) [Vietnamese](/problems/MKTHNUM/vn/) You are working for Macrohard company in data structures department. After failing your previous task about key insertion you were asked to write a new data structure that would be able to return quickly k-th order statistics in the array segment.
That is, given an array a\[1 ... n\] of different integer numbers, your program must answer a series of questions Q(i, j, k) in the form: "What would be the k-th number in a\[i ... j\] segment, if this segment was sorted?"
For example, consider the array a = (1, 5, 2, 6, 3, 7, 4). Let the question be Q(2, 5, 3). The segment a\[2 ... 5\] is (5, 2, 6, 3). If we sort this segment, we get (2, 3, 5, 6), the third number is 5, and therefore the answer to the question is 5.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div> The first line of the input contains n — the size of the array, and m — the number of questions to answer (1 ≤ n ≤ 100000, 1 ≤ m ≤ 5000).
The second line contains n different integer numbers not exceeding 10^9 by their absolute values — the array for which the answers should be given.
The following m lines contain question descriptions, each description consists of three numbers: i, j, and k (1 ≤ i ≤ j ≤ n, 1 ≤ k ≤ j - i + 1) and represents the question Q(i, j, k).
```
SAMPLE INPUT
7 3
1 5 2 6 3 7 4
2 5 3
4 4 1
1 7 3
```</div>
<h3>输出格式</h3>
<br />
<div>```
For each question output the answer to it — the k-th number in sorted
a[i ... j] segment.
SAMPLE OUTPUT
5
6
3
```
**Note : naive solution will not work!!!**</div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
