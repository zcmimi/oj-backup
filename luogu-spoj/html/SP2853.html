<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>PDECODE - Decode the Strings - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449761:ugz+WJhJWNZihVWnZGDnZldVdCZUB9KPAq7MKMjUsbw=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%20Bruce%20Force%20has%20had%20an%20interesting%20idea%20how%20to%20encode%20strings.%20The%20following%20is%20the%20description%20of%20how%20the%20encoding%20is%20done%3A%5Cn%5Cn%20Let%20x%20%24%20_%7B1%7D%20%24%20%2Cx%20%24%20_%7B2%7D%20%24%20%2C...%2Cx%20%24%20_%7Bn%7D%20%24%20be%20the%20sequence%20of%20characters%20of%20the%20string%20to%20be%20encoded.%5Cn%5Cn1.%20Choose%20an%20integer%20_m_%20and%20_n_%20pairwise%20distinct%20numbers%20p%20%24%20_%7B1%7D%20%24%20%2Cp%20%24%20_%7B2%7D%20%24%20%2C...%2Cp%20%24%20_%7Bn%7D%20%24%20from%20the%20set%20%7B_1_%2C%20_2_%2C%20...%2C%20_n_%7D%20%28a%20permutation%20of%20the%20numbers%20_1_%20to%20_n_%29.%5Cn2.%20Repeat%20the%20following%20step%20_m_%20times.%5Cn3.%20For%20_1_%20%5Cu2264%20i%20%5Cu2264%20_n_%20set%20y%20%24%20_%7Bi%7D%20%24%20to%20x%20%24%20_%7Bpi%7D%20%24%20%2C%20and%20then%20for%20_1_%20%5Cu2264%20i%20%5Cu2264%20_n_%20replace%20x%20%24%20_%7Bi%7D%20%24%20by%20y%20%24%20_%7Bi%7D%20%24%20.%5Cn%5Cn%20For%20example%2C%20when%20we%20want%20to%20encode%20the%20string%20%5C%22hello%5C%22%2C%20and%20we%20choose%20the%20value%20_m%20%3D%203_%20and%20the%20permutation%20_2%2C%203%2C%201%2C%205%2C%204_%2C%20the%20data%20would%20be%20encoded%20in%203%20steps%3A%20%5C%22hello%5C%22%20-%3E%20%5C%22elhol%5C%22%20-%3E%20%5C%22lhelo%5C%22%20-%3E%20%5C%22helol%5C%22.%5Cn%5Cn%20Bruce%20gives%20you%20the%20encoded%20strings%2C%20and%20the%20numbers%20_m_%20and%20p%20%24%20_%7B1%7D%20%24%20%2C%20...%2C%20p%20%24%20_%7Bn%7D%20%24%20used%20to%20encode%20these%20strings.%20He%20claims%20that%20because%20he%20used%20huge%20numbers%20_m_%20for%20encoding%2C%20you%20will%20need%20a%20lot%20of%20time%20to%20decode%20the%20strings.%20Can%20you%20disprove%20this%20claim%20by%20quickly%20decoding%20the%20strings%3F%22%2C%22inputFormat%22%3A%22The%20input%20contains%20several%20test%20cases.%20Each%20test%20case%20starts%20with%20a%20line%20containing%20two%20numbers%20_n_%20and%20_m_%20%28_1%20%5Cu2264%20n%20%5Cu2264%2080_%2C%20_1%20%5Cu2264%20m%20%5Cu2264%2010%20%24%20%5E%7B9%7D%20%24_%20%29.%20The%20following%20line%20consists%20of%20_n_%20pairwise%20different%20numbers%20p%20%24%20_%7B1%7D%20%24%20%2C...%2Cp%20%24%20_%7Bn%7D%20%24%20%28_1_%20%5Cu2264%20p%20%24%20_%7Bi%7D%20%24%20%5Cu2264%20_n_%29.%20The%20third%20line%20of%20each%20test%20case%20consists%20of%20exactly%20_n_%20characters%2C%20and%20represent%20the%20encoded%20string.%20The%20last%20test%20case%20is%20followed%20by%20a%20line%20containing%20two%20zeros.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20print%20one%20line%20with%20the%20decoded%20string.%22%2C%22samples%22%3A%5B%5B%225%203%5Cr%5Cn2%203%201%205%204%5Cr%5Cnhelol%5Cr%5Cn16%20804289384%5Cr%5Cn13%2010%202%207%208%201%2016%2012%2015%206%205%2014%203%204%2011%209%5Cr%5Cnscssoet%20tcaede%20n%5Cr%5Cn8%2012%5Cr%5Cn5%203%204%202%201%208%206%207%5Cr%5Cnencoded%3F%5Cr%5Cn0%200%22%2C%22hello%5Cr%5Cnsecond%20test%20case%5Cr%5Cnencoded%3F%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B970%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F2853%22%2C%22id%22%3A%222853%22%7D%2C%22translation%22%3A%22%5Cu7ed9%5Cu51fan%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4ea4%5Cu6362%5Cu65b9%5Cu5f0f%5Cu4e0e%5Cu7f6e%5Cu6362m%5Cu6b21%5Cu540e%5Cu7684%5Cu6700%5Cu7ec8%5Cu7f6e%5Cu6362%5Cu7ed3%5Cu679c%5Cuff0c%5Cu8981%5Cu6c42%5Cu8fd8%5Cu539f%5Cu51fa%5Cu7f6e%5Cu6362%5Cu524d%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu5982hello%5Cu7f6e%5Cu6362%5Cu65b9%5Cu5f0f2%2C3%2C1%2C5%2C4%5Cuff1b%5Cu7f6e%5Cu6362%5Cu4e00%5Cu6b21%5Cu540e%5Cu4e3aelhol%5Cuff1b%5Cr%5Cn%5Cu8f93%5Cu5165%5Cu591a%5Cu7ec4%5Cu6570%5Cu636e%5Cu6bcf%5Cu7ec4%5Cu6570%5Cu636e%5Cu9996%5Cu884c%5Cu4e3an%2Cm%5Cu5982%5Cu9898%5Cu6240%5Cu8ff0%5Cuff0c%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu4e3an%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu8868%5Cu793a%5Cu7b2ci%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu7684%5Cu7f6e%5Cu6362%5Cu65b9%5Cu5f0f%5Cuff0c%5Cu7b2c%5Cu4e09%5Cu884c%5Cu4e3a%5Cu7f6e%5Cu6362%5Cu540e%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu8f93%5Cu5165%5Cu6700%5Cu540e%5Cu4ee50%2C0%5Cu7ed3%5Cu5c3e%5Cu3002%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cu7f6e%5Cu6362%5Cu524d%5Cu5b57%5Cu7b26%5Cu4e32%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A11%2C%22totalAccepted%22%3A6%2C%22pid%22%3A%22SP2853%22%2C%22title%22%3A%22PDECODE%20-%20Decode%20the%20Strings%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22PDECODE%20-%20Decode%20the%20Strings%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>PDECODE - Decode the Strings</h1>
<h2>题意翻译</h2>
<div>给出n个字符交换方式与置换m次后的最终置换结果，要求还原出置换前字符串，如hello置换方式2,3,1,5,4；置换一次后为elhol；
输入多组数据每组数据首行为n,m如题所述，第二行为n个字符表示第i个字符的置换方式，第三行为置换后字符串，输入最后以0,0结尾。
输出置换前字符串</div>
<h2>题目描述</h2>
<div> Bruce Force has had an interesting idea how to encode strings. The following is the description of how the encoding is done:
Let x $ _{1} $ ,x $ _{2} $ ,...,x $ _{n} $ be the sequence of characters of the string to be encoded.
1. Choose an integer _m_ and _n_ pairwise distinct numbers p $ _{1} $ ,p $ _{2} $ ,...,p $ _{n} $ from the set {_1_, _2_, ..., _n_} (a permutation of the numbers _1_ to _n_).
2. Repeat the following step _m_ times.
3. For _1_ ≤ i ≤ _n_ set y $ _{i} $ to x $ _{pi} $ , and then for _1_ ≤ i ≤ _n_ replace x $ _{i} $ by y $ _{i} $ .
For example, when we want to encode the string "hello", and we choose the value _m = 3_ and the permutation _2, 3, 1, 5, 4_, the data would be encoded in 3 steps: "hello" -> "elhol" -> "lhelo" -> "helol".
Bruce gives you the encoded strings, and the numbers _m_ and p $ _{1} $ , ..., p $ _{n} $ used to encode these strings. He claims that because he used huge numbers _m_ for encoding, you will need a lot of time to decode the strings. Can you disprove this claim by quickly decoding the strings?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The input contains several test cases. Each test case starts with a line containing two numbers _n_ and _m_ (_1 ≤ n ≤ 80_, _1 ≤ m ≤ 10 $ ^{9} $_ ). The following line consists of _n_ pairwise different numbers p $ _{1} $ ,...,p $ _{n} $ (_1_ ≤ p $ _{i} $ ≤ _n_). The third line of each test case consists of exactly _n_ characters, and represent the encoded string. The last test case is followed by a line containing two zeros.</div>
<h3>输出格式</h3>
<br />
<div>For each test case, print one line with the decoded string.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 3
2 3 1 5 4
helol
16 804289384
13 10 2 7 8 1 16 12 15 6 5 14 3 4 11 9
scssoet tcaede n
8 12
5 3 4 2 1 8 6 7
encoded?
0 0</code></pre>
<h3>输出样例 #1</h3>
<pre><code>hello
second test case
encoded?</code></pre>
</article>
</div>
</div>
</body>
</html>
