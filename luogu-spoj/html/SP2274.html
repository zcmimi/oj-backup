<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>ISLHOP - Island Hopping - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449730:aUpDvnygU/OGMP0JOWgFTQtjZ0DAPHQrrD0x6uANm3g=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20company%20Pacific%20Island%20Net%20%28PIN%29%20has%20identified%20several%20small%20island%20groups%20in%20the%20Pacific%20that%20do%20not%20have%20a%20fast%20internet%20connection.%20PIN%20plans%20to%20tap%20this%20potential%20market%20by%20offering%20internet%20service%20to%20the%20island%20inhabitants.%20Each%20groups%20of%20islands%20already%20has%20a%20deep-sea%20cable%20that%20connects%20the%20main%20island%20to%20the%20closest%20internet%20hub%20on%20the%20mainland%20%28be%20it%20America%2C%20Australia%20or%20Asia%29.%20All%20that%20remains%20to%20be%20done%20is%20to%20connect%20the%20islands%20in%20a%20group%20to%20each%20other.%20You%20must%20write%20a%20program%20to%20help%20them%20determine%20a%20connection%20procedure.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP2274%5C%2F536b15849278b0376bb7548f6a85ef0a92dab53d.png%29For%20each%20island%2C%20you%20are%20given%20the%20position%20of%20its%20router%20and%20the%20number%20of%20island%20inhabitants.%20In%20the%20figure%2C%20the%20dark%20dots%20are%20the%20routers%20and%20the%20numbers%20are%20the%20numbers%20of%20inhabitants.%20PIN%20will%20build%20connections%20between%20pairs%20of%20routers%20such%20that%20every%20router%20has%20a%20path%20to%20the%20main%20island.%20PIN%20has%20decided%20to%20build%20the%20network%20such%20that%20the%20total%20amount%20of%20cable%20used%20is%20minimal.%20Under%20this%20restriction%2C%20there%20may%20be%20several%20optimal%20networks.%20However%2C%20it%20does%20not%20matter%20to%20PIN%20which%20of%20the%20optimal%20networks%20is%20built.%5Cn%5CnPIN%20is%20interested%20in%20the%20average%20time%20required%20for%20new%20customers%20to%20access%20the%20internet%2C%20based%20on%20the%20assumption%20that%20construction%20on%20all%20cable%20links%20in%20the%20network%20begins%20at%20the%20same%20time.%20Cable%20links%20can%20be%20constructed%20at%20a%20rate%20of%20one%20kilometer%20of%20cable%20per%20day.%20As%20a%20result%2C%20shorter%20cable%20links%20are%20completed%20before%20the%20longer%20links.%20An%20island%20will%20have%20internet%20access%20as%20soon%20as%20there%20is%20a%20path%20from%20the%20island%20to%20the%20main%20island%20along%20completed%20cable%20links.%20If%20_m%20%24%20_%7Bi%7D%20%24_%20%20is%20the%20number%20of%20inhabitants%20of%20the%20_i_th%20island%20and%20t%20%24%20_%7Bi%7D%20%24%20is%20the%20time%20when%20the%20island%20is%20connected%20to%20the%20internet%2C%20then%20the%20average%20connection%20time%20is%3A%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP2274%5C%2F2e99181a8a0943bbb515c33a5f723651cc404857.png%29%22%2C%22inputFormat%22%3A%22The%20input%20consists%20of%20several%20descriptions%20of%20groups%20of%20islands.%20The%20first%20line%20of%20each%20description%20contains%20a%20single%20positive%20integer%20n%2C%20the%20number%20of%20islands%20in%20the%20group%20%28n%20%3C%3D%2050%29.%20Each%20of%20the%20next%20n%20lines%20has%20three%20integers%20x%20%24%20_%7Bi%7D%20%24%20%2C%20y%20%24%20_%7Bi%7D%20%24%20%2C%20m%20%24%20_%7Bi%7D%20%24%20%2C%20giving%20the%20position%20of%20the%20router%20%28x%20%24%20_%7Bi%7D%20%24%20%2C%20y%20%24%20_%7Bi%7D%20%24%20%29%20and%20number%20of%20inhabitants%20m%20%24%20_%7Bi%7D%20%24%20%28m%20%24%20_%7Bi%7D%20%24%20%3E%200%29%20of%20the%20islands.%20Coordinates%20are%20measured%20in%20kilometers.%20The%20first%20island%20in%20this%20sequence%20is%20the%20main%20island.%5Cn%5CnThe%20input%20is%20terminated%20by%20the%20number%20zero%20on%20a%20line%20by%20itself.%22%2C%22outputFormat%22%3A%22For%20each%20group%20of%20islands%20in%20the%20input%2C%20output%20the%20sequence%20number%20of%20the%20group%20and%20the%20average%20number%20of%20days%20until%20the%20inhabitants%20are%20connected%20to%20the%20internet.%20The%20number%20of%20days%20should%20have%20two%20digits%20to%20the%20right%20of%20the%20decimal%20point.%20Use%20the%20output%20format%20in%20the%20sample%20given%20below.%5Cn%5CnPlace%20a%20blank%20line%20after%20the%20output%20of%20each%20test%20case.%22%2C%22samples%22%3A%5B%5B%227%5Cr%5Cn11%2012%202500%5Cr%5Cn14%2017%201500%5Cr%5Cn9%209%20750%5Cr%5Cn7%2015%20600%5Cr%5Cn19%2016%20500%5Cr%5Cn8%2018%20400%5Cr%5Cn15%2021%20250%5Cr%5Cn0%22%2C%22Island%20Group%3A%201%20Average%203.20%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B500%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F2274%22%2C%22id%22%3A%222274%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP2274%22%2C%22title%22%3A%22ISLHOP%20-%20Island%20Hopping%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22ISLHOP%20-%20Island%20Hopping%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>ISLHOP - Island Hopping</h1>
<h2>题目描述</h2>
<div>The company Pacific Island Net (PIN) has identified several small island groups in the Pacific that do not have a fast internet connection. PIN plans to tap this potential market by offering internet service to the island inhabitants. Each groups of islands already has a deep-sea cable that connects the main island to the closest internet hub on the mainland (be it America, Australia or Asia). All that remains to be done is to connect the islands in a group to each other. You must write a program to help them determine a connection procedure.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/SP2274/536b15849278b0376bb7548f6a85ef0a92dab53d.png)For each island, you are given the position of its router and the number of island inhabitants. In the figure, the dark dots are the routers and the numbers are the numbers of inhabitants. PIN will build connections between pairs of routers such that every router has a path to the main island. PIN has decided to build the network such that the total amount of cable used is minimal. Under this restriction, there may be several optimal networks. However, it does not matter to PIN which of the optimal networks is built.
PIN is interested in the average time required for new customers to access the internet, based on the assumption that construction on all cable links in the network begins at the same time. Cable links can be constructed at a rate of one kilometer of cable per day. As a result, shorter cable links are completed before the longer links. An island will have internet access as soon as there is a path from the island to the main island along completed cable links. If _m $ _{i} $_ is the number of inhabitants of the _i_th island and t $ _{i} $ is the time when the island is connected to the internet, then the average connection time is:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/SP2274/2e99181a8a0943bbb515c33a5f723651cc404857.png)</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The input consists of several descriptions of groups of islands. The first line of each description contains a single positive integer n, the number of islands in the group (n <= 50). Each of the next n lines has three integers x $ _{i} $ , y $ _{i} $ , m $ _{i} $ , giving the position of the router (x $ _{i} $ , y $ _{i} $ ) and number of inhabitants m $ _{i} $ (m $ _{i} $ > 0) of the islands. Coordinates are measured in kilometers. The first island in this sequence is the main island.
The input is terminated by the number zero on a line by itself.</div>
<h3>输出格式</h3>
<br />
<div>For each group of islands in the input, output the sequence number of the group and the average number of days until the inhabitants are connected to the internet. The number of days should have two digits to the right of the decimal point. Use the output format in the sample given below.
Place a blank line after the output of each test case.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>7
11 12 2500
14 17 1500
9 9 750
7 15 600
19 16 500
8 18 400
15 21 250
0</code></pre>
<h3>输出样例 #1</h3>
<pre><code>Island Group: 1 Average 3.20</code></pre>
</article>
</div>
</div>
</body>
</html>
