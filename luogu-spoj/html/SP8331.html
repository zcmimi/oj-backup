<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>SSTRCITS - Sister cities - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450092:IaJbAbatTZZ/eSLtpiA8UXsa/Y9Vv5pkteHrksf2AAs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Unlike%20Dystopia%2C%20the%20neighbouring%20nation%20of%20Utopia%20believes%20in%20economic%20development.%20To%20improve%20the%20economy%20of%20the%20nation%2C%20the%20Utopian%20government%20has%20decided%20to%20select%20some%20pairs%20of%20cities%20as%20sister%20cities%20and%20take%20steps%20to%20improve%20trade%20relations%20between%20each%20pair.%5Cn%5CnThere%20are%20N%20cities%20in%20Utopia%2C%20numbered%201%20to%20N.%20There%20are%20two-way%20roads%20connecting%20some%20pairs%20of%20cities.%20The%20total%20number%20of%20roads%20in%20Utopia%20is%20R.%20Now%20the%20road%20network%20in%20Utopia%20has%20been%20created%20efficiently%20so%20that%20there%20is%20no%20road%20that%20is%20redundant.%20That%20is%2C%20there%20is%20exactly%20one%20way%20to%20travel%20between%20any%20pair%20of%20cities%20without%20using%20the%20same%20road%20twice.%20Now%20when%20a%20pair%20of%20cities%20is%20chosen%20as%20sister%20cities%2C%20the%20government%20wants%20to%20make%20sure%20that%20there%20is%20a%20direct%20road%20between%20them.%20Also%2C%20a%20given%20city%20cannot%20have%20more%20than%20one%20sister.%5Cn%5CnGiven%20the%20road%20network%20of%20Utopia%2C%20find%20the%20number%20of%20ways%20of%20selecting%20K%20pairs%20of%20sister%20cities%20under%20these%20constraints.%20As%20the%20answer%20can%20be%20quite%20large%2C%20output%20it%20modulo%20100000007.%5Cn%5CnFor%20example%2C%20assume%20that%20there%20are%206%20cities%20in%20Utopia.%20There%20are%20direct%20roads%20between%20the%20following%20pairs%20of%20cities%20%3A%20%281%2C2%29%2C%20%282%2C3%29%2C%20%282%2C4%29%2C%20%284%2C5%29%2C%20%284%2C6%29.%20Notice%20that%20there%20is%20exactly%20one%20way%20to%20travel%20between%20any%20pair%20of%20cities.%20If%20the%20government%20wants%20to%20select%20two%20pairs%20of%20sister%20cities%2C%20it%20can%20do%20it%20in%20four%20ways%20%3A%20%7B%281%2C2%29%2C%284%2C5%29%7D%2C%20%7B%283%2C2%29%2C%284%2C5%29%7D%2C%20%7B%281%2C2%29%2C%284%2C6%29%7D%2C%20%7B%283%2C2%29%2C%284%2C6%29%7D%22%2C%22inputFormat%22%3A%22First%20line%20of%20the%20input%20contains%20T%20%28%5Cn%5CnThe%20description%20of%20each%20test%20case%20begins%20with%20a%20line%20containing%203%20space%20separated%20integers%20N%20%28%3C400%29%2C%20R%20%28%3C10000%29%20and%20K%20%28%3C400%29.%20Following%20these%20are%20R%20lines%2C%20each%20representing%20a%20road%20in%20Utopia.%20The%20line%20will%20contain%20two%20different%20space%20separated%20integers%20N%20%24%20_%7B1%7D%20%24%20and%20N%20%24%20_%7B2%7D%20%24%20implying%20that%20there%20is%20a%20two%20way%20road%20between%20N%20%24%20_%7B1%7D%20%24%20and%20N%20%24%20_%7B2%7D%20%24%20.%20You%20are%20assured%20that%20the%20road%20network%20has%20the%20property%20as%20described%20in%20the%20problem%20statement.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20output%20modulo%20100000007%20the%20number%20of%20ways%20of%20selecting%20K%20pairs%20of%20sister%20cities%20satisfying%20the%20conditions%20in%20the%20problem%20statement.%22%2C%22samples%22%3A%5B%5B%222%5Cr%5Cn3%202%201%5Cr%5Cn1%202%5Cr%5Cn2%203%5Cr%5Cn6%205%202%5Cr%5Cn1%202%5Cr%5Cn2%203%5Cr%5Cn2%204%5Cr%5Cn4%205%5Cr%5Cn4%206%22%2C%222%5Cr%5Cn4%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B607%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F8331%22%2C%22id%22%3A%228331%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP8331%22%2C%22title%22%3A%22SSTRCITS%20-%20Sister%20cities%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22SSTRCITS%20-%20Sister%20cities%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>SSTRCITS - Sister cities</h1>
<h2>题目描述</h2>
<div>Unlike Dystopia, the neighbouring nation of Utopia believes in economic development. To improve the economy of the nation, the Utopian government has decided to select some pairs of cities as sister cities and take steps to improve trade relations between each pair.
There are N cities in Utopia, numbered 1 to N. There are two-way roads connecting some pairs of cities. The total number of roads in Utopia is R. Now the road network in Utopia has been created efficiently so that there is no road that is redundant. That is, there is exactly one way to travel between any pair of cities without using the same road twice. Now when a pair of cities is chosen as sister cities, the government wants to make sure that there is a direct road between them. Also, a given city cannot have more than one sister.
Given the road network of Utopia, find the number of ways of selecting K pairs of sister cities under these constraints. As the answer can be quite large, output it modulo 100000007.
For example, assume that there are 6 cities in Utopia. There are direct roads between the following pairs of cities : (1,2), (2,3), (2,4), (4,5), (4,6). Notice that there is exactly one way to travel between any pair of cities. If the government wants to select two pairs of sister cities, it can do it in four ways : {(1,2),(4,5)}, {(3,2),(4,5)}, {(1,2),(4,6)}, {(3,2),(4,6)}</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>First line of the input contains T (
The description of each test case begins with a line containing 3 space separated integers N (<400), R (<10000) and K (<400). Following these are R lines, each representing a road in Utopia. The line will contain two different space separated integers N $ _{1} $ and N $ _{2} $ implying that there is a two way road between N $ _{1} $ and N $ _{2} $ . You are assured that the road network has the property as described in the problem statement.</div>
<h3>输出格式</h3>
<br />
<div>For each test case, output modulo 100000007 the number of ways of selecting K pairs of sister cities satisfying the conditions in the problem statement.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2
3 2 1
1 2
2 3
6 5 2
1 2
2 3
2 4
4 5
4 6</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
4</code></pre>
</article>
</div>
</div>
</body>
</html>
