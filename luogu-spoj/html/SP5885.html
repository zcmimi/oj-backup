<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>TROOPS - Troops of Sand Monsters - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449969:UR6CmJfee+k3pabhfZm+GfZQfnWVT4idnQ5+qq0SE64=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Under%20the%20command%20of%20the%20Evil%20Vizier%20there%20are%20N%20unique%20troops%20of%20sand%20monsters%2C%20where%20each%20troop%20contains%20Ci%20sand%20monsters.%20The%20Vizier%20in%20his%20desperate%20battle%20against%20the%20Prince%20of%20Persia%20has%20ordered%20all%20his%20troops%20to%20attack%20him%20simultaneously.%20%20%20%5Cn%20%20%20%5CnThe%20Prince%20realizes%20that%20he%20cannot%20defeat%20all%20of%20the%20sand%20monsters%2C%20as%20they%20are%20invincible%20when%20they%20are%20active.%20So%20he%20uses%20the%20Eye%20of%20the%20Storm%20spell%20to%20freeze%20all%20the%20sand%20monsters%20of%20all%20troops.%20Now%20the%20Prince%20can%20kill%20any%20monster%20by%20stabbing%20each%20monster%20once%20using%20the%20Dagger%20of%20Time.%20Once%20the%20monster%20is%20killed%2C%20it%20can%20never%20become%20active%20again%20and%20releases%20a%20certain%20quantity%20of%20the%20Sands%20of%20Time.%20It%20takes%20one%20unit%20of%20time%20to%20kill%20any%20monster.%20%20%20%5Cn%20%20%20%5CnEach%20troop%20i%2C%20consits%20of%20Ci%20similar%20monsters%2C%20all%20with%20the%20same%20spell%20resistance%20time%20Ti%20-%20after%20which%20it%20becomes%20active%20again%20and%20therefore%20invulnerable%20-%20and%20Sand%20Si%20-%20which%20can%20be%20taken%20by%20the%20Prince%20after%20killing%20it.%20%20%20%5Cn%20%20%20%5CnThe%20spell%20lasts%20only%20for%20a%20limited%20duration%20of%20time.%20So%2C%20the%20Prince%20has%20to%20kill%20as%20many%20sand%20monsters%20as%20possible%20and%20take%20maximum%20sand%20from%20the%20monsters%20before%20they%20become%20active%20again.%20It%20is%20not%20necessary%20for%20The%20Prince%20to%20kill%20all%20the%20monsters%20in%20a%20troop%20before%20moving%20on%20to%20next%20troop.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20K%20%3C%3D70%20the%20number%20of%20testcases.%20Each%20testcase%20begins%20with%20%27N%27%20%28%3C%3D1000%29%20the%20number%20of%20troops%20of%20monsters.%20Next%20N%20lines%20contain%203%20integers%20Ci%2C%20Ti%2C%20Si.%201%3Ci%3C%3DN%2C%201%3C%3DCi%3C%3D15000%2C%201%3C%3DTi%3C%3D1000000%2C%201%3C%3DSi%3C%3D100%2C%22%2C%22outputFormat%22%3A%22Single%20Line%20containing%20the%20maximum%20amount%20of%20sand%20that%20Prince%20can%20get%20if%20he%20kills%20some%20or%20all%20the%20monsters.%22%2C%22samples%22%3A%5B%5B%22%5C%5Cn1%20%5C%5Cn4%20%5C%5Cn2%201%202%20%5C%5Cn2%203%206%20%5C%5Cn2%205%205%20%5C%5Cn2%207%208%5C%5Cn%5C%5Cn%22%2C%22%5C%5Cn40%5C%5Cn%5C%5CnExplanation%28time%2C%20troop%2C%20sand%29%20%5C%5Cn%280%2C1%2C2%29%20%281%2C2%2C6%29%20%282%2C2%2C6%29%20%283%2C3%2C5%29%20%284%2C3%2C5%29%20%285%2C4%2C8%29%20%285%2C4%2C8%29%20%3D%2040%5C%5Cn%26nbsp%3B%5C%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B449%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F5885%22%2C%22id%22%3A%225885%22%7D%2C%22translation%22%3A%22%5Cu9898%5Cu610f%5Cu7b80%5Cu8ff0%5Cuff1a%5Cr%5Cn%5Cr%5Cn%5Ct%5Cu73b0%5Cu5728%5Cu6709N%5Cu4e2a%5Cu6c99%5Cu602a%5Cu90e8%5Cu961f%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu90e8%5Cu961f%5Cu4e2d%5Cu6709Ci%5Cu53ea%5Cu6c99%5Cu602a%5Cuff0c%5Cu6c99%5Cu602a%5Cu5728%5Cu6d3b%5Cu8dc3%5Cu7684%5Cu72b6%5Cu6001%5Cu4e0b%5Cu662f%5Cu65e0%5Cu654c%5Cu7684%5Cu3002%5Cr%5Cn%20%20%20%20%5Cr%5Cn%5CtThe%20Prince%5Cu7528%5Cu6cd5%5Cu672f%5Cu51bb%5Cu7ed3%5Cu4e86%5Cu6240%5Cu6709%5Cu7684%5Cu6c99%5Cu602a%5Cuff0c%5Cu7136%5Cu540e%5Cu624d%5Cu80fd%5Cu5c06%5Cu5b83%5Cu4eec%5Cu6740%5Cu6b7b%5Cuff0c%5Cu6740%5Cu6b7b%5Cu7684%5Cu6c99%5Cu602a%5Cu4e0d%5Cu4f1a%5Cu518d%5Cu6d3b%5Cu8dc3%5Cuff0c%5Cu5e76%5Cu4e14%5Cu6740%5Cu6b7b%5Cu6c99%5Cu602a%5Cu65f6The%20Prince%5Cu5c06%5Cu4f1a%5Cu5f97%5Cu5230%5Cu4e00%5Cu5b9a%5Cu7684%5Cu65f6%5Cu95f4%5Cu4e4b%5Cu6c99%5Cuff0c%5Cu6740%5Cu6b7b%5Cu6bcf%5Cu4e2a%5Cu602a%5Cu7269%5Cu9700%5Cu8981%5Cu4e00%5Cu4e2a%5Cu5355%5Cu4f4d%5Cu65f6%5Cu95f4%5Cu3002%5Cr%5Cn%20%20%20%20%5Cr%5Cn%5Ct%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e2a%5Cu90e8%5Cu961f%5Cu4e2d%5Cu7684Ci%5Cu53ea%5Cu6c99%5Cu602a%5Cuff0c%5Cu5b83%5Cu4eec%5Cu90fd%5Cu5177%5Cu6709%5Cu76f8%5Cu540c%5Cu7684%5Cu9b54%5Cu6cd5%5Cu6297%5Cu6027Ti%5Cuff0c%5Cu8868%5Cu793a%5Cu5728Ti%5Cu65f6%5Cu95f4%5Cu540e%5Cu8fd9%5Cu652f%5Cu961f%5Cu4f0d%5Cu91cc%5Cu8fd8%5Cu6d3b%5Cu7740%5Cu7684%5Cu6c99%5Cu602a%5Cu5c06%5Cu4f1a%5Cu91cd%5Cu65b0%5Cu6062%5Cu590d%5Cu6d3b%5Cu8dc3%5Cuff08%5Cu5373%5Cu65e0%5Cu654c%5Cu4e86%5Cuff09%5Cuff0cThe%20Prince%5Cu65e0%5Cu6cd5%5Cu5c06%5Cu5176%5Cu51fb%5Cu6740%5Cu3002%5Cr%5Cn%5Ct%5Cu8bf7%5Cu4f60%5Cu8bbe%5Cu8ba1%5Cu7a0b%5Cu5e8f%5Cuff0c%5Cu5e2e%5Cu52a9The%20Prince%5Cu8ba1%5Cu7b97%5Cu51fa%5Cu5728%5Cu6240%5Cu6709%5Cu6c99%5Cu602a%5Cu6062%5Cu590d%5Cu6d3b%5Cu8dc3%5Cu4e4b%5Cu524d%5Cuff0c%5Cu4ed6%5Cu6700%5Cu591a%5Cu53ef%5Cu4ee5%5Cu83b7%5Cu5f97%5Cu591a%5Cu5c11%5Cu7684%5Cu65f6%5Cu95f4%5Cu4e4b%5Cu6c99%5Cu3002%5Cr%5Cn%20%20%20%20%5Cr%5Cn%20%20%20%20%5Cu6ce8%5Cu610f%5Cuff1aThe%20Prince%5Cu4e0d%5Cu4e00%5Cu5b9a%5Cu9700%5Cu8981%5Cu5c06%5Cu67d0%5Cu652f%5Cu90e8%5Cu961f%5Cu7684%5Cu6240%5Cu6709%5Cu6c99%5Cu602a%5Cu6740%5Cu5149%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cr%5Cn%5Cr%5Cn%5Ct%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6570%5Cu5b57K%5Cuff08K%3C%3D70%5Cuff09%5Cuff0c%5Cu8868%5Cu793a%5Cu5171K%5Cu7ec4%5Cu6570%5Cu636e%5Cu3002%5Cr%5Cn%5Ct%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu7ec4%5Cu6570%5Cu636e%5Cuff1a%5Cr%5Cn%5Ct%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e3a%5Cu90e8%5Cu961f%5Cu6570N%5Cuff08%3C%3D1000%29%5Cu3002%5Cu63a5%5Cu4e0b%5Cu6765%5Cu7684N%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu5305%5Cu62ec%5Cu4e09%5Cu4e2a%5Cu6574%5Cu6570Ci%5Cuff0cTi%5Cuff0cSi%5Cuff081%20%3Ci%20%3C%3D%20N%5Cuff0c1%20%3C%3D%20Ci%20%3C%3D%2015000%2C1%20%3C%3D%20Ti%20%3C%3D%201000000%2C1%20%3C%3D%20Si%20%3C%3D%20100%5Cuff09Ci%5Cuff0cTi%5Cu542b%5Cu4e49%5Cu89c1%5Cu4e0a%5Cu6587%5Cuff0cSi%5Cu8868%5Cu793a%5Cu6740%5Cu6b7b%5Cu7b2ci%5Cu652f%5Cu90e8%5Cu961f%5Cu4e2d%5Cu7684%5Cu6bcf%5Cu4e2a%5Cu6c99%5Cu602a%5Cu53ef%5Cu4ee5%5Cu83b7%5Cu5f97%5Cu7684%5Cu65f6%5Cu95f4%5Cu4e4b%5Cu6c99%5Cu7684%5Cu6570%5Cu91cf%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cr%5Cn%5Cr%5Cn%5Ct%5Cu5bf9%5Cu6bcf%5Cu7ec4%5Cu6570%5Cu636e%5Cuff0c%5Cu8f93%5Cu51fa%5Cu6709%5Cu4e00%5Cu884c%5Cuff0c%5Cu8868%5Cu793aThe%20Prince%5Cu6700%5Cu591a%5Cu53ef%5Cu83b7%5Cu5f97%5Cu7684%5Cu65f6%5Cu95f4%5Cu4e4b%5Cu6c99%5Cu7684%5Cu6570%5Cu76ee%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP5885%22%2C%22title%22%3A%22TROOPS%20-%20Troops%20of%20Sand%20Monsters%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22TROOPS%20-%20Troops%20of%20Sand%20Monsters%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>TROOPS - Troops of Sand Monsters</h1>
<h2>题意翻译</h2>
<div>题意简述：
现在有N个沙怪部队，每个部队中有Ci只沙怪，沙怪在活跃的状态下是无敌的。
The Prince用法术冻结了所有的沙怪，然后才能将它们杀死，杀死的沙怪不会再活跃，并且杀死沙怪时The Prince将会得到一定的时间之沙，杀死每个怪物需要一个单位时间。
对于每个部队中的Ci只沙怪，它们都具有相同的魔法抗性Ti，表示在Ti时间后这支队伍里还活着的沙怪将会重新恢复活跃（即无敌了），The Prince无法将其击杀。
请你设计程序，帮助The Prince计算出在所有沙怪恢复活跃之前，他最多可以获得多少的时间之沙。
注意：The Prince不一定需要将某支部队的所有沙怪杀光。
输入格式：
第一行一个数字K（K<=70），表示共K组数据。
对于每组数据：
第一行为部队数N（<=1000)。接下来的N行，每行包括三个整数Ci，Ti，Si（1 <i <=N，1 <=Ci <=15000,1 <=Ti <=1000000,1 <=Si <=100）Ci，Ti含义见上文，Si表示杀死第i支部队中的每个沙怪可以获得的时间之沙的数量。 输出格式： 对每组数据，输出有一行，表示The Prince最多可获得的时间之沙的数目。</div>
<h2>题目描述</h2>
<div>Under the command of the Evil Vizier there are N unique troops of sand monsters, where each troop contains Ci sand monsters. The Vizier in his desperate battle against the Prince of Persia has ordered all his troops to attack him simultaneously.
The Prince realizes that he cannot defeat all of the sand monsters, as they are invincible when they are active. So he uses the Eye of the Storm spell to freeze all the sand monsters of all troops. Now the Prince can kill any monster by stabbing each monster once using the Dagger of Time. Once the monster is killed, it can never become active again and releases a certain quantity of the Sands of Time. It takes one unit of time to kill any monster.
Each troop i, consits of Ci similar monsters, all with the same spell resistance time Ti - after which it becomes active again and therefore invulnerable - and Sand Si - which can be taken by the Prince after killing it.
The spell lasts only for a limited duration of time. So, the Prince has to kill as many sand monsters as possible and take maximum sand from the monsters before they become active again. It is not necessary for The Prince to kill all the monsters in a troop before moving on to next troop.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains K <=70 the number of testcases. Each testcase begins with 'N' (<=1000) the number of troops of monsters. Next N lines contain 3 integers Ci, Ti, Si. 1<i<=N, 1<=Ci<=15000, 1<=Ti<=1000000, 1<=Si<=100,</div>
<h3>输出格式</h3>
<br />
<div>Single Line containing the maximum amount of sand that Prince can get if he kills some or all the monsters.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>\n1 \n4 \n2 1 2 \n2 3 6 \n2 5 5 \n2 7 8\n\n</code></pre>
<h3>输出样例 #1</h3>
<pre><code>\n40\n\nExplanation(time, troop, sand) \n(0,1,2) (1,2,6) (2,2,6) (3,3,5) (4,3,5) (5,4,8) (5,4,8) = 40\n&amp;nbsp;\n</code></pre>
</article>
</div>
</div>
</body>
</html>
