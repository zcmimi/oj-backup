<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>SANTA2 - Travelling Santa - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450401:1JCeJIWXbtp/45vthuf44VZ5hjv2RB37T7DF4uiSbqw=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22At%20last%2C%20Santa%20is%20on%20his%20way%21%20He%27s%20got%20a%20number%20of%20presents%20to%20deliver%20to%20various%20households%2C%20and%20he%20won%27t%20stop%20until%20he%27s%20disposed%20of%20them%20all.%20However%2C%20each%20present%20is%20only%20suitable%20for%20one%20gender%20-%20for%20example%2C%20men%20might%20enjoy%20such%20things%20as%20baseball%20bats%2C%20football%20helmets%2C%20and%20certain%20adult%20reading%20material%2C%20while%20women%20would%20prefer%20make-up%2C%20knitting%20needles%2C%20and%20certain%20other%20adult%20reading%20material.%5Cn%5CnAt%20the%20moment%2C%20Santa%20is%20in%20a%20neighbourhood%20with%20%24%20H%20%24%20%28%20%24%201%20%5C%5Cleq%20H%20%5C%5Cleq%2050%20%24%20%29%20houses%20%28numbered%20%24%201..H%20%24%20%29%2C%20connected%20by%20%24%20R%20%24%20%28%20%24%201%20%5C%5Cleq%20R%20%5C%5Cleq%2010%5E%7B4%7D%20%24%20%29%20roads.%20The%20family%20living%20in%20house%20%24%20i%20%24%20includes%20%24%20M_i%20%24%20%28%20%24%200%20%5C%5Cleq%20M_i%20%5C%5Cleq%2010%20%24%20%29%20males%20and%20%24%20F_i%20%24%20%28%20%24%200%20%5C%5Cleq%20F_i%20%5C%5Cleq%2010%20%24%20%29%20females.%20The%20%24%20i%20%24%20th%20road%20runs%20between%20distinct%20houses%20%24%20A_i%20%24%20and%20%24%20B_i%20%24%20%2C%20and%20can%20be%20travelled%20in%20either%20direction.%20No%20pair%20of%20houses%20is%20directly%20connected%20by%20more%20than%20one%20road.%5Cn%5CnSanta%20starts%20at%20house%20%24%201%20%24%20%2C%20carrying%20%24%20M_S%20%24%20%28%20%24%200%20%5C%5Cleq%20M_S%20%5C%5Cleq%2050%20%24%20%29%20male-appropriate%20and%20%24%20F_S%20%24%20%28%20%24%200%20%5C%5Cleq%20F_S%20%5C%5Cleq%2050%20%24%20%29%20female-appropriate%20presents.%20He%20then%20repeats%20the%20following%20process%20until%20he%27s%20out%20of%20gifts.%20First%2C%20he%20moves%20randomly%20to%20an%20adjacent%20house%20%28a%20house%20reachable%20by%20taking%20one%20road%29%20-%20it%27s%20guaranteed%20that%20there%20will%20be%20at%20least%20one%20such%20house.%20If%20he%20currently%20has%20%24%20m%20%24%20male-appropriate%20and%20%24%20f%20%24%20female-approrpiate%20presents%2C%20his%20probability%20of%20moving%20to%20adjacent%20house%20%24%20i%20%24%20is%20proportional%20to%20the%20value%20of%20%24%20M_i%20m%20%2B%20F_i%20f%20%24%20.%20Of%20course%2C%20the%20probabilities%20for%20all%20adjacent%20houses%20must%20add%20up%20to%20%24%201%20%24%20.%20Note%20that%20if%20this%20value%20is%20%24%200%20%24%20for%20all%20adjacent%20houses%2C%20then%20Santa%20will%20move%20to%20any%20of%20them%20with%20equal%20probability.%20After%20reaching%20the%20new%20house%2C%20he%20delivers%20a%20male%20present%20to%20it%20with%20probability%20%24%20%5C%5Cfrac%7Bm%7D%7Bm%2Bf%7D%20%24%20%2C%20and%20a%20female%20present%20otherwise.%5Cn%5CnWanting%20to%20plan%20ahead%20to%20leaving%20this%20neighbourhood%2C%20Santa%20is%20curious%20as%20to%20where%20he%27ll%20end%20up.%20He%27d%20like%20you%20to%20calculate%20the%20probability%20of%20him%20being%20at%20each%20of%20the%20%24%20H%20%24%20houses%20when%20he%20runs%20out%20of%20presents.%22%2C%22inputFormat%22%3A%22First%20line%3A%20%24%20H%20%24%20and%20%24%20R%20%24%5Cn%5CnNext%20%24%20H%20%24%20lines%3A%20%24%20M_i%20%24%20and%20%24%20F_i%20%24%20%2C%20for%20%24%20i%20%3D%201..H%20%24%5Cn%5CnNext%20%24%20R%20%24%20lines%3A%20%24%20A_i%20%24%20and%20%24%20B_i%20%24%20%2C%20for%20%24%20i%20%3D%201..R%20%24%5Cn%5CnNext%20line%3A%20%24%20M_S%20%24%20and%20%24%20F_S%20%24%22%2C%22outputFormat%22%3A%22%20%24%20H%20%24%20lines%3A%20The%20probability%20of%20Santa%20finishing%20his%20present-delivering%20process%20at%20house%20%24%20i%20%24%20%2C%20rounded%20off%20to%206%20decimal%20places%2C%20for%20%24%20i%20%3D%201..H%20%24%22%2C%22samples%22%3A%5B%5B%224%203%5C%5Cn1%202%5C%5Cn2%201%5C%5Cn1%201%5C%5Cn4%200%5C%5Cn1%202%5C%5Cn2%204%5C%5Cn3%201%5C%5Cn1%201%22%2C%22%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F14946%22%2C%22id%22%3A%2214946%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP14946%22%2C%22title%22%3A%22SANTA2%20-%20Travelling%20Santa%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22SANTA2%20-%20Travelling%20Santa%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>SANTA2 - Travelling Santa</h1>
<h2>题目描述</h2>
<div>At last, Santa is on his way! He's got a number of presents to deliver to various households, and he won't stop until he's disposed of them all. However, each present is only suitable for one gender - for example, men might enjoy such things as baseball bats, football helmets, and certain adult reading material, while women would prefer make-up, knitting needles, and certain other adult reading material.
At the moment, Santa is in a neighbourhood with $ H $ ( $ 1 \leq H \leq 50 $ ) houses (numbered $ 1..H $ ), connected by $ R $ ( $ 1 \leq R \leq 10^{4} $ ) roads. The family living in house $ i $ includes $ M_i $ ( $ 0 \leq M_i \leq 10 $ ) males and $ F_i $ ( $ 0 \leq F_i \leq 10 $ ) females. The $ i $ th road runs between distinct houses $ A_i $ and $ B_i $ , and can be travelled in either direction. No pair of houses is directly connected by more than one road.
Santa starts at house $ 1 $ , carrying $ M_S $ ( $ 0 \leq M_S \leq 50 $ ) male-appropriate and $ F_S $ ( $ 0 \leq F_S \leq 50 $ ) female-appropriate presents. He then repeats the following process until he's out of gifts. First, he moves randomly to an adjacent house (a house reachable by taking one road) - it's guaranteed that there will be at least one such house. If he currently has $ m $ male-appropriate and $ f $ female-approrpiate presents, his probability of moving to adjacent house $ i $ is proportional to the value of $ M_i m + F_i f $ . Of course, the probabilities for all adjacent houses must add up to $ 1 $ . Note that if this value is $ 0 $ for all adjacent houses, then Santa will move to any of them with equal probability. After reaching the new house, he delivers a male present to it with probability $ \frac{m}{m+f} $ , and a female present otherwise.
Wanting to plan ahead to leaving this neighbourhood, Santa is curious as to where he'll end up. He'd like you to calculate the probability of him being at each of the $ H $ houses when he runs out of presents.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>First line: $ H $ and $ R $
Next $ H $ lines: $ M_i $ and $ F_i $ , for $ i = 1..H $
Next $ R $ lines: $ A_i $ and $ B_i $ , for $ i = 1..R $
Next line: $ M_S $ and $ F_S $</div>
<h3>输出格式</h3>
<br />
<div> $ H $ lines: The probability of Santa finishing his present-delivering process at house $ i $ , rounded off to 6 decimal places, for $ i = 1..H $</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 3\n1 2\n2 1\n1 1\n4 0\n1 2\n2 4\n3 1\n1 1</code></pre>
<h3>输出样例 #1</h3>
<pre><code></code></pre>
</article>
</div>
</div>
</body>
</html>
