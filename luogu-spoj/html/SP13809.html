<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>ISRANK - ISRANK - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450366:P8rFRPyx6Th4cuRx7gt9zoSPHxV0DpozqeuTeUZJJhk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22There%20are%20%2A%2AN%2A%2A%20schools%2C%20with%20i%20th%20school%20having%20%2A%2AS%20%24%20_%7Bi%7D%20%24%2A%2A%20%20students.%20There%20is%20a%20inter-school%20programming%20contest%20%2A%2AIPC%2A%2A%20in%20which%20all%20the%20schools%20participate.%20As%20%2A%2AIPC%2A%2A%20is%20a%20very%20prestigious%20event%2C%20the%20schools%20conduct%20a%20test%20run%20within%20themselves.%20They%20assign%20a%20predicted%20rank%20for%20students%20within%20the%20school%20for%20all%20students%2C%20based%20on%20the%20rank%20they%20got%20in%20the%20test%20run.%20Let%20%2A%2AP%20%24%20_%7Bij%7D%20%24%2A%2A%20%20be%20the%20predicted%20rank%20of%20%2A%2Aj%2A%2A%20th%20student%20of%20%2A%2Ai%2A%2A%20th%20school.%20The%20predicted%20rank%20will%20be%20unique%20within%20the%20school%2C%20i.e.%20formally%3A%20%20%5Cn%21%5B%5D%28http%3A%5C%2F%5C%2Flatex.codecogs.com%5C%2Fgif.latex%3F%5C%5Clarge%20%5C%5Cinline%20%5C%5Cfn_jvn%20%5C%5C%7B%5C%5Cforall%20i%2C%20P_i_j%20%3D%20P_i_k%20%5C%5CLeftrightarrow%20j%3Dk%5C%5C%7D%20%5C%22%5C%5Cfn_jvn%20%5C%5C%7B%5C%5Cforall%20i%2C%20P_i_j%20%3D%20P_i_k%20%5C%5CLeftrightarrow%20j%3Dk%5C%5C%7D%5C%22%29%20%20%5CnIt%20should%20be%20noted%20that%20students%20of%20different%20schools%20may%20have%20the%20same%20predicted%20rank.%20%20%20%5Cn%20%20%5Cn%20At%20the%20end%20of%20IPC%2C%20the%20IPC%20committee%20has%20given%20each%20school%20the%20result%20card%20containing%20the%20marks%20of%20all%20students%20of%20that%20school.%20Let%20%2A%2AM%20%24%20_%7Bij%7D%20%24%2A%2A%20%20represent%20the%20actual%20marks%20obtained%20by%20the%20%2A%2Aj%2A%2A%20th%20student%20of%20%2A%2Ai%2A%2A%20th%20school.%20IPC%20follows%20a%20strict%20rule%20of%20giving%20unique%20marks%20to%20all%20students%20taking%20part%20in%20IPC%2C%20i.e.%20formally%3A%20%20%5Cn%21%5B%5D%28http%3A%5C%2F%5C%2Flatex.codecogs.com%5C%2Fgif.latex%3F%5C%5Clarge%20%5C%5Cinline%20%5C%5Cfn_jvn%20%5C%5C%7B%5C%5Cforall%20i%2C%20%5C%5Cforall%20j%20%2C%20M_i_j%20%3D%20M_p_k%20%5C%5CLeftrightarrow%20i%3Dp%20%5C%5Cand%5C%5C%20j%3Dk%5C%5C%7D%20%5C%22%5C%5Cfn_jvn%20%5C%5C%7B%5C%5Cforall%20i%2C%20%5C%5Cforall%20j%20%2C%20M_i_j%20%3D%20M_p_k%20%5C%5CLeftrightarrow%20i%3Dp%20%5C%5Cand%5C%5C%20j%3Dk%5C%5C%7D%5C%22%29%20%20%5Cn%20%20%5Cn%20You%20are%20to%20design%20a%20system%2C%20which%20will%20efficiently%20answer%20queries%20of%20the%20following%20form%3A%20%20%5Cn%2A%2AL%2A%2A%20-%20the%20number%20of%20schools%20to%20be%20considered%20%20%5Cn%2A%2AA1%20A2%20A3%20....%20AL%2A%2A%20-%20the%20list%20of%20schools%20%20%5Cn%2A%2AP1%20P2%2A%2A%20-%20The%20range%20of%20predicted%20ranks%20%20%5Cn%2A%2AK%2A%2A%20-%20desired%20rank%20%20%5Cn%20You%20are%20to%20answer%20-%20among%20all%20the%20students%20who%20attended%20the%20given%20list%20of%20schools%20and%20with%20predicted%20ranks%20between%20%2A%2AP1%2A%2A%20and%20%2A%2AP2%2A%2A%20both%20inclusive%2C%20the%20marks%20of%20the%20student%20with%20%2A%2AK%2A%2A%20th%20highest%20marks.%20%28The%20first%20highest%20marks%20would%20the%20the%20maximum%20marks%2C%20and%20second%20would%20be%20the%20next%20and%20so%20on%29%5Cn%5Cn%20%20%20%5Cn%23%23%23%23%20Input%5Cn%5CnFirst%20line%20contains%20a%20single%20integer%20%2A%2AN%2A%2A%2C%20the%20number%20of%20schools.%20%20%5Cn%20The%20next%20line%20contains%20%2A%2AN%2A%2A%20space%20separated%20integers%20%2A%2AS%20%24%20_%7Bi%7D%20%24%2A%2A%20.%20%20%5Cn%20The%20next%20%2A%2AN%2A%2A%20lines%2C%20the%20%2A%2Ai%2A%2A%20th%20line%20contains%20%2A%2AS%20%24%20_%7Bi%7D%20%24%2A%2A%20%20space%20separated%20integers%2C%20%2A%2Aj%2A%2A%20th%20of%20which%20is%20denoting%20%2A%2AP%20%24%20_%7Bij%7D%20%24%2A%2A%20.%20%20%5Cn%20The%20next%20%2A%2AN%2A%2A%20lines%2C%20the%20%2A%2Ai%2A%2A%20th%20line%20contains%20%2A%2AS%20%24%20_%7Bi%7D%20%24%2A%2A%20%20space%20separated%20integers%2C%20%2A%2Aj%2A%2A%20th%20of%20which%20is%20denoting%20%2A%2AM%20%24%20_%7Bij%7D%20%24%2A%2A%20.%20%20%5Cn%20The%20next%20line%20contains%20a%20single%20integer%20%2A%2AQ%2A%2A%2C%20denoting%20the%20number%20of%20queries.%20%20%5Cn%20Whats%20follows%20are%20%2A%2AQ%2A%2A%20sets%20of%20queries.%20Each%20query%20is%20structured%20as%20follows.%20%20%5Cn%20First%20line%20of%20the%20query%20is%20%2A%2AL%2A%2A%2C%20the%20list%20of%20schools.%20%20%5Cn%20Followed%20by%20%2A%2AL%2A%2A%20integers%20denoting%20the%20%2A%2A1%20based%2A%2A%20indices%20of%20schools.%20%20%5Cn%20Next%20are%20%2A%2AP1%2A%2A%20and%20%2A%2AP2%2A%2A%2C%20the%20range%20of%20ranks%20we%20are%20interested%20in.%20%20%5Cn%20Next%20is%20the%20integer%20%2A%2AK%2A%2A.%5Cn%5Cn%20%20%20%5Cn%23%23%23%23%20Output%5Cn%5CnFor%20each%20query%20on%20a%20separate%20line%20print%20a%20single%20integer%20answering%20the%20query.%20If%20answer%20is%20not%20possible%20print%20-1%5Cn%5Cn%20%20%20%5Cn%23%23%23%23%20Constraints%5Cn%5Cn1%20N%201%20S%20%24%20_%7Bi%7D%20%24%201%20P%20%24%20_%7Bij%7D%20%24%20S%20%24%20_%7Bi%7D%20%24%20%20%20%5Cn%201%20M%20%24%20_%7Bij%7D%20%24%201%20Q%20%2A%2A1%201%2A%2A%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F13809%22%2C%22id%22%3A%2213809%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP13809%22%2C%22title%22%3A%22ISRANK%20-%20ISRANK%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22ISRANK%20-%20ISRANK%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>ISRANK - ISRANK</h1>
<h2>题目描述</h2>
<div>There are **N** schools, with i th school having **S $ _{i} $** students. There is a inter-school programming contest **IPC** in which all the schools participate. As **IPC** is a very prestigious event, the schools conduct a test run within themselves. They assign a predicted rank for students within the school for all students, based on the rank they got in the test run. Let **P $ _{ij} $** be the predicted rank of **j** th student of **i** th school. The predicted rank will be unique within the school, i.e. formally:
![](http://latex.codecogs.com/gif.latex?\large \inline \fn_jvn \{\forall i, P_i_j = P_i_k \Leftrightarrow j=k\} "\fn_jvn \{\forall i, P_i_j = P_i_k \Leftrightarrow j=k\}")
It should be noted that students of different schools may have the same predicted rank.
At the end of IPC, the IPC committee has given each school the result card containing the marks of all students of that school. Let **M $ _{ij} $** represent the actual marks obtained by the **j** th student of **i** th school. IPC follows a strict rule of giving unique marks to all students taking part in IPC, i.e. formally:
![](http://latex.codecogs.com/gif.latex?\large \inline \fn_jvn \{\forall i, \forall j , M_i_j = M_p_k \Leftrightarrow i=p \and\ j=k\} "\fn_jvn \{\forall i, \forall j , M_i_j = M_p_k \Leftrightarrow i=p \and\ j=k\}")
You are to design a system, which will efficiently answer queries of the following form:
**L** - the number of schools to be considered
**A1 A2 A3 .... AL** - the list of schools
**P1 P2** - The range of predicted ranks
**K** - desired rank
You are to answer - among all the students who attended the given list of schools and with predicted ranks between **P1** and **P2** both inclusive, the marks of the student with **K** th highest marks. (The first highest marks would the the maximum marks, and second would be the next and so on)
#### Input
First line contains a single integer **N**, the number of schools.
The next line contains **N** space separated integers **S $ _{i} $** .
The next **N** lines, the **i** th line contains **S $ _{i} $** space separated integers, **j** th of which is denoting **P $ _{ij} $** .
The next **N** lines, the **i** th line contains **S $ _{i} $** space separated integers, **j** th of which is denoting **M $ _{ij} $** .
The next line contains a single integer **Q**, denoting the number of queries.
Whats follows are **Q** sets of queries. Each query is structured as follows.
First line of the query is **L**, the list of schools.
Followed by **L** integers denoting the **1 based** indices of schools.
Next are **P1** and **P2**, the range of ranks we are interested in.
Next is the integer **K**.
#### Output
For each query on a separate line print a single integer answering the query. If answer is not possible print -1
#### Constraints
1 N 1 S $ _{i} $ 1 P $ _{ij} $ S $ _{i} $
1 M $ _{ij} $ 1 Q **1 1**</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
