<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>RTREE3 - Roger and tree III - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450595:XsScvYhXx9qJk0uWeUmYl2Q8WLF/c0oWClwzJzUzZwM=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Roger%20was%20able%20to%20solve%20his%20problem%20based%20on%20tree%20last%20time%2C%20only%20because%20of%20your%20help.%20He%20has%20been%20doing%20good%20and%20is%20learning%20and%20practicing%20various%20problems%20on%20trees%20%28as%20he%20likes%20solving%20problems%20on%20connected%20undirected%20acyclic%20graphs%29.%20This%20time%20he%20is%20stuck%20with%20a%20harder%20problem%20and%20has%20spent%20almost%20a%20week%20trying%20to%20solve%20this%20problem%2C%20with%20no%20efficient%20solution%20till%20now.%20But%2C%20he%20has%20you%20as%20his%20friend%20and%20he%20knows%20that%20only%20you%20can%20help%20him%20with%20your%20excellent%20programming%20skills.%5Cn%5CnYou%20will%20be%20given%20an%20input%20in%20the%20form%20of%20a%20growing%20tree.%20ie%3B%20Initially%20you%20have%20a%20tree%20consisting%20only%20of%20vertex%20%2A%2A1%2A%2A.%20At%20each%20step%2C%20the%20tree%20will%20grow.%20So%20next%2C%20vertex%20%2A%2Au%2A%2A%20will%20be%20connected%20to%20vertex%20%2A%2A1%2A%2A%2C%20then%20vertex%20%2A%2Av%2A%2A%20will%20be%20connected%20to%20either%20vertex%20%2A%2A1%2A%2A%20or%20vertex%20%2A%2Au%2A%2A%2C%20and%20so%20on%20till%20you%20get%20a%20tree%20consisting%20of%20%2A%2A%27N%27%2A%2A%20vertex.%20However%2C%20at%20any%20instant%2C%20while%20adding%20the%20vertexes%20you%20will%20be%20given%20a%20vertex%20%2A%2A%27x%27%2A%2A%20%28which%20is%20already%20present%20in%20the%20tree%20grown%20so%20far%29%2C%20and%20you%20will%20be%20asked%20to%20print%20the%20eccentricity%20of%20the%20given%20vertex%20%2A%2Ax.%2A%2A%5Cn%5CnLet%20%2A%2AG%2A%2A%20be%20a%20graph%20and%20%2A%2A%27x%27%2A%2A%20be%20a%20vertex%20of%20G.%5Cn%5CnThe%20eccentricity%20of%20the%20vertex%20%2A%2A%27x%27%2A%2A%20is%20the%20maximum%20distance%20from%20%27x%27%20to%20any%20vertex%20present%20in%20G.%5Cn%5CnThat%20is%2C%20%2A%2Ae%20%28x%29%20%3D%20max%20%7Bd%20%28x%2C%20y%29%20%3A%20y%20is%20in%20G%7D.%2A%2A%5Cn%5CnOf%20Course%20vertex%20%2A%2Ay%2A%2A%2C%20should%20also%20be%20present%20in%20the%20tree%2C%20grown%20so%20far.%5Cn%5CnAlong%20with%20the%20eccentricity%2C%20you%20should%20also%20print%20the%20vertex%20%2A%2A%27y%27%2A%2A.%5Cn%5CnPlease%20help%20Roger.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20%2A%2A%27N%27%2A%2A%20and%20%2A%2A%27M%27%2A%2A%2C%20where%20N%20%3D%20Number%20of%20nodes%20in%20the%20tree%20and%20M%20%3D%20Number%20of%20Queries.%5Cn%5CnNext%20M%20lines%20will%20either%20have%20an%20input%20of%20the%20type%20%2A%2A%5C%22U%20x%20y%5C%22%2A%2A%20or%20%2A%2A%5C%22Q%20x%5C%22.%2A%2A%5Cn%5CnFor%20the%20input%20of%20type%20%2A%2A%5C%22U%20x%20y%5C%22%2A%2A%2C%20you%20have%20to%20connect%20the%20vertex%20%2A%2A%27y%27%2A%2A%20to%20the%20vertex%20%2A%2A%27x%27%2A%2A%2C%20where%20vertex%20%2A%2A%27x%27%2A%2A%20is%20already%20present%20in%20the%20tree%20and%20vertex%20%2A%2A%27y%27%2A%2A%20is%20the%20new%20vertex.%20Obviously%2C%20there%20will%20be%20%2A%2A%28N%20-%201%29%2A%2A%20inputs%20of%20the%20type%20%2A%2A%5C%22U%20x%20y%5C%22%2A%2A.%22%2C%22outputFormat%22%3A%22For%20each%20input%20of%20the%20type%20%2A%2A%5C%22Q%20x%5C%22%2A%2A%2C%20you%20have%20to%20print%20the%20eccentricity%20of%20vertex%20%2A%2A%27x%27%2A%2A%2C%20followed%20by%20the%20vertex%20%2A%2A%27y%27%2A%2A.%5Cn%5CnIf%20there%20are%20multiple%20such%20%2A%2A%27y%27%2A%2A.%20Print%20the%20%2A%2Asmallest%20%27y%27%2A%2A.%22%2C%22samples%22%3A%5B%5B%225%208%5Cr%5CnQ%201%5Cr%5CnU%201%204%5Cr%5CnQ%201%5Cr%5CnU%204%202%5Cr%5CnU%201%205%5Cr%5CnU%205%203%5Cr%5CnQ%201%5Cr%5CnQ%202%22%2C%220%201%5Cr%5Cn1%204%5Cr%5Cn2%202%5Cr%5Cn4%203%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F22561%22%2C%22id%22%3A%2222561%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP22561%22%2C%22title%22%3A%22RTREE3%20-%20Roger%20and%20tree%20III%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22RTREE3%20-%20Roger%20and%20tree%20III%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>RTREE3 - Roger and tree III</h1>
<h2>题目描述</h2>
<div>Roger was able to solve his problem based on tree last time, only because of your help. He has been doing good and is learning and practicing various problems on trees (as he likes solving problems on connected undirected acyclic graphs). This time he is stuck with a harder problem and has spent almost a week trying to solve this problem, with no efficient solution till now. But, he has you as his friend and he knows that only you can help him with your excellent programming skills.
You will be given an input in the form of a growing tree. ie; Initially you have a tree consisting only of vertex **1**. At each step, the tree will grow. So next, vertex **u** will be connected to vertex **1**, then vertex **v** will be connected to either vertex **1** or vertex **u**, and so on till you get a tree consisting of **'N'** vertex. However, at any instant, while adding the vertexes you will be given a vertex **'x'** (which is already present in the tree grown so far), and you will be asked to print the eccentricity of the given vertex **x.**
Let **G** be a graph and **'x'** be a vertex of G.
The eccentricity of the vertex **'x'** is the maximum distance from 'x' to any vertex present in G.
That is, **e (x) = max {d (x, y) : y is in G}.**
Of Course vertex **y**, should also be present in the tree, grown so far.
Along with the eccentricity, you should also print the vertex **'y'**.
Please help Roger.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains **'N'** and **'M'**, where N = Number of nodes in the tree and M = Number of Queries.
Next M lines will either have an input of the type **"U x y"** or **"Q x".**
For the input of type **"U x y"**, you have to connect the vertex **'y'** to the vertex **'x'**, where vertex **'x'** is already present in the tree and vertex **'y'** is the new vertex. Obviously, there will be **(N - 1)** inputs of the type **"U x y"**.</div>
<h3>输出格式</h3>
<br />
<div>For each input of the type **"Q x"**, you have to print the eccentricity of vertex **'x'**, followed by the vertex **'y'**.
If there are multiple such **'y'**. Print the **smallest 'y'**.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 8
Q 1
U 1 4
Q 1
U 4 2
U 1 5
U 5 3
Q 1
Q 2</code></pre>
<h3>输出样例 #1</h3>
<pre><code>0 1
1 4
2 2
4 3</code></pre>
</article>
</div>
</div>
</body>
</html>
