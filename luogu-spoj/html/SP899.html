<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>WSCIPHER - Ws Cipher - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449622:gu7MAJAH/2iKIIHcQug5j13aJNRZQs2rI67ufHnaeSo=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%20Weird%20Wally%27s%20Wireless%20Widgets%2C%20Inc.%20manufactures%20an%20eclectic%20assortment%20of%20small%2C%20wireless%2C%20network%20capable%20devices%2C%20ranging%20from%20dog%20collars%2C%20to%20pencils%2C%20to%20fishing%20bobbers.%20All%20these%20devices%20have%20very%20small%20memories.%20Encryption%20algorithms%20like%20Rijndael%2C%20the%20candidate%20for%20the%20Advanced%20Encryption%20Standard%20%28AES%29%20are%20demonstrably%20secure%20but%20they%20don%27t%20fit%20in%20such%20a%20tiny%20memory.%20In%20order%20to%20provide%20some%20security%20for%20transmissions%20to%20and%20from%20the%20devices%2C%20WWWW%20uses%20the%20following%20algorithm%2C%20which%20you%20are%20to%20implement.%5Cn%5Cn%20Encrypting%20a%20message%20requires%20three%20integer%20keys%2C%20_k%20%24%20_%7B1%7D%20%24_%20%2C%20_k%20%24%20_%7B2%7D%20%24_%20%2C%20and%20_k%20%24%20_%7B3%7D%20%24_%20.%20The%20letters%20%5C%5C%5Ba-i%5C%5C%5D%20form%20one%20group%2C%20%5C%5C%5Bj-r%5C%5C%5D%20a%20second%20group%2C%20and%20everything%20else%20%28%5C%5C%5Bs-z%5C%5C%5D%20and%20underscore%29%20the%20third%20group.%20Within%20each%20group%20the%20letters%20are%20rotated%20_left_%20by%20_k%20%24%20_%7Bi%7D%20%24_%20%20positions%20in%20the%20message.%20Each%20group%20is%20rotated%20independently%20of%20the%20other%20two.%20Decrypting%20the%20message%20means%20doing%20a%20_right_%20rotation%20by%20_k%20%24%20_%7Bi%7D%20%24_%20%20positions%20within%20each%20group.%5Cn%5Cn%20Consider%20the%20message%20the%5C%5C_quick%5C%5C_brown%5C%5C_fox%20encrypted%20with%20_k%20%24%20_%7Bi%7D%20%24_%20%20values%20of%202%2C%203%20and%201.%20The%20encrypted%20string%20is%20%5C%5C_icuo%5C%5C_bfnwhoq%5C%5C_kxert.%20The%20figure%20below%20shows%20the%20decrypting%20right%20rotations%20for%20one%20character%20in%20each%20of%20the%20three%20character%20groups.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP899%5C%2F8583cdcb46a9a46aecaf4d014176faac07da36c3.png%29%20Looking%20at%20all%20the%20letters%20in%20the%20group%20%5C%5C%5Ba-i%5C%5C%5D%20we%20see%20%7Bi%2Cc%2Cb%2Cf%2Ch%2Ce%7D%20appear%20at%20positions%20%7B2%2C3%2C7%2C8%2C11%2C17%7D%20within%20the%20encrypted%20message.%20After%20a%20right%20rotation%20of%20_k%20%24%20_%7B1%7D%20%24_%20%3D2%2C%20these%20positions%20contain%20the%20letters%20%7Bh%2Ce%2Ci%2Cc%2Cb%2Cf%7D.%20The%20table%20below%20shows%20the%20intermediate%20strings%20that%20come%20from%20doing%20all%20the%20rotations%20in%20the%20first%20group%2C%20then%20all%20rotations%20in%20the%20second%20group%2C%20then%20all%20the%20rotations%20in%20the%20third%20group.%20Rotating%20letters%20in%20one%20group%20will%20not%20change%20any%20letters%20in%20any%20of%20the%20other%20groups.%5Cn%5Cn%20%20%5C%5C%5Ba-i%5C%5C%5D%2C%20_k%20%24%20_%7B1%7D%20%24_%20%3D%202%20%5C%5C%5Bj-r%5C%5C%5D%2C%20_k%20%24%20_%7B2%7D%20%24_%20%3D%203%20%5C%5C%5Bs-z%5C%5C%5D%20and%20%5C%5C_%2C%20_k%20%24%20_%7B3%7D%20%24_%20%3D%201%20Encrypted%3A%20%5C%5C_icuo%5C%5C_bfnwhoq%5C%5C_kxert%20%5C%5C_heuo%5C%5C_icnwboq%5C%5C_kxfrt%20%5C%5C_heuq%5C%5C_ickwbro%5C%5C_nxfot%20Decrypted%3A%20%5C%5C_heuo%5C%5C_icnwboq%5C%5C_kxfrt%20%5C%5C_heuq%5C%5C_ickwbro%5C%5C_nxfot%20the%5C%5C_quick%5C%5C_brown%5C%5C_fox%20Changes%3A%20%60%20%5E%5E%20%20%20%5E%5E%20%20%5E%20%20%20%20%20%5E%20%20%60%20%60%20%20%20%20%5E%20%20%20%5E%20%20%5E%5E%20%5E%20%20%5E%20%20%60%20%60%5E%20%20%5E%20%5E%20%20%20%5E%20%20%20%5E%20%5E%20%20%5E%20%20%60%20All%20input%20strings%20contain%20only%20lowercase%20letters%20and%20underscores%28%5C%5C_%29.%20Each%20string%20will%20be%20at%20most%2080%20characters%20long.%20The%20_k%20%24%20_%7Bi%7D%20%24_%20%20are%20all%20positive%20integers%20in%20the%20range%201-100.%5Cn%5Cn%20Input%20consists%20of%20information%20for%20one%20or%20more%20encrypted%20messages.%20Each%20problem%20begins%20with%20one%20line%20containing%20_k%20%24%20_%7B1%7D%20%24_%20%2C%20_k%20%24%20_%7B2%7D%20%24_%20%2C%20and%20_k%20%24%20_%7B3%7D%20%24_%20%20followed%20by%20a%20line%20containing%20the%20encrypted%20message.%20The%20end%20of%20the%20input%20is%20signalled%20by%20a%20line%20with%20all%20key%20values%20of%200.%5Cn%5CnFor%20each%20encrypted%20message%2C%20the%20output%20is%20a%20single%20line%20containing%20the%20decrypted%20string.%5Cn%5Cn%20%60%60%60%5Cn%5CnInput%3A%5Cn2%203%201%5Cn_icuo_bfnwhoq_kxert%5Cn1%201%201%5Cnbcalmkyzx%5Cn3%207%204%5Cnwcb_mxfep_dorul_eov_qtkrhe_ozany_dgtoh_u_eji%5Cn2%204%203%5Cncjvdksaltbmu%5Cn0%200%200%5Cn%60%60%60%5Cn%20%60%60%60%5Cn%5CnOutput%3A%5Cnthe_quick_brown_fox%5Cnabcklmxyz%5Cnthe_quick_brown_fox_jumped_over_the_lazy_dog%5Cnajsbktcludmv%5Cn%60%60%60%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B194%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F899%22%2C%22id%22%3A%22899%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP899%22%2C%22title%22%3A%22WSCIPHER%20-%20Ws%20Cipher%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22WSCIPHER%20-%20Ws%20Cipher%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>WSCIPHER - Ws Cipher</h1>
<h2>题目描述</h2>
<div> Weird Wally's Wireless Widgets, Inc. manufactures an eclectic assortment of small, wireless, network capable devices, ranging from dog collars, to pencils, to fishing bobbers. All these devices have very small memories. Encryption algorithms like Rijndael, the candidate for the Advanced Encryption Standard (AES) are demonstrably secure but they don't fit in such a tiny memory. In order to provide some security for transmissions to and from the devices, WWWW uses the following algorithm, which you are to implement.
Encrypting a message requires three integer keys, _k $ _{1} $_ , _k $ _{2} $_ , and _k $ _{3} $_ . The letters \[a-i\] form one group, \[j-r\] a second group, and everything else (\[s-z\] and underscore) the third group. Within each group the letters are rotated _left_ by _k $ _{i} $_ positions in the message. Each group is rotated independently of the other two. Decrypting the message means doing a _right_ rotation by _k $ _{i} $_ positions within each group.
Consider the message the\_quick\_brown\_fox encrypted with _k $ _{i} $_ values of 2, 3 and 1. The encrypted string is \_icuo\_bfnwhoq\_kxert. The figure below shows the decrypting right rotations for one character in each of the three character groups.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/SP899/8583cdcb46a9a46aecaf4d014176faac07da36c3.png) Looking at all the letters in the group \[a-i\] we see {i,c,b,f,h,e} appear at positions {2,3,7,8,11,17} within the encrypted message. After a right rotation of _k $ _{1} $_ =2, these positions contain the letters {h,e,i,c,b,f}. The table below shows the intermediate strings that come from doing all the rotations in the first group, then all rotations in the second group, then all the rotations in the third group. Rotating letters in one group will not change any letters in any of the other groups.
\[a-i\], _k $ _{1} $_ = 2 \[j-r\], _k $ _{2} $_ = 3 \[s-z\] and \_, _k $ _{3} $_ = 1 Encrypted: \_icuo\_bfnwhoq\_kxert \_heuo\_icnwboq\_kxfrt \_heuq\_ickwbro\_nxfot Decrypted: \_heuo\_icnwboq\_kxfrt \_heuq\_ickwbro\_nxfot the\_quick\_brown\_fox Changes: ` ^^ ^^ ^ ^ ` ` ^ ^ ^^ ^ ^ ` `^ ^ ^ ^ ^ ^ ^ ` All input strings contain only lowercase letters and underscores(\_). Each string will be at most 80 characters long. The _k $ _{i} $_ are all positive integers in the range 1-100.
Input consists of information for one or more encrypted messages. Each problem begins with one line containing _k $ _{1} $_ , _k $ _{2} $_ , and _k $ _{3} $_ followed by a line containing the encrypted message. The end of the input is signalled by a line with all key values of 0.
For each encrypted message, the output is a single line containing the decrypted string.
```
Input:
2 3 1
_icuo_bfnwhoq_kxert
1 1 1
bcalmkyzx
3 7 4
wcb_mxfep_dorul_eov_qtkrhe_ozany_dgtoh_u_eji
2 4 3
cjvdksaltbmu
0 0 0
```
```
Output:
the_quick_brown_fox
abcklmxyz
the_quick_brown_fox_jumped_over_the_lazy_dog
ajsbktcludmv
```</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
