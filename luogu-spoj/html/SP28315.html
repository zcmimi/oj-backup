<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>WEAKSMK - Shoumiks Weakness - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450680:JdjuU637ta1Ff7+Zex4NQ1B7NmA8BZFXzSXoaPdlzcM=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Shoumik%20loves%20problem%20solving%20but%20he%20is%20weak%20in%20string%20related%20problems.%5Cn%5CnSo%20he%20is%20practicing%20string%20related%20problems.%20But%20he%20thought%20that%20creating%5Cn%5Cna%20string%20related%20problem%20and%20solving%20that%20would%20be%20a%20great%20idea%20to%20be%5Cn%5Cnstrong%20in%20strings.%20So%20he%20thought%20of%20a%20problem.%5Cn%5CnGiven%20a%20string%20S%20of%20N%20lower%20case%20alphabets%20how%20many%20distinct%20substrings%20T%5Cn%5Cnare%20there%20with%20length%20L%28%20L%3D%7CT%7C%20%29%20and%20S%20contains%20exactly%20X%20occurrences%20of%20T.%5Cn%5CnIn%20the%20string%20S%3D%5Cu201cabcbcb%5Cu201d%20the%20substring%20T%3D%5Cu201cbcb%5Cu201d%20has%20length%20L%3D3%20and%20S%5Cn%5Cnhas%20X%3D2%20occurrences%20of%20T.%28See%20hints%20for%20more%20clarification%29%5Cn%5CnBut%20as%20Shoumik%20is%20weak%20in%20string%2C%20he%20is%20stuck%20with%20this%20problem.%20You%20have%5Cn%5Cnto%20help%20him%20answering%20Q%20queries%20for%20a%20given%20string%20S.%5Cn%5Cn%23%23%23%20Input%5Cn%5CnFirst%20line%20of%20input%20will%20contain%20the%20number%20of%20test%20cases%20Ts.%5Cn%5CnThen%20Ts%20test%20cases%20follows.%20Every%20test%20case%20contains%20two%20integers%5Cn%5CnN%20and%20Q%20in%20the%20first%20line.%20Next%20line%20will%20contain%20a%20string%20S%2C%20consisting%20of%5Cn%5CnN%20lower%20casecharacters.%20The%20next%20Q%20lines%20will%20contain%20Q%20queries%20with%5Cn%5Cntwo%20integers%20L%2Clength%20of%20T%20for%20this%20query%20and%20X%2C%20Occurrences%20of%20T%20in%20S.%5Cn%5Cn1%3C%3DTs%3C%3D15%5Cn%5Cn1%3C%3DN%3C%3D10000%5Cn%5Cn1%3C%3DQ%3C%3D100000%5Cn%5Cn1%3C%3DL%3C2%5E31%5Cn%5Cn0%3C%3DX%3C2%5E31%5Cn%5CnSum%20of%20N%20over%20all%20test%20cases%20%3C%3D60000%20%286%5C%5C%2A10%5E4%29%20%20%5CnNumber%20of%20queries%20Q%20over%20all%20test%20cases%20%3C%3D%20600000%20%286%5C%5C%2A10%5E5%29%5Cn%5Cn%23%23%23%20Output%5Cn%5CnFor%20every%20query%20print%20the%20number%20of%20distinct%20substrings%20T%20in%20the%20string%20S%5Cn%5Cnwhich%20are%20of%20length%20L%20and%20have%20exactly%20X%20occurrences%20in%20S.%5Cn%5Cn%23%23%23%20Example%5Cn%5Cn%20%60%3Cpre%20style%3D%5C%22text-align%3A%20left%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E%3Cstrong%3EInput%3A%3C%5C%2Fstrong%3E%3C%5C%2Fspan%3E%60%20%60%60%60%5Cn%3Cpre%20style%3D%5C%22text-align%3A%20left%3B%5C%22%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E1%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E%3Cbr%3E%3C%5C%2Fbr%3E%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E6%205%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E%3Cbr%3E%3C%5C%2Fbr%3E%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3Eabcbcb%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E%3Cbr%3E%3C%5C%2Fbr%3E%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E3%202%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E%3Cbr%3E%3C%5C%2Fbr%3E%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E4%201%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E%3Cbr%3E%3C%5C%2Fbr%3E%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E6%202%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E%3Cbr%3E%3C%5C%2Fbr%3E%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E6%201%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E%3Cbr%3E%3C%5C%2Fbr%3E%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E1%202%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E%5Cn%3Cstrong%3EOutput%3A%3C%5C%2Fstrong%3E%5Cn%3C%5C%2Fspan%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E1%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E%3Cbr%3E%3C%5C%2Fbr%3E%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E3%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E%3Cbr%3E%3C%5C%2Fbr%3E%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E0%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E%3Cbr%3E%3C%5C%2Fbr%3E%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E1%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E%3Cbr%3E%3C%5C%2Fbr%3E%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%3Cspan%20style%3D%5C%22font-size%3A%20large%3B%5C%22%3E1%3C%5C%2Fspan%3E%3C%5C%2Fp%3E%3Cp%20style%3D%5C%22margin-bottom%3A%200in%3B%20line-height%3A%20100%25%3B%5C%22%3E%5Cu00a0%3C%5C%2Fp%3E%5Cn%60%60%60%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F28315%22%2C%22id%22%3A%2228315%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP28315%22%2C%22title%22%3A%22WEAKSMK%20-%20Shoumiks%20Weakness%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22WEAKSMK%20-%20Shoumiks%20Weakness%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>WEAKSMK - Shoumiks Weakness</h1>
<h2>题目描述</h2>
<div>Shoumik loves problem solving but he is weak in string related problems.
So he is practicing string related problems. But he thought that creating
a string related problem and solving that would be a great idea to be
strong in strings. So he thought of a problem.
Given a string S of N lower case alphabets how many distinct substrings T
are there with length L( L=|T| ) and S contains exactly X occurrences of T.
In the string S=“abcbcb” the substring T=“bcb” has length L=3 and S
has X=2 occurrences of T.(See hints for more clarification)
But as Shoumik is weak in string, he is stuck with this problem. You have
to help him answering Q queries for a given string S.
### Input
First line of input will contain the number of test cases Ts.
Then Ts test cases follows. Every test case contains two integers
N and Q in the first line. Next line will contain a string S, consisting of
N lower casecharacters. The next Q lines will contain Q queries with
two integers L,length of T for this query and X, Occurrences of T in S.
1<=Ts<=15
1<=N<=10000
1<=Q<=100000
1<=L<2^31
0<=X<2^31
Sum of N over all test cases <=60000 (6\*10^4)
Number of queries Q over all test cases <= 600000 (6\*10^5)
### Output
For every query print the number of distinct substrings T in the string S
which are of length L and have exactly X occurrences in S.
### Example
`<pre style="text-align: left;"><span style="font-size: large;"><strong>Input:</strong></span>` ```
<pre style="text-align: left;"><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;">1</span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;"><br></br></span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;">6 5</span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;"><br></br></span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;">abcbcb</span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;"><br></br></span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;">3 2</span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;"><br></br></span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;">4 1</span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;"><br></br></span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;">6 2</span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;"><br></br></span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;">6 1</span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;"><br></br></span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;">1 2</span></p><span style="font-size: large;">
<strong>Output:</strong>
</span><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;">1</span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;"><br></br></span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;">3</span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;"><br></br></span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;">0</span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;"><br></br></span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;">1</span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;"><br></br></span></p><p style="margin-bottom: 0in; line-height: 100%;"><span style="font-size: large;">1</span></p><p style="margin-bottom: 0in; line-height: 100%;"> </p>
```</div>

    <h2>输入输出格式</h2>
    <h3>输入格式</h3>
    <br />
    <div></div>
    <h3>输出格式</h3>
    <br />
    <div></div>

    <h2>输入输出样例</h2>
            <i>暂无测试点</i>
    
    </article>
    </div>
</div>
<!-- <script src="//www.recaptcha.net/recaptcha/api.js?hl=zh-CN&render=explicit&onload=renderCaptcha" async defer></script> -->
</body>
</html>
