<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>MMAHWIRE - Manhattan Wire - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449835:UUJk+ffzeavSvSzyhMtu8O9uwnhC1HNw9WVrr0SqpkY=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%5BEnglish%5D%28%5C%2Fproblems%5C%2FMTEMP%5C%2Fen%5C%2F%29%20%5BVietnamese%5D%28%5C%2Fproblems%5C%2FMTEMP%5C%2Fvn%5C%2F%29%20%60%60%60%5Cn%5CnThere%20is%20a%20rectangular%20area%20containing%20n%20%5Cu00d7%20m%20cells.%20Two%20cells%20are%20marked%5Cnwith%20%5Cu201c2%5Cu201d%2C%20and%20another%20two%20with%20%5Cu201c3%5Cu201d.%20Some%20cells%20are%20occupied%20by%20obstacles.%20%5CnYou%20should%20connect%20the%20two%20%5Cu201c2%5Cu201ds%20and%20also%20the%20two%20%5Cu201c3%5Cu201ds%20with%20non-intersecting%5Cnlines.%20Lines%20can%20run%20only%20vertically%20or%20horizontally%20connecting%20centers%5Cnof%20cells%20without%20obstacles.%5Cn%5CnLines%20cannot%20run%20on%20a%20cell%20with%20an%20obstacle.%20Only%20one%20line%20can%20run%20on%5Cna%20cell%20at%20most%20once.%20Hence%2C%20a%20line%20cannot%20intersect%20with%20the%20other%20line%2C%20%5Cnnor%20with%20itself.%20Under%20these%20constraints%2C%20the%20total%20length%20of%20the%20two%5Cnlines%20should%20be%20minimized.%20The%20length%20of%20a%20line%20is%20defined%20as%20the%5Cnnumber%20of%20cell%20borders%20it%20passes.%20In%20particular%2C%20a%20line%20connecting%20cells%5Cnsharing%20their%20border%20has%20length%201.%5Cn%5CnFig.%201%28a%29%20shows%20an%20example%20setting.%20Fig.%201%28b%29%20shows%20two%20lines%20satisfying%20the%5Cnconstraints%20above%20with%20minimum%20total%20length%2018.%5Cn%5Cn%5Cn%5CnFigure%201%3A%20An%20example%20of%20setting%20and%20its%20solution%5Cn%60%60%60%22%2C%22inputFormat%22%3A%22%60%60%60%5Cn%5CnThe%20input%20consists%20of%20multiple%20datasets%2C%20each%20in%20the%20following%20format.%5Cn%5Cn%20%20%20%20n%5Ctm%5Cn%20%20%20%20row1%5Cn%20%20%20%20%5Cu2026%5Cn%20%20%20%20rown%5Cn%5Cnn%20is%20the%20number%20of%20rows%20which%20satisfies%202%20%5Cu2264%20n%20%5Cu2264%209.%20m%20is%20the%20number%20of%20columns%5Cnwhich%20satisfies%202%20%5Cu2264%20m%20%5Cu2264%209.%20Each%20rowi%20is%20a%20sequence%20of%20m%20digits%20separated%20by%5Cna%20space.%20The%20digits%20mean%20the%20following.%5Cn%5Cn%20%20%20%200%3A%20Empty%5Cn%5Cn%20%20%20%201%3A%20Occupied%20by%20an%20obstacle%5Cn%5Cn%20%20%20%202%3A%20Marked%20with%20%5Cu201c2%5Cu201d%5Cn%5Cn%20%20%20%203%3A%20Marked%20with%20%5Cu201c3%5Cu201d%5Cn%5CnThe%20end%20of%20the%20input%20is%20indicated%20with%20a%20line%20containing%20two%20zeros%20separated%5Cnby%20a%20space.%5Cn%5CnSAMPLE%20INPUT%5Cn5%205%5Cn0%200%200%200%200%5Cn0%200%200%203%200%5Cn2%200%202%200%200%5Cn1%200%201%201%201%5Cn0%200%200%200%203%5Cn2%203%5Cn2%202%200%5Cn0%203%203%5Cn6%205%5Cn2%200%200%200%200%5Cn0%203%200%200%200%5Cn0%200%200%200%200%5Cn1%201%201%200%200%5Cn0%200%200%200%200%5Cn0%200%202%203%200%5Cn0%200%5Cn%60%60%60%22%2C%22outputFormat%22%3A%22%60%60%60%5Cn%5CnFor%20each%20dataset%2C%20one%20line%20containing%20the%20minimum%20total%20length%20of%20the%20two%5Cnlines%20should%20be%20output.%20If%20there%20is%20no%20pair%20of%20lines%20satisfying%20the%20requirement%2C%5Cnanswer%20%5Cu201c0%5Cu201d%20instead.%20%20%5Cn%5CnSample%20Output%5Cn%5Cn18%5Cn2%5Cn17%5Cn%60%60%60%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B435%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F3926%22%2C%22id%22%3A%223926%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A1%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22SP3926%22%2C%22title%22%3A%22MMAHWIRE%20-%20Manhattan%20Wire%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22MMAHWIRE%20-%20Manhattan%20Wire%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>MMAHWIRE - Manhattan Wire</h1>
<h2>题目描述</h2>
<div>[English](/problems/MTEMP/en/) [Vietnamese](/problems/MTEMP/vn/) ```
There is a rectangular area containing n × m cells. Two cells are marked
with “2”, and another two with “3”. Some cells are occupied by obstacles.
You should connect the two “2”s and also the two “3”s with non-intersecting
lines. Lines can run only vertically or horizontally connecting centers
of cells without obstacles.
Lines cannot run on a cell with an obstacle. Only one line can run on
a cell at most once. Hence, a line cannot intersect with the other line,
nor with itself. Under these constraints, the total length of the two
lines should be minimized. The length of a line is defined as the
number of cell borders it passes. In particular, a line connecting cells
sharing their border has length 1.
Fig. 1(a) shows an example setting. Fig. 1(b) shows two lines satisfying the
constraints above with minimum total length 18.
Figure 1: An example of setting and its solution
```</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>```
The input consists of multiple datasets, each in the following format.
n m
row1
…
rown
n is the number of rows which satisfies 2 ≤ n ≤ 9. m is the number of columns
which satisfies 2 ≤ m ≤ 9. Each rowi is a sequence of m digits separated by
a space. The digits mean the following.
0: Empty
1: Occupied by an obstacle
2: Marked with “2”
3: Marked with “3”
The end of the input is indicated with a line containing two zeros separated
by a space.
SAMPLE INPUT
5 5
0 0 0 0 0
0 0 0 3 0
2 0 2 0 0
1 0 1 1 1
0 0 0 0 3
2 3
2 2 0
0 3 3
6 5
2 0 0 0 0
0 3 0 0 0
0 0 0 0 0
1 1 1 0 0
0 0 0 0 0
0 0 2 3 0
0 0
```</div>
<h3>输出格式</h3>
<br />
<div>```
For each dataset, one line containing the minimum total length of the two
lines should be output. If there is no pair of lines satisfying the requirement,
answer “0” instead.
Sample Output
18
2
17
```</div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
