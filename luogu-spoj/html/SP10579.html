<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>DESRUG - Desrugenstein - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450231:8J2cEuphlRXS+kza8yRADVuGU6H6KRXCJdpWrpB0A4Y=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20city%20of%20Desrugenstein%20is%20a%20complete%20mess.%20Looking%20at%20the%20map%2C%20it%20seems%20organized%2C%20since%20it%20%20%5Cnwas%20created%20in%20a%20square%20grid%20form%2C%20but%20there%20is%20no%20directions%20standard.%20Each%20corner%20says%20the%20directions%20%20%5Cnyou%20can%20go%20from%20there%20%28north%2C%20south%2C%20west%2C%20east%29.%20The%20mayor%20Daniel%20Snake%20is%20headstrong%20and%20lazy%20%20%5Cnenough%20to%20let%20everything%20as%20it%20is%20and%20forbid%20any%20change%20attempt.%20Unable%20to%20do%20much%2C%20the%20Master%20%20%5CnSpiritual%20Counselor%20of%20Desrugenstein%2C%20Giordano%20Marfyn%2C%20asked%20you%2C%20Spiritual%20Counselor%20Level%20XVII%20of%20%20%5CnDesrugenstein%2C%20lead%20programmer%20of%20Desrugenstein%2C%20to%20write%20a%20program%20to%20calculate%20the%20cost%20of%20going%20%20%5Cnfrom%20a%20corner%20%28x%2C%20y%29%20to%20another%20corner%20%28z%2C%20w%29%2C%20considering%20the%20messy%20streets.%22%2C%22inputFormat%22%3A%22Input%20file%20contains%20several%20test%20cases.%20First%20line%20of%20each%20test%20case%20contains%20an%20integer%20N%20%281%20represents%20height%20and%20width%20of%20the%20grid%20that%20maps%20the%20city%20%28a%20N%20x%20N%20grid%29.%20The%20input%20file%20ends%20with%20N%20%3D%200%2C%20%20%5Cnand%20it%20should%20not%20be%20processed.%20Each%20one%20of%20the%20next%20N%20lines%20represents%20a%20street%20of%20the%20city%2C%20starting%20from%20%20%5Cnthe%20further%20north%20%28N%20%5Cu2013%201%29%20until%20the%20further%20south.%20In%20each%20one%20of%20these%20lines%20there%20are%204%5C%5C%2AN%20integers%2C%204%20for%20%20%5Cneach%20corner%3A%20A%20%28north%29%20B%20%28south%29%20C%20%28west%29%20D%20%28east%29.%20Each%20one%20is%200%20if%20it%20is%20not%20possible%20to%20go%20on%20the%20%20%5Cnrespective%20direction%2C%20or%201%20if%20it%20is%20possible.%20%20%5CnAfter%20the%20city%20map%2C%20your%20program%20should%20read%20an%20integer%20P%20%281%20each%2C%20x0%20y0%20x1%20y1%20representing%20the%20question%3A%20%5Cu201cWhat%20is%20the%20minimum%20cost%20to%20go%20from%20corner%20%28x%200%20%2C%20y0%29%20to%20%20%5Cncorner%20%28x1%20%2C%20y1%29%3F%5Cu201d.%20The%20cost%20to%20go%20from%20a%20corner%20to%20the%20nearest%20corner%20in%20any%20direction%20is%201.%22%2C%22outputFormat%22%3A%22For%20each%20question%2C%20answer%20%5Cu201cImpossible%5Cu201d%20if%20there%20is%20no%20valid%20%28respecting%20corners%20directions%29%20path%20between%20%20%5Cnthe%20corners%2C%20or%20the%20minimum%20cost%2C%20if%20there%20is%28are%29%20path%28s%29.%20Print%20a%20blank%20line%20after%20each%20test%20case.%22%2C%22samples%22%3A%5B%5B%224%5C%5Cn0%201%200%201%200%200%201%200%200%200%200%201%200%201%200%200%5C%5Cn0%200%200%200%201%200%200%201%200%200%200%201%200%201%200%200%5C%5Cn1%200%200%200%201%200%201%200%201%201%200%200%200%201%201%200%5C%5Cn0%200%200%200%200%200%201%200%200%200%201%200%200%200%200%200%5C%5Cn5%5C%5Cn1%203%200%203%5C%5Cn2%203%203%200%5C%5Cn2%203%200%200%5C%5Cn3%201%203%202%5C%5Cn0%203%200%200%5C%5Cn0%22%2C%221%5C%5Cn4%5C%5Cn7%5C%5Cn3%5C%5CnImpossible%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B153%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F10579%22%2C%22id%22%3A%2210579%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP10579%22%2C%22title%22%3A%22DESRUG%20-%20Desrugenstein%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22DESRUG%20-%20Desrugenstein%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>DESRUG - Desrugenstein</h1>
<h2>题目描述</h2>
<div>The city of Desrugenstein is a complete mess. Looking at the map, it seems organized, since it
was created in a square grid form, but there is no directions standard. Each corner says the directions
you can go from there (north, south, west, east). The mayor Daniel Snake is headstrong and lazy
enough to let everything as it is and forbid any change attempt. Unable to do much, the Master
Spiritual Counselor of Desrugenstein, Giordano Marfyn, asked you, Spiritual Counselor Level XVII of
Desrugenstein, lead programmer of Desrugenstein, to write a program to calculate the cost of going
from a corner (x, y) to another corner (z, w), considering the messy streets.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Input file contains several test cases. First line of each test case contains an integer N (1 represents height and width of the grid that maps the city (a N x N grid). The input file ends with N = 0,
and it should not be processed. Each one of the next N lines represents a street of the city, starting from
the further north (N – 1) until the further south. In each one of these lines there are 4\*N integers, 4 for
each corner: A (north) B (south) C (west) D (east). Each one is 0 if it is not possible to go on the
respective direction, or 1 if it is possible.
After the city map, your program should read an integer P (1 each, x0 y0 x1 y1 representing the question: “What is the minimum cost to go from corner (x 0 , y0) to
corner (x1 , y1)?”. The cost to go from a corner to the nearest corner in any direction is 1.</div>
<h3>输出格式</h3>
<br />
<div>For each question, answer “Impossible” if there is no valid (respecting corners directions) path between
the corners, or the minimum cost, if there is(are) path(s). Print a blank line after each test case.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4\n0 1 0 1 0 0 1 0 0 0 0 1 0 1 0 0\n0 0 0 0 1 0 0 1 0 0 0 1 0 1 0 0\n1 0 0 0 1 0 1 0 1 1 0 0 0 1 1 0\n0 0 0 0 0 0 1 0 0 0 1 0 0 0 0 0\n5\n1 3 0 3\n2 3 3 0\n2 3 0 0\n3 1 3 2\n0 3 0 0\n0</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1\n4\n7\n3\nImpossible</code></pre>
</article>
</div>
</div>
</body>
</html>
