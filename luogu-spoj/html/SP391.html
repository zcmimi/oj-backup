<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>RAILROAD - Railroads - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449587:JcFMDBxaeKc7N10+6Yo8hqjsNFe9mZVQh/GfJ5Em97w=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22It%27s%20Friday%20evening%20and%20Jill%20hates%20two%20things%20which%20are%20common%20to%20all%20trains%3A%5Cn%5Cn1.%20They%20are%20always%20late.%5Cn2.%20The%20schedule%20is%20always%20wrong.%5Cn%5Cn%20Nevertheless%2C%20tomorrow%20in%20the%20early%20morning%20hours%20Jill%20will%20have%20to%20travel%20from%20Hamburg%20to%20Darmstadt%20in%20order%20to%20get%20to%20the%20regional%20programming%20contest.%20Since%20she%20is%20afraid%20of%20arriving%20too%20late%20and%20being%20excluded%20from%20the%20contest%20she%20is%20looking%20for%20the%20train%20which%20gets%20her%20to%20Darmstadt%20as%20early%20as%20possible.%20However%2C%20she%20dislikes%20to%20get%20to%20the%20station%20too%20early%2C%20so%20if%20there%20are%20several%20schedules%20with%20the%20same%20arrival%20time%20then%20she%20will%20choose%20the%20one%20with%20the%20latest%20departure%20time.%5Cn%5Cn%20Jill%20asks%20you%20to%20help%20her%20with%20her%20problem.%20You%20are%20given%20a%20set%20of%20railroad%20schedules%20from%20which%20you%20must%20compute%20the%20train%20with%20the%20earliest%20arrival%20time%20and%20the%20fastest%20connection%20from%20one%20location%20to%20another.%20One%20good%20thing%3A%20Jill%20is%20very%20experienced%20in%20changing%20trains.%20She%20can%20do%20this%20instantaneously%2C%20i.e.%2C%20in%20zero%20time%21%21%21%22%2C%22inputFormat%22%3A%22The%20very%20first%20line%20of%20the%20input%20gives%20the%20number%20of%20scenarios.%20Each%20scenario%20consists%20of%20three%20parts.%5Cn%5Cn%20Part%20one%20lists%20the%20names%20of%20all%20cities%20connected%20by%20the%20railroads.%20It%20starts%20with%20a%20number%20_1%20%3C%20C%20%5Cu2264%20100_%2C%20followed%20by%20_C_%20lines%20containing%20city%20names.%20These%20names%20consist%20of%20letters.%5Cn%5Cn%20Part%20two%20describes%20all%20the%20trains%20running%20during%20a%20day.%20It%20starts%20with%20a%20number%20_T%20%5Cu2264%201000_%20followed%20by%20_T_%20train%20descriptions.%20Each%20of%20them%20consists%20of%20one%20line%20with%20a%20number%20_t%20%24%20_%7Bi%7D%20%24%20%5Cu2264%20100_%20and%20_t%20%24%20_%7Bi%7D%20%24_%20%20more%20lines%20with%20a%20time%20and%20a%20city%20name%2C%20meaning%20that%20passengers%20can%20get%20on%20or%20off%20the%20train%20at%20that%20time%20at%20that%20city.%5Cn%5Cn%20Part%20three%20consists%20of%20three%20lines%3A%20Line%20one%20contains%20the%20earliest%20journey%27s%20starting%20time%2C%20line%20two%20the%20name%20of%20the%20city%20where%20she%20starts%2C%20and%20line%20three%20the%20destination%20city.%20The%20two%20cities%20are%20always%20different.%22%2C%22outputFormat%22%3A%22For%20each%20scenario%20print%20a%20line%20containing%20%5C%22Scenario%20i%5C%22%2C%20where%20i%20is%20the%20number%20of%20the%20scenario%20starting%20at%201.%5Cn%5Cn%20If%20a%20connection%20exists%20then%20print%20the%20two%20lines%20containing%20zero%20padded%20timestamps%20and%20locations%20as%20shown%20in%20the%20sample.%20Use%20blanks%20to%20achieve%20the%20indentation.%20If%20no%20connection%20exists%20on%20the%20same%20day%20%28i.e.%2C%20arrival%20before%20midnight%29%20then%20print%20a%20line%20containing%20%5C%22No%20connection%5C%22.%5Cn%5Cn%20After%20each%20scenario%20print%20a%20blank%20line.%22%2C%22samples%22%3A%5B%5B%222%5Cn3%5CnHamburg%5CnFrankfurt%5CnDarmstadt%5Cn3%5Cn2%5Cn0949%20Hamburg%5Cn1006%20Frankfurt%5Cn2%5Cn1325%20Hamburg%5Cn1550%20Darmstadt%5Cn2%5Cn1205%20Frankfurt%5Cn1411%20Darmstadt%5Cn0800%5CnHamburg%5CnDarmstadt%5Cn2%5CnParis%5CnTokyo%5Cn1%5Cn2%5Cn0100%20Paris%5Cn2300%20Tokyo%5Cn0800%5CnParis%5CnTokyo%22%2C%22Scenario%201%5CnDeparture%200949%20Hamburg%5CnArrival%20%20%201411%20Darmstadt%5Cn%5CnScenario%202%5CnNo%20connection%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B523%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F391%22%2C%22id%22%3A%22391%22%7D%2C%22translation%22%3A%22Jill%5Cu4e0d%5Cu559c%5Cu6b22%5Cu706b%5Cu8f66%5Cu56e0%5Cu4e3a%5Cu706b%5Cu8f66%5Cu603b%5Cu662f%5Cu8bef%5Cu70b9%5Cuff0c%5Cu5bb9%5Cu6613%5Cu8fdf%5Cu5230%5Cu3002%5Cu4f46%5Cu662f%5Cu660e%5Cu5929%5Cu65e9%5Cu4e0aJill%5Cu8981%5Cu5750%5Cu706b%5Cu8f66%5Cu4eceHamburg%5Cu5230Darmstadt%5Cu53c2%5Cu52a0OI%5Cu6bd4%5Cu8d5b%5Cuff0c%5Cu56e0%5Cu4e3a%5Cu5979%5Cu662f%5Cu4e2a%5Cu597d%5Cu5b66%5Cu751f%5Cuff0c%5Cu4e0d%5Cu60f3%5Cu8fdf%5Cu5230%5Cuff0c%5Cu6240%5Cu4ee5%5Cu5979%5Cu4f1a%5Cu5750%5Cu6700%5Cu65e9%5Cu5230%5Cu8fbe%5Cu7ec8%5Cu70b9%5Cu7684%5Cu5217%5Cu8f66%5Cu3002%5Cu4e0d%5Cu8fc7%5Cu5979%5Cu4e0d%5Cu60f3%5Cu592a%5Cu65e9%5Cu5230%5Cu8f66%5Cu7ad9%5Cuff0c%5Cu6240%5Cu4ee5%5Cu5982%5Cu679c%5Cu6709%5Cu51e0%5Cu8f86%5Cu5217%5Cu8f66%5Cu7684%5Cu5230%5Cu8fbe%5Cu65f6%5Cu95f4%5Cu76f8%5Cu540c%5Cuff0c%5Cu5979%5Cu5c31%5Cu4f1a%5Cu9009%5Cu62e9%5Cu51fa%5Cu53d1%5Cu65f6%5Cu95f4%5Cu6700%5Cu665a%5Cu7684%5Cu8f66%5Cu3002%5Cu73b0%5Cu5728%5Cu4f60%5Cu7684%5Cu9053%5Cu4e86%5Cu4e00%5Cu4efd%5Cu94c1%5Cu8def%5Cu65f6%5Cu523b%5Cu8868%5Cuff0c%5Cu8bf7%5Cu4f60%5Cu627e%5Cu5230%5Cu5728%5Cu6ee1%5Cu8db3%5Cu6700%5Cu65e9%5Cu5230%5Cu8fbe%5Cu7684%5Cu524d%5Cu63d0%5Cu4e0b%5Cuff0c%5Cu5230%5Cu706b%5Cu8f66%5Cu7ad9%5Cu65f6%5Cu95f4%5Cu6700%5Cu665a%5Cu7684%5Cu8def%5Cu7ebf%5Cu3002%5Cu53e6%5Cu5916%5Cuff0cJill%5Cu5bf9%5Cu6362%5Cu8f66%5Cu975e%5Cu5e38%5Cu6709%5Cu7ecf%5Cu9a8c%5Cuff0c%5Cu5979%5Cu53ef%5Cu4ee5%5Cu5728%240%24%20%5Cu79d2%5Cu5185%5Cu6362%5Cu8f66%5Cuff01%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP391%22%2C%22title%22%3A%22RAILROAD%20-%20Railroads%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A33239%2C%22title%22%3A%2214%20%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A13143%2C%22name%22%3A%22SP391%20RAILROAD%20-%20Railroads%22%2C%22slug%22%3A%22SP391%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22RAILROAD%20-%20Railroads%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>RAILROAD - Railroads</h1>
<h2>题意翻译</h2>
<div>Jill不喜欢火车因为火车总是误点，容易迟到。但是明天早上Jill要坐火车从Hamburg到Darmstadt参加OI比赛，因为她是个好学生，不想迟到，所以她会坐最早到达终点的列车。不过她不想太早到车站，所以如果有几辆列车的到达时间相同，她就会选择出发时间最晚的车。现在你的道了一份铁路时刻表，请你找到在满足最早到达的前提下，到火车站时间最晚的路线。另外，Jill对换车非常有经验，她可以在$0$ 秒内换车！</div>
<h2>题目描述</h2>
<div>It's Friday evening and Jill hates two things which are common to all trains:
1. They are always late.
2. The schedule is always wrong.
Nevertheless, tomorrow in the early morning hours Jill will have to travel from Hamburg to Darmstadt in order to get to the regional programming contest. Since she is afraid of arriving too late and being excluded from the contest she is looking for the train which gets her to Darmstadt as early as possible. However, she dislikes to get to the station too early, so if there are several schedules with the same arrival time then she will choose the one with the latest departure time.
Jill asks you to help her with her problem. You are given a set of railroad schedules from which you must compute the train with the earliest arrival time and the fastest connection from one location to another. One good thing: Jill is very experienced in changing trains. She can do this instantaneously, i.e., in zero time!!!</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The very first line of the input gives the number of scenarios. Each scenario consists of three parts.
Part one lists the names of all cities connected by the railroads. It starts with a number _1 < C ≤ 100_, followed by _C_ lines containing city names. These names consist of letters.
Part two describes all the trains running during a day. It starts with a number _T ≤ 1000_ followed by _T_ train descriptions. Each of them consists of one line with a number _t $ _{i} $ ≤ 100_ and _t $ _{i} $_ more lines with a time and a city name, meaning that passengers can get on or off the train at that time at that city.
Part three consists of three lines: Line one contains the earliest journey's starting time, line two the name of the city where she starts, and line three the destination city. The two cities are always different.</div>
<h3>输出格式</h3>
<br />
<div>For each scenario print a line containing "Scenario i", where i is the number of the scenario starting at 1.
If a connection exists then print the two lines containing zero padded timestamps and locations as shown in the sample. Use blanks to achieve the indentation. If no connection exists on the same day (i.e., arrival before midnight) then print a line containing "No connection".
After each scenario print a blank line.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2
3
Hamburg
Frankfurt
Darmstadt
3
2
0949 Hamburg
1006 Frankfurt
2
1325 Hamburg
1550 Darmstadt
2
1205 Frankfurt
1411 Darmstadt
0800
Hamburg
Darmstadt
2
Paris
Tokyo
1
2
0100 Paris
2300 Tokyo
0800
Paris
Tokyo</code></pre>
<h3>输出样例 #1</h3>
<pre><code>Scenario 1
Departure 0949 Hamburg
Arrival   1411 Darmstadt

Scenario 2
No connection</code></pre>
</article>
</div>
</div>
</body>
</html>
