<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>COWWORDS - Cows Language - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450482:lAgX52Jp8tmbU2kZoJYJTcIvnpun4IOdThF1ekVibvE=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%60%60%60%5CnLike%20all%20bovines%2C%20Farmer%20John%27s%20cows%20speak%20the%20peculiar%20%27Cow%27%5Cnlanguage.%20Like%20so%20many%20languages%2C%20each%20word%20in%20this%20language%20comprises%5Cna%20sequence%20of%20upper%20and%20lowercase%20letters%20%28A-Z%20and%20a-z%29.%20%20A%20word%5Cnis%20valid%20if%20and%20only%20if%20each%20ordered%20pair%20of%20adjacent%20letters%20in%5Cnthe%20word%20is%20a%20valid%20pair.%5Cn%5CnFarmer%20John%2C%20ever%20worried%20that%20his%20cows%20are%20plotting%20against%20him%2C%5Cnrecently%20tried%20to%20eavesdrop%20on%20their%20conversation.%20He%20overheard%20one%5Cnword%20before%20the%20cows%20noticed%20his%20presence.%20The%20Cow%20language%20is%5Cnspoken%20so%20quickly%2C%20and%20its%20sounds%20are%20so%20strange%2C%20that%20all%20that%5CnFarmer%20John%20was%20able%20to%20perceive%20was%20the%20total%20number%20of%20uppercase%5Cnletters%2C%20U%20%281%20%3C%3D%20U%20%3C%3D%20250%29%20and%20the%20total%20number%20of%20lowercase%5Cnletters%2C%20L%20%281%20%3C%3D%20L%20%3C%3D%20250%29%20in%20the%20word.%5Cn%5CnFarmer%20John%20knows%20all%20P%20%281%20%3C%3D%20P%20%3C%3D%20200%29%20valid%20ordered%20pairs%20of%5Cnadjacent%20letters.%20%20He%20wishes%20to%20know%20how%20many%20different%20valid%5Cnwords%20are%20consistent%20with%20his%20limited%20data.%20%20However%2C%20since%5Cnthis%20number%20may%20be%20very%20large%2C%20he%20only%20needs%20the%20value%20modulo%5Cn97654321.%5Cn%5CnINPUT%20FORMAT%3A%5Cn%5Cn%2A%20Line%201%3A%20Three%20space-separated%20integers%3A%20U%2C%20L%20and%20P%5Cn%5Cn%2A%20Lines%202..P%2B1%3A%20Two%20letters%20%28each%20of%20which%20may%20be%20uppercase%20or%5Cn%20%20%20%20%20%20%20%20lowercase%29%2C%20representing%20one%20valid%20ordered%20pair%20of%20adjacent%5Cn%20%20%20%20%20%20%20%20letters%20in%20Cow.%5Cn%5CnSAMPLE%20INPUT%20%3A%5Cn%5Cn2%202%207%5CnAB%5Cnab%5CnBA%5Cnba%5CnAa%5CnBb%5CnbB%5Cn%5CnINPUT%20DETAILS%3A%5Cn%5CnThe%20word%20Farmer%20John%20overheard%20had%202%20uppercase%20and%202%20lowercase%5Cnletters.%20%20The%20valid%20pairs%20of%20adjacent%20letters%20are%20AB%2C%20ab%2C%20BA%2C%20ba%2C%5CnAa%2C%20Bb%20and%20bB.%5Cn%5CnOUTPUT%20FORMAT%3A%5Cn%5Cn%2A%20Line%201%3A%20A%20single%20integer%2C%20the%20number%20of%20valid%20words%20consistent%20with%5Cn%20%20%20%20%20%20%20%20Farmer%20%20John%27s%20data%20mod%2097654321.%5Cn%5CnSAMPLE%20OUTPUT%20%3A%5Cn%5Cn7%5Cn%5CnOUTPUT%20DETAILS%3A%5Cn%5CnThe%20possible%20words%20are%3A%5CnAabB%5CnABba%5CnabBA%5CnBAab%5CnBbBb%5CnbBAa%5CnbBbB%5Cn%60%60%60%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F17539%22%2C%22id%22%3A%2217539%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP17539%22%2C%22title%22%3A%22COWWORDS%20-%20Cows%20Language%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22COWWORDS%20-%20Cows%20Language%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>COWWORDS - Cows Language</h1>
<h2>题目描述</h2>
<div>```
Like all bovines, Farmer John's cows speak the peculiar 'Cow'
language. Like so many languages, each word in this language comprises
a sequence of upper and lowercase letters (A-Z and a-z). A word
is valid if and only if each ordered pair of adjacent letters in
the word is a valid pair.
Farmer John, ever worried that his cows are plotting against him,
recently tried to eavesdrop on their conversation. He overheard one
word before the cows noticed his presence. The Cow language is
spoken so quickly, and its sounds are so strange, that all that
Farmer John was able to perceive was the total number of uppercase
letters, U (1 <= U <= 250) and the total number of lowercase
letters, L (1 <= L <= 250) in the word.
Farmer John knows all P (1 <= P <= 200) valid ordered pairs of
adjacent letters. He wishes to know how many different valid
words are consistent with his limited data. However, since
this number may be very large, he only needs the value modulo
97654321.
INPUT FORMAT:
* Line 1: Three space-separated integers: U, L and P
* Lines 2..P+1: Two letters (each of which may be uppercase or
lowercase), representing one valid ordered pair of adjacent
letters in Cow.
SAMPLE INPUT :
2 2 7
AB
ab
BA
ba
Aa
Bb
bB
INPUT DETAILS:
The word Farmer John overheard had 2 uppercase and 2 lowercase
letters. The valid pairs of adjacent letters are AB, ab, BA, ba,
Aa, Bb and bB.
OUTPUT FORMAT:
* Line 1: A single integer, the number of valid words consistent with
Farmer John's data mod 97654321.
SAMPLE OUTPUT :
7
OUTPUT DETAILS:
The possible words are:
AabB
ABba
abBA
BAab
BbBb
bBAa
bBbB
```</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
