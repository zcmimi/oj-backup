<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>CONTCITY - Contaminated City - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450218:+peMs0Wg9zp5lIVT0oOVZNANSI0skzs27BleqJlDHh8=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22In%20a%20far%20away%20country%20there%20is%20a%20city%20facing%20a%20big%20problem.%20The%20city%20is%20plagued%20by%20a%20deadly%20gas.%20Many%20%20%5Cnpeople%20have%20died%2C%20but%20there%20are%20groups%20of%20survivors%20at%20places%20around%20the%20city.%20Between%20these%20places%20%20%5Cnthere%20are%20roads%20connecting%20two%20distinct%20places%20that%20can%20still%20be%20traversed%20safely.%20These%20roads%20can%20be%20%20%5Cntraversed%20in%20both%20directions.%20It%27s%20known%20the%20number%20of%20days%20necessary%20to%20traverse%20each%20road%20and%20the%20%20%5Cntwo%20places%20that%20it%20connects.%20It%27s%20also%20known%20the%20number%20of%20survivors%20at%20each%20location.%20Each%20survivor%20%20%5Cncan%20get%20to%20other%20places%20following%20a%20sequence%20of%20roads.%20%20%5CnThe%20mayor%20will%20send%20several%20helicopters%20to%20rescue%20these%20people%2C%20each%20having%20a%20capacity%2C%20a%20limit%20on%20%20%5Cnthe%20number%20of%20crew%20%28people%20that%20it%20can%20rescue%29.%20Each%20helicopter%20will%20land%20on%20a%20certain%20day%20and%20place.%20%20%5CnYou%20should%20answer%20an%20important%20question%20for%20the%20mayor.%20How%20many%20days%20are%20needed%20to%20rescue%20all%20%20%5Cnsurvivors%3F%20If%20it%27s%20not%20possible%20to%20rescue%20all%20people%20you%20should%20answer%20how%20many%20of%20them%20can%20be%20%20%5Cnrescued.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20file%20have%20the%20number%20of%20test%20cases%20T%20%28T%20%3C%3D%2040%29.%20%20%5CnThe%20first%20line%20of%20each%20test%20case%20have%20N%2C%20M%2C%20and%20H%2C%20the%20number%20of%20places%20considered%2C%20the%20number%20of%20%20%5Cnroads%20between%20the%20places%20and%20the%20number%20of%20helicopters%20that%20will%20be%20sent%2C%20respectively.%20Each%20place%20is%20%20%5Cnuniquely%20identified%20by%20a%20number%20between%201%20and%20N.%20The%20next%20N%20lines%20will%20have%20N%20integers%2C%20the%20i-th%20%20%5Cnline%20have%20the%20number%20of%20survivors%20in%20place%20i%2C%20Xi.%20Each%20of%20next%20M%20lines%20will%20have%20three%20numbers%20Aj%2C%20%20%5CnBj%20and%20Dj%2C%20meaning%20that%20there%20is%20a%20way%20between%20places%20Aj%20and%20Bj%20that%20last%20Dj%20days%20to%20traverse.%20The%20%20%5Cninput%20can%20contain%20several%20roads%20between%20the%20same%20pair%20of%20places.%20Each%20of%20next%20H%20lines%20will%20have%20%20%5Cnthree%20integers%20Dh%2C%20Ph%2C%20and%20Ch%20%28in%20this%20order%29%2C%20meaning%20that%20a%20helicopter%20with%20capacity%20Ch%20will%20arrive%20%20%5Cnat%20place%20Ph%20at%20day%20Dh.%20The%20sum%20of%20survivors%20will%20not%20be%20more%20than%20200.%20If%20a%20survivor%20can%20get%20a%20%20%5Cnhelicopter%20following%20a%20sequence%20of%20roads%2C%20the%20total%20time%20to%20get%20the%20helicopter%20will%20not%20be%20more%20than%20%20%5Cn1000%5C%5C.%5Cn%5Cn%20%20%5CnConstraints%3A%20%20%5Cn1%20%3C%3D%20N%2C%20H%20%3C%3D%2050%20%20%5Cn1%20%3C%3D%20M%20%3C%3D%201500%20%20%5Cn1%20%3C%3D%20Aj%2C%20Bj%2C%20Ph%20%3C%3D%20N%20%20%5Cn1%20%3C%3D%20Dj%2C%20Dh%20%3C%3D%201000%20%20%5Cn1%20%3C%3D%20Ch%20%3C%3D%20200%20%20%5Cn0%20%3C%3D%20Xi%20%3C%3D%20200%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%20there%20is%20one%20line%20in%20output.%20If%20all%20people%20can%20be%20rescued%20%5C%22All%20people%20can%20be%20rescued%20%20%5Cnin%20D%20day%28s%29%20.%5C%22%20should%20be%20printed%2C%20where%20D%20is%20the%20minimum%20number%20of%20days%20to%20rescue%20all%20people.%20If%20it%20%20%5Cnis%20impossible%20to%20rescue%20all%20people%20%5C%22X%20survivor%28s%29%20can%20be%20rescued.%5C%22%20should%20be%20printed%2C%20where%20X%20is%20the%20%20%5Cnmaximum%20number%20of%20survivors%20that%20can%20be%20rescued.%22%2C%22samples%22%3A%5B%5B%222%5C%5Cn4%204%204%5C%5Cn3%5C%5Cn4%5C%5Cn5%5C%5Cn6%5C%5Cn1%202%207%5C%5Cn2%203%203%5C%5Cn3%204%203%5C%5Cn4%201%204%5C%5Cn4%204%207%5C%5Cn6%203%202%5C%5Cn5%202%203%5C%5Cn3%201%206%5C%5Cn4%202%203%5C%5Cn2%5C%5Cn2%5C%5Cn3%5C%5Cn1%5C%5Cn1%204%203%5C%5Cn2%203%203%5C%5Cn2%204%202%5C%5Cn3%202%204%5C%5Cn3%203%202%22%2C%22All%20people%20can%20be%20rescued%20in%206%20day%28s%29.%5C%5Cn7%20survivor%28s%29%20can%20be%20rescued.%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B184%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F10447%22%2C%22id%22%3A%2210447%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP10447%22%2C%22title%22%3A%22CONTCITY%20-%20Contaminated%20City%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22CONTCITY%20-%20Contaminated%20City%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>CONTCITY - Contaminated City</h1>
<h2>题目描述</h2>
<div>In a far away country there is a city facing a big problem. The city is plagued by a deadly gas. Many
people have died, but there are groups of survivors at places around the city. Between these places
there are roads connecting two distinct places that can still be traversed safely. These roads can be
traversed in both directions. It's known the number of days necessary to traverse each road and the
two places that it connects. It's also known the number of survivors at each location. Each survivor
can get to other places following a sequence of roads.
The mayor will send several helicopters to rescue these people, each having a capacity, a limit on
the number of crew (people that it can rescue). Each helicopter will land on a certain day and place.
You should answer an important question for the mayor. How many days are needed to rescue all
survivors? If it's not possible to rescue all people you should answer how many of them can be
rescued.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input file have the number of test cases T (T <= 40).
The first line of each test case have N, M, and H, the number of places considered, the number of
roads between the places and the number of helicopters that will be sent, respectively. Each place is
uniquely identified by a number between 1 and N. The next N lines will have N integers, the i-th
line have the number of survivors in place i, Xi. Each of next M lines will have three numbers Aj,
Bj and Dj, meaning that there is a way between places Aj and Bj that last Dj days to traverse. The
input can contain several roads between the same pair of places. Each of next H lines will have
three integers Dh, Ph, and Ch (in this order), meaning that a helicopter with capacity Ch will arrive
at place Ph at day Dh. The sum of survivors will not be more than 200. If a survivor can get a
helicopter following a sequence of roads, the total time to get the helicopter will not be more than
1000\.
Constraints:
1 <= N, H <= 50
1 <= M <= 1500
1 <= Aj, Bj, Ph <= N
1 <= Dj, Dh <= 1000
1 <= Ch <= 200
0 <= Xi <= 200</div>
<h3>输出格式</h3>
<br />
<div>For each test case there is one line in output. If all people can be rescued "All people can be rescued
in D day(s) ." should be printed, where D is the minimum number of days to rescue all people. If it
is impossible to rescue all people "X survivor(s) can be rescued." should be printed, where X is the
maximum number of survivors that can be rescued.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2\n4 4 4\n3\n4\n5\n6\n1 2 7\n2 3 3\n3 4 3\n4 1 4\n4 4 7\n6 3 2\n5 2 3\n3 1 6\n4 2 3\n2\n2\n3\n1\n1 4 3\n2 3 3\n2 4 2\n3 2 4\n3 3 2</code></pre>
<h3>输出样例 #1</h3>
<pre><code>All people can be rescued in 6 day(s).\n7 survivor(s) can be rescued.</code></pre>
</article>
</div>
</div>
</body>
</html>
