<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>NAJKRACI - Najkraci - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449811:G7yRUZumHVHgQ+p6MbnG447serVPLJqsA3kngPEaTB8=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22A%20road%20network%20in%20a%20country%20consists%20of%20N%20cities%20and%20M%20one-way%20roads.%20The%20cities%20are%20numbered%201%20through%20N.%20For%20each%20road%20we%20know%20the%20origin%20and%20destination%20cities%2C%20as%20well%20as%20its%20length.%5Cn%5CnWe%20say%20that%20the%20road%20F%20is%20a%20continuation%20of%20road%20E%20if%20the%20destination%20city%20of%20road%20E%20is%20the%20same%20as%20the%20origin%20city%20of%20road%20F.%20A%20path%20from%20city%20A%20to%20city%20B%20is%20a%20sequence%20of%20road%20such%20that%20origin%20of%20the%20first%20road%20is%20city%20A%2C%20each%20other%20road%20is%20a%20continuation%20of%20the%20one%20before%20it%2C%20and%20the%20destination%20of%20the%20last%20road%20is%20city%20B.%20The%20length%20of%20the%20path%20is%20the%20sum%20of%20lengths%20of%20all%20roads%20in%20it.%5Cn%5CnA%20path%20from%20A%20to%20B%20is%20a%20shortest%20path%20if%20there%20is%20no%20other%20path%20from%20A%20to%20B%20that%20is%20shorter%20in%20length.%5Cn%5CnYour%20task%20is%20to%2C%20for%20each%20road%2C%20output%20how%20many%20different%20shortest%20paths%20containing%20that%20road%2C%20modulo%201%20000%20000%20007.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20N%20and%20M%20%281%20%5Cu2264%20N%20%5Cu2264%201500%2C%201%20%5Cu2264%20M%20%5Cu2264%205000%29%2C%20the%20number%20of%20cities%20and%20roads.%5Cn%5CnEach%20of%20the%20following%20M%20lines%20contains%20three%20positive%20integers%20O%2C%20D%20and%20L.%20These%20represent%20a%20one-way%20road%20from%20city%20O%20to%20city%20D%20of%20length%20L.%20The%20numbers%20O%20and%20D%20will%20be%20different%20and%20L%20will%20be%20at%20most%2010000.%22%2C%22outputFormat%22%3A%22Output%20M%20integers%2C%20each%20on%20its%20own%20line%20%5Cu2013%20for%20each%20road%2C%20the%20number%20of%20different%20shortest%20paths%20containing%20it%2C%20modulo%201%20000%20000%20007.%20The%20order%20of%20these%20numbers%20should%20match%20the%20order%20of%20roads%20in%20the%20input.%22%2C%22samples%22%3A%5B%5B%224%204%5Cr%5Cn1%202%205%5Cr%5Cn2%203%205%5Cr%5Cn3%204%205%5Cr%5Cn1%204%208%22%2C%222%5Cr%5Cn3%5Cr%5Cn2%5Cr%5Cn1%5Cr%5Cn%5Cr%5CnInput%3A%5Cr%5Cn5%208%5Cr%5Cn1%202%2020%5Cr%5Cn1%203%202%5Cr%5Cn2%203%202%5Cr%5Cn4%202%203%5Cr%5Cn4%202%203%5Cr%5Cn3%204%205%5Cr%5Cn4%203%205%5Cr%5Cn5%204%2020%5Cr%5Cn%5Cr%5CnOutput%3A%5Cr%5Cn0%5Cr%5Cn4%5Cr%5Cn6%5Cr%5Cn6%5Cr%5Cn6%5Cr%5Cn7%5Cr%5Cn2%5Cr%5Cn6%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1707%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F3545%22%2C%22id%22%3A%223545%22%7D%2C%22translation%22%3A%22%23%23%20%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cr%5Cn%5Cu4e00%5Cu4e2a%5Cu57ce%5Cu5e02%5Cu7684%5Cu9053%5Cu8def%5Cu7f51%5Cu5305%5Cu62ec%24n%24%5Cu4e2a%5Cu70b9%24m%24%5Cu6761%5Cu6709%5Cu5411%5Cu8fb9%5Cuff0c%5Cu70b9%5Cu7f16%5Cu53f7%241%24%5Cu5230%24n%24%5Cuff0c%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu6761%5Cu8fb9%5Cuff0c%5Cu6c42%5Cu51fa%5Cu6709%5Cu591a%5Cu5c11%5Cu6761%5Cu4e0d%5Cu540c%5Cu7684%5Cu6700%5Cu77ed%5Cu8def%5Cu5305%5Cu62ec%5Cu4e86%5Cu8fd9%5Cu6761%5Cu8fb9%5Cuff0c%5Cu7b54%5Cu6848%5Cu5bf9%241e9%20%2B%207%24%5Cu53d6%5Cu6a21%5Cr%5Cn%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6570%24n%24%2C%24m%24%5Cuff0c%5Cu8868%5Cu793a%5Cu70b9%5Cu7684%5Cu4e2a%5Cu6570%5Cu548c%5Cu6709%5Cu5411%5Cu8fb9%5Cu6570%5Cr%5Cn%5Cr%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%24m%24%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu6709%5Cu4e09%5Cu4e2a%5Cu6570%24u%2Cv%2Cd%24%5Cu8868%5Cu793a%5Cu8fb9%5Cu7684%5Cu8d77%5Cu70b9%5Cuff0c%5Cu7ec8%5Cu70b9%5Cu548c%5Cu8fb9%5Cu6743%5Cr%5Cn%5Cr%5Cn%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu51fa%24m%24%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu8f93%5Cu51fa%5Cu5bf9%5Cu4e8e%5Cu8be5%5Cu8fb9%5Cuff0c%5Cu6709%5Cu591a%5Cu5c11%5Cu6761%5Cu4e0d%5Cu540c%5Cu7684%5Cu6700%5Cu77ed%5Cu8def%5Cu5305%5Cu62ec%5Cu5b83%5Cu3002%5Cu5fc5%5Cu987b%5Cu6309%5Cu7167%5Cu8f93%5Cu5165%5Cu7ed9%5Cu5b9a%5Cu8fb9%5Cu7684%5Cu987a%5Cu5e8f%5Cu8f93%5Cu51fa%5Cr%5Cn%5Cr%5Cn%23%23%20%5Cu8bf4%5Cu660e%5C%2F%5Cu63d0%5Cu793a%5Cr%5Cn%5Cr%5Cn%5Cu5bf9%5Cu4e8e%24100%20%5C%5C%25%24%5Cu7684%5Cu6570%5Cu636e%5Cuff0c%5Cu4fdd%5Cu8bc1%241%20%5C%5Cleq%20n%20%5C%5Cleq%201500%24%2C%241%20%5C%5Cleq%20m%20%5C%5Cleq%205000%24%2C%241%20%5C%5Cleq%20u%2Cv%20%5C%5Cleq%20n%24%2C%24u%20%5C%5Cne%20v%2Cd%20%5C%5Cleq%2010000%24%5Cr%5Cn%5Cr%5Cn%5Cu8bd1%5Cu8005%5Cu6ce8%5Cuff1a%5BCOCI%5Cu539f%5Cu9898%5Cu9762%5Cu94fe%5Cu63a5%5D%28http%3A%5C%2F%5C%2Fwww.hsin.hr%5C%2Fcoci%5C%2Farchive%5C%2F2008_2009%5C%2Fcontest3_tasks.pdf%29%5Cuff0c%5Cu8fb9%5Cu6743%5Cu5e94%5Cu8be5%5Cu662f%5Cu975e%5Cu8d1f%5Cu6570%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A18%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22SP3545%22%2C%22title%22%3A%22NAJKRACI%20-%20Najkraci%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22NAJKRACI%20-%20Najkraci%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>NAJKRACI - Najkraci</h1>
<h2>题意翻译</h2>
<div>## 题目描述
一个城市的道路网包括$n$个点$m$条有向边，点编号$1$到$n$，对于每条边，求出有多少条不同的最短路包括了这条边，答案对$1e9 + 7$取模
## 输入格式
第一行两个数$n$,$m$，表示点的个数和有向边数
接下来$m$行，每行有三个数$u,v,d$表示边的起点，终点和边权
## 输出格式
输出$m$行，每行输出对于该边，有多少条不同的最短路包括它。必须按照输入给定边的顺序输出
## 说明/提示
对于$100 \%$的数据，保证$1 \leq n \leq 1500$,$1 \leq m \leq 5000$,$1 \leq u,v \leq n$,$u \ne v,d \leq 10000$
译者注：[COCI原题面链接](http://www.hsin.hr/coci/archive/2008_2009/contest3_tasks.pdf)，边权应该是非负数</div>
<h2>题目描述</h2>
<div>A road network in a country consists of N cities and M one-way roads. The cities are numbered 1 through N. For each road we know the origin and destination cities, as well as its length.
We say that the road F is a continuation of road E if the destination city of road E is the same as the origin city of road F. A path from city A to city B is a sequence of road such that origin of the first road is city A, each other road is a continuation of the one before it, and the destination of the last road is city B. The length of the path is the sum of lengths of all roads in it.
A path from A to B is a shortest path if there is no other path from A to B that is shorter in length.
Your task is to, for each road, output how many different shortest paths containing that road, modulo 1 000 000 007.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers N and M (1 ≤ N ≤ 1500, 1 ≤ M ≤ 5000), the number of cities and roads.
Each of the following M lines contains three positive integers O, D and L. These represent a one-way road from city O to city D of length L. The numbers O and D will be different and L will be at most 10000.</div>
<h3>输出格式</h3>
<br />
<div>Output M integers, each on its own line – for each road, the number of different shortest paths containing it, modulo 1 000 000 007. The order of these numbers should match the order of roads in the input.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 4
1 2 5
2 3 5
3 4 5
1 4 8</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
3
2
1

Input:
5 8
1 2 20
1 3 2
2 3 2
4 2 3
4 2 3
3 4 5
4 3 5
5 4 20

Output:
0
4
6
6
6
7
2
6</code></pre>
</article>
</div>
</div>
</body>
</html>
