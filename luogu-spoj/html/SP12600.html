<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>BMASTER - Blade Master - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450322:gB16u/5Z9+Iha61Jwm9QqmjHtUTWt7zhhCGKBT0cPng=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Loda%20and%20Maelk%20are%20legendary%20ChefCraft%20players.%20They%20have%20played%20so%20many%20games%20that%20this%20number%20doesn%27t%20fit%20in%20a%20standard%2032-bit%20integer%20type.%20Today%20Loda%20and%20Maelk%20are%20going%20to%20sort%20the%20things%20out%20and%20find%20out%20who%20is%20the%20greatest%20ChefCraft%20player%20ever.%20So%20the%20great%20fight%20is%20coming.%20There%20are%20a%20lot%20of%20different%20heroes%20you%20may%20choose%20to%20play%20ChefCraft.%20Obviously%20every%20hero%20has%20his%20pros%20and%20cons.%20Loda%20perfectly%20plays%20Blade%20Master.%20His%20main%20skill%20is%20to%20make%20mirror%20images%20of%20himself%20to%20spoof%20the%20enemy.%5Cn%5CnAs%20every%20other%20popular%20game%20ChefCraft%20is%20played%20on%20a%20rectangular%20grid%20which%20consists%20of%20%2A%2AN%2A%2A%20rows%20and%20%2A%2AM%2A%2A%20columns.%20Rows%20of%20the%20grid%20are%20numbered%20by%20integers%20from%20%2A%2A1%2A%2A%20to%20%2A%2AN%2A%2A.%20So%20the%20upper%20row%20of%20the%20grid%20has%20number%20%2A%2A1%2A%2A%20and%20the%20lower%20row%20has%20number%20%2A%2AN%2A%2A.%20The%20same%20holds%20for%20columns.%20They%20are%20numbered%20by%20integers%20from%20%2A%2A1%2A%2A%20to%20%2A%2AM%2A%2A%20such%20that%20the%20most%20left%20column%20has%20number%20%2A%2A1%2A%2A%20while%20the%20most%20right%20column%20has%20number%20%2A%2AM%2A%2A.%5Cn%5CnAt%20the%20beginning%20of%20the%20game%20the%20only%20Blade%20Master%27s%20image%20stands%20on%20some%20starting%20cell%20%2A%2A%28Sx%2C%20Sy%29%2A%2A%20where%20%2A%2A1%20and%20%2A%2A1%20.%20Then%20Loda%20makes%20%2A%2AT%2A%2A%20moves.%20Maelk%20knows%20how%20the%20distribution%20of%20images%20on%20the%20grid%20changes%20after%20each%20Loda%27s%20move.%20This%20happens%20according%20to%20the%20following%20rules.%2A%2A%2A%2A%5Cn%5Cn%2A%2A1.%2A%2A%20If%20there%20is%20an%20image%20standing%20on%20the%20cell%20%2A%2A%28i%2C%20j%29%2A%2A%20then%20the%20new%20images%20appear%20by%20the%20next%20rules%3A%5Cn%5Cn-%20Let%20%2A%2AF%28i%2C%20j%29%2A%2A%20be%20the%20total%20number%20of%20images%20in%20the%20%5C%22cross%5C%22%20of%20the%20cell%20%2A%2A%28i%2C%20j%29%2A%2A.%20The%20%5C%22cross%5C%22%20of%20the%20cell%20%2A%2A%28i%2C%20j%29%2A%2A%20is%20union%20of%20all%20cells%20in%20the%20%2A%2Ai%2A%2A-th%20row%20of%20the%20grid%20and%20in%20the%20%2A%2Aj%2A%2A-th%20column%20of%20the%20grid.%20So%20%2A%2AN%20%2B%20M%20%5Cu2212%201%2A%2A%20cells%20belongs%20to%20the%20%5C%22cross%5C%22.%5Cn-%20Let%20%2A%2AX%20%3D%20F%28i%2C%20j%29%20mod%206%2A%2A%2C%20that%20is%20%2A%2AX%2A%2A%20is%20the%20remainder%20of%20the%20division%20of%20%2A%2AF%28i%2C%20j%29%2A%2A%20by%20%2A%2A6%2A%2A.%5Cn-%20For%20every%20possible%20value%20of%20%2A%2AX%2A%2A%20we%20have%20following%20values%3A%20%2A%2AD1%2A%2A%2C%20%2A%2AD2%2A%2A%2C%20%2A%2AP1%2A%2A%20%20and%20%2A%2AP2%2A%2A.%5Cn-%20%2A%2AD1%2A%2A%20and%20%2A%2AD2%2A%2A%20may%20be%20equal%20to%20one%20of%20the%20%2A%2A4%2A%2A%20values%20%2A%2A%5C%5C%5B%27U%27%2C%20%27R%27%2C%20%27D%27%2C%20%27L%27%5C%5C%5D%2A%2A%20and%20mean%20some%20two%20directions.%20Here%20%2A%2A%27U%27%2A%2A%20means%20%2A%2Aup%2A%2A%2C%20%2A%2A%27R%27%2A%2A%20means%20%2A%2Aright%2A%2A%2C%20%2A%2A%27D%27%2A%2A%20means%20%2A%2Adown%2A%2A%20and%20%2A%2A%27L%27%2A%2A%20means%20%2A%2Aleft%2A%2A.%5Cn-%20%2A%2AP1%2A%2A%20and%20%2A%2AP2%2A%2A%20are%20integer%20numbers.%5Cn-%20New%20mirror%20images%20will%20appear%20at%20every%20cell%20in%20the%20direction%20%2A%2AD1%2A%2A%20with%20the%20period%20%2A%2AP1%2A%2A%20starting%20from%20cell%20%2A%2A%28i%2C%20j%29%2A%2A%20and%20in%20the%20direction%20%2A%2AD2%2A%2A%20with%20the%20period%20%2A%2AP2%2A%2A%20also%20starting%20from%20the%20cell%20%2A%2A%28i%2C%20j%29%2A%2A.%20Of%20course%2C%20no%20images%20will%20appear%20out%20of%20the%20grid.%20For%20example%2C%20if%20%2A%2AD1%20%3D%20%27U%27%2A%2A%20and%20%2A%2AP1%20%3D%202%2A%2A%20then%20images%20appear%20at%20the%20cells%20%2A%2A%28i%20%5Cu2212%202%2C%20j%29%2C%20%28i%20%5Cu2212%204%2C%20j%29%2C%20%28i%20%5Cu2212%206%2C%20j%29%2A%2A%2C%20and%20so%20on.%5Cn-%20Loda%20always%20use%20the%20same%20values%20for%20%2A%2AD1%2A%2A%20and%20%2A%2AD2%2A%2A.%20Namely%2C%20%20%5Cn%20%20%2A%2AD1%20%3D%20%27U%27%2C%20D2%20%3D%20%27D%27%2A%2A%20for%20%2A%2AX%20%3D%200%2C%2A%2A%20%20%5Cn%20%20%2A%2AD1%20%3D%20%27L%27%2C%20D2%20%3D%20%27R%27%2A%2A%20for%20%2A%2AX%20%3D%201%2C%2A%2A%20%20%5Cn%20%20%2A%2AD1%20%3D%20%27U%27%2C%20D2%20%3D%20%27R%27%2A%2A%20for%20%2A%2AX%20%3D%202%2C%2A%2A%20%20%5Cn%20%20%2A%2AD1%20%3D%20%27R%27%2C%20D2%20%3D%20%27D%27%2A%2A%20for%20%2A%2AX%20%3D%203%2C%2A%2A%20%20%5Cn%20%20%2A%2AD1%20%3D%20%27D%27%2C%20D2%20%3D%20%27L%27%2A%2A%20for%20%2A%2AX%20%3D%204%2C%2A%2A%20%20%5Cn%20%20%2A%2AD1%20%3D%20%27L%27%2C%20D2%20%3D%20%27U%27%2A%2A%20for%20%2A%2AX%20%3D%205.%2A%2A%5Cn-%20But%20values%20%2A%2AP1%2A%2A%20and%20%2A%2AP2%2A%2A%20may%20vary%20for%20different%20games.%20But%20once%20chosen%20they%20will%20be%20the%20same%20for%20all%20moves.%5Cn%5Cn%2A%2A2.%2A%2A%20Appearing%20of%20new%20mirror%20images%20happens%20immediately.%5Cn%5Cn%2A%2A3.%2A%2A%20Whenever%20there%20is%20more%20than%20one%20image%20at%20the%20cell%20they%20start%20one%20on%20one%20fights.%20In%20each%20fight%20two%20images%20participate%20and%20both%20die.%20So%20if%20the%20number%20of%20images%20in%20the%20cell%20was%20even%20than%20all%20images%20will%20disappear%20in%20the%20end%2C%20otherwise%20exactly%20one%20image%20will%20remain%20at%20this%20cell.%5Cn%5CnNow%20Maelk%20wants%20to%20choose%20his%20hero%20in%20order%20to%20win%20the%20fight.%20The%20most%20important%20thing%20he%20needs%20to%20know%20for%20this%20is%20how%20the%20number%20of%20images%20changes%20during%20Loda%27s%20moves.%20So%20he%20asks%20you%20for%20help.%20Denote%20by%20%2A%2AC%28t%29%2A%2A%20the%20number%20of%20images%20on%20the%20grid%20after%20the%20%2A%2At%2A%2A-th%20Loda%27s%20move%20for%20%2A%2At%2A%2A%20from%20%2A%2A1%2A%2A%20to%20%2A%2AT%2A%2A.%20For%20convenience%20we%20denote%20%2A%2AC%280%29%20%3D%201%2A%2A%20with%20meaning%20that%200-th%20move%20is%20the%20putting%20of%20the%20only%20Blade%20Master%27s%20image%20at%20the%20starting%20cell.%20Maelk%20wants%20you%20to%20calculate%20the%20sum%20%2A%2AC%280%29%20%2B%20C%281%29%20%2B%20...%20%2B%20C%28T%29%2A%2A.%20Since%20Maelk%20doesn%27t%20know%20what%20to%20expect%20from%20Loda%20he%20would%20like%20to%20know%20the%20answer%20for%20several%20values%20of%20%2A%2AT%2A%2A.%20As%20you%20remember%20the%20total%20number%20of%20games%20played%20by%20Maelk%20and%20Loda%20at%20ChefCraft%20doesn%27t%20fit%20in%20a%20standard%2032-bit%20integer%20type.%20Of%20course%2C%20the%20same%20can%20hold%20for%20the%20number%20of%20moves%20in%20their%20final%20fight.%20Since%20Maelk%20plays%20ChefCraft%20the%20whole%20life%20he%20is%20not%20strong%20in%20math%20and%20can%27t%20calculate%20such%20large%20sums.%20So%20let%27s%20help%20him%20to%20win%20the%20final%20fight%20and%20become%20the%20only%20ChefCraft%20master%20ever.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20contains%20three%20space%20separated%20integers%20%2A%2AN%2A%2A%2C%20%2A%2AM%2A%2A%20%20and%20%2A%2AQ%2A%2A.%20Here%20%2A%2AN%2A%2A%20and%20%2A%2AM%2A%2A%20are%20sizes%20of%20the%20grid%20described%20above%20and%20%2A%2AQ%2A%2A%20is%20the%20number%20of%20Maelk%27s%20queries.%20The%20second%20line%20contains%20two%20space%20separated%20integers%20%2A%2ASx%2A%2A%20and%20%2A%2ASy%2A%2A%2C%20row%20index%20and%20column%20index%20of%20the%20starting%20position%20of%20the%20first%20image.%20Each%20of%20the%20following%20six%20lines%20contains%20two%20space%20separated%20integers%2C%20the%20values%20%2A%2AP1%2A%2A%20and%20%2A%2AP2%2A%2A%20%20for%20the%20corresponding%20%2A%2AX%2A%2A%2C%20that%20is%2C%20%2A%2Ai%2A%2A-th%20line%20among%20these%20six%20lines%20contains%20values%20%2A%2AP1%2A%2A%20and%20%2A%2AP2%2A%2A%20%20for%20%2A%2AX%20%3D%20i%20%5Cu2212%201%2A%2A.%20Each%20of%20the%20following%20%2A%2AQ%2A%2A%20lines%20contains%20a%20single%20integer%20%2A%2AT%2A%2A%2C%20the%20number%20of%20Loda%27s%20moves%20for%20the%20corresponding%20Maelk%27s%20query.%22%2C%22outputFormat%22%3A%22For%20every%20Maelk%27s%20query%20output%20on%20a%20separate%20line%20the%20numbers%20of%20images%20Maelk%20will%20see%20during%20Loda%27s%20move.%22%2C%22samples%22%3A%5B%5B%223%203%203%5Cr%5Cn1%201%5Cr%5Cn1%201%5Cr%5Cn1%201%5Cr%5Cn1%201%5Cr%5Cn1%201%5Cr%5Cn1%201%5Cr%5Cn1%201%5Cr%5Cn1%5Cr%5Cn2%5Cr%5Cn3%22%2C%224%5Cr%5Cn12%5Cr%5Cn17%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B690%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F12600%22%2C%22id%22%3A%2212600%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP12600%22%2C%22title%22%3A%22BMASTER%20-%20Blade%20Master%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22BMASTER%20-%20Blade%20Master%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>BMASTER - Blade Master</h1>
<h2>题目描述</h2>
<div>Loda and Maelk are legendary ChefCraft players. They have played so many games that this number doesn't fit in a standard 32-bit integer type. Today Loda and Maelk are going to sort the things out and find out who is the greatest ChefCraft player ever. So the great fight is coming. There are a lot of different heroes you may choose to play ChefCraft. Obviously every hero has his pros and cons. Loda perfectly plays Blade Master. His main skill is to make mirror images of himself to spoof the enemy.
As every other popular game ChefCraft is played on a rectangular grid which consists of **N** rows and **M** columns. Rows of the grid are numbered by integers from **1** to **N**. So the upper row of the grid has number **1** and the lower row has number **N**. The same holds for columns. They are numbered by integers from **1** to **M** such that the most left column has number **1** while the most right column has number **M**.
At the beginning of the game the only Blade Master's image stands on some starting cell **(Sx, Sy)** where **1 and **1 . Then Loda makes **T** moves. Maelk knows how the distribution of images on the grid changes after each Loda's move. This happens according to the following rules.****
**1.** If there is an image standing on the cell **(i, j)** then the new images appear by the next rules:
- Let **F(i, j)** be the total number of images in the "cross" of the cell **(i, j)**. The "cross" of the cell **(i, j)** is union of all cells in the **i**-th row of the grid and in the **j**-th column of the grid. So **N + M − 1** cells belongs to the "cross".
- Let **X = F(i, j) mod 6**, that is **X** is the remainder of the division of **F(i, j)** by **6**.
- For every possible value of **X** we have following values: **D1**, **D2**, **P1** and **P2**.
- **D1** and **D2** may be equal to one of the **4** values **\['U', 'R', 'D', 'L'\]** and mean some two directions. Here **'U'** means **up**, **'R'** means **right**, **'D'** means **down** and **'L'** means **left**.
- **P1** and **P2** are integer numbers.
- New mirror images will appear at every cell in the direction **D1** with the period **P1** starting from cell **(i, j)** and in the direction **D2** with the period **P2** also starting from the cell **(i, j)**. Of course, no images will appear out of the grid. For example, if **D1 = 'U'** and **P1 = 2** then images appear at the cells **(i − 2, j), (i − 4, j), (i − 6, j)**, and so on.
- Loda always use the same values for **D1** and **D2**. Namely,
**D1 = 'U', D2 = 'D'** for **X = 0,**
**D1 = 'L', D2 = 'R'** for **X = 1,**
**D1 = 'U', D2 = 'R'** for **X = 2,**
**D1 = 'R', D2 = 'D'** for **X = 3,**
**D1 = 'D', D2 = 'L'** for **X = 4,**
**D1 = 'L', D2 = 'U'** for **X = 5.**
- But values **P1** and **P2** may vary for different games. But once chosen they will be the same for all moves.
**2.** Appearing of new mirror images happens immediately.
**3.** Whenever there is more than one image at the cell they start one on one fights. In each fight two images participate and both die. So if the number of images in the cell was even than all images will disappear in the end, otherwise exactly one image will remain at this cell.
Now Maelk wants to choose his hero in order to win the fight. The most important thing he needs to know for this is how the number of images changes during Loda's moves. So he asks you for help. Denote by **C(t)** the number of images on the grid after the **t**-th Loda's move for **t** from **1** to **T**. For convenience we denote **C(0) = 1** with meaning that 0-th move is the putting of the only Blade Master's image at the starting cell. Maelk wants you to calculate the sum **C(0) + C(1) + ... + C(T)**. Since Maelk doesn't know what to expect from Loda he would like to know the answer for several values of **T**. As you remember the total number of games played by Maelk and Loda at ChefCraft doesn't fit in a standard 32-bit integer type. Of course, the same can hold for the number of moves in their final fight. Since Maelk plays ChefCraft the whole life he is not strong in math and can't calculate such large sums. So let's help him to win the final fight and become the only ChefCraft master ever.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input contains three space separated integers **N**, **M** and **Q**. Here **N** and **M** are sizes of the grid described above and **Q** is the number of Maelk's queries. The second line contains two space separated integers **Sx** and **Sy**, row index and column index of the starting position of the first image. Each of the following six lines contains two space separated integers, the values **P1** and **P2** for the corresponding **X**, that is, **i**-th line among these six lines contains values **P1** and **P2** for **X = i − 1**. Each of the following **Q** lines contains a single integer **T**, the number of Loda's moves for the corresponding Maelk's query.</div>
<h3>输出格式</h3>
<br />
<div>For every Maelk's query output on a separate line the numbers of images Maelk will see during Loda's move.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 3 3
1 1
1 1
1 1
1 1
1 1
1 1
1 1
1
2
3</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4
12
17</code></pre>
</article>
</div>
</div>
</body>
</html>
