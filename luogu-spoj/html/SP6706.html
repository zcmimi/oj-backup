<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>CT101CC - Making Chess Boards - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449996:tOv/AOjYQTkVIU2FMO+UnBYtOVwaCZkpwilosqRcA4E=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20chess%20board%20industry%20has%20fallen%20on%20hard%20times%20and%20needs%20your%20help.%20It%20is%20a%20little-known%20fact%20that%20chess%20boards%20are%20made%20from%20the%20bark%20of%20the%20extremely%20rare%20Croatian%20Chess%20Board%20tree%2C%20%28_Biggus%20Mobydiccus_%29.%20The%20bark%20of%20that%20tree%20is%20stripped%20and%20unwrapped%20into%20a%20huge%20rectangular%20sheet%20of%20chess%20board%20material.%20The%20rectangle%20is%20a%20grid%20of%20black%20and%20white%20squares.%5Cn%5CnYour%20task%20is%20to%20make%20as%20many%20large%20square%20chess%20boards%20as%20possible.%20A%20chess%20board%20is%20a%20piece%20of%20the%20bark%20that%20is%20a%20square%2C%20with%20sides%20parallel%20to%20the%20sides%20of%20the%20bark%20rectangle%2C%20with%20cells%20colored%20in%20the%20pattern%20of%20a%20chess%20board%20%28no%20two%20cells%20of%20the%20same%20color%20can%20share%20an%20edge%29.%5Cn%5CnEach%20time%20you%20cut%20out%20a%20chess%20board%2C%20you%20must%20choose%20the%20largest%20possible%20chess%20board%20left%20in%20the%20sheet.%20If%20there%20are%20several%20such%20boards%2C%20pick%20the%20topmost%20one.%20If%20there%20is%20still%20a%20tie%2C%20pick%20the%20leftmost%20one.%20Continue%20cutting%20out%20chess%20boards%20until%20there%20is%20no%20bark%20left.%20You%20may%20need%20to%20go%20as%20far%20as%20cutting%20out%201-by-1%20mini%20chess%20boards.%5Cn%5CnHere%20is%20an%20example%20showing%20the%20bark%20of%20a%20Chess%20Board%20tree%20and%20the%20first%20few%20chess%20boards%20that%20will%20be%20cut%20out%20of%20it.%5Cn%5Cn%21%5B%5D%28http%3A%5C%2F%5C%2Fcode.google.com%5C%2Fcodejam%5C%2Fcontest%5C%2Fimages%5C%2F%3Fimage%3Dmcb.png%26p%3D563116%26c%3D619102%29%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20gives%20the%20number%20of%20test%20cases%2C%20%2A%2AT%2A%2A.%20%2A%2AT%2A%2A%20test%20cases%20follow.%20Each%20one%20starts%20with%20a%20line%20containing%20the%20dimensions%20of%20the%20bark%20grid%2C%20%2A%2AM%2A%2A%20and%20%2A%2AN%2A%2A.%20%2A%2AN%2A%2A%20will%20always%20be%20a%20multiple%20of%204.%20The%20next%20%2A%2AM%2A%2A%20lines%20will%20each%20contain%20an%20%28%2A%2AN%2A%2A%5C%2F4%29-character%20hexadecimal%20integer%2C%20representing%20a%20row%20of%20the%20bark%20grid.%20The%20binary%20representation%20of%20these%20integers%20will%20give%20you%20a%20strings%20of%20%2A%2AN%2A%2A%20bits%2C%20one%20for%20each%20row.%20Zeros%20represent%20black%20squares%3B%20ones%20represent%20white%20squares%20of%20the%20grid.%20The%20rows%20are%20given%20in%20the%20input%20from%20top%20to%20bottom.%20In%20each%20row%2C%20the%20most-significant%20bit%20of%20the%20hexadecimal%20integer%20corresponds%20to%20the%20leftmost%20cell%20in%20that%20row.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20output%20one%20line%20containing%20%5C%22Case%20%23x%3A%20%2A%2AK%2A%2A%5C%22%2C%20where%20x%20is%20the%20case%20number%20%28starting%20from%201%29%20and%20%2A%2AK%2A%2A%20is%20the%20number%20of%20different%20chess%20board%20sizes%20that%20you%20can%20cut%20out%20by%20following%20the%20procedure%20described%20above.%20The%20next%20%2A%2AK%2A%2A%20lines%20should%20contain%20two%20integers%20each%20--%20the%20size%20of%20the%20chess%20board%20%28from%20largest%20to%20smallest%29%20and%20the%20number%20of%20chess%20boards%20of%20that%20size%20that%20you%20can%20cut%20out.%22%2C%22samples%22%3A%5B%5B%22%5C%5Cn%204%5C%5Cn%2015%2020%5C%5Cn%2055555%5C%5Cn%20FFAAA%5C%5Cn%202AAD5%5C%5Cn%20D552A%5C%5Cn%202AAD5%5C%5Cn%20D542A%5C%5Cn%204AD4D%5C%5Cn%20B52B2%5C%5Cn%2052AAD%5C%5Cn%20AD552%5C%5Cn%20AA52D%5C%5Cn%20AAAAA%5C%5Cn%205AA55%5C%5Cn%20A55AA%5C%5Cn%205AA55%5C%5Cn%204%204%5C%5Cn%200%5C%5Cn%200%5C%5Cn%200%5C%5Cn%200%5C%5Cn%204%204%5C%5Cn%203%5C%5Cn%203%5C%5Cn%20C%5C%5Cn%20C%5C%5Cn%204%204%5C%5Cn%206%5C%5Cn%209%5C%5Cn%209%5C%5Cn%206%5C%5Cn%5C%5Cn%22%2C%22%5C%5Cn%20Case%20%231%3A%205%5C%5Cn%206%202%5C%5Cn%204%203%5C%5Cn%203%207%5C%5Cn%202%2015%5C%5Cn%201%2057%5C%5Cn%20Case%20%232%3A%201%5C%5Cn%201%2016%5C%5Cn%20Case%20%233%3A%202%5C%5Cn%202%201%5C%5Cn%201%2012%5C%5Cn%20Case%20%234%3A%201%5C%5Cn%202%204%5C%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1121%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F6706%22%2C%22id%22%3A%226706%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP6706%22%2C%22title%22%3A%22CT101CC%20-%20Making%20Chess%20Boards%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22CT101CC%20-%20Making%20Chess%20Boards%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>CT101CC - Making Chess Boards</h1>
<h2>题目描述</h2>
<div>The chess board industry has fallen on hard times and needs your help. It is a little-known fact that chess boards are made from the bark of the extremely rare Croatian Chess Board tree, (_Biggus Mobydiccus_). The bark of that tree is stripped and unwrapped into a huge rectangular sheet of chess board material. The rectangle is a grid of black and white squares.
Your task is to make as many large square chess boards as possible. A chess board is a piece of the bark that is a square, with sides parallel to the sides of the bark rectangle, with cells colored in the pattern of a chess board (no two cells of the same color can share an edge).
Each time you cut out a chess board, you must choose the largest possible chess board left in the sheet. If there are several such boards, pick the topmost one. If there is still a tie, pick the leftmost one. Continue cutting out chess boards until there is no bark left. You may need to go as far as cutting out 1-by-1 mini chess boards.
Here is an example showing the bark of a Chess Board tree and the first few chess boards that will be cut out of it.
![](http://code.google.com/codejam/contest/images/?image=mcb.png&p=563116&c=619102)</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input gives the number of test cases, **T**. **T** test cases follow. Each one starts with a line containing the dimensions of the bark grid, **M** and **N**. **N** will always be a multiple of 4. The next **M** lines will each contain an (**N**/4)-character hexadecimal integer, representing a row of the bark grid. The binary representation of these integers will give you a strings of **N** bits, one for each row. Zeros represent black squares; ones represent white squares of the grid. The rows are given in the input from top to bottom. In each row, the most-significant bit of the hexadecimal integer corresponds to the leftmost cell in that row.</div>
<h3>输出格式</h3>
<br />
<div>For each test case, output one line containing "Case #x: **K**", where x is the case number (starting from 1) and **K** is the number of different chess board sizes that you can cut out by following the procedure described above. The next **K** lines should contain two integers each -- the size of the chess board (from largest to smallest) and the number of chess boards of that size that you can cut out.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>\n 4\n 15 20\n 55555\n FFAAA\n 2AAD5\n D552A\n 2AAD5\n D542A\n 4AD4D\n B52B2\n 52AAD\n AD552\n AA52D\n AAAAA\n 5AA55\n A55AA\n 5AA55\n 4 4\n 0\n 0\n 0\n 0\n 4 4\n 3\n 3\n C\n C\n 4 4\n 6\n 9\n 9\n 6\n\n</code></pre>
<h3>输出样例 #1</h3>
<pre><code>\n Case #1: 5\n 6 2\n 4 3\n 3 7\n 2 15\n 1 57\n Case #2: 1\n 1 16\n Case #3: 2\n 2 1\n 1 12\n Case #4: 1\n 2 4\n</code></pre>
</article>
</div>
</div>
</body>
</html>
