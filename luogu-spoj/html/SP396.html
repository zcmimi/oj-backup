<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>HITOMISS - Hit or Miss - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449589:Dsu+B7df2PZZTNISBSPozms/9JNfYjTcZ57tZOwWXJs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22One%20very%20simple%20type%20of%20solitaire%20game%20known%20as%20%5Cu201cHit%20or%20Miss%5Cu201d%20%28also%20known%20as%20%5Cu201cFrustration%2C%5Cu201d%20%5Cu201cHarvest%2C%5Cu201d%20%5Cu201cRoll-Call%2C%5Cu201d%20%5Cu201cTalkative%5Cu201d%2C%20and%20%5Cu201cTreize%5Cu201d%29%20is%20played%20as%20follows%3A%20take%20a%20standard%20deck%20of%2052%20playing%20cards%20%5Cu2014%20four%20sets%20of%20cards%20numbered%201%20through%2013%20%28suits%20do%20not%20matter%20in%20this%20game%29%20which%20have%20been%20shuffled%20%5Cu2014%20and%20start%20counting%20through%20the%20deck%201%2C%202%2C%203%2C%20.%20.%20.%20%2C%20and%20so%20on.%20When%20your%20count%20reaches%2013%2C%20start%20over%20at%201.%20Each%20time%20you%20count%2C%20look%20at%20the%20top%20card%20of%20the%20deck%20and%20do%20one%20of%20two%20things%3A%20if%20the%20number%20you%20count%20matches%20the%20value%20of%20the%20top%20card%2C%20discard%20it%20from%20the%20deck%3B%20if%20it%20does%20not%20match%20it%2C%20move%20that%20card%20to%20the%20bottom%20of%20the%20deck.%20You%20win%20the%20game%20if%20you%20are%20able%20to%20remove%20all%20cards%20from%20the%20deck%20%28which%20may%20take%20a%20very%20long%20time%29.%5Cn%5CnA%20version%20of%20this%20game%20can%20be%20devised%20for%20two%20or%20more%20players.%20The%20first%20player%20starts%20as%20before%20with%20a%2052%20card%20deck%2C%20while%20the%20other%20players%20have%20no%20cards%20initially.%20As%20the%20first%20player%20removes%20cards%20from%20her%20deck%2C%20she%20gives%20them%20to%20the%20second%20player%2C%20who%20then%20starts%20playing%20the%20same%20game%2C%20starting%20at%20count%201.%20When%20that%20player%20gets%20a%20match%2C%20he%20passes%20his%20card%20to%20the%20third%20player%2C%20and%20so%20on.%20The%20last%20player%20discards%20matches%20rather%20than%20passing%20them%20to%20player%201.%20All%20players%20who%20have%20cards%20to%20play%20with%20perform%20the%20following%202-step%20cycle%20of%20moves%20in%20lockstep%3A%5Cn%5Cn%3E%201.%20Each%20player%20says%20his%20or%20her%20current%20count%20value%20and%20checks%20for%20a%20match.%20If%20there%20is%20no%20match%2C%20the%20top%20card%20is%20moved%20to%20the%20bottom%20of%20the%20deck%3B%20otherwise%20it%20is%20passed%20to%20the%20next%20player%20%28or%20discarded%20if%20this%20is%20the%20last%20player%29.%5Cn%3E%20%5Cn%3E%20%202.%20Each%20player%20except%20the%20first%20takes%20a%20passed%20card%20%28if%20there%20is%20one%29%20and%20places%20it%20at%20the%20bottom%20of%20his%20or%20her%20deck.%5Cn%5CnThese%20rules%20are%20repeated%20over%20and%20over%20until%20either%20the%20game%20is%20won%20%28all%20the%20cards%20are%20discarded%20by%20the%20last%20player%29%20or%20an%20unwinnable%20position%20is%20reached.%20If%20any%20player%20ever%20runs%20out%20of%20cards%2C%20he%20waits%20until%20he%20is%20passed%20a%20card%20and%20resumes%20his%20count%20from%20where%20he%20left%20off%20%28e.g.%2C%20if%20player%203%20passes%20his%20last%20card%20on%20a%20count%20of%207%2C%20he%20waits%20until%20he%20receives%20a%20card%20from%20player%202%20and%20resumes%20his%20count%20with%208%20at%20the%20beginning%20of%20the%20next%202-step%20cycle%29.%22%2C%22inputFormat%22%3A%22Input%20will%20consist%20of%20multiple%20input%20sets.%20The%20first%20line%20of%20the%20file%20will%20contain%20a%20single%20positive%20integer%20n%20indicating%20the%20number%20of%20input%20sets%20in%20the%20file.%20Each%20input%20set%20will%20be%20a%20single%20line%20containing%2053%20integers%3A%20the%20first%20integer%20will%20indicate%20the%20number%20of%20players%20in%20the%20game%20and%20the%20remaining%2052%20values%20will%20be%20the%20initial%20layout%20of%20the%20cards%20in%20the%20deck%2C%20topmost%20card%20first.%20These%20values%20will%20all%20lie%20in%20the%20range%201%20.%20.%20.%2013%2C%20and%20the%20number%20of%20players%20will%20lie%20in%20the%20range%201%20.%20.%20.%2010.%22%2C%22outputFormat%22%3A%22For%20each%20input%20set%2C%20output%20the%20input%20set%20number%20%28as%20shown%20below%2C%20starting%20with%201%29%20and%20either%20the%20phrase%20%5Cu201cunwinnable%5Cu201d%20or%20a%20list%20showing%20the%20last%20card%20discarded%20by%20each%20player.%20Use%20a%20single%20blank%20to%20separate%20all%20outputs.%22%2C%22samples%22%3A%5B%5B%22%28note%20that%20the%20line%20break%20is%20only%20in%20the%20sample%20input%20for%20displaying%20purposes%29%5Cr%5Cn%5Cr%5Cn2%5Cr%5Cn4%201%202%203%204%205%206%207%208%209%2010%2011%2012%2013%201%202%203%204%205%206%207%208%209%2010%2011%2012%2013%5Cr%5Cn%20%201%202%203%204%205%206%207%208%209%2010%2011%2012%2013%201%202%203%204%205%206%207%208%209%2010%2011%2012%2013%5Cr%5Cn4%202%203%204%205%206%207%208%209%2010%2011%2012%2013%201%202%203%204%205%206%207%208%209%2010%2011%2012%2013%201%5Cr%5Cn%20%202%203%204%205%206%207%208%209%2010%2011%2012%2013%201%202%203%204%205%206%207%208%209%2010%2011%2012%2013%201%22%2C%22Case%201%3A%2013%2013%2013%2013%5Cr%5CnCase%202%3A%20unwinnable%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B290%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F396%22%2C%22id%22%3A%22396%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP396%22%2C%22title%22%3A%22HITOMISS%20-%20Hit%20or%20Miss%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22HITOMISS%20-%20Hit%20or%20Miss%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>HITOMISS - Hit or Miss</h1>
<h2>题目描述</h2>
<div>One very simple type of solitaire game known as “Hit or Miss” (also known as “Frustration,” “Harvest,” “Roll-Call,” “Talkative”, and “Treize”) is played as follows: take a standard deck of 52 playing cards — four sets of cards numbered 1 through 13 (suits do not matter in this game) which have been shuffled — and start counting through the deck 1, 2, 3, . . . , and so on. When your count reaches 13, start over at 1. Each time you count, look at the top card of the deck and do one of two things: if the number you count matches the value of the top card, discard it from the deck; if it does not match it, move that card to the bottom of the deck. You win the game if you are able to remove all cards from the deck (which may take a very long time).
A version of this game can be devised for two or more players. The first player starts as before with a 52 card deck, while the other players have no cards initially. As the first player removes cards from her deck, she gives them to the second player, who then starts playing the same game, starting at count 1. When that player gets a match, he passes his card to the third player, and so on. The last player discards matches rather than passing them to player 1. All players who have cards to play with perform the following 2-step cycle of moves in lockstep:
> 1. Each player says his or her current count value and checks for a match. If there is no match, the top card is moved to the bottom of the deck; otherwise it is passed to the next player (or discarded if this is the last player).
>
> 2. Each player except the first takes a passed card (if there is one) and places it at the bottom of his or her deck.
These rules are repeated over and over until either the game is won (all the cards are discarded by the last player) or an unwinnable position is reached. If any player ever runs out of cards, he waits until he is passed a card and resumes his count from where he left off (e.g., if player 3 passes his last card on a count of 7, he waits until he receives a card from player 2 and resumes his count with 8 at the beginning of the next 2-step cycle).</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Input will consist of multiple input sets. The first line of the file will contain a single positive integer n indicating the number of input sets in the file. Each input set will be a single line containing 53 integers: the first integer will indicate the number of players in the game and the remaining 52 values will be the initial layout of the cards in the deck, topmost card first. These values will all lie in the range 1 . . . 13, and the number of players will lie in the range 1 . . . 10.</div>
<h3>输出格式</h3>
<br />
<div>For each input set, output the input set number (as shown below, starting with 1) and either the phrase “unwinnable” or a list showing the last card discarded by each player. Use a single blank to separate all outputs.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>(note that the line break is only in the sample input for displaying purposes)

2
4 1 2 3 4 5 6 7 8 9 10 11 12 13 1 2 3 4 5 6 7 8 9 10 11 12 13
  1 2 3 4 5 6 7 8 9 10 11 12 13 1 2 3 4 5 6 7 8 9 10 11 12 13
4 2 3 4 5 6 7 8 9 10 11 12 13 1 2 3 4 5 6 7 8 9 10 11 12 13 1
  2 3 4 5 6 7 8 9 10 11 12 13 1 2 3 4 5 6 7 8 9 10 11 12 13 1</code></pre>
<h3>输出样例 #1</h3>
<pre><code>Case 1: 13 13 13 13
Case 2: unwinnable</code></pre>
</article>
</div>
</div>
</body>
</html>
