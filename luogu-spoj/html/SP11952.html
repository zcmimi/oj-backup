<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>IGALAXY - Intergalactic Highways - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450293:PFu0n8tmgEEIkjyf6LUZXrLPWYia6GhvdMuKfgbBWQE=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%5B%5D%28https%3A%5C%2F%5C%2Fdocs.google.com%5C%2Fopen%3Fid%3D0B9MWHgzm3i0ib3pPYzNZS0txVjA%29%5Cn%5Cn%5BORIGINAL%20STATEMENT%5D%28https%3A%5C%2F%5C%2Fdocs.google.com%5C%2Fopen%3Fid%3D0B9MWHgzm3i0iMzk4UWFONk9uVkU%29%5Cn%5Cn%20The%20world%20is%20on%20constant%20evolution%2C%20the%20humans%20evolved%20to%20a%20galactic%20civilization%20at%20the%20year%20700%2C000%2C%20they%20are%20now%20capable%20of%20going%20instantly%20to%20any%20other%20planet%20in%201%20unit%20of%20time%2C%20however%2C%20they%20must%20stop%20sometimes%20in%20a%20planet%20to%20avoid%20a%20horrible%20collision%20against%20an%20asteroid.%5Cn%5Cn%20Rudolph-X3000%2C%20a%20single%20humanoid%2C%20wants%20to%20visit%20his%20family%20visiting%20as%20fewer%20planet%20as%20possible%20from%20planet%20A%20to%20planet%20B%20inclusive%20without%20repeating%20any%20planet%2C%20he%20is%20in%20a%20hurry%20so%20he%20need%20the%20answer%20quickly.%20Can%20you%20determine%20how%20many%20planets%20is%20going%20to%20visit%3F%5Cn%5Cn%20As%20Rudolph-X3000%20is%20an%20intergalactic%20traveler%2C%20he%20want%20to%20determine%20the%20planets%20he%20is%20going%20to%20visit%20as%20well%2C%20if%20there%20exists%20more%20than%20a%20single%20shortest%20path%20between%20planet%20A%20and%20B%2C%20print%20the%20one%20lexicographically%20smallest%2C%20if%20there%20isn%27t%20exists%20such%20route%2C%20print%20-1.%5Cn%5Cn%20The%20human%20race%20knows%20now%20the%20Delta%20Velocity%2C%20this%20velocity%20allows%20to%20move%20in%20a%20single%20unit%20of%20time%20at%20a%20very%20fast%20speed%20from%20a%20place%20i%20to%20place%20j.%20So%20you%20can%20consider%20the%20distance%20between%20planets%20will%20be%20always%20of%201.%5Cn%5Cn%20%2A%2AINPUT%2A%2A%3A%5Cn%5Cn%20The%20first%20line%20will%20contain%20an%20integer%20T%20representing%20T%20test%20cases%5Cn%5Cn%20Then%2C%20in%20the%20next%20line%2C%20there%20will%20be%20an%20integer%20R%20denoting%20the%20number%20of%20relations%20between%20planet%2C%20a%20relation%20is%20considered%20so%20that%20from%20a%20planet%20i%20you%20can%20go%20to%20planet%20j%2C%20this%20relation%20is%20symmetric%2C%20so%20the%20path%20between%20%28i%2Cj%29%20is%20the%20same%20as%20%28j%2Ci%29%5Cn%5Cn%20The%20next%20R%20lines%20will%20contain%20two%20strings%20P%20and%20Q%2C%20these%20strings%20will%20denote%20the%20name%20of%20a%20planet%20P%20and%20a%20name%20of%20a%20planet%20Q%20and%20their%20relation.%5Cn%5Cn%20The%20last%20line%20will%20contain%20two%20strings%20S%20and%20D%2C%20representing%20the%20origin%20planet%20and%20the%20destiny%20planet.%5Cn%5CnNote%3A%20All%20the%20strings%20will%20have%20the%20combination%20of%20uppercase%20and%20lowercase%20letters%20%5C%5C%5BA-Z%5C%5C%5D%20%5C%5C%5Ba-z%5C%5C%5D.%5Cn%5Cn%20%2A%2AOUTPUT%2A%2A%3A%5Cn%5Cn%20For%20each%20test%20case%20you%20shall%20print%20the%20string%20%5Cu201cScenario%20%23i%3A%20%5Cu201c%20where%20i%20is%20the%20test%20case%20you%27re%20analyzing%20%28starting%20from%201%29%20followed%20by%20the%20minimum%20number%20of%20planets%2C%20then%2C%20in%20the%20next%20line%2C%20you%20should%20list%20each%20planet%20visit%20%28including%20origin%20and%20destiny%29%2C%20each%20one%20separated%20by%20a%20single%20space.%5Cn%5Cn%2A%2ASAMPLE%20CASE%3A%2A%2A%5Cn%5Cn%20%2A%2AINPUT%2A%2A%5Cn%5Cn%20%20%2A%2AOUTPUT%2A%2A%5Cn%5Cn%20%203%5Cn%5Cn8%5Cn%5CnMercury%20Venus%5Cn%5CnVenus%20Earth%5Cn%5CnEarth%20Mars%5Cn%5CnMars%20Jupiter%5Cn%5CnJupiter%20Saturn%5Cn%5CnSaturn%20Uranus%5Cn%5CnUranus%20Neptune%5Cn%5CnNeptune%20Pluto%5Cn%5CnEarth%20Pluto%5Cn%5Cn7%5Cn%5CnMesopotamia%20Merrick%5Cn%5CnMerian%20Earth%5Cn%5CnEarth%20Venus%5Cn%5CnMerian%20Merrick%5Cn%5CnVenus%20Mesopotamia%5Cn%5CnPluto%20Earth%5Cn%5CnMesopotamia%20Pluto%5Cn%5CnMesopotamia%20Earth%5Cn%5Cn2%5Cn%5CnEarth%20Sun%5Cn%5CnMoon%20Venus%5Cn%5CnEarth%20Moon%5Cn%5Cn%20%20Scenario%20%231%3A%207%5Cn%5CnEarth%20Mars%20Jupiter%20Saturn%20Uranus%20Neptune%20Pluto%5Cn%5CnScenario%20%232%3A%203%5Cn%5CnMesopotamia%20Pluto%20Earth%5Cn%5CnScenario%20%233%3A%20-1%5Cn%5Cn%20Explanation%20of%20the%20second%20case%3A%5Cn%5CnThere%20are%20two%20possible%20routes%20for%20going%20from%20Mesopotamia%20to%20Earth%2C%20one%20is%20%5Cu201cMesopotamia%20%5Cu2192%20Pluto%20%5Cu2192%20Earth%5Cu201d%2C%20the%20other%20one%20is%20%5Cu201cMesopotamia%20%5Cu2192%20Venus%20%5Cu2192%20Earth%5Cu201d%2C%20we%20select%20the%20lexicographically%20smaller.%5Cn%5CnCONSTRAINTS%3A%5Cn%5Cn1%3C%3DT%3C%3D100%5Cn%5Cn1%3C%3DR%3C%3D100%2C000%5Cn%5Cn1%3C%3D%7C%7BP.Q.S.D%7D%7C%3C%3D50%5Cn%5CnIt%20is%20safe%20to%20say%20that%20there%20will%20be%20no%20more%20than%2010%2C000%20distinct%20planets.%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4528%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F11952%22%2C%22id%22%3A%2211952%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP11952%22%2C%22title%22%3A%22IGALAXY%20-%20Intergalactic%20Highways%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22IGALAXY%20-%20Intergalactic%20Highways%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>IGALAXY - Intergalactic Highways</h1>
<h2>题目描述</h2>
<div>[](https://docs.google.com/open?id=0B9MWHgzm3i0ib3pPYzNZS0txVjA)
[ORIGINAL STATEMENT](https://docs.google.com/open?id=0B9MWHgzm3i0iMzk4UWFONk9uVkU)
The world is on constant evolution, the humans evolved to a galactic civilization at the year 700,000, they are now capable of going instantly to any other planet in 1 unit of time, however, they must stop sometimes in a planet to avoid a horrible collision against an asteroid.
Rudolph-X3000, a single humanoid, wants to visit his family visiting as fewer planet as possible from planet A to planet B inclusive without repeating any planet, he is in a hurry so he need the answer quickly. Can you determine how many planets is going to visit?
As Rudolph-X3000 is an intergalactic traveler, he want to determine the planets he is going to visit as well, if there exists more than a single shortest path between planet A and B, print the one lexicographically smallest, if there isn't exists such route, print -1.
The human race knows now the Delta Velocity, this velocity allows to move in a single unit of time at a very fast speed from a place i to place j. So you can consider the distance between planets will be always of 1.
**INPUT**:
The first line will contain an integer T representing T test cases
Then, in the next line, there will be an integer R denoting the number of relations between planet, a relation is considered so that from a planet i you can go to planet j, this relation is symmetric, so the path between (i,j) is the same as (j,i)
The next R lines will contain two strings P and Q, these strings will denote the name of a planet P and a name of a planet Q and their relation.
The last line will contain two strings S and D, representing the origin planet and the destiny planet.
Note: All the strings will have the combination of uppercase and lowercase letters \[A-Z\] \[a-z\].
**OUTPUT**:
For each test case you shall print the string “Scenario #i: “ where i is the test case you're analyzing (starting from 1) followed by the minimum number of planets, then, in the next line, you should list each planet visit (including origin and destiny), each one separated by a single space.
**SAMPLE CASE:**
**INPUT**
**OUTPUT**
3
8
Mercury Venus
Venus Earth
Earth Mars
Mars Jupiter
Jupiter Saturn
Saturn Uranus
Uranus Neptune
Neptune Pluto
Earth Pluto
7
Mesopotamia Merrick
Merian Earth
Earth Venus
Merian Merrick
Venus Mesopotamia
Pluto Earth
Mesopotamia Pluto
Mesopotamia Earth
2
Earth Sun
Moon Venus
Earth Moon
Scenario #1: 7
Earth Mars Jupiter Saturn Uranus Neptune Pluto
Scenario #2: 3
Mesopotamia Pluto Earth
Scenario #3: -1
Explanation of the second case:
There are two possible routes for going from Mesopotamia to Earth, one is “Mesopotamia → Pluto → Earth”, the other one is “Mesopotamia → Venus → Earth”, we select the lexicographically smaller.
CONSTRAINTS:
1<=T<=100
1<=R<=100,000
1<=|{P.Q.S.D}|<=50
It is safe to say that there will be no more than 10,000 distinct planets.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
