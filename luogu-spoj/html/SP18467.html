<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>UOFTCE - A Brief Expedition - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450509:lqWY7vNDlC/J3HNHZ68gPnYPoi/SyZg5EPVlEm0X6cM=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Alice%20has%20convinced%20Bob%20to%20accompany%20her%20on%20a%20shopping%20trip%21%20For%20some%20reason%2C%20he%20seems%20reluctant%20to%20spend%20too%20much%20time%20on%20it%2C%20but%20she%20has%20every%20intention%20of%20hitting%20every%20single%20store%20at%20%24%20M%20%24%20%28%20%24%201%20%5C%5Cleq%20M%20%5C%5Cleq%20100%20%24%20%29%20different%20malls%20today.%20Still%2C%20she%27s%20promised%20to%20get%20it%20over%20with%20as%20quickly%20as%20possible.%5Cn%5CnA%20given%20mall%20can%20be%20modelled%20as%20a%20two-dimensional%20grid%20of%20cells%2C%20with%20%24%20R%20%24%20%28%20%24%201%20%5C%5Cleq%20R%20%5C%5Cleq%20100%20%24%20%29%20rows%20and%20%24%20C%20%24%20%28%20%24%201%20%5C%5Cleq%20C%20%5C%5Cleq%20100%20%24%20%29%20columns.%20Each%20cell%20contains%20either%20a%20wall%20%28represented%20by%20a%20%5C%22%23%5C%22%29%2C%20open%20space%20%28%5C%22.%5C%22%29%2C%20a%20store%20%28%5C%22S%5C%22%2C%20of%20which%20there%20is%20at%20least%20one%29%2C%20or%20Bob%27s%20car%20%28%5C%22C%5C%22%2C%20of%20which%20there%20is%20exactly%20one%29.%20Alice%20and%20Bob%20can%20walk%20from%20one%20cell%20to%20a%20horizontally-%20or%20vertically-adjacent%20one%20in%201%20minute%20if%20neither%20cell%20is%20blocked%20by%20a%20wall.%5Cn%5CnThe%20two%20of%20them%20will%20start%20at%20Bob%27s%20car%2C%20and%20walk%20to%20a%20store%20%28possibly%20passing%20through%20other%20stores%20on%20the%20way%29%20so%20that%20Alice%20can%20do%20what%20she%20does%20best%2C%20which%20only%20takes%20her%2060%20minutes.%20At%20that%20point%2C%20due%20to%20the%20large%20volume%20of%20items%20purchased%2C%20they%27ll%20need%20to%20return%20to%20the%20car%20to%20drop%20them%20off.%20This%20process%20will%20repeat%20until%20all%20stores%20in%20the%20mall%20have%20been%20visited%2C%20in%20some%20order.%20It%27s%20guaranteed%20that%20each%20store%20is%20reachable%20from%20the%20car.%5Cn%5CnTo%20reassure%20Bob%20that%20they%20won%27t%20spend%20too%20much%20time%20at%20each%20mall%2C%20Alice%20will%20leave%20a%20stopwatch%20running%20until%20the%20final%20items%20have%20been%20dropped%20off%20in%20the%20car.%20However%2C%20sneaky%20as%20she%20is%2C%20Alice%20will%20only%20start%20timing%20when%20she%20actually%20starts%20shopping%20at%20the%20first%20store%20they%20decide%20to%20visit.%20She%27d%20like%20to%20know%20how%20much%20time%20will%20be%20spent%20at%20each%20mall%20-%20though%20she%27s%20sure%20that%20it%20won%27t%20be%20much%20at%20all.%22%2C%22inputFormat%22%3A%22Line%201%3A%201%20integer%2C%20%24%20M%20%24%5Cn%5Cn%2A%2AFor%20each%20mall%3A%2A%2A%5Cn%5CnLine%201%3A%202%20integers%2C%20%24%20R%20%24%20and%20%24%20C%20%24%5Cn%5CnNext%20%24%20R%20%24%20lines%3A%20%24%20C%20%24%20characters%2C%20representing%20the%20%24%20i%20%24%20th%20row%20of%20the%20mall%20grid%2C%20for%20%24%20i%3D1..H%20%24%22%2C%22outputFormat%22%3A%22%2A%2AFor%20each%20mall%3A%2A%2A%5Cn%5Cn1%20integer%2C%20the%20minimal%20number%20of%20minutes%20required%20to%20visit%20all%20stores%20and%20return%20to%20the%20car%2C%20as%20per%20Alice%27s%20stopwatch.%22%2C%22samples%22%3A%5B%5B%222%5C%5Cn4%204%5C%5Cn..S%23%5C%5Cn.%23%23C%5C%5Cn....%5C%5CnS.%23S%5C%5Cn1%205%5C%5CnSSCSS%22%2C%22%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F18467%22%2C%22id%22%3A%2218467%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP18467%22%2C%22title%22%3A%22UOFTCE%20-%20A%20Brief%20Expedition%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22UOFTCE%20-%20A%20Brief%20Expedition%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>UOFTCE - A Brief Expedition</h1>
<h2>题目描述</h2>
<div>Alice has convinced Bob to accompany her on a shopping trip! For some reason, he seems reluctant to spend too much time on it, but she has every intention of hitting every single store at $ M $ ( $ 1 \leq M \leq 100 $ ) different malls today. Still, she's promised to get it over with as quickly as possible.
A given mall can be modelled as a two-dimensional grid of cells, with $ R $ ( $ 1 \leq R \leq 100 $ ) rows and $ C $ ( $ 1 \leq C \leq 100 $ ) columns. Each cell contains either a wall (represented by a "#"), open space ("."), a store ("S", of which there is at least one), or Bob's car ("C", of which there is exactly one). Alice and Bob can walk from one cell to a horizontally- or vertically-adjacent one in 1 minute if neither cell is blocked by a wall.
The two of them will start at Bob's car, and walk to a store (possibly passing through other stores on the way) so that Alice can do what she does best, which only takes her 60 minutes. At that point, due to the large volume of items purchased, they'll need to return to the car to drop them off. This process will repeat until all stores in the mall have been visited, in some order. It's guaranteed that each store is reachable from the car.
To reassure Bob that they won't spend too much time at each mall, Alice will leave a stopwatch running until the final items have been dropped off in the car. However, sneaky as she is, Alice will only start timing when she actually starts shopping at the first store they decide to visit. She'd like to know how much time will be spent at each mall - though she's sure that it won't be much at all.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Line 1: 1 integer, $ M $
**For each mall:**
Line 1: 2 integers, $ R $ and $ C $
Next $ R $ lines: $ C $ characters, representing the $ i $ th row of the mall grid, for $ i=1..H $</div>
<h3>输出格式</h3>
<br />
<div>**For each mall:**
1 integer, the minimal number of minutes required to visit all stores and return to the car, as per Alice's stopwatch.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2\n4 4\n..S#\n.##C\n....\nS.#S\n1 5\nSSCSS</code></pre>
<h3>输出样例 #1</h3>
<pre><code></code></pre>
</article>
</div>
</div>
</body>
</html>
