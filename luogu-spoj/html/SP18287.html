<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>IITWPC4K - Maggu and Magguness Level - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450505:2fXxGTA9R8ZK9NtlbU8AAe9oifZRddHKkaYmZCVUajg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Until%20now%20you%20would%20have%20known%20that%20Maggu%20is%20a%20big%20geek.%20His%20class%20has%20n%20students.%20All%20the%20students%20are%20geeks%20like%20him.%20You%20are%20given%20m%20informations%20of%20form%20a%2C%20b%20which%20denotes%20that%20a%20th%20guy%20is%20less%20geeky%20than%20b%20th%20guy%20%28geekiness%28a%29%20%3C%20geekiness%20%28b%29%29.%20Note%20that%20geekiness%20of%20each%20person%20is%20unique%20and%20can%20be%20from%201%20to%20n.%20Now%20Maggu%20wonders%20what%20are%20the%20possible%20values%20of%20his%20geekiness.%20If%20such%20a%20distribution%20of%20geekiness%20value%20is%20not%20possible%2C%20then%20output%20-1.%22%2C%22inputFormat%22%3A%22First%20line%20contains%20T%3A%20number%20of%20test%20cases%20%281%20%3C%3D%20T%20%3C%3D%20100%29.%5Cn%5CnFor%20each%20test%20case%2C%20first%20line%20contains%20n%2C%20m%2C%20idx%20where%20n%20is%20number%20of%20boys%20in%20the%20class%2C%20m%20is%20number%20of%20informations%2C%20idx%20is%20the%20index%20corresponding%20to%20Maggu.%201%20%3C%3D%20n%20%3C%3D%2010%5E6%2C%201%20%3C%3D%20m%20%3C%3D%20min%20%2810%5E5%2C%20n%20%5C%5C%2A%20%28n%20-%201%29%20%5C%2F%202%29%2C%201%3C%3D%20idx%20%3C%3D%20n.%5Cn%5CnThen%20next%20m%20line%20contains%20two%20space%20separated%20integers%20representing%20a%2C%20b.%20%281%20%3C%3D%20a%2C%20b%20%3C%3D%20n%29.%5Cn%5CnNo%20pair%20of%20information%20is%20repeated%20twice%20in%20the%20input.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20You%20have%20to%20output%20one%20or%20two%20lines%20depending%20on%20the%20situation.%20In%20the%20former%20case%2C%20If%20the%20disribution%20of%20geekiness%20can%20not%20exist%2C%20output%20-1.%5Cn%5CnIn%20the%20second%20case%20%28ie%20two%20lines%29%2C%20In%20the%20first%20line%2C%20output%20a%20single%20integer%20number%20of%20possible%20geekiness%20values%20of%20Maggu.%20%20%5CnThen%20in%20the%20next%20line%20output%20in%20the%20increasing%20order%20all%20the%20possible%20geekiness%20values%20of%20Maggu%20in%20ascending%20order.%20All%20the%20values%20should%20be%20space%20seperated.%22%2C%22samples%22%3A%5B%5B%222%5C%5Cn3%202%201%5C%5Cn1%202%5C%5Cn2%203%5C%5Cn4%202%201%5C%5Cn1%202%5C%5Cn3%204%22%2C%221%5C%5Cn1%5C%5Cn3%5Cr%5Cn1%202%203%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F18287%22%2C%22id%22%3A%2218287%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP18287%22%2C%22title%22%3A%22IITWPC4K%20-%20Maggu%20and%20Magguness%20Level%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22IITWPC4K%20-%20Maggu%20and%20Magguness%20Level%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>IITWPC4K - Maggu and Magguness Level</h1>
<h2>题目描述</h2>
<div>Until now you would have known that Maggu is a big geek. His class has n students. All the students are geeks like him. You are given m informations of form a, b which denotes that a th guy is less geeky than b th guy (geekiness(a) < geekiness (b)). Note that geekiness of each person is unique and can be from 1 to n. Now Maggu wonders what are the possible values of his geekiness. If such a distribution of geekiness value is not possible, then output -1.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>First line contains T: number of test cases (1 <= T <= 100).
For each test case, first line contains n, m, idx where n is number of boys in the class, m is number of informations, idx is the index corresponding to Maggu. 1 <= n <= 10^6, 1 <= m <= min (10^5, n \* (n - 1) / 2), 1<= idx <= n.
Then next m line contains two space separated integers representing a, b. (1 <= a, b <= n).
No pair of information is repeated twice in the input.</div>
<h3>输出格式</h3>
<br />
<div>For each test case, You have to output one or two lines depending on the situation. In the former case, If the disribution of geekiness can not exist, output -1.
In the second case (ie two lines), In the first line, output a single integer number of possible geekiness values of Maggu.
Then in the next line output in the increasing order all the possible geekiness values of Maggu in ascending order. All the values should be space seperated.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2\n3 2 1\n1 2\n2 3\n4 2 1\n1 2\n3 4</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1\n1\n3
1 2 3</code></pre>
</article>
</div>
</div>
</body>
</html>
