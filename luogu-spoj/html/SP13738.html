<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>A_W_S_N - Happy Valentine Day (Valentine Maze Game) - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450362:BJ8HygAnWbjfSygglemafBJrjTko/OsS5Z+ef+C/cYo=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%2A%2AHappy%20Valentine%20Day%21%2A%2A%5Cn%5Cn%21%5BValentine%20Maze%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP13738%5C%2F8c007a8c10a111d5aece8f1744482f97847d70d1.png%29%5Cn%5CnPicture%20Source%3A%20%5Bhttp%3A%5C%2F%5C%2Fwww.printactivities.com%5C%2FMazes%5C%2FShape%5C%5C_Mazes%5C%2FHeart%5C%5C_Maze.html%5D%28http%3A%5C%2F%5C%2Fwww.printactivities.com%5C%2FMazes%5C%2FShape_Mazes%5C%2FHeart_Maze.html%20%5C%22VMaze%20Source%5C%22%29%5Cn%5CnIn%20this%20valentine%20day%2C%20Tjandra%20Satria%20Gunawan%20%28TSG%29%20have%20a%20mission%20to%20date%20with%20A%5C%5C%2A%5C%5C%2A%20W%5C%5C%2A%5C%5C%2A%5C%5C%2A%5C%5C%2A%5C%5C%2A%5C%5C%2A%20S%5C%5C%2A%5C%5C%2A%5C%5C%2A%5C%5C%2A%5C%5C%2A%5C%5C%2A%20N%5C%5C%2A%5C%5C%2A%5C%5C%2A%5C%5C%2A%5C%5C%2A%5C%5C%2A%28AWSN%29%2C%20Before%20TSG%20meet%20AWSN%2C%20TSG%20want%20to%20collect%20all%20the%20chocolate%20in%20entire%20land%5C%2Fmaze%20then%20share%20all%20the%20chocolate%20with%20AWSN%20later%2C%20but%20AWSN%20doesn%27t%20like%20to%20wait%2C%20so%20TSG%20must%20collect%20all%20chocolate%20as%20fast%20as%20possible%20before%20meet%20AWSN.%20Please%20help%20TSG%20to%20complete%20this%20mission.%20Given%20a%20map%20size%20%2A%2Am%2A%2A%5Cu00d7%2A%2An%2A%2A%20%281%3C%2A%2Am%2A%2A%2C%2A%2An%2A%2A%5Cn%5Cn%27%2A%2A%5C%5C%23%2A%2A%27%20denoting%20wall%20%28TSG%20can%27t%20walk%20to%20this%20area%29%5Cn%5Cn%27%2A%2A.%2A%2A%27%20denotning%20road%20%28TSG%20can%20walk%20to%20this%20area%29%5Cn%5Cn%27%2A%2AC%2A%2A%27%20denoting%20chocolate%20%28also%20walkable%20area%2C%20appear%20less%20than%2010%20times%20on%20the%20map%29%5Cn%5Cn%27%2A%2AT%2A%2A%27%20denoting%20%2A%2AT%2A%2ASG%20%28also%20walkable%20area%2C%20only%20appear%20once%20on%20the%20map%29%5Cn%5Cn%27%2A%2AW%2A%2A%27%20denoting%20A%2A%2AW%2A%2ASN%20%28also%20walkable%20area%2C%20only%20appear%20once%20on%20the%20map%29%5Cn%5CnTjandra%20can%20move%20up%2C%20down%2C%20left%20or%20right%2C%20and%20cost%20one%20unit%20of%20time%20every%20movement.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%2C%20there%27s%20one%20integer%20%2A%2AT%2A%2A%20%28%2A%2AT%2A%2AT%20case%28s%29%20follow%2C%5Cn%5CnFor%20each%20test%20case%3A%5Cn%5Cn%5C%5C--%3E%20First%20line%20contains%20two%20integers%20%2A%2Am%2A%2A%20and%20%2A%2An%2A%2A%20denoting%20size%20of%20map%5Cn%5Cn%5C%5C--%3E%20next%20%2A%2Am%2A%2A%20line%28s%29%20contains%20%2A%2An%2A%2A%20characters%20that%27s%20the%20map%20description.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20output%20minimum%20of%20tme%20required%20to%20complete%20this%20mission%2C%20if%20it%27s%20impossible%20to%20complete%20this%20mission%2C%20output%20%5C%22Mission%20Failed%21%5C%22%20without%20quotes.%22%2C%22samples%22%3A%5B%5B%228%5Cr%5Cn3%26nbsp%3B3%5Cr%5CnT..%5C%5Cn...%5C%5Cn..W%5Cr%5Cn3%206%5Cr%5Cn%23%23%23%23%23%23%5C%5Cn%23T..W%23%5C%5Cn%23%23%23%23%23%23%5Cr%5Cn3%206%5Cr%5Cn%23%23%23%23%23%23%5C%5Cn%23T%23.W%23%5C%5Cn%23%23%23%23%23%23%5Cr%5Cn3%206%5Cr%5Cn%23%23C%23%23%23%5C%5Cn%23T..W%23%5C%5Cn%23%23%23%23%23%23%5Cr%5Cn3%206%5Cr%5CnC%23C%23%23%23%5C%5Cn.T..W%23%5C%5Cn%23%23%23%23%23%23%5Cr%5Cn5%2010%5Cr%5Cn%23%23%23%23%23%23%23%23%23%23%5C%5Cn%23T.%23.C%23..%23%5C%5Cn%23..%23..%23..%23%5C%5Cn%23..W..%23..%23%5C%5Cn%23%23%23%23%23%23%23%23%23%23%5Cr%5Cn5%2010%5Cr%5Cn%23%23%23%23%23%23%23%23%23%23%5C%5Cn%23T.%23.C%23.C%23%5C%5Cn%23..%23..%23..%23%5C%5Cn%23..W..%23..%23%5C%5Cn%23%23%23%23%23%23%23%23%23%23%5Cr%5Cn5%2010%5Cr%5Cn%23%23%23%23%23%23%23%23%23%23%5C%5Cn%23C.%23.C%23.C%23%5C%5Cn%23..%23..%23..%23%5C%5Cn%23..T..W..%23%5C%5Cn%23%23%23%23%23%23%23%23%23%23%22%2C%22%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B643%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F13738%22%2C%22id%22%3A%2213738%22%7D%2C%22translation%22%3A%22%5Cu9898%5Cu76ee%5Cu63cf%5Cu8ff0%5Cr%5Cn%5Cu60c5%5Cu4eba%5Cu8282%5Cu5feb%5Cu4e50%5Cuff01%5Cr%5Cn%5Cr%5CnValentine%20Maze%5Cr%5Cn%5Cr%5Cn%5Cu56fe%5Cu7247%5Cu6765%5Cu6e90%5Cuff1ahttp%3A%5C%2F%5C%2Fwww.printactivities.com%5C%2FMazes%5C%2FShape_Mazes%5C%2FHeart_Maze.html%5Cr%5Cn%5Cr%5Cn%5Cu5728%5Cu8fd9%5Cu4e2a%5Cu60c5%5Cu4eba%5Cu8282%5Cuff0cTjandra%20Satria%20Gunawan%28TSG%29%5Cu4e0eA%2AW%2AS%2AN%2A%28AWSN%29%5Cu6709%5Cu4e00%5Cu9879%5Cu4efb%5Cu52a1%5Cuff0c%5Cu5728TSG%5Cu9047%5Cu5230AWSN%5Cu4e4b%5Cu524d%5Cuff0cTSG%5Cu5e0c%5Cu671b%5Cu5728%5Cu6574%5Cu4e2a%5Cu571f%5Cu5730%5C%2F%5Cu8ff7%5Cu5bab%5Cu4e2d%5Cu6536%5Cu96c6%5Cu6240%5Cu6709%5Cu5de7%5Cu514b%5Cu529b%5Cuff0c%5Cu7136%5Cu540e%5Cu4e0eAWSN%5Cu5171%5Cu4eab%5Cu6240%5Cu6709%5Cu5de7%5Cu514b%5Cu529b%5Cuff0c%5Cu4f46%5Cu662fAWSN%5Cu4e0d%5Cu559c%5Cu6b22%5Cu7b49%5Cu5f85%5Cuff0c%5Cu6240%5Cu4ee5%5Cu5728%5Cu9047%5Cu5230AWSN%5Cu4e4b%5Cu524d%5Cuff0cTSG%5Cu5fc5%5Cu987b%5Cu5c3d%5Cu5feb%5Cu6536%5Cu96c6%5Cu6240%5Cu6709%5Cu7684%5Cu5de7%5Cu514b%5Cu529b%5Cu3002%5Cu8bf7%5Cu5e2e%5Cu52a9TSG%5Cu5b8c%5Cu6210%5Cu8fd9%5Cu9879%5Cu4efb%5Cu52a1%5Cu3002%5Cu7ed9%5Cu5b9a%5Cu5730%5Cu56fe%5Cu5927%5Cu5c0fm%5Cu00d7n%20%281%3Cm%2Cn%5Cr%5Cn%5Cr%5Cn%27%23%5Cu201c%5Cu6307%5Cu793a%5Cu5899%5Cu201d%28TSG%5Cu4e0d%5Cu80fd%5Cu6b65%5Cu884c%5Cu5230%5Cu8fd9%5Cu4e00%5Cu5730%5Cu533a%29%5Cr%5Cn%5Cr%5Cn%27.%5Cu201c%5Cu6307%5Cu793a%5Cu9053%5Cu8def%5Cu201d%28TSG%5Cu53ef%5Cu6b65%5Cu884c%5Cu5230%5Cu8fd9%5Cu4e00%5Cu5730%5Cu533a%29%5Cr%5Cn%5Cr%5Cn%27C%5Cu201c%5Cu8868%5Cu793a%5Cu5de7%5Cu514b%5Cu529b%28%5Cu4e5f%5Cu662f%5Cu53ef%5Cu6b65%5Cu884c%5Cu7684%5Cu533a%5Cu57df%5Cuff0c%5Cu5728%5Cu5730%5Cu56fe%5Cu4e0a%5Cu51fa%5Cu73b0%5Cu4e0d%5Cu523010%5Cu6b21%29%5Cr%5Cn%5Cr%5Cn%27T%5Cu201c%5Cu8868%5Cu793a%5Cu201dTSG%28%5Cu4e5f%5Cu662f%5Cu53ef%5Cu884c%5Cu8d70%5Cu7684%5Cu533a%5Cu57df%5Cuff0c%5Cu53ea%5Cu5728%5Cu5730%5Cu56fe%5Cu4e0a%5Cu51fa%5Cu73b0%5Cu4e00%5Cu6b21%29%5Cr%5Cn%5Cr%5Cn%27W%5Cu8868%5Cu793aAWSN%28%5Cu4e5f%5Cu662f%5Cu53ef%5Cu6b65%5Cu884c%5Cu7684%5Cu533a%5Cu57df%5Cuff0c%5Cu53ea%5Cu5728%5Cu5730%5Cu56fe%5Cu4e0a%5Cu51fa%5Cu73b0%5Cu4e00%5Cu6b21%29%5Cr%5Cn%5Cr%5CnTjandra%5Cu53ef%5Cu4ee5%5Cu5411%5Cu4e0a%5Cu3001%5Cu5411%5Cu4e0b%5Cu3001%5Cu5de6%5Cu6216%5Cu53f3%5Cu79fb%5Cu52a8%5Cuff0c%5Cu6bcf%5Cu4e00%5Cu6b21%5Cu79fb%5Cu52a8%5Cu90fd%5Cu8981%5Cu82b1%5Cu8d39%5Cu4e00%5Cu4e2a%5Cu5355%5Cu4f4d%5Cu7684%5Cu65f6%5Cu95f4%5Cu5355%5Cu4f4d%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cuff1a%5Cr%5Cn%5Cu8f93%5Cu5165%5Cu7684%5Cu7b2c%5Cu4e00%5Cu884c%5Cuff0c%5Cu6709%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570T%20%28T%5Cu63a5%5Cu4e0b%5Cu53bb%5Cuff0c%5Cr%5Cn%5Cr%5Cn%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e2a%5Cu6d4b%5Cu8bd5%5Cu7528%5Cu4f8b%5Cuff1a%5Cr%5Cn%5Cr%5Cn-%3E%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5305%5Cu542b%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570m%5Cu548cn%5Cu5730%5Cu56fe%5Cu8868%5Cu793a%5Cu5c3a%5Cu5bf8%5Cr%5Cn%5Cr%5Cn-%3E%5Cu4e0b%5Cu4e00%5Cu4e2am%5Cu884c%5Cu5305%5Cu542bn%5Cu8fd9%5Cu662f%5Cu5730%5Cu56fe%5Cu63cf%5Cu8ff0%5Cu7684%5Cu5b57%5Cu7b26%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cuff1a%5Cr%5Cn%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e2a%5Cu6d4b%5Cu8bd5%5Cu7528%5Cu4f8b%5Cuff0c%5Cu5b8c%5Cu6210%5Cu6b64%5Cu4efb%5Cu52a1%5Cu6240%5Cu9700%5Cu7684%5Cu6700%5Cu5c0f%5Cu8f93%5Cu51fa%5Cuff0c%5Cu5982%5Cu679c%5Cu65e0%5Cu6cd5%5Cu5b8c%5Cu6210%5Cu6b64%5Cu4efb%5Cu52a1%5Cuff0c%5Cu5219%5Cu8f93%5Cu51fa%5Cu201c%5Cu4efb%5Cu52a1%5Cu5931%5Cu8d25%5Cuff01%5Cu201d%5Cu6ca1%5Cu6709%5Cu5f15%5Cu53f7%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu6837%5Cu4f8b%5Cr%5Cn%5Cu8f93%5Cu5165%5Cu6837%5Cu4f8b%231%5Cuff1a%20%5Cu590d%5Cu5236%5Cr%5Cn8%5Cr%5Cn3%26nbsp%3B3%5Cr%5CnT..%5C%5Cn...%5C%5Cn..W%5Cr%5Cn3%206%5Cr%5Cn%23%23%23%23%23%23%5C%5Cn%23T..W%23%5C%5Cn%23%23%23%23%23%23%5Cr%5Cn3%206%5Cr%5Cn%23%23%23%23%23%23%5C%5Cn%23T%23.W%23%5C%5Cn%23%23%23%23%23%23%5Cr%5Cn3%206%5Cr%5Cn%23%23C%23%23%23%5C%5Cn%23T..W%23%5C%5Cn%23%23%23%23%23%23%5Cr%5Cn3%206%5Cr%5CnC%23C%23%23%23%5C%5Cn.T..W%23%5C%5Cn%23%23%23%23%23%23%5Cr%5Cn5%2010%5Cr%5Cn%23%23%23%23%23%23%23%23%23%23%5C%5Cn%23T.%23.C%23..%23%5C%5Cn%23..%23..%23..%23%5C%5Cn%23..W..%23..%23%5C%5Cn%23%23%23%23%23%23%23%23%23%23%5Cr%5Cn5%2010%5Cr%5Cn%23%23%23%23%23%23%23%23%23%23%5C%5Cn%23T.%23.C%23.C%23%5C%5Cn%23..%23..%23..%23%5C%5Cn%23..W..%23..%23%5C%5Cn%23%23%23%23%23%23%23%23%23%23%5Cr%5Cn5%2010%5Cr%5Cn%23%23%23%23%23%23%23%23%23%23%5C%5Cn%23C.%23.C%23.C%23%5C%5Cn%23..%23..%23..%23%5C%5Cn%23..T..W..%23%5C%5Cn%23%23%23%23%23%23%23%23%23%23%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP13738%22%2C%22title%22%3A%22A_W_S_N%20-%20Happy%20Valentine%20Day%20%28Valentine%20Maze%20Game%29%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A49509%2C%22title%22%3A%22%5Cu5783%5Cu573e%5Cu7684%5Cu7ffb%5Cu8bd1%22%2C%22forum%22%3A%7B%22id%22%3A15221%2C%22name%22%3A%22SP13738%20A_W_S_N%20-%20Happy%20Valentine%20Day%20%28Valentine%20Maze%20Game%29%22%2C%22slug%22%3A%22SP13738%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22A_W_S_N%20-%20Happy%20Valentine%20Day%20%28Valentine%20Maze%20Game%29%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>A_W_S_N - Happy Valentine Day (Valentine Maze Game)</h1>
<h2>题意翻译</h2>
<div>题目描述
情人节快乐！
Valentine Maze
图片来源：http://www.printactivities.com/Mazes/Shape_Mazes/Heart_Maze.html
在这个情人节，Tjandra Satria Gunawan(TSG)与A*W*S*N*(AWSN)有一项任务，在TSG遇到AWSN之前，TSG希望在整个土地/迷宫中收集所有巧克力，然后与AWSN共享所有巧克力，但是AWSN不喜欢等待，所以在遇到AWSN之前，TSG必须尽快收集所有的巧克力。请帮助TSG完成这项任务。给定地图大小m×n (1<m,n '#“指示墙”(TSG不能步行到这一地区)

'.“指示道路”(TSG可步行到这一地区) 'C“表示巧克力(也是可步行的区域，在地图上出现不到10次)

'T“表示”TSG(也是可行走的区域，只在地图上出现一次) 'W表示AWSN(也是可步行的区域，只在地图上出现一次)

Tjandra可以向上、向下、左或右移动，每一次移动都要花费一个单位的时间单位。

输入输出格式
输入格式：
输入的第一行，有一个整数T (T接下去，

对于每个测试用例：

->第一行包含两个整数m和n地图表示尺寸

->下一个m行包含n这是地图描述的字符。

输出格式：
对于每个测试用例，完成此任务所需的最小输出，如果无法完成此任务，则输出“任务失败！”没有引号。

输入输出样例
输入样例#1： 复制
8
3&nbsp;3
T..\n...\n..W
3 6
######\n#T..W#\n######
3 6
######\n#T#.W#\n######
3 6
##C###\n#T..W#\n######
3 6
C#C###\n.T..W#\n######
5 10
##########\n#T.#.C#..#\n#..#..#..#\n#..W..#..#\n##########
5 10
##########\n#T.#.C#.C#\n#..#..#..#\n#..W..#..#\n##########
5 10
##########\n#C.#.C#.C#\n#..#..#..#\n#..T..W..#\n##########</div>
    
    
    <h2>题目描述</h2>
    <div>**Happy Valentine Day!**

![Valentine Maze](https://cdn.luogu.com.cn/upload/vjudge_pic/SP13738/8c007a8c10a111d5aece8f1744482f97847d70d1.png)

Picture Source: [http://www.printactivities.com/Mazes/Shape\_Mazes/Heart\_Maze.html](http://www.printactivities.com/Mazes/Shape_Mazes/Heart_Maze.html "VMaze Source")

In this valentine day, Tjandra Satria Gunawan (TSG) have a mission to date with A\*\* W\*\*\*\*\*\* S\*\*\*\*\*\* N\*\*\*\*\*\*(AWSN), Before TSG meet AWSN, TSG want to collect all the chocolate in entire land/maze then share all the chocolate with AWSN later, but AWSN doesn't like to wait, so TSG must collect all chocolate as fast as possible before meet AWSN. Please help TSG to complete this mission. Given a map size **m**×**n** (1<**m**,**n** '**\#**' denoting wall (TSG can't walk to this area)

'**.**' denotning road (TSG can walk to this area)

'**C**' denoting chocolate (also walkable area, appear less than 10 times on the map)

'**T**' denoting **T**SG (also walkable area, only appear once on the map)

'**W**' denoting A**W**SN (also walkable area, only appear once on the map)

Tjandra can move up, down, left or right, and cost one unit of time every movement.</div>

    <h2>输入输出格式</h2>
    <h3>输入格式</h3>
    <br />
    <div>The first line of input, there's one integer **T** (**T**T case(s) follow, For each test case: \--> First line contains two integers **m** and **n** denoting size of map
\--> next **m** line(s) contains **n** characters that's the map description.</div>
<h3>输出格式</h3>
<br />
<div>For each test case, output minimum of tme required to complete this mission, if it's impossible to complete this mission, output "Mission Failed!" without quotes.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>8
3&amp;nbsp;3
T..\n...\n..W
3 6
######\n#T..W#\n######
3 6
######\n#T#.W#\n######
3 6
##C###\n#T..W#\n######
3 6
C#C###\n.T..W#\n######
5 10
##########\n#T.#.C#..#\n#..#..#..#\n#..W..#..#\n##########
5 10
##########\n#T.#.C#.C#\n#..#..#..#\n#..W..#..#\n##########
5 10
##########\n#C.#.C#.C#\n#..#..#..#\n#..T..W..#\n##########</code></pre>
<h3>输出样例 #1</h3>
<pre><code></code></pre>
</article>
</div>
</div>
</body>
</html>
