<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>PROBMOR - Problems in Moria - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450232:V1p7WVwYjVOD2Mja5Aw14363Pm02wq8AxBVZ2QuxRCc=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Balin%2C%20in%20his%20last%20days%2C%20needed%20to%20put%20more%20workers%20on%20the%20tunnels%20of%20Moria%20to%20build%20a%20%20%5Cnlot%20of%20shelters%20to%20his%20people%20and%20to%20discovery%20the%20depths%20of%20that%20land.%20However%2C%20he%20didn%27t%20know%20%20%5Cnwhere%20to%20put%20a%20collection%20point%20in%20order%20to%20take%20all%20the%20rocks%20in%20the%20way%20and%20bring%20all%20of%20them%20%20%5Cnoutside%20of%20Moria.%20The%20only%20thing%20he%20knew%20was%20this%20collection%20point%20needed%20to%20be%20fix%20in%20a%20%20%5Cnjunction%20point%20that%20connects%20two%20independent%20parts.%20If%20there%27s%20no%20point%20with%20this%20feature%2C%20any%20%20%5Cnjunction%20point%2C%20that%27s%20not%20the%20source%20one%2C%20can%20be%20used.%22%2C%22inputFormat%22%3A%22The%20input%20contains%20several%20test%20cases.%20Each%20test%20is%20given%20by%20a%20line%20with%20two%20integers%20%20%5CnX%20%5Cue09e0%5Cue084%20X%20number%20of%20tunnels.%20Then%2C%20the%20next%20Y%20lines%20are%20followed%20by%20three%20integers%3A%20A%5Cue09e%200%5Cue084%20AB%20%5Cue09e0%5Cue084Bcapacity%20C%20of%20workers%20that%20can%20walk%20through%20there.%20After%20that%2C%20there%27s%20a%20line%20with%20only%20one%20%20%5Cninteger%20which%20is%20the%20start%20point%2C%20in%20the%20other%20words%2C%20the%20point%20where%20the%20workers%20are%20divided.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20display%20it%27s%20case%20number%20followed%20by%20a%20blank%20line.%20In%20the%20next%20line%20%20%5Cndisplay%20the%20number%20Z%20of%20points%20that%20can%20be%20used%20as%20a%20collection%20point%20and%2C%20in%20the%20next%20Z%20%20%5Cnlines%20shows%20in%20decreasing%20order%20the%20maximum%20number%20of%20workers%20that%20can%20be%20used.%20%20%5CnEach%20test%20case%20is%20separated%20by%20a%20blank%20line%20as%20the%20sample%20output.%22%2C%22samples%22%3A%5B%5B%2245%20%5C%5Cn125%20%5C%5Cn148%20%5C%5Cn233%20%5C%5Cn2%204%2011%20%5C%5Cn346%20%5C%5Cn1%20%5C%5Cn56%20%5C%5Cn125%20%5C%5Cn148%20%5C%5Cn233%20%5C%5Cn2%204%2011%20%5C%5Cn346%20%5C%5Cn4%205%2012%20%5C%5Cn2%22%2C%22Case%201%5C%5CnPoints%3A%203%5C%5Cn13%5C%5Cn13%5C%5Cn9%5C%5CnCase%202%5C%5CnPoints%3A%201%5C%5Cn19%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F10586%22%2C%22id%22%3A%2210586%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP10586%22%2C%22title%22%3A%22PROBMOR%20-%20Problems%20in%20Moria%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22PROBMOR%20-%20Problems%20in%20Moria%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>PROBMOR - Problems in Moria</h1>
<h2>题目描述</h2>
<div>Balin, in his last days, needed to put more workers on the tunnels of Moria to build a
lot of shelters to his people and to discovery the depths of that land. However, he didn't know
where to put a collection point in order to take all the rocks in the way and bring all of them
outside of Moria. The only thing he knew was this collection point needed to be fix in a
junction point that connects two independent parts. If there's no point with this feature, any
junction point, that's not the source one, can be used.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The input contains several test cases. Each test is given by a line with two integers
X 0 X number of tunnels. Then, the next Y lines are followed by three integers: A 0 AB 0Bcapacity C of workers that can walk through there. After that, there's a line with only one
integer which is the start point, in the other words, the point where the workers are divided.</div>
<h3>输出格式</h3>
<br />
<div>For each test case, display it's case number followed by a blank line. In the next line
display the number Z of points that can be used as a collection point and, in the next Z
lines shows in decreasing order the maximum number of workers that can be used.
Each test case is separated by a blank line as the sample output.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>45 \n125 \n148 \n233 \n2 4 11 \n346 \n1 \n56 \n125 \n148 \n233 \n2 4 11 \n346 \n4 5 12 \n2</code></pre>
<h3>输出样例 #1</h3>
<pre><code>Case 1\nPoints: 3\n13\n13\n9\nCase 2\nPoints: 1\n19</code></pre>
</article>
</div>
</div>
</body>
</html>
