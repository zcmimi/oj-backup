<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>ALTARS - The Altars - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449553:NPVvwjw+Tpgo+GIuBvkmB4SpCDJ373FGHyxxjrzxP+A=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%20According%20to%20Chinese%20folk%20beliefs%20evil%20spirits%20can%20move%20only%20on%20a%20straight%20line.%20It%20is%20of%20a%20great%20importance%20when%20temples%20are%20built.%20The%20temples%20are%20constructed%20on%20rectangular%20planes%20with%20sides%20parallel%20to%20the%20north%20-%20south%20or%20east%20-%20west%20directions.%20No%20two%20of%20the%20rectangles%20have%20common%20points.%20An%20entrance%20is%20situated%20in%20the%20middle%20of%20one%20of%20four%20walls%20and%20its%20width%20is%20equal%20to%20the%20half%20of%20the%20length%20of%20the%20wall.%20An%20altar%20appears%20in%20the%20center%20of%20the%20temple%2C%20where%20diagonals%20of%20the%20rectangle%20intersect.%20If%20an%20evil%20spirit%20appears%20in%20this%20point%2C%20a%20temple%20will%20be%20profaned.%20It%20may%20happen%20only%20if%20there%20exists%20a%20ray%20which%20runs%20from%20an%20altar%2C%20through%20an%20entrance%20to%20infinity%20and%20neither%20intersects%20nor%20touches%20walls%20of%20any%20temple%20%28on%20a%20plane%20parallel%20to%20the%20plane%20of%20a%20construction%20area%29%2C%20i.e.%20one%20can%20draw%20at%20a%20construction%20area%20a%20line%20which%20starts%20at%20the%20altar%20and%20runs%20to%20the%20infinity%20without%20touching%20any%20wall.%5Cn%5Cn%20%20%20%5Cn%23%23%23%20Task%5Cn%5Cn%20Write%20a%20program%20which%3A%5Cn%5Cn-%20reads%20descriptions%20of%20the%20temples%20from%20the%20standard%20input%2C%5Cn-%20verifies%20which%20temples%20could%20be%20profaned%2C%5Cn-%20writes%20their%20numbers%20to%20the%20standard%20output.%22%2C%22inputFormat%22%3A%22%20The%20number%20of%20test%20cases%20t%20is%20in%20the%20first%20line%20of%20input%2C%20then%20t%20test%20cases%20follow%20separated%20by%20an%20empty%20line.%20In%20the%20first%20line%20of%20each%20test%20case%20one%20integer%20_n_%2C%20the%20number%20of%20temples%20%20_1%20%3C%3D%20n%20%3C%3D%201000%2C_%20is%20written.%5Cn%5Cn%20In%20each%20of%20the%20following%20%20_n_%20lines%20there%20is%20a%20description%20of%20one%20temple%20%28in%20_i_-th%20line%20a%20description%20of%20the%20_i-_th%20temple%29.%20The%20description%20of%20a%20temple%20consists%20of%20four%20non-negative%20integers%2C%20not%20greater%20than%208000%20and%20a%20letter%20E%2C%20W%2C%20S%20or%20N.%20Two%20first%20numbers%20are%20coordinates%20of%20a%20temple%27s%20northern-west%20corner%20and%20two%20following%20are%20coordinates%20of%20an%20opposite%20southern-east%20corner.%20In%20order%20to%20specify%20coordinates%20of%20a%20point%20first%20we%20give%20its%20geographical%20longitude%2C%20which%20increases%20from%20the%20west%20to%20the%20east%2C%20and%20then%20its%20latitude%2C%20which%20increases%20from%20the%20south%20to%20the%20north.%20The%20fifth%20element%20of%20the%20description%20indicates%20the%20wall%20with%20the%20entrance%20%28E%20-%20Eastern%2C%20W%20-%20Western%2C%20S%20-%20Southern%2C%20N%20-%20Northern%29.%20The%20elements%20of%20the%20temple%27s%20description%20are%20separated%20by%20single%20spaces.%22%2C%22outputFormat%22%3A%22In%20the%20following%20lines%20of%20the%20output%20for%20each%20test%20case%20your%20program%20should%20write%20in%20ascending%20order%20numbers%20of%20the%20temples%2C%20which%20may%20be%20profaned%20by%20an%20evil%20spirit.%20Each%20number%20is%20placed%20in%20a%20separate%20line.%20If%20there%20are%20no%20such%20numbers%2C%20you%20should%20write%20one%20word%3A%20NONE.%22%2C%22samples%22%3A%5B%5B%226%5Cr%5Cn1%207%204%201%20E%5Cr%5Cn3%209%2011%208%20S%5Cr%5Cn6%207%2010%204%20N%5Cr%5Cn8%203%2010%201%20N%5Cr%5Cn11%204%2013%201%20E%5Cr%5Cn14%208%2020%207%20W%22%2C%221%5Cr%5Cn2%5Cr%5Cn5%5Cr%5Cn6%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1318%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F210%22%2C%22id%22%3A%22210%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP210%22%2C%22title%22%3A%22ALTARS%20-%20The%20Altars%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22ALTARS%20-%20The%20Altars%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>ALTARS - The Altars</h1>
<h2>题目描述</h2>
<div> According to Chinese folk beliefs evil spirits can move only on a straight line. It is of a great importance when temples are built. The temples are constructed on rectangular planes with sides parallel to the north - south or east - west directions. No two of the rectangles have common points. An entrance is situated in the middle of one of four walls and its width is equal to the half of the length of the wall. An altar appears in the center of the temple, where diagonals of the rectangle intersect. If an evil spirit appears in this point, a temple will be profaned. It may happen only if there exists a ray which runs from an altar, through an entrance to infinity and neither intersects nor touches walls of any temple (on a plane parallel to the plane of a construction area), i.e. one can draw at a construction area a line which starts at the altar and runs to the infinity without touching any wall.
### Task
Write a program which:
- reads descriptions of the temples from the standard input,
- verifies which temples could be profaned,
- writes their numbers to the standard output.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div> The number of test cases t is in the first line of input, then t test cases follow separated by an empty line. In the first line of each test case one integer _n_, the number of temples _1 <= n <= 1000,_ is written.
In each of the following _n_ lines there is a description of one temple (in _i_-th line a description of the _i-_th temple). The description of a temple consists of four non-negative integers, not greater than 8000 and a letter E, W, S or N. Two first numbers are coordinates of a temple's northern-west corner and two following are coordinates of an opposite southern-east corner. In order to specify coordinates of a point first we give its geographical longitude, which increases from the west to the east, and then its latitude, which increases from the south to the north. The fifth element of the description indicates the wall with the entrance (E - Eastern, W - Western, S - Southern, N - Northern). The elements of the temple's description are separated by single spaces.</div>
<h3>输出格式</h3>
<br />
<div>In the following lines of the output for each test case your program should write in ascending order numbers of the temples, which may be profaned by an evil spirit. Each number is placed in a separate line. If there are no such numbers, you should write one word: NONE.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6
1 7 4 1 E
3 9 11 8 S
6 7 10 4 N
8 3 10 1 N
11 4 13 1 E
14 8 20 7 W</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
2
5
6</code></pre>
</article>
</div>
</div>
</body>
</html>
