<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>ESCJAILA - Escape from Jail Again - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450038:HlG/GIZ8rBJVhC0QGZx7hLil8PRCiS1sTJuKndgT06E=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22A%20new%20International%20Common%20Prison%20for%20Criminals%20%28ICPC%29%20was%20built%2C%20and%20your%20old%20friend%20%20%5CnHarry%20was%20moved%20there%20as%20a%20prisoner.%20As%20before%2C%20the%20new%20ICPC%20is%20one%20of%20the%20most%20secure%20%20%5Cnprisons%20in%20the%20world.%20It%20was%20designed%20by%20and%20old%20gamer%20and%20as%20such%2C%20the%20prison%20is%20not%20%20%5Cnnecessarily%20closed%2C%20but%20only%20an%20incredibly%20logical%20and%20fast%20mind%20can%20get%20out.%20%20%5CnThe%20new%20ICPC%20can%20be%20represented%20as%20a%20grid%20of%20square%20cells.%20Each%20cell%20is%20empty%2C%20or%20it%20%20%5Cncontains%20a%20wall%2C%20a%20door%2C%20an%20opening%20button%20or%20a%20closing%20button.%20Harry%20was%20accommodated%20%20%5Cnin%20an%20empty%20cell%2C%20and%20all%20doors%20were%20closed.%20Nevertheless%2C%20Harry%20told%20you%20that%20he%20will%20%20%5Cntry%20to%20escape.%20Each%20time%20Harry%20is%20in%20a%20cell%2C%20he%20can%20move%20in%20a%20single%20step%20to%20an%20adjacent%20%20%5Cncell%20%28i.e.%2C%20a%20cell%20that%20shares%20a%20side%20with%20his%20current%20location%29.%20Each%20time%20Harry%20steps%20on%20a%20%20%5Cncell%20that%20contains%20an%20opening%20button%2C%20all%20doors%20open%2C%20while%20each%20time%20he%20steps%20on%20a%20cell%20%20%5Cnthat%20contains%20a%20closing%20button%2C%20all%20doors%20close.%20Harry%20can%20walk%20around%20as%20he%20wants%20within%20%20%5Cnthe%20prison%2C%20although%20he%20cannot%20move%20to%20a%20cell%20that%20contains%20a%20wall%2C%20neither%20to%20a%20cell%20that%20%20%5Cncontains%20a%20door%20if%20the%20doors%20are%20closed.%20%20%5CnTo%20escape%20from%20the%20prison%2C%20Harry%20needs%20to%20step%20outside%2C%20which%20means%20placing%20himself%20in%20%20%5Cnone%20of%20the%20cells%20on%20the%20sides%20and%20then%20taking%20one%20extra%20step%20out%20in%20the%20direction%20opposite%20%20%5Cnto%20the%20prison.%20%20%5CnYou%20obtained%20a%20map%20of%20the%20prison%2C%20and%20Harry%20deserves%20your%20advise.%20Tell%20him%20the%20minimum%20%20%5Cnnumber%20of%20steps%20he%20needs%20to%20escape%2C%20or%20warn%20him%20that%20there%20is%20no%20way%20to%20get%20out.%22%2C%22inputFormat%22%3A%22Each%20test%20case%20is%20described%20using%20several%20lines.%20The%20first%20line%20contains%20two%20integers%20N%20and%20%20%5CnM%20indicating%20respectively%20the%20number%20of%20rows%20and%20columns%20of%20the%20grid%20that%20represents%20%20%5Cnthe%20prison%20%281%20using%20a%20string%20of%20exactly%20M%20characters%2C%20where%20character%20j%20represents%20cell%20j%20of%20that%20row.%20%20%5CnThis%20string%20only%20contains%20the%20following%20characters%20with%20the%20indicated%20meanings%3A%20%5Cu201cH%5Cu201d%20is%20%20%5Cnthe%20empty%20cell%20where%20Harry%20is%20at%20the%20beginning%3B%20%5Cu201c.%5Cu201d%20is%20an%20empty%20cell%20where%20Harry%20is%20not%20%20%5Cnat%20the%20beginning%3B%20%5Cu201cW%5Cu201d%20is%20a%20wall%3B%20%5Cu201cD%5Cu201d%20is%20a%20door%3B%20%5Cu201cO%5Cu201d%20is%20an%20opening%20button%3B%20and%20%5Cu201cC%5Cu201d%20is%20closing%20%20%5Cnbutton.%20You%20may%20assume%20that%20within%20each%20test%20case%20there%20is%20exactly%20one%20character%20%5Cu201cH%5Cu201d.%20%20%5CnThe%20end%20of%20input%20is%20indicated%20with%20a%20line%20containing%20the%20number%20%5Cu22121%20twice.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20output%20a%20single%20line%20with%20a%20single%20integer%20representing%20the%20minimum%20%20%5Cnnumber%20of%20steps%20Harry%20needs%20to%20escape%20the%20prison%2C%20or%20the%20number%20%5Cu22121%20if%20it%20is%20impossible%20%20%5Cnfor%20him%20to%20do%20so.%22%2C%22samples%22%3A%5B%5B%22%5C%5Cn5%208%5C%5CnWWWWWWW.%5C%5CnWHDC...D%5C%5CnW.WW.WCW%5C%5CnW.OW..OW%5C%5Cn.WWWWWWW%5C%5Cn3%203%5C%5CnODO%5C%5CnDHD%5C%5CnODO%5C%5Cn3%207%5C%5CnWWWWWWW%5C%5CnDH..OCD%5C%5CnWWWWWWW%5C%5Cn4%201%5C%5CnW%5C%5CnH%5C%5CnO%5C%5CnW%5C%5Cn1%2013%5C%5CnHOW.DO.COW.DO%5C%5Cn-1%20-1%22%2C%22%5C%5Cn21%5C%5Cn-1%5C%5Cn8%5C%5Cn1%5C%5Cn1%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B297%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F7422%22%2C%22id%22%3A%227422%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP7422%22%2C%22title%22%3A%22ESCJAILA%20-%20Escape%20from%20Jail%20Again%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22ESCJAILA%20-%20Escape%20from%20Jail%20Again%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>ESCJAILA - Escape from Jail Again</h1>
<h2>题目描述</h2>
<div>A new International Common Prison for Criminals (ICPC) was built, and your old friend
Harry was moved there as a prisoner. As before, the new ICPC is one of the most secure
prisons in the world. It was designed by and old gamer and as such, the prison is not
necessarily closed, but only an incredibly logical and fast mind can get out.
The new ICPC can be represented as a grid of square cells. Each cell is empty, or it
contains a wall, a door, an opening button or a closing button. Harry was accommodated
in an empty cell, and all doors were closed. Nevertheless, Harry told you that he will
try to escape. Each time Harry is in a cell, he can move in a single step to an adjacent
cell (i.e., a cell that shares a side with his current location). Each time Harry steps on a
cell that contains an opening button, all doors open, while each time he steps on a cell
that contains a closing button, all doors close. Harry can walk around as he wants within
the prison, although he cannot move to a cell that contains a wall, neither to a cell that
contains a door if the doors are closed.
To escape from the prison, Harry needs to step outside, which means placing himself in
one of the cells on the sides and then taking one extra step out in the direction opposite
to the prison.
You obtained a map of the prison, and Harry deserves your advise. Tell him the minimum
number of steps he needs to escape, or warn him that there is no way to get out.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Each test case is described using several lines. The first line contains two integers N and
M indicating respectively the number of rows and columns of the grid that represents
the prison (1 using a string of exactly M characters, where character j represents cell j of that row.
This string only contains the following characters with the indicated meanings: “H” is
the empty cell where Harry is at the beginning; “.” is an empty cell where Harry is not
at the beginning; “W” is a wall; “D” is a door; “O” is an opening button; and “C” is closing
button. You may assume that within each test case there is exactly one character “H”.
The end of input is indicated with a line containing the number −1 twice.</div>
<h3>输出格式</h3>
<br />
<div>For each test case, output a single line with a single integer representing the minimum
number of steps Harry needs to escape the prison, or the number −1 if it is impossible
for him to do so.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>\n5 8\nWWWWWWW.\nWHDC...D\nW.WW.WCW\nW.OW..OW\n.WWWWWWW\n3 3\nODO\nDHD\nODO\n3 7\nWWWWWWW\nDH..OCD\nWWWWWWW\n4 1\nW\nH\nO\nW\n1 13\nHOW.DO.COW.DO\n-1 -1</code></pre>
<h3>输出样例 #1</h3>
<pre><code>\n21\n-1\n8\n1\n1</code></pre>
</article>
</div>
</div>
</body>
</html>
