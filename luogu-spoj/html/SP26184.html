<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>JC15F - Colorful Beads - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450638:yvuzV5MqjUNbjnfYcKAMjcsB116SzGkZ2hoK3ZEKYvs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%2A%2AColorful%20Beads%2A%2A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP26184%5C%2F3e60a8764beaa3aa01992f6a9de8523c087c0434.png%29%5Cn%5CnYay%2C%20today%20is%20colorful%20day%21%20why%3F%20because%20there%20are%20so%20many%20colorful%20beads%20on%20the%20table.%20Satria%20want%20to%20make%20a%20necklace%20using%20all%20that%20available%20beads%2C%20in%20order%20to%20make%20the%20necklace%20most%20valuable%2C%20Satria%20arrange%20the%20beads%20using%20magic%20secret%20formula.%20Gunawan%20secretly%20want%20to%20know%20Satria%27s%20secret%20formula%2C%20so%20he%20try%20all%20possible%20beads%20combination%20until%20the%20beads%20become%20most%20valuable%2C%20at%20first%20he%20easily%20found%20the%20most%20valuable%20beads%20combination%20for%20small%20number%20of%20beads%2C%20but%20he%20can%27t%20derive%20general%20formula%2C%20he%20keeps%20trying%2C%20and%20tying%2C%20and%20trying...%20Never%20give%20up%21%5Cn%5CnSomeday%2C%20Tjandra%20meet%20Gunawan%20and%20suggest%20him%20to%20not%20continuing%20his%20bruteforce%20action%20because%20the%20number%20of%20possible%20combinations%20are%20too%20many.%20Gunawan%20doesn%27t%20believe%20that%20and%20ask%20Tjandra%20to%20show%20him%20number%20of%20possible%20combinations.%5Cn%5CnGunawan%20said%3A%20%5C%22If%20I%20have%20this%20N%20beads%20how%20many%20combinations%20are%20there%3F%5C%22%20%20%5CnTjandra%20replied%3A%20%5C%22It%27s%20N%20facorial%20combinations%5C%22%20%20%5CnGunawan%20replied%3A%20%5C%22But%20that%27s%20not%20always%20true%20some%20of%20my%20beads%20has%20more%20than%20one%20color%2C%20so%20if%20I%20swap%20beads%20with%20same%20color%20doesn%27t%20change%20tha%20necklace%20value%5C%22%20%20%5CnTjandra%20replied%3A%20%5C%22Okay%2C%20tell%20me%20the%20details%20of%20your%20beads%5C%22%20%20%5CnGunawan%20replied%3A%20%5C%22My%20beads%20has%20M%20distinct%20colors%2C%20it%20has%20K%20%24%20_%7B1%7D%20%24%20beads%20of%20color%201%2C%20K%20%24%20_%7B2%7D%20%24%20beads%20of%20color%202%2C%20...%20%2C%20K%20%24%20_%7BM%7D%20%24%20beads%20of%20color%20M%5C%22%20%20%5CnTjandra%20replied%3A%20%5C%22It%20will%20have%20F%28K%20%24%20_%7B1%7D%20%24%20%2BK%20%24%20_%7B2%7D%20%24%20%2B...%2BK%20%24%20_%7BM%7D%20%24%20%29%5C%2F%28F%28K%20%24%20_%7B1%7D%20%24%20%29%5C%5C%2AF%28K%20%24%20_%7B2%7D%20%24%20%29%5C%5C%2A...%5C%5C%2AF%28K%20%24%20_%7BM%7D%20%24%20%29%29%20combinations%20where%20F%28N%29%20means%20N%20factorial%5C%22%20%20%5Cn%285%20minutes%20later%29%20%20%5CnGunawan%20said%3A%20%5C%22Hey%2C%20your%20formula%20is%20not%20true%2C%20I%20tried%20it%20with%202%20green%20beads%20and%202%20blue%20beads%2C%20your%20formula%20showed%20F%282%2B2%29%5C%2F%28F%282%29%5C%5C%2AF%282%29%29%20%3D%2024%5C%2F%282%5C%5C%2A2%29%20%3D%206%20combinations%2C%20but%20actually%20it%20has%20only%202%20combinations%5C%22%20%20%5CnTjandra%20confidently%20replied%3A%20%5C%22I%27m%20good%20at%20math%2C%20I%27m%20sure%20my%20formula%20is%20correct%5C%22%20%20%5CnGunawan%20replied%3A%20%5C%22I%20made%20these%20two%20different%20necklace%3A%20%7B1%3A%7Bg%2Cg%2Cb%2Cb%7D%2C2%3A%7Bg%2Cb%2Cg%2Cb%7D%7D%20%5C%5C%5Bg%3Dgreen%20beads%2C%20b%3Dblue%20beads%5C%5C%5D%20can%20you%20make%20the%20third%20necklace%20that%20is%20different%20than%20both%20of%20these%3F%5C%22%20%20%5CnTjandra%20replied%3A%20%5C%22That%27s%20easy%2C%20here%20is%20the%20third%20necklace%3A%20%7Bb%2Cg%2Cb%2Cg%7D%20%5C%22%20%20%5CnGunawan%20replied%20after%20rotating%20that%20necklace%3A%20%5C%22Look%2C%20your%20neclace%20become%20equal%20to%20my%20second%20necklace%3A%20%7Bb%2Cg%2Cb%2Cg%7D%20-%3E%20%7Bg%2Cb%2Cg%2Cb%7D%5C%22%20%20%5CnTjandra%20replied%3A%20%5C%22Oops%2C%20I%20forgot%20about%20necklace%20rotation%2C%20you%27really%20smart%20bruteforcer%2C%20why%20you%20don%27t%20believe%20me%20that%20number%20of%20combination%20is%20too%20many%20even%20though%20it%27s%20a%20little%20bit%20smaller%20than%20my%20calculation%5C%22%20%20%5CnGunawan%20replied%3A%20%5C%22A%20little%20bit%3F%20do%20you%20think%206%20and%202%20is%20little%20difference%3F%5C%22%20%20%5CnTjandra%20replied%3A%20%5C%22huh%20-%5C%5C_-%20I%20can%20show%20you%20that%20the%20exact%20number%20of%20distinct%20combinations%2C%20but%20unfortunately%20the%20formula%20become%20too%20complex%20and%20I%20don%27t%20bring%20a%20computer%2C%20is%20there%20any%20computer%20here%3F%5C%22%20%20%5CnGunawan%20replied%3A%20%5C%22No%2C%20I%27m%20also%20don%27t%20have%20a%20computer%5C%22%5Cn%5CnNow%20Tjandra%20call%20you%20using%20his%20old%20phone%20for%20help%2C%20because%20he%20know%20that%20now%20you%27re%20sitting%20in%20front%20of%20your%20computer.%20Can%20you%20help%20them%3F%5Cn%5Cn%2A%2AInput%2A%2A%5Cn%5CnThe%20first%20line%20there%20is%20an%20integer%20K%20denoting%20number%20of%20distinct%20beads%20colors.%20%20%5CnOn%20the%20second%20line%20there%20are%20K%20integers%2C%20K%20%24%20_%7Bi%7D%20%24%20is%20number%20of%20beads%20with%20i-th%20color.%5Cn%5Cn%2A%2AOutput%2A%2A%5Cn%5CnPrint%20single%20integer%20that%20is%20the%20number%20of%20distinct%20color%20combination.%20Since%20this%20number%20is%20very%20large%20as%20Tjandra%20predict%2C%20output%20it%20modulo%2010%20%24%20%5E%7B9%7D%20%24%20%2B7.%5Cn%5Cn%2A%2AConstraint%2A%2A%5Cn%5Cn1%5Cn%5Cn1%5Cn%5Cn%2A%2ASample%201%2A%2A%5Cn%5CnInput%5Cn%5Cn%20%60%60%60%5Cn1%5Cn1000%5Cn%60%60%60%5CnOutput%5Cn%5Cn%20%601%60%2A%2ASample%202%2A%2A%5Cn%5CnInput%5Cn%5Cn%20%60%60%60%5Cn2%5Cn2%202%5Cn%60%60%60%5CnOutput%5Cn%5Cn%20%602%60%2A%2ASample%203%2A%2A%5Cn%5CnInput%5Cn%5Cn%20%60%60%60%5Cn3%5Cn1%201%201%5Cn%60%60%60%5CnOutput%5Cn%5Cn%20%602%60%2A%2ASample%204%2A%2A%5Cn%5CnInput%5Cn%5Cn%20%60%60%60%5Cn4%5Cn2%203%204%205%5Cn%60%60%60%5CnOutput%5Cn%5Cn%20%60180180%60%2A%2ASample%205%2A%2A%5Cn%5CnInput%5Cn%5Cn%20%60%60%60%5Cn5%5Cn1%202%203%204%205%5Cn%60%60%60%5CnOutput%5Cn%5Cn%20%602522520%60%2A%2ASample%203%20Explanation%2A%2A%5Cn%5CnOn%20sample%203%20there%20are%203%20distinct%20color%20of%20beads%2C%20there%20is%201%20bead%20for%20each%20color.%5Cn%5CnLet%27s%20assume%20those%203%20distinct%20color%20are%20red%2C%20green%2C%20and%20blue%2C%5Cn%5Cnhere%20are%202%20possible%20necklace%2C%20all%20other%20beads%20combination%20can%20be%20rotated%20to%20obtain%20one%20of%20thoose%20necklace%20below.%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP26184%5C%2F6e71422320bae63940c8dcaa207dfeb9af15d06f.png%29%5Cn%5CnNote%20that%20if%20we%20can%20flip%20the%20necklace%2C%20both%20necklace%20are%20equal%2C%20but%20in%20this%20problem%2C%20we%20assume%20the%20front%20side%20of%20necklace%20is%20different%20than%20the%20back%20side%2C%20so%20both%20necklace%20above%20are%20considered%20different.%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F26184%22%2C%22id%22%3A%2226184%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP26184%22%2C%22title%22%3A%22JC15F%20-%20Colorful%20Beads%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22JC15F%20-%20Colorful%20Beads%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>JC15F - Colorful Beads</h1>
<h2>题目描述</h2>
<div>**Colorful Beads**
![](https://cdn.luogu.com.cn/upload/vjudge_pic/SP26184/3e60a8764beaa3aa01992f6a9de8523c087c0434.png)
Yay, today is colorful day! why? because there are so many colorful beads on the table. Satria want to make a necklace using all that available beads, in order to make the necklace most valuable, Satria arrange the beads using magic secret formula. Gunawan secretly want to know Satria's secret formula, so he try all possible beads combination until the beads become most valuable, at first he easily found the most valuable beads combination for small number of beads, but he can't derive general formula, he keeps trying, and tying, and trying... Never give up!
Someday, Tjandra meet Gunawan and suggest him to not continuing his bruteforce action because the number of possible combinations are too many. Gunawan doesn't believe that and ask Tjandra to show him number of possible combinations.
Gunawan said: "If I have this N beads how many combinations are there?"
Tjandra replied: "It's N facorial combinations"
Gunawan replied: "But that's not always true some of my beads has more than one color, so if I swap beads with same color doesn't change tha necklace value"
Tjandra replied: "Okay, tell me the details of your beads"
Gunawan replied: "My beads has M distinct colors, it has K $ _{1} $ beads of color 1, K $ _{2} $ beads of color 2, ... , K $ _{M} $ beads of color M"
Tjandra replied: "It will have F(K $ _{1} $ +K $ _{2} $ +...+K $ _{M} $ )/(F(K $ _{1} $ )\*F(K $ _{2} $ )\*...\*F(K $ _{M} $ )) combinations where F(N) means N factorial"
(5 minutes later)
Gunawan said: "Hey, your formula is not true, I tried it with 2 green beads and 2 blue beads, your formula showed F(2+2)/(F(2)\*F(2)) = 24/(2\*2) = 6 combinations, but actually it has only 2 combinations"
Tjandra confidently replied: "I'm good at math, I'm sure my formula is correct"
Gunawan replied: "I made these two different necklace: {1:{g,g,b,b},2:{g,b,g,b}} \[g=green beads, b=blue beads\] can you make the third necklace that is different than both of these?"
Tjandra replied: "That's easy, here is the third necklace: {b,g,b,g} "
Gunawan replied after rotating that necklace: "Look, your neclace become equal to my second necklace: {b,g,b,g} -> {g,b,g,b}"
Tjandra replied: "Oops, I forgot about necklace rotation, you'really smart bruteforcer, why you don't believe me that number of combination is too many even though it's a little bit smaller than my calculation"
Gunawan replied: "A little bit? do you think 6 and 2 is little difference?"
Tjandra replied: "huh -\_- I can show you that the exact number of distinct combinations, but unfortunately the formula become too complex and I don't bring a computer, is there any computer here?"
Gunawan replied: "No, I'm also don't have a computer"
Now Tjandra call you using his old phone for help, because he know that now you're sitting in front of your computer. Can you help them?
**Input**
The first line there is an integer K denoting number of distinct beads colors.
On the second line there are K integers, K $ _{i} $ is number of beads with i-th color.
**Output**
Print single integer that is the number of distinct color combination. Since this number is very large as Tjandra predict, output it modulo 10 $ ^{9} $ +7.
**Constraint**
1
1
**Sample 1**
Input
```
1
1000
```
Output
`1`**Sample 2**
Input
```
2
2 2
```
Output
`2`**Sample 3**
Input
```
3
1 1 1
```
Output
`2`**Sample 4**
Input
```
4
2 3 4 5
```
Output
`180180`**Sample 5**
Input
```
5
1 2 3 4 5
```
Output
`2522520`**Sample 3 Explanation**
On sample 3 there are 3 distinct color of beads, there is 1 bead for each color.
Let's assume those 3 distinct color are red, green, and blue,
here are 2 possible necklace, all other beads combination can be rotated to obtain one of thoose necklace below.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/SP26184/6e71422320bae63940c8dcaa207dfeb9af15d06f.png)
Note that if we can flip the necklace, both necklace are equal, but in this problem, we assume the front side of necklace is different than the back side, so both necklace above are considered different.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
