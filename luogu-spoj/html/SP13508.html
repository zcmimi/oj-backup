<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>MDT1 - Madotsuki Pattern - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450355:kl1f8zoeWTULVMqoGItoW7shxL57OIC2KYI1AESQ9vM=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Madotsuki%20is%20the%20main%20character%20of%20the%20surreal%20adventure%20game%20Yumenikki.%20The%20poor%20girl%20ended%20her%20life%20after%20discard%20all%20of%20her%20properties%20that%20have%20been%20found%20in%20the%20dream.%20Every%20year%20there%20are%20some%20small%20celebrations%20among%20people.%20The%20most%20symbolic%20sign%20of%20Madotsuki%20is%20the%20pattern%20on%20her%20clothes%20...%5Cn%5Cn%20%20%20%5Cn%21%5Bsubir%20imagenes%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP13508%5C%2F33f1c9de7ae5220a019bdfa9462f5b1f04bd970a.png%29%5C%2F%3E%20%20%20%5Cn%20%28image%20taken%20from%20%5Bgithub.com%5C%2Fmadotsuki%5D%28https%3A%5C%2F%5C%2Fgithub.com%5C%2Fmadotsuki%29%29%20%20%20%5CnYou%20have%20been%20given%20a%20n%5C%5C%2Am%20design.%20Each%20element%20is%20one%20of%20the%20following%20character%20%271%27%2C%20%270%27%2C%20%27%3F%27.%20You%20can%20freely%20choose%20each%20%27%3F%27%20to%20become%20%270%27%20or%20%271%27%2C%20to%20maximizate%20the%20number%20madotsuki%20pattern%20in%20the%20design.%5Cn%5Cnwhich%20the%20madotsuki%20pattern%20is%20somethings%20like%20this%3A%5Cn%5Cn101%5Cn%5Cn010%5Cn%5CnRemark%5Cn%5Cn010%5Cn%5Cn101%5Cn%5Cnis%20not%20a%20madotsuki%20pattern.%22%2C%22inputFormat%22%3A%22%28Multiply%20test%20cases%2C%20for%20each%20test%20case%29%5Cn%5Cnn%20m%20%28%20n%20%3C%3D%201000%2C%20m%20%3C%3D%2010%29%5Cn%5Cn%5C%5C%5Bn%5C%5C%2Am%20%270%27%2C%20%271%27%20or%20%27%3F%27%5C%5C%5D%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20output%20the%20maximum%20answer%2C%20and%20how%20many%20design%20can%20reach%20the%20answer%20in%20total.%20Since%20the%20answer%20can%20be%20very%20huge%2C%20you%20only%20need%20to%20output%20it%20after%20mod%201%2C000%2C000%2C007.%22%2C%22samples%22%3A%5B%5B%222%2042%204%5Cr%5Cn%3F%3F%3F%3F%5Cr%5Cn%3F%3F%3F%3F%5Cr%5Cn4%206%5Cr%5Cn%3F%3F%3F%3F%3F%3F%5Cr%5Cn%3F1010%3F%5Cr%5Cn%3F0101%3F%5Cr%5Cn%3F%3F%3F%3F%3F%3F%22%2C%221%208%5Cr%5Cn6%204%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F13508%22%2C%22id%22%3A%2213508%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP13508%22%2C%22title%22%3A%22MDT1%20-%20Madotsuki%20Pattern%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22MDT1%20-%20Madotsuki%20Pattern%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>MDT1 - Madotsuki Pattern</h1>
<h2>题目描述</h2>
<div>Madotsuki is the main character of the surreal adventure game Yumenikki. The poor girl ended her life after discard all of her properties that have been found in the dream. Every year there are some small celebrations among people. The most symbolic sign of Madotsuki is the pattern on her clothes ...
![subir imagenes](https://cdn.luogu.com.cn/upload/vjudge_pic/SP13508/33f1c9de7ae5220a019bdfa9462f5b1f04bd970a.png)/>
(image taken from [github.com/madotsuki](https://github.com/madotsuki))
You have been given a n\*m design. Each element is one of the following character '1', '0', '?'. You can freely choose each '?' to become '0' or '1', to maximizate the number madotsuki pattern in the design.
which the madotsuki pattern is somethings like this:
101
010
Remark
010
101
is not a madotsuki pattern.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>(Multiply test cases, for each test case)
n m ( n <= 1000, m <= 10)
\[n\*m '0', '1' or '?'\]</div>
<h3>输出格式</h3>
<br />
<div>For each test case, output the maximum answer, and how many design can reach the answer in total. Since the answer can be very huge, you only need to output it after mod 1,000,000,007.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2 42 4
????
????
4 6
??????
?1010?
?0101?
??????</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1 8
6 4</code></pre>
</article>
</div>
</div>
</body>
</html>
