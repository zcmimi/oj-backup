<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>DCEPC301 - Foodie Golu - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450251:uDq5bIXKBrj33ivhtfQoV+jUQ6/fe6xn3wXoLYSCtEA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Being%20a%20big%20foodie%20Golu%20wants%20to%20try%20all%20the%20dishes%20available%20at%20a%20party%20but%20because%20of%20his%20increasing%20weight%20his%20mother%20does%20not%20allow%20him%20to%20do%20so.%20After%20a%20huge%20fight%20they%20both%20come%20to%20an%20agreement.%5Cn%5Cn1%5C%5C.%20The%20first%20rule%20of%20the%20agreement%20says%20that%20Golu%20should%20only%20eat%20at%20an%20interval%20of%2010%20minutes.%5Cn%5Cn2%5C%5C.%20The%20second%20rule%20is%20regarding%20the%20stalls%20available.%20There%20are%20N%20stalls%20in%20one%20line%20and%20Golu%20should%20select%20only%20one%20stall%20to%20eat%20at%20one%20time.%20The%20selected%20stall%20must%20lie%20at%20the%20n%5C%2F2th%20position%20or%20%28n%5C%2F2%20%2B%201%29%20position%20%28zero%20indexed%29%20among%20all%20remaining%20stalls.%5Cn%5Cn3%5C%5C.%20Once%20he%20has%20selected%20a%20stall%20he%20must%20discard%20all%20the%20stalls%20to%20its%20left%20%28or%20right%29%20and%20in%20future%20can%20only%20eat%20from%20the%20remaining%20stalls.%20Also%20he%20can%20eat%20from%20a%20stall%20only%20once%20during%20the%20party%2C%20so%20once%20he%20has%20eaten%20from%20a%20stall%2C%20it%20should%20be%20discarded%20too.%5Cn%5CnThe%20initial%20cooking%20speed%20at%20all%20the%20stalls%20is%201%20unit.%20After%20doing%20some%20calculations%20Golu%20realises%20that%20the%20speed%20of%20cooking%20of%20the%20cook%20at%20every%20stall%20becomes%20double%20every%2010%20minutes.%20Depending%20upon%20the%20type%20of%20dish%20available%20and%20his%20eating%20capacity%2C%20he%20assigned%20a%20value%20to%20each%20stall%20such%20that%20any%20point%20of%20time%20he%20can%20eat%20a%20quantity%20which%20is%20equal%20to%20%28value%20of%20that%20stall%29%20%5C%5C%2A%20%28current%20speed%20of%20cooking%20at%20that%20stall%29.%20Since%20speed%20is%20increasing%20exponentially%20he%20only%20remembers%20speed%20as%20speed%20%25%20mod%20at%20any%20time.%5Cn%5CnSince%20he%20wants%20to%20eat%20the%20maximum%20amount%20of%20food%2C%20help%20him%20in%20developing%20a%20strategy%20to%20eat.%5Cn%5Cn%20%2A%2ANOTE%3A%20If%20there%20are%20only%202%20stalls%20left%2C%20he%20must%20choose%20any%20one%20stall%20and%20discard%20the%20other.%2A%2A%22%2C%22inputFormat%22%3A%22First%20line%20contains%20T%2C%20the%20number%20of%20test%20cases.%20%281%3C%3DT%3C%3D5%29%5Cn%5CnFirst%20line%20of%20each%20test%20case%20contains%20n%2C%20the%20number%20of%20stalls%20in%20the%20party.%20%281%3C%3Dn%3C%3D3000%29%5Cn%5CnNext%20line%20of%20each%20test%20case%20contains%20n%20space%20separated%20integers%2C%20representing%20the%20value%20of%20each%20of%20the%20stalls.%20%28All%20values%20are%20between%201%20and%203000%20inclusive%29%22%2C%22outputFormat%22%3A%22Output%20T%20lines%2C%20one%20for%20each%20test%20case%20containing%20the%20maximum%20amount%20of%20food%20Golu%20can%20eat%20mod%2010%5E9%2B7%22%2C%22samples%22%3A%5B%5B%22152%204%201%203%205%22%2C%2221%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B194%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F10945%22%2C%22id%22%3A%2210945%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP10945%22%2C%22title%22%3A%22DCEPC301%20-%20Foodie%20Golu%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22DCEPC301%20-%20Foodie%20Golu%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>DCEPC301 - Foodie Golu</h1>
<h2>题目描述</h2>
<div>Being a big foodie Golu wants to try all the dishes available at a party but because of his increasing weight his mother does not allow him to do so. After a huge fight they both come to an agreement.
1\. The first rule of the agreement says that Golu should only eat at an interval of 10 minutes.
2\. The second rule is regarding the stalls available. There are N stalls in one line and Golu should select only one stall to eat at one time. The selected stall must lie at the n/2th position or (n/2 + 1) position (zero indexed) among all remaining stalls.
3\. Once he has selected a stall he must discard all the stalls to its left (or right) and in future can only eat from the remaining stalls. Also he can eat from a stall only once during the party, so once he has eaten from a stall, it should be discarded too.
The initial cooking speed at all the stalls is 1 unit. After doing some calculations Golu realises that the speed of cooking of the cook at every stall becomes double every 10 minutes. Depending upon the type of dish available and his eating capacity, he assigned a value to each stall such that any point of time he can eat a quantity which is equal to (value of that stall) \* (current speed of cooking at that stall). Since speed is increasing exponentially he only remembers speed as speed % mod at any time.
Since he wants to eat the maximum amount of food, help him in developing a strategy to eat.
**NOTE: If there are only 2 stalls left, he must choose any one stall and discard the other.**</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>First line contains T, the number of test cases. (1<=T<=5)
First line of each test case contains n, the number of stalls in the party. (1<=n<=3000)
Next line of each test case contains n space separated integers, representing the value of each of the stalls. (All values are between 1 and 3000 inclusive)</div>
<h3>输出格式</h3>
<br />
<div>Output T lines, one for each test case containing the maximum amount of food Golu can eat mod 10^9+7</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>152 4 1 3 5</code></pre>
<h3>输出样例 #1</h3>
<pre><code>21</code></pre>
</article>
</div>
</div>
</body>
</html>
