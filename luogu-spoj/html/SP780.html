<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>ARCHPLG - The Archipelago - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449618:zszPC7VfjVa8rnEPlzBTqqRKzBpQfOZzQ+q4mA8wNDA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Byteland%20is%20a%20country%20located%20in%20the%20Archipelago%20of%20Rectangular%20Islands.%20The%20archipelago%20consists%20of%201%3C%3Dn%3C%3D1000%20islands.%20A%20fact%20that%20each%20island%20has%20a%20rectangular%20shape%20is%20very%20nice%20for%20Bytelandian%20cartographers.%5Cn%5Cn%20Bytelandian%20islands%20are%20rather%20small%20and%20none%20are%20very%20fertile%2C%20so%20each%20of%20%28rectangular%20of%20course%29%20pieces%20of%20cultivated%20land%20is%20under%20special%20control%2C%20simply%20speaking%3A%20%5Cu2018never%20enter%20there%20to%20save%20your%20life%5Cu2019.%20Other%20areas%20are%20guaranteed%20to%20be%20free%20accessible%20for%20the%20people.%5Cn%5Cn%20The%20communication%20between%20islands%20is%20possible%20by%20ferries.%20On%20each%20island%20there%20is%200%3C%3Db%3C%3D10%20terminals%2C%20from%20where%20crossings%20to%20another%20terminals%20on%20other%20islands%20are%20possible.%20It%20is%20known%20that%20total%20number%20of%20crossing%20connections%20is%200%3C%3Dm%3C%3D100000.%20Other%20infrastructure%20is%20practically%20unknown.%20Specifically%20the%20only%20possible%20way%20of%20traveling%20through%20the%20island%20is%20to%20do%20it%20on%20foot.%5Cn%5Cn%20Well%2C%20now%20we%20are%20close%20to%20a%20task%20you%20are%20requested%20to%20solve.%20John%20%5Cu2013%20one%20of%20the%20Bytelandian%20citizens%20is%20working%20as%20a%20sales%20manager.%20Simply%20speaking%20he%20is%20often%20requested%20to%20travel%20from%20one%20place%20to%20another%2C%20what%20he%20rather%20dislike%20and%20preferably%20%28like%20other%20Bytelandian%20people%20use%20to%20do%29%20he%20would%20like%20to%20spent%20more%20time%20in%20one%20of%20the%20beach%20clubs%20playing%20Puto%20%28a%20kind%20of%20strategic%20game%2C%20very%20popular%20in%20Byteland%29.%20Please%20help%20him%20to%20find%20a%20way%20to%20spare%20his%20time.%5Cn%5Cn%23%23%23%20Task%5Cn%5Cn%20Find%20one%20of%20the%20fastest%20ways%20for%20John%20using%20ferries%20and%20foot%20paths%20on%20islands.%20Assume%20that%20while%20walking%20John%20is%20always%20moving%20one%20BM%20%28Bytelandian%20unit%20of%20length%29%20per%20BH%20%28Bytelandian%20unit%20of%20time%29.%20You%20can%20also%20assume%20that%20the%20ferry%20departures%20nearly%20immediately%20after%20John%20arrives%20the%20terminal%2C%20it%20will%20be%20enough%20to%20round%20up%20the%20walking%20time%20to%20the%20nearest%20integer.%22%2C%22inputFormat%22%3A%22In%20the%20first%20line%20t%20-%20the%20number%20of%20tests%2C%20then%20for%20each%20test%3A%20in%20next%20line%20n%20-%20the%20number%20of%20islands.%20Description%20of%20each%20island%20is%20as%20follows%3A%5Cn%5Cn%60%60%60%5Cn%5Cnname%5Cnw%20h%20%5Bisland%20dimensions%5D%5Cnb%20-%20%5Bnumber%20of%20terminals%5D%5Cn%5Bdescription%20of%20each%20terminal%20in%20a%20form%3A%5D%5Cnname%20x%20y%20%5Bname%20of%20a%20terminal%20and%20its%20coordinates%5D%5CnF%20%5Bnumber%20of%20restricted%20areas%20F%5Cn%60%60%60%5Cn%20All%20coordinates%20are%20nonnegative%20integers%20measured%20in%20BM%20according%20to%20upper%20left%20corner%20of%20an%20island.%5Cn%5Cn%20You%20can%20assume%20that%20any%20two%20restricted%20areas%20are%20disjoint.%20After%20the%20description%20of%20all%20islands%20all%20ferry%20connections%20are%20given%20%28each%20connection%20is%20bi-directional%29.%5Cn%5Cn%60%60%60%5Cn%5Cnm%20%20%5Bnumber%20of%20connections%5D%5Cn%5Bdescription%20of%20each%20connection%5D%5CnNB1%20NW1%20NB2%20NW2%20time%20%5Bname%20of%20a%20first%20terminal%2C%20its%20island%2C%20the%20second%20respectively%5Cnand%20communiaction%20time%5D%5Cn...%5Cn%5Bdescription%20follows%5D%5Cn...%5CnNBS%20NWS%20NBC%20NWC%20%5Bstart%20and%20goal%20terminal%20for%20John%5D%5Cn%60%60%60%22%2C%22outputFormat%22%3A%22%20For%20each%20test%20describe%20the%20shortest%20route%20for%20John%20from%20terminal%20NBS%20on%20NWS%20island%20to%20terminal%20NBC%20on%20NWC%20island%20in%20the%20following%20format%3A%5Cn%5Cn%60%60%60%5Cn%5Cncase%20nr%20Y%20%5Bnr%20-%20test%20number%5D%5CnT%20%5Btravel%20time%20in%20BH%5D%5CnNBS%20%20NWS%5Cn...%5Cn%5Bconsecutive%20terminals%5D%5Cn...%5CnNBC%20NWC%5Cn%5Bempty%20line%5D%5Cn%5Bconsecutive%20tests%5D%5Cn%60%60%60%5Cn%20If%20two%20consecutive%20terminals%20are%20located%20on%20the%20same%20island%20and%20John%20must%20take%20some%20walk%20you%20must%20give%20all%20middle%20point%20like%20in%20an%20example.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP780%5C%2Ffe2260b018eebeee1c56acd5f7d9920efccb8c3c.png%29%22%2C%22samples%22%3A%5B%5B%221%5Cr%5Cn3%5Cr%5CnW1%5Cr%5Cn8%207%5Cr%5Cn2%5Cr%5CnLindos%204%200%5Cr%5CnKamejros%204%207%5Cr%5Cn3%5Cr%5Cn2%201%206%202%5Cr%5Cn2%203%206%204%20%5Cr%5Cn2%205%206%206%20%5Cr%5CnW2%5Cr%5Cn14%2012%5Cr%5Cn2%5Cr%5CnMalia%2014%201%5Cr%5CnKnossos%201%2012%5Cr%5Cn5%5Cr%5Cn2%206%2010%2010%5Cr%5Cn11%201%2012%206%5Cr%5Cn8%201%2010%205%5Cr%5Cn11%207%2012%209%5Cr%5Cn3%202%205%204%5Cr%5CnW3%20%5Cr%5Cn1%201%5Cr%5Cn1%5Cr%5CnKorkyra%200%200%5Cr%5Cn0%5Cr%5Cn2%5Cr%5CnKamejros%20W1%20Knossos%20W2%20100%5Cr%5CnMalia%20W2%20Korkyra%20W3%20100%5Cr%5CnKorkyra%20W3%20Lindos%20W1%5Cr%5Cn%5Cr%5Cn%5Cr%5CnAn%20example%20of%20a%20correct%20answer%3A%22%2C%22case%201%20Y%5Cr%5Cn230%5Cr%5CnKorkyra%20W3%5Cr%5CnMalia%20W2%5Cr%5Cn12%206%5Cr%5Cn11%207%5Cr%5Cn10%2010%5Cr%5CnKnossos%20W2%5Cr%5CnKamejros%20W1%5Cr%5Cn2%206%5Cr%5Cn2%201%5Cr%5CnLindos%20W1%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5393%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F780%22%2C%22id%22%3A%22780%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP780%22%2C%22title%22%3A%22ARCHPLG%20-%20The%20Archipelago%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22ARCHPLG%20-%20The%20Archipelago%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>ARCHPLG - The Archipelago</h1>
<h2>题目描述</h2>
<div>Byteland is a country located in the Archipelago of Rectangular Islands. The archipelago consists of 1<=n<=1000 islands. A fact that each island has a rectangular shape is very nice for Bytelandian cartographers.
Bytelandian islands are rather small and none are very fertile, so each of (rectangular of course) pieces of cultivated land is under special control, simply speaking: ‘never enter there to save your life’. Other areas are guaranteed to be free accessible for the people.
The communication between islands is possible by ferries. On each island there is 0<=b<=10 terminals, from where crossings to another terminals on other islands are possible. It is known that total number of crossing connections is 0<=m<=100000. Other infrastructure is practically unknown. Specifically the only possible way of traveling through the island is to do it on foot.
Well, now we are close to a task you are requested to solve. John – one of the Bytelandian citizens is working as a sales manager. Simply speaking he is often requested to travel from one place to another, what he rather dislike and preferably (like other Bytelandian people use to do) he would like to spent more time in one of the beach clubs playing Puto (a kind of strategic game, very popular in Byteland). Please help him to find a way to spare his time.
### Task
Find one of the fastest ways for John using ferries and foot paths on islands. Assume that while walking John is always moving one BM (Bytelandian unit of length) per BH (Bytelandian unit of time). You can also assume that the ferry departures nearly immediately after John arrives the terminal, it will be enough to round up the walking time to the nearest integer.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>In the first line t - the number of tests, then for each test: in next line n - the number of islands. Description of each island is as follows:
```
name
w h [island dimensions]
b - [number of terminals]
[description of each terminal in a form:]
name x y [name of a terminal and its coordinates]
F [number of restricted areas F
```
All coordinates are nonnegative integers measured in BM according to upper left corner of an island.
You can assume that any two restricted areas are disjoint. After the description of all islands all ferry connections are given (each connection is bi-directional).
```
m [number of connections]
[description of each connection]
NB1 NW1 NB2 NW2 time [name of a first terminal, its island, the second respectively
and communiaction time]
...
[description follows]
...
NBS NWS NBC NWC [start and goal terminal for John]
```</div>
<h3>输出格式</h3>
<br />
<div> For each test describe the shortest route for John from terminal NBS on NWS island to terminal NBC on NWC island in the following format:
```
case nr Y [nr - test number]
T [travel time in BH]
NBS NWS
...
[consecutive terminals]
...
NBC NWC
[empty line]
[consecutive tests]
```
If two consecutive terminals are located on the same island and John must take some walk you must give all middle point like in an example.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/SP780/fe2260b018eebeee1c56acd5f7d9920efccb8c3c.png)</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1
3
W1
8 7
2
Lindos 4 0
Kamejros 4 7
3
2 1 6 2
2 3 6 4 
2 5 6 6 
W2
14 12
2
Malia 14 1
Knossos 1 12
5
2 6 10 10
11 1 12 6
8 1 10 5
11 7 12 9
3 2 5 4
W3 
1 1
1
Korkyra 0 0
0
2
Kamejros W1 Knossos W2 100
Malia W2 Korkyra W3 100
Korkyra W3 Lindos W1


An example of a correct answer:</code></pre>
<h3>输出样例 #1</h3>
<pre><code>case 1 Y
230
Korkyra W3
Malia W2
12 6
11 7
10 10
Knossos W2
Kamejros W1
2 6
2 1
Lindos W1</code></pre>
</article>
</div>
</div>
</body>
</html>
