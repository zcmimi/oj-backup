<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>CHARLIE - Charlie and the Chocolate Factory - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450116:cXHtt4VBkoWCMcnoLe9NQ54AhpwyYS+4SqixlW35A8Q=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Charlie%20works%20in%20a%20magical%20chocolate%20factory.%20Packets%20of%20its%20marzipan%20are%20made%20on%20conveyor%20belts.%20To%20make%20marzipan%20perfect%2C%20M%20conveyor%20belts%20are%20used%2C%20and%20the%20process%20is%20as%20follows.%5Cn%5CnEach%20of%20the%20M%20belts%20has%20N%20cells.%20Charlie%20first%20makes%20a%20few%20initial%20packets%20and%20puts%20them%20on%20the%20cells%20of%20the%20first%20belt%20%28there%20may%20be%20zero%20or%20more%20packets%20in%20a%20particular%20cell%29.%5Cn%5CnThen%20the%20first%20belt%20generates%20a%20second%20belt%20such%20that%20each%20cell%20of%20the%20second%20belt%2C%20at%20the%20same%20time%2C%20counts%20the%20packets%20in%20some%20five%20cells%20of%20the%20first%20belt%20and%20creates%20that%20number%20of%20packets%20in%20itself.%5Cn%5CnFox%20example%2C%20the%20first%20cell%20of%20the%20second%20belt%20sums%20the%20packets%20in%20the%20cells%201%2C%202%2C%203%2C%205%2C%209%20of%20the%20first%20belt%2C%20the%20second%20cell%20of%20the%20second%20belt%20sums%20the%20packets%20in%20the%20cells%202%2C%203%2C%204%2C%205%2C%206%20of%20the%20first%20belt%20and%20so%20on.%5Cn%5CnThen%2C%20from%20the%20second%20belt%2C%20a%20third%20belt%20is%20generated%20in%20the%20same%20manner%2C%20then%20the%20fourth%20from%20the%20third%20and%20so%20on%20until%20the%20M%20%24%20%5E%7Bth%7D%20%24%20.%20Since%20the%20number%20of%20packets%20on%20the%20belts%20usually%20increases%2C%20the%20number%20of%20packets%20in%20each%20cell%20is%20observed%20only%20modulo%2010007.%5Cn%5CnYou%2C%20as%20the%20winner%20of%20the%20golden%20ticket%20to%20the%20factory%2C%20are%20able%20to%20see%20how%20the%20M%20%24%20%5E%7Bth%7D%20%24%20belt%20looks%20like%20-%20that%20is%2C%20how%20many%20packets%20of%20marzipan%20there%20is%20in%20each%20cell.%20Charlie%20has%20also%20explained%20to%20you%20the%20production%20process%20and%20now%20you%20are%20wondering%20how%20first%20belt%20looked%20like.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20contains%20positive%20integers%20N%20%28N%20%20100%29%20and%20M%20%28M%20%3C%202%20%24%20%5E%7B31%7D%20%24%20%29.%5Cn%5CnThe%20next%20N%20lines%20describe%20the%20process%20of%20generating%20each%20new%20belt.%20In%20the%20A%20%24%20%5E%7Bth%7D%20%24%20of%20these%20lines%20there%20are%20five%20distinct%20integers%20from%20the%20interval%20%5C%5C%5B1%2C%20N%5C%5C%5D%2C%20denoting%20the%20cells%20of%20a%20previous%20belt%20from%20which%20the%20packets%20are%20added%20to%20the%20A%20%24%20%5E%7Bth%7D%20%24%20cell%20of%20a%20new%20belt.%5Cn%5CnThe%20next%20line%20contains%20N%20integers%20describing%20the%20state%20of%20the%20M%20%24%20%5E%7Bth%7D%20%24%20belt%20%28modulo%2010007%29.%22%2C%22outputFormat%22%3A%22Print%20N%20integers%20describing%20the%20state%20of%20the%20first%20belt%20%28modulo%2010007%29.%20A%20%2A%2Aunique%2A%2A%20solution%20will%20exist%20in%20all%20of%20the%20test%20data.%22%2C%22samples%22%3A%5B%5B%226%203%5Cr%5Cn1%202%203%204%205%5Cr%5Cn1%202%203%204%206%5Cr%5Cn1%202%203%205%206%5Cr%5Cn1%202%204%205%206%5Cr%5Cn1%203%204%205%206%5Cr%5Cn2%203%204%205%206%5Cr%5Cn13%2012%2012%2012%2014%2012%22%2C%221%200%200%200%202%200%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B256%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F8734%22%2C%22id%22%3A%228734%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP8734%22%2C%22title%22%3A%22CHARLIE%20-%20Charlie%20and%20the%20Chocolate%20Factory%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22CHARLIE%20-%20Charlie%20and%20the%20Chocolate%20Factory%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>CHARLIE - Charlie and the Chocolate Factory</h1>
<h2>题目描述</h2>
<div>Charlie works in a magical chocolate factory. Packets of its marzipan are made on conveyor belts. To make marzipan perfect, M conveyor belts are used, and the process is as follows.
Each of the M belts has N cells. Charlie first makes a few initial packets and puts them on the cells of the first belt (there may be zero or more packets in a particular cell).
Then the first belt generates a second belt such that each cell of the second belt, at the same time, counts the packets in some five cells of the first belt and creates that number of packets in itself.
Fox example, the first cell of the second belt sums the packets in the cells 1, 2, 3, 5, 9 of the first belt, the second cell of the second belt sums the packets in the cells 2, 3, 4, 5, 6 of the first belt and so on.
Then, from the second belt, a third belt is generated in the same manner, then the fourth from the third and so on until the M $ ^{th} $ . Since the number of packets on the belts usually increases, the number of packets in each cell is observed only modulo 10007.
You, as the winner of the golden ticket to the factory, are able to see how the M $ ^{th} $ belt looks like - that is, how many packets of marzipan there is in each cell. Charlie has also explained to you the production process and now you are wondering how first belt looked like.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input contains positive integers N (N 100) and M (M < 2 $ ^{31} $ ).
The next N lines describe the process of generating each new belt. In the A $ ^{th} $ of these lines there are five distinct integers from the interval \[1, N\], denoting the cells of a previous belt from which the packets are added to the A $ ^{th} $ cell of a new belt.
The next line contains N integers describing the state of the M $ ^{th} $ belt (modulo 10007).</div>
<h3>输出格式</h3>
<br />
<div>Print N integers describing the state of the first belt (modulo 10007). A **unique** solution will exist in all of the test data.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6 3
1 2 3 4 5
1 2 3 4 6
1 2 3 5 6
1 2 4 5 6
1 3 4 5 6
2 3 4 5 6
13 12 12 12 14 12</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1 0 0 0 2 0</code></pre>
</article>
</div>
</div>
</body>
</html>
