<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>SPACESHIP - Spaceship - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450655:nTbltXVh5OBOvUyO+wd9F/o/f+8gQYeDDj9IlmFPLgs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22In%20the%20future%20world%2C%20you%20have%20moved%20into%20the%20space%20colony%2C%20and%20will%20be%20using%20a%20flying%20disc%20which%20moves%20in%20three%20dimensions%20as%20a%20vehicle.%20You%20have%20been%20assigned%20with%20buying%20the%20parts%20to%20form%20%27N%27%20sets%20of%20computer%20from%20the%20shops%20in%20the%20colony.%20Each%20set%20of%20computer%20consists%20of%203%20parts%3A%20monitor%2C%20keyboard%2C%20and%20CPU.%20Because%20the%20parts%20available%20at%20one%20shop%20may%20not%20be%20enough%20for%20the%20%27N%27%20computers%20and%20the%20budget%20is%20limited%2C%20you%20have%20to%20design%20a%20navigation%20system%20for%20the%20flying%20disc%20such%20that%20the%20total%20cost%20of%20navigation%20is%20minimized.%20You%20know%20the%20exact%20coordinates%20of%20the%20%27M%27%20available%20shops%20and%20the%20number%20of%20the%20parts%20available%20at%20each%20store.%20Assume%20that%20the%20route%20from%20a%20shop%20to%20every%20other%20shop%20will%20have%20no%20obstacles%2C%20thus%20a%20straight%20path%20is%20always%20possible%2C%20the%20flying%20disc%20contains%20unlimited%20storage%20space%2C%20and%20the%20parts%20at%20each%20store%20are%20free.%20Let%20the%20trip%20terminate%20when%20all%20parts%20needed%20are%20collected.%5Cn%5CnLet%20shop%5C%2Fposition%20A%20has%20coordinate%20%28X1%2C%20Y1%2C%20Z1%29%20and%20shop%5C%2Fposition%20B%20has%20coordinate%20%28X2%2C%20Y2%2C%20Z2%29%2C%20the%20navigation%20cost%20between%20the%20two%20shops%5C%2Fpositions%20is%20calculated%20by%20the%20formula%20%28X1-X2%29%5E2%20%2B%20%28Y1-Y2%29%5E2%20%2B%20%28Z1-Z2%29%5E2.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20the%20integer%20%27N%27%3A%20the%20number%20of%20the%20required%20sets%20of%20computer.%5Cn%5CnThe%20second%20line%20contains%20three%20integers%20%27X%27%2C%20%27Y%27%2C%20%27Z%27%3A%20the%20initial%20position%20of%20the%20spaceship%20in%20the%20form%20of%20coordinates%20%28X%2C%20Y%2C%20Z%29%5Cn%5CnThe%20third%20line%20contains%20the%20integer%20%27M%27%3A%20the%20total%20number%20of%20shops%20in%20the%20colony%5Cn%5CnThere%20follows%202M%20lines%3A%20the%20information%20for%20each%20shop%20in%20the%20colony%2C%20where%20two%20lines%20are%20responsible%20for%20the%20information%20of%20one%20shop.%5Cn%5CnThe%20first%20of%20these%20two%20lines%20contains%20three%20integers%20%27Xi%27%2C%20%27Yi%27%2C%20%27Zi%27%2C%20the%20position%20of%20the%20shop%20in%20the%20form%20of%20coordinates%20%28X%2C%20Y%2C%20Z%29%5Cn%5CnThe%20second%20of%20these%20two%20lines%20contains%20three%20integers%20%27Mi%27%2C%20%27Ki%27%2C%20%27Ci%27%2C%20the%20number%20of%20monitors%2C%20keyboards%2C%20and%20CPUs%2C%20respectively%2C%20available%20at%20the%20shop.%5Cn%5CnIt%20is%20guaranteed%20that%20it%20is%20sufficient%20to%20build%20%27N%27%20sets%20of%20computers%20from%20all%20parts%20of%20every%20shop%20combined.%22%2C%22outputFormat%22%3A%22One%20line%20containing%20the%20minimum%20navigation%20cost%20from%20the%20initial%20position%20to%20the%20end%20of%20the%20trip.%5Cn%5Cn%2A%2AConstraints%2A%2A%5Cn%5Cn1%20%3C%3D%20%27N%27%20%3C%3D%2020%5Cn%5Cn0%20%3C%3D%20%27X%27%2C%20%27Y%27%2C%20%27Z%27%2C%20%27Xi%27%2C%20%27Yi%27%2C%20%27Zi%27%20%3C%3D%20500%5Cn%5Cn1%20%3C%3D%20%27M%27%20%3C%3D%2010%5Cn%5Cn0%20%3C%3D%20%27Mi%27%2C%20%27Ki%27%2C%20%27Ci%27%20%3C%3D%2020%22%2C%22samples%22%3A%5B%5B%22%231%3A%5C%5Cn1%5C%5Cn0%200%200%5C%5Cn2%5C%5Cn10%200%200%5C%5Cn2%205%207%5C%5Cn0%2010%200%5C%5Cn0%203%209%22%2C%22%231%3A%5C%5Cn100%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F26958%22%2C%22id%22%3A%2226958%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP26958%22%2C%22title%22%3A%22SPACESHIP%20-%20Spaceship%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22SPACESHIP%20-%20Spaceship%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>SPACESHIP - Spaceship</h1>
<h2>题目描述</h2>
<div>In the future world, you have moved into the space colony, and will be using a flying disc which moves in three dimensions as a vehicle. You have been assigned with buying the parts to form 'N' sets of computer from the shops in the colony. Each set of computer consists of 3 parts: monitor, keyboard, and CPU. Because the parts available at one shop may not be enough for the 'N' computers and the budget is limited, you have to design a navigation system for the flying disc such that the total cost of navigation is minimized. You know the exact coordinates of the 'M' available shops and the number of the parts available at each store. Assume that the route from a shop to every other shop will have no obstacles, thus a straight path is always possible, the flying disc contains unlimited storage space, and the parts at each store are free. Let the trip terminate when all parts needed are collected.
Let shop/position A has coordinate (X1, Y1, Z1) and shop/position B has coordinate (X2, Y2, Z2), the navigation cost between the two shops/positions is calculated by the formula (X1-X2)^2 + (Y1-Y2)^2 + (Z1-Z2)^2.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains the integer 'N': the number of the required sets of computer.
The second line contains three integers 'X', 'Y', 'Z': the initial position of the spaceship in the form of coordinates (X, Y, Z)
The third line contains the integer 'M': the total number of shops in the colony
There follows 2M lines: the information for each shop in the colony, where two lines are responsible for the information of one shop.
The first of these two lines contains three integers 'Xi', 'Yi', 'Zi', the position of the shop in the form of coordinates (X, Y, Z)
The second of these two lines contains three integers 'Mi', 'Ki', 'Ci', the number of monitors, keyboards, and CPUs, respectively, available at the shop.
It is guaranteed that it is sufficient to build 'N' sets of computers from all parts of every shop combined.</div>
<h3>输出格式</h3>
<br />
<div>One line containing the minimum navigation cost from the initial position to the end of the trip.
**Constraints**
1 <= 'N' <= 20
0 <= 'X', 'Y', 'Z', 'Xi', 'Yi', 'Zi' <= 500
1 <= 'M' <= 10
0 <= 'Mi', 'Ki', 'Ci' <= 20</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>#1:\n1\n0 0 0\n2\n10 0 0\n2 5 7\n0 10 0\n0 3 9</code></pre>
<h3>输出样例 #1</h3>
<pre><code>#1:\n100</code></pre>
</article>
</div>
</div>
</body>
</html>
