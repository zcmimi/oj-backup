<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>PLNDTREE - Palindrome in a Tree - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450632:Ak8fcakJv20rKHK6zf2Eyo3uVCoH0/JwbQtfwsHsj1I=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%60%60%60%5CnJohn%20has%20got%20a%20tree%20with%20N%20vertices.%20The%20vertices%20are%20numbered%20from%201%20to%20N.%20He%20considers%20vertex%201%20as%20the%20root%20of%20the%20tree.%20Each%20vertex%20of%20the%20tree%20contains%20a%20character%20C.%5CnNow%20John%20is%20doing%20a%20weird%20experiment%20with%20this%20tree.%5CnHe%20often%20changes%20the%20character%20of%20a%20node%20in%20the%20tree%20and%20then%20sometimes%20he%20randomly%20selects%20a%20node%20v%20and%20tries%20to%20form%20a%20palindrome%20with%20all%20the%20characters%20in%20the%20subtree%20of%20node%20v.%5CnBut%20since%20John%20is%20very%20busy%20man%20and%20has%20a%20lot%20of%20other%20important%20experiments%20to%20do%20he%20needs%20your%20help%20on%20this%20one.%5CnINPUT%3A%5CnFirst%20line%20of%20the%20input%20contains%20an%20integer%20N%20%281%3C%3DN%3C%3D100000%29%20denoting%20the%20number%20of%20vertices.%5CnNext%20N-1%20lines%20contains%20two%20integers%20A%20and%20B%20%281%3C%3DA%2C%20B%3C%3DN%29%20which%20means%20there%20is%20an%20edge%20between%20vertex%20A%20and%20B.%5CnNext%20line%20contains%20a%20string%20of%20length%20N.%20The%20ith%20character%20of%20this%20string%20denotes%20the%20character%20in%20node%20i.%5CnThen%20there%20will%20be%20an%20integer%20M%20%281%3C%3DM%3C%3D100000%29%20in%20a%20separate%20line%20denoting%20the%20number%20of%20queries.%20Next%20M%20lines%20will%20contain%20a%20query.%5CnEach%20query%20will%20be%20in%20one%20of%20the%20following%20form%3A%5Cu00a0%5Cn0%20x%20C%3A%20which%20means%20the%20character%20of%20node%20x%20has%20been%20changed%20to%20C.%5Cu00a0%5Cn1%20x%3A%5Cu00a0which%20means%20you%20are%20asked%20to%20answer%20if%20a%20palindrome%20can%20be%20formed%20with%20all%20the%20characters%20in%20the%20sub%20tree%20of%20node%20x.%20There%20will%20be%20at%20least%20one%20query%20of%20this%20type.%5CnOUTPUT%3A%5CnFor%20each%20query%20of%20the%20form%5Cu00a0%5Cu201c1%20x%5Cu201d%5Cu00a0print%20%5Cu201cYES%5Cu201d%20if%20a%20palindrome%20can%20be%20formed%20with%20all%20the%20characters%20in%20subtree%20of%20node%20x.%20Otherwise%20print%20%5Cu201cNO%5Cu201d%20%28without%20the%20quotes%29.%5Cn%28All%20the%20characters%20in%20the%20input%20will%20be%20small%20letters%20of%20English%20alphabet.%20i.e.%20a%2C%20b%2C%20c%5Cu2026%20x%2C%20y%2C%20z%29.%5CnSee%20sample%20input%20%5C%2Fsample%20output%20for%20details.%5Cn%5Cn%5Cn%5Cn%5CnSample%20%20%20Input%5Cn%5Cn%5CnSample%20%20%20Output%5Cn%5Cn%5Cn%5Cn%5Cn7%5Cn5%204%5Cn1%205%5Cn6%203%5Cn1%207%5Cn5%206%5Cn6%202%5Cnabdaabc%5Cn7%5Cn1%201%5Cn1%205%5Cn1%203%5Cn0%207%20a%5Cn1%201%5Cn0%204%20z%5Cn1%205%5Cn%5Cn%5CnNO%5CnYES%5CnYES%5CnYES%5CnNO%5Cn%5Cu00a0%5Cn%5Cn%5Cn%5Cn%5Cn%5Cu00a0%5CnIn%20the%202nd%5Cu00a0query%2C%20the%20formed%20palindrome%20can%20be%20%5Cu201cbadab%5Cu201d%20or%20%5Cu201cabdba%5Cu201d%5CnIn%20the%203rd%5Cu00a0query%2C%20there%20is%20only%201%20character%20%5Cu201cd%5Cu201d%2C%20which%20is%20palindrome.%5Cn%5Cu00a0%5Cn%60%60%60%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F25892%22%2C%22id%22%3A%2225892%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP25892%22%2C%22title%22%3A%22PLNDTREE%20-%20Palindrome%20in%20a%20Tree%20%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22PLNDTREE%20-%20Palindrome%20in%20a%20Tree%20%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>PLNDTREE - Palindrome in a Tree </h1>
<h2>题目描述</h2>
<div>```
John has got a tree with N vertices. The vertices are numbered from 1 to N. He considers vertex 1 as the root of the tree. Each vertex of the tree contains a character C.
Now John is doing a weird experiment with this tree.
He often changes the character of a node in the tree and then sometimes he randomly selects a node v and tries to form a palindrome with all the characters in the subtree of node v.
But since John is very busy man and has a lot of other important experiments to do he needs your help on this one.
INPUT:
First line of the input contains an integer N (1<=N<=100000) denoting the number of vertices.
Next N-1 lines contains two integers A and B (1<=A, B<=N) which means there is an edge between vertex A and B.
Next line contains a string of length N. The ith character of this string denotes the character in node i.
Then there will be an integer M (1<=M<=100000) in a separate line denoting the number of queries. Next M lines will contain a query.
Each query will be in one of the following form: 
0 x C: which means the character of node x has been changed to C. 
1 x: which means you are asked to answer if a palindrome can be formed with all the characters in the sub tree of node x. There will be at least one query of this type.
OUTPUT:
For each query of the form “1 x” print “YES” if a palindrome can be formed with all the characters in subtree of node x. Otherwise print “NO” (without the quotes).
(All the characters in the input will be small letters of English alphabet. i.e. a, b, c… x, y, z).
See sample input /sample output for details.
Sample Input
Sample Output
7
5 4
1 5
6 3
1 7
5 6
6 2
abdaabc
7
1 1
1 5
1 3
0 7 a
1 1
0 4 z
1 5
NO
YES
YES
YES
NO
 
 
In the 2nd query, the formed palindrome can be “badab” or “abdba”
In the 3rd query, there is only 1 character “d”, which is palindrome.
 
```</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
