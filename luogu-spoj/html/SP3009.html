<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>VORONOI - Revenge of Voronoi - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449776:FZg7nKiYZe0QUGfuUOJcOiONvmBgz1Tj1ngf6bv+gqg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22A%20discrete%20Voronoi%20diagram%20is%20a%20derivation%20of%20a%20Voronoi%20diagram.%20It%20is%20represented%20as%20a%20set%20of%20pixels.%20Each%20of%20the%20generatrices%20lies%20on%20the%20center%20of%20some%20pixel.%20Each%20pixel%20belongs%20to%20the%20generatrix%20nearest%20from%20the%20center%20of%20the%20pixel%20in%20the%20sense%20of%20Manhattan%20distance.%20The%20Manhattan%20distance%20d%20between%20two%20points%20%28_x_%20%24%20_%7B1%7D%20%24%20%2C%20_y_%20%24%20_%7B1%7D%20%24%20%29%20and%20%28_x_%20%24%20_%7B2%7D%20%24%20%2C%20_y_%20%24%20_%7B2%7D%20%24%20%29%20is%20given%20by%20the%20following%20formula%3A%5Cn%5Cn_d_%20%3D%20%7C_x_%20%24%20_%7B1%7D%20%24%20-%20_x_%20%24%20_%7B2%7D%20%24%20%7C%20%2B%20%7C_y_%20%24%20_%7B1%7D%20%24%20-%20_y_%20%24%20_%7B2%7D%20%24%20%7CYour%20task%20is%20to%20find%20a%20set%20of%20generatrices%20which%20generates%20a%20given%20discrete%20Voronoi%20diagram.%20In%20the%20given%20diagram%2C%20each%20generatrix%20is%20given%20a%20unique%20lowercase%20letter%20as%20its%20identifier%2C%20and%20each%20pixel%20is%20represented%20by%20the%20identifier%20of%20the%20generatrix%20the%20pixel%20belongs%20to.%20If%20a%20pixel%20has%20multiple%20generatrices%20at%20the%20same%20distance%20from%20its%20center%2C%20it%20belongs%20to%20the%20generatrix%20with%20the%20most%20preceding%20identifier%20among%20them%20%28i.e.%20the%20smallest%20character%20code%29.%22%2C%22inputFormat%22%3A%22The%20input%20consists%20of%20multiple%20test%20cases.%5Cn%5CnEach%20test%20case%20begins%20with%20a%20line%20containing%20two%20integers%20_W_%20%281%20%5Cu2264%20_W_%20%5Cu2264%2032%29%20and%20_H_%20%281%20%5Cu2264%20_H_%20%5Cu2264%2032%29%2C%20which%20denote%20the%20width%20and%20height%20of%20the%20discrete%20Voronoi%20diagram.%5Cn%5CnThe%20following%20_H_%20lines%2C%20each%20of%20which%20consists%20of%20_W_%20letters%2C%20give%20one%20discrete%20Voronoi%20diagram.%20Each%20letter%20represents%20one%20pixel.%5Cn%5CnThe%20end%20of%20input%20is%20indicated%20by%20a%20line%20with%20two%20zeros.%20This%20is%20not%20a%20part%20of%20any%20test%20cases.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20print%20the%20case%20number%20and%20the%20coordinates%20of%20generatrices%20as%20shown%20in%20the%20sample%20output.%20Each%20generatrix%20line%20should%20consist%20of%20its%20identifier%2C%20_x_-coordinate%2C%20and%20_y_-coordinate.%20Generatrices%20should%20be%20printed%20in%20alphabetical%20order%20of%20the%20identifiers.%20Each%20coordinate%20is%20zero-based%20where%20%280%2C%200%29%20indicates%20the%20center%20of%20the%20top-left%20corner%20pixel%20of%20the%20diagram.%5Cn%5CnYou%20may%20assume%20that%20every%20test%20case%20has%20at%20least%20one%20solution.%20If%20there%20are%20multiple%20solutions%2C%20any%20one%20is%20acceptable.%5Cn%5CnPrint%20a%20blank%20line%20after%20every%20test%20case%20including%20the%20last%20one.%22%2C%22samples%22%3A%5B%5B%224%203%5Cr%5Cnooxx%5Cr%5Cnooxx%5Cr%5Cnooxx%5Cr%5Cn4%201%5Cr%5Cnnull%5Cr%5Cn4%204%5Cr%5Cnaabb%5Cr%5Cnaabb%5Cr%5Cnccdd%5Cr%5Cnccdd%5Cr%5Cn0%200%22%2C%22Case%201%3A%5Cr%5Cno%200%200%5Cr%5Cnx%202%200%5Cr%5Cn%5Cr%5CnCase%202%3A%5Cr%5Cnl%202%200%5Cr%5Cnn%200%200%5Cr%5Cnu%201%200%5Cr%5Cn%5Cr%5CnCase%203%3A%5Cr%5Cna%200%200%5Cr%5Cnb%202%200%5Cr%5Cnc%200%202%5Cr%5Cnd%202%202%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B100%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F3009%22%2C%22id%22%3A%223009%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP3009%22%2C%22title%22%3A%22VORONOI%20-%20Revenge%20of%20Voronoi%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22VORONOI%20-%20Revenge%20of%20Voronoi%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>VORONOI - Revenge of Voronoi</h1>
<h2>题目描述</h2>
<div>A discrete Voronoi diagram is a derivation of a Voronoi diagram. It is represented as a set of pixels. Each of the generatrices lies on the center of some pixel. Each pixel belongs to the generatrix nearest from the center of the pixel in the sense of Manhattan distance. The Manhattan distance d between two points (_x_ $ _{1} $ , _y_ $ _{1} $ ) and (_x_ $ _{2} $ , _y_ $ _{2} $ ) is given by the following formula:
_d_ = |_x_ $ _{1} $ - _x_ $ _{2} $ | + |_y_ $ _{1} $ - _y_ $ _{2} $ |Your task is to find a set of generatrices which generates a given discrete Voronoi diagram. In the given diagram, each generatrix is given a unique lowercase letter as its identifier, and each pixel is represented by the identifier of the generatrix the pixel belongs to. If a pixel has multiple generatrices at the same distance from its center, it belongs to the generatrix with the most preceding identifier among them (i.e. the smallest character code).</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The input consists of multiple test cases.
Each test case begins with a line containing two integers _W_ (1 ≤ _W_ ≤ 32) and _H_ (1 ≤ _H_ ≤ 32), which denote the width and height of the discrete Voronoi diagram.
The following _H_ lines, each of which consists of _W_ letters, give one discrete Voronoi diagram. Each letter represents one pixel.
The end of input is indicated by a line with two zeros. This is not a part of any test cases.</div>
<h3>输出格式</h3>
<br />
<div>For each test case, print the case number and the coordinates of generatrices as shown in the sample output. Each generatrix line should consist of its identifier, _x_-coordinate, and _y_-coordinate. Generatrices should be printed in alphabetical order of the identifiers. Each coordinate is zero-based where (0, 0) indicates the center of the top-left corner pixel of the diagram.
You may assume that every test case has at least one solution. If there are multiple solutions, any one is acceptable.
Print a blank line after every test case including the last one.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 3
ooxx
ooxx
ooxx
4 1
null
4 4
aabb
aabb
ccdd
ccdd
0 0</code></pre>
<h3>输出样例 #1</h3>
<pre><code>Case 1:
o 0 0
x 2 0

Case 2:
l 2 0
n 0 0
u 1 0

Case 3:
a 0 0
b 2 0
c 0 2
d 2 2</code></pre>
</article>
</div>
</div>
</body>
</html>
