<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>ONTIME - Just on Time - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450037:tVlm+240ZMN12DtBHVpUiB4JyF20botLnoskdBWRnLw=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Last%20week%5Cu2019s%20campaign%20on%20healthy%20and%20environmentally%20friendly%20mobility%20was%20a%20big%20success.%20Hundreds%20of%20commuters%20to%20the%20EPFL%20campus%20traded%20their%20car%20for%20a%20ride%20by%20bus%20or%20metro%20and%20gave%20a%20very%20positive%20feedback.%20They%20merely%20complained%20about%20earlier%20wake-up%20times%20necessary%20to%20reach%20the%20campus%20on%20time.%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP7404%5C%2Fe2f9a1a7e863f0ec230fe303cf220f11e29a0d47.png%29%5Cn%5CnThis%20is%20where%20you%20enter%20the%20story.%20Try%20to%20improve%20the%20mood%20of%20the%20people%20by%20indicating%20them%20the%20latest%20time%20they%20can%20leave%20their%20house%20such%20that%20they%20can%20reach%20the%20campus%20no%20later%20than%208h15.%20Any%20means%20are%20ok%20to%20maximize%20their%20sleeping%20time%2C%20and%20all%20would%20accept%20to%20change%20bus%20or%20metro%20lines%20several%20times%20during%20their%20journey%20if%20this%20helps%20your%20planning.%5Cn%5CnThe%20public%20transport%20network%20is%20made%20up%20of%20_S%20%280%3C%3DS%3C%3D100%29_%20stations%20%28numbered%20from%201%20to%20_S_%29%20and%20counts%20_C%20%280%3C%3DC%3C%3D1%27000%29_%20unidirectional%20connections%20that%20link%20two%20stations%20in%20regular%20time%20intervals%2C%20starting%20from%20a%20certain%20time%20in%20the%20morning%20and%20up%20to%208h15.%20Note%20that%20for%20any%20two%20stations%2C%20there%20might%20exist%20several%20direct%20shuttle%20services%20with%20different%20starting%20time%20and%20frequency.%20You%20are%20to%20answer%20some%20students%5Cu2019%20request%20on%20the%20latest%20possible%20time%20they%20can%20leave%20from%20home%20in%20order%20not%20to%20be%20late.%5Cn%5Cn%2A%2AINPUT%2A%2A%5Cn%5CnThe%20input%20consists%20of%20several%20test-cases%20separated%20by%20an%20empty%20line.%20Each%20test-case%20starts%20with%20the%20number%20of%20stations%20_S_%2C%20the%20number%20of%20connections%20_C_%20and%20the%20number%20of%20requests%20_R_%20on%20a%20line.%20Then%20come%20_C_%20lines%2C%20each%20describing%20one%20shuttle%20service%20in%20the%20format%20%5Cu2018from%5Cu2019%20%5Cu2018to%5Cu2019%20%5Cu2018firstRide%5Cu2019%20%5Cu2018travelTime%5Cu2019%20%5Cu2018frequency%5Cu2019%20%28in%20minutes%29.%20The%20next%20_R_%20lines%20each%20hold%20two%20integers%2C%20the%20first%20being%20the%20closest%20station%20to%20the%20student%5Cu2019s%20home%20%28come%20what%20may%2C%20but%20so%20early%20no%20student%20would%20like%20to%20walk%20more%20than%20necessary%29%20and%20the%20second%20the%20time%20%28in%20minutes%29%20it%20takes%20the%20student%20to%20reach%20that%20station.%20The%20campus%20is%20located%20at%20station%20_S_.%20Input%20terminates%20on%20a%20test-case%20_with%20S%3DC%3DR%3D0_%2C%20which%20must%20not%20be%20evaluated.%5Cn%5Cn%2A%2AOUTPUT%2A%2A%5Cn%5CnAnswer%20the%20requests%20in%20the%20same%20order%20as%20they%20appeare%20in%20the%20input.%20For%20each%20request%2C%20print%20a%20line%20in%20the%20form%20%5Cu201cLeave%20no%20later%20than%20%5Cu2018time%5Cu2019%5Cu201d%2C%20where%20%5Cu2018time%5Cu2019%20is%20in%20the%20format%20_hh%3Amm_.%20Add%20an%20empty%20line%20after%20each%20test-case.%20If%20there%20is%20no%20way%20the%20students%20can%20make%20it%20on%20time%2C%20output%20%5Cu201cDoomed%20to%20be%20late%5Cu201d.%20You%20can%20safely%20assume%20that%20the%20commuters%20are%20so%20experienced%20in%20hopping%20on%20and%20off%20busses%20that%20they%20can%20change%20busses%20in%20no%20time%20at%20all.%5Cn%5Cn%2A%2ASAMPLE%20INPUT%2A%2A%5Cn%5Cn3%202%202%5Cn%5Cn1%203%2007%3A10%2050%2015%5Cn%5Cn2%203%2008%3A20%205%205%5Cn%5Cn1%203%5Cn%5Cn2%200%5Cn%5Cn3%204%203%5Cn%5Cn2%203%2005%3A30%206%205%5Cn%5Cn1%203%2006%3A11%205%2015%5Cn%5Cn1%202%2007%3A01%202%205%5Cn%5Cn3%202%2008%3A00%201%208%5Cn%5Cn1%202%5Cn%5Cn2%201%5Cn%5Cn3%2010%5Cn%5Cn0%200%200%5Cn%5Cn%2A%2ASAMPLE%20OUTPUT%2A%2A%5Cn%5CnLeave%20no%20later%20than%2007%3A22%5Cn%5CnDoomed%20to%20be%20late%5Cn%5CnLeave%20no%20later%20than%2007%3A59%5Cn%5CnLeave%20no%20later%20than%2008%3A04%5Cn%5CnLeave%20no%20later%20than%2008%3A05%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F7404%22%2C%22id%22%3A%227404%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP7404%22%2C%22title%22%3A%22ONTIME%20-%20Just%20on%20Time%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22ONTIME%20-%20Just%20on%20Time%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>ONTIME - Just on Time</h1>
<h2>题目描述</h2>
<div>Last week’s campaign on healthy and environmentally friendly mobility was a big success. Hundreds of commuters to the EPFL campus traded their car for a ride by bus or metro and gave a very positive feedback. They merely complained about earlier wake-up times necessary to reach the campus on time.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/SP7404/e2f9a1a7e863f0ec230fe303cf220f11e29a0d47.png)
This is where you enter the story. Try to improve the mood of the people by indicating them the latest time they can leave their house such that they can reach the campus no later than 8h15. Any means are ok to maximize their sleeping time, and all would accept to change bus or metro lines several times during their journey if this helps your planning.
The public transport network is made up of _S (0<=S<=100)_ stations (numbered from 1 to _S_) and counts _C (0<=C<=1'000)_ unidirectional connections that link two stations in regular time intervals, starting from a certain time in the morning and up to 8h15. Note that for any two stations, there might exist several direct shuttle services with different starting time and frequency. You are to answer some students’ request on the latest possible time they can leave from home in order not to be late.
**INPUT**
The input consists of several test-cases separated by an empty line. Each test-case starts with the number of stations _S_, the number of connections _C_ and the number of requests _R_ on a line. Then come _C_ lines, each describing one shuttle service in the format ‘from’ ‘to’ ‘firstRide’ ‘travelTime’ ‘frequency’ (in minutes). The next _R_ lines each hold two integers, the first being the closest station to the student’s home (come what may, but so early no student would like to walk more than necessary) and the second the time (in minutes) it takes the student to reach that station. The campus is located at station _S_. Input terminates on a test-case _with S=C=R=0_, which must not be evaluated.
**OUTPUT**
Answer the requests in the same order as they appeare in the input. For each request, print a line in the form “Leave no later than ‘time’”, where ‘time’ is in the format _hh:mm_. Add an empty line after each test-case. If there is no way the students can make it on time, output “Doomed to be late”. You can safely assume that the commuters are so experienced in hopping on and off busses that they can change busses in no time at all.
**SAMPLE INPUT**
3 2 2
1 3 07:10 50 15
2 3 08:20 5 5
1 3
2 0
3 4 3
2 3 05:30 6 5
1 3 06:11 5 15
1 2 07:01 2 5
3 2 08:00 1 8
1 2
2 1
3 10
0 0 0
**SAMPLE OUTPUT**
Leave no later than 07:22
Doomed to be late
Leave no later than 07:59
Leave no later than 08:04
Leave no later than 08:05</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
