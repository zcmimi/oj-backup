<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>UOFTAC - Foxhole - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450403:Pj0W0TNmeDy1Bj4Av8DuxSd5p73DpYa+C8Z2r+TPCXo=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Everyone%20knows%20that%20Foxen%20love%20digging%20holes.%20You%27ve%20been%20observing%20one%20Fox%20in%20particular%2C%20who%27s%20preparing%20to%20burrow%20underground%20in%20search%20of%20treasures.%20When%20viewed%20from%20the%20side%2C%20as%20a%20cross-section%2C%20his%20digging%20site%20can%20be%20represented%20as%20a%20grid%20of%20cells%2C%20%24%20H%20%24%20%28%20%24%201%20%5C%5Cleq%20H%20%5C%5Cleq%20100%20%24%20%29%20deep%20and%20%24%20W%20%24%20%28%20%24%201%20%5C%5Cleq%20W%20%5C%5Cleq%20100%20%24%20%29%20across.%20Every%20cell%20contains%20either%20dirt%20%28represented%20by%20%5C%22D%5C%22%29%2C%20stone%20%28%5C%22S%5C%22%29%2C%20empty%20space%20%28%5C%22E%5C%22%29%2C%20or%20a%20treasure%20%28%5C%22T%5C%22%29.%20The%20surface%20can%20also%20be%20traversed%2C%20effectively%20giving%20the%20grid%20an%20additional%20row%20of%20empty%20cells%20above%20the%20topmost%20row.%5Cn%5CnThe%20Fox%20starts%20immediately%20above%20the%20top-left%20cell%2C%20which%20is%20guaranteed%20to%20not%20be%20empty.%20It%20has%20a%20set%20of%20%24%20N%20%24%20%28%20%24%201%20%5C%5Cleq%20N%20%5C%5Cleq%201000%20%24%20%29%20actions%20in%20mind%20before%20it%20starts%20its%20dig%2C%20which%20it%20will%20execute%20in%20order.%20Each%20action%20consists%20of%20moving%20either%20left%20%28represented%20by%20%5C%22L%5C%22%29%2C%20right%20%28%5C%22R%5C%22%29%2C%20or%20down%20%28%5C%22D%5C%22%29%20by%20one%20cell.%20If%20the%20cell%20that%20the%20Fox%20would%20move%20to%20contains%20stone%2C%20or%20is%20beyond%20the%20boundaries%20of%20the%20grid%20in%20any%20direction%2C%20it%20will%20skip%20that%20action.%20If%20it%20enters%20a%20cell%20with%20a%20previously-uncollected%20treasure%2C%20it%20will%20collect%20it%2C%20leaving%20the%20cell%20empty.%20If%20the%20cell%20immediately%20below%20the%20Fox%20is%20ever%20empty%2C%20it%20will%20fall%20down%20until%20this%20is%20no%20longer%20the%20case.%20Note%20that%20collecting%20treasure%20occurs%20before%20falling%2C%20and%20that%20the%20Fox%20stops%20falling%20if%20it%20hits%20the%20bottom%20of%20the%20grid.%5Cn%5CnThere%20are%20%24%20T%20%24%20%28%20%24%201%20%5C%5Cleq%20T%20%5C%5Cleq%2020%20%24%20%29%20scenarios%20as%20described%20above.%20For%20each%20one%2C%20you%27d%20like%20to%20determine%20how%20many%20treasures%20the%20Fox%20will%20collect%20throughout%20the%20course%20of%20its%20dig.%22%2C%22inputFormat%22%3A%22First%20line%3A%201%20integer%2C%20%24%20T%20%24%5Cn%5CnFor%20each%20scenario%3A%5Cn%5CnFirst%20line%3A%203%20integers%2C%20%24%20H%20%24%20%2C%20%24%20W%20%24%20%2C%20and%20%24%20N%20%24%5Cn%5CnNext%20%24%20H%20%24%20lines%3A%20%24%20W%20%24%20characters%2C%20representing%20the%20%24%20i%20%24%20th%20row%20of%20the%20grid%2C%20for%20%24%20i%20%3D%201..H%20%24%5Cn%5CnNext%20%24%20N%20%24%20lines%3A%201%20character%2C%20representing%20the%20%24%20i%20%24%20th%20action%2C%20for%20%24%20i%20%3D%201..N%20%24%22%2C%22outputFormat%22%3A%22For%20each%20scenario%3A%5Cn%5Cn1%20integer%2C%20the%20number%20of%20treasures%20collected%20in%20total.%22%2C%22samples%22%3A%5B%5B%222%5C%5Cn2%203%204%5C%5CnDDD%5C%5CnTES%5C%5CnR%5C%5CnD%5C%5CnR%5C%5CnL%5C%5Cn3%202%206%5C%5CnTE%5C%5CnTE%5C%5CnET%5C%5CnR%5C%5CnR%5C%5CnL%5C%5CnR%5C%5CnL%5C%5CnR%22%2C%22%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F14972%22%2C%22id%22%3A%2214972%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP14972%22%2C%22title%22%3A%22UOFTAC%20-%20Foxhole%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22UOFTAC%20-%20Foxhole%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>UOFTAC - Foxhole</h1>
<h2>题目描述</h2>
<div>Everyone knows that Foxen love digging holes. You've been observing one Fox in particular, who's preparing to burrow underground in search of treasures. When viewed from the side, as a cross-section, his digging site can be represented as a grid of cells, $ H $ ( $ 1 \leq H \leq 100 $ ) deep and $ W $ ( $ 1 \leq W \leq 100 $ ) across. Every cell contains either dirt (represented by "D"), stone ("S"), empty space ("E"), or a treasure ("T"). The surface can also be traversed, effectively giving the grid an additional row of empty cells above the topmost row.
The Fox starts immediately above the top-left cell, which is guaranteed to not be empty. It has a set of $ N $ ( $ 1 \leq N \leq 1000 $ ) actions in mind before it starts its dig, which it will execute in order. Each action consists of moving either left (represented by "L"), right ("R"), or down ("D") by one cell. If the cell that the Fox would move to contains stone, or is beyond the boundaries of the grid in any direction, it will skip that action. If it enters a cell with a previously-uncollected treasure, it will collect it, leaving the cell empty. If the cell immediately below the Fox is ever empty, it will fall down until this is no longer the case. Note that collecting treasure occurs before falling, and that the Fox stops falling if it hits the bottom of the grid.
There are $ T $ ( $ 1 \leq T \leq 20 $ ) scenarios as described above. For each one, you'd like to determine how many treasures the Fox will collect throughout the course of its dig.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>First line: 1 integer, $ T $
For each scenario:
First line: 3 integers, $ H $ , $ W $ , and $ N $
Next $ H $ lines: $ W $ characters, representing the $ i $ th row of the grid, for $ i = 1..H $
Next $ N $ lines: 1 character, representing the $ i $ th action, for $ i = 1..N $</div>
<h3>输出格式</h3>
<br />
<div>For each scenario:
1 integer, the number of treasures collected in total.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2\n2 3 4\nDDD\nTES\nR\nD\nR\nL\n3 2 6\nTE\nTE\nET\nR\nR\nL\nR\nL\nR</code></pre>
<h3>输出样例 #1</h3>
<pre><code></code></pre>
</article>
</div>
</div>
</body>
</html>
