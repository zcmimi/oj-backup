<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>SOCCERCH - Soccer Challenge - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450229:YnrLq1fQ0Q006XXlKP+q68afhwmdIUYipb9LOOKew4Y=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22A%20soccer%20field%20is%20divided%20into%20squared%20plots%2C%20like%20a%20grid%20of%20N%20rows%20and%20M%20columns.%20The%20length%20of%20a%20plot%20%20%5Cnside%20is%20equal%20to%201.%20Fernando%20likes%20to%20practice%20running%20only%20through%20the%20boundaries%20of%20the%20plots%2C%20he%20%20%5Cndoes%20not%20like%20to%20go%20inside%20the%20plots.%20%20%5CnSome%20of%20the%20plots%20are%20muddy%2C%20and%20some%20others%20have%20been%20selected%20by%20Fernando%20as%20target%20plots.%20A%20%20%5Cnplot%20may%20neither%20be%20muddy%20nor%20a%20target%20one.%20%20%5CnStarting%20at%20the%20top%20left%20corner%2C%20he%20would%20like%20to%20go%20through%20the%20field%20and%20return%20back%20to%20the%20starting%20%20%5Cnpoint.%20All%20plots%20that%20lie%20inside%20the%20cycle%20of%20his%20path%20are%20considered%20to%20be%20inspected.%20To%20make%20things%20%20%5Cnmore%20interesting%20he%20would%20like%20his%20path%20not%20to%20intersect%20with%20itself%20in%20any%20point%20different%20than%20the%20%20%5Cnstarting%20point.%20Luckily%2C%20the%20plots%20boundaries%20are%20so%20wide%20that%20Fernando%20can%20go%20along%20the%20same%20%20%5Cnboundary%20multiple%20times%20without%20intersecting%20his%20own%20path.%20%20%5CnFernando%20would%20like%20to%20inspect%20all%20target%20plots%2C%20but%20not%20any%20muddy%20plots.%20Martin%2C%20who%20plays%20in%20the%20%20%5Cnopposing%20team%2C%20challenged%20Fernando%20that%20he%20could%20do%20a%20shortest%20path%20starting%20from%20the%20lower%20right%20%20%5Cncorner.%20Can%20you%20help%20Fernando%20to%20get%20his%20shortest%20path%2C%20and%20decide%20weather%20it%20is%20shorter%20than%20the%20one%22%2C%22inputFormat%22%3A%22Input%20consist%20of%20many%20test%20cases.%20%20%5CnFirst%20line%20of%20input%20starts%20with%20two%20integers%20R%20and%20C%20%281%3C%3DR%2CC%3C%3D50%29%2C%20which%20defines%20the%20rows%20and%20%20%5Cncolumns%20the%20soccer%20field%20has%20been%20divided%20into.%20%20%5CnNext%2C%20the%20soccer%20field%20is%20described%20in%20R%20rows%2C%20each%20containing%20C%20characters.%20Chars%20I%2C%20X%2C%20and%20O%2C%20%20%5Cnrepresents%20target%20plots%20%28to%20inspect%29%2C%20muddy%20plots%2C%20and%20common%20plots%20respectively.%20The%20quantity%20of%20%20%5Cntarget%20plots%20plus%20the%20quantity%20of%20muddy%20plots%20will%20not%20exceed%2010.%20%20%5CnThere%20will%20be%20not%20spaces%20between%20the%20C%20characters%20of%20each%20line%20describing%20the%20soccer%20field.%20%20%5CnEnd%20of%20the%20input%20is%20indicated%20by%20a%20line%20containing%20two%20zeros%2C%20and%20should%20not%20be%20processed.%22%2C%22outputFormat%22%3A%22The%20output%20of%20each%20test%20case%20should%20be%20a%20separate%20line%20consisting%20of%20the%20name%20of%20the%20player%20who%20has%20%20%5Cnthe%20shortest%20path%20to%20inspect%20the%20target%20plots%20but%20not%20the%20muddy%20plots%2C%20or%20the%20word%20%5Cu201cTie%5Cu201d%20in%20case%20of%20a%20tie%2C%20%20%5Cnfollowed%20by%20a%20number%20representing%20the%20length%20of%20the%20shortest%20path%20for%20that%20player.%20The%20examples%20may%20%20%5Cnclarify%20the%20format.%22%2C%22samples%22%3A%5B%5B%221%201%20%5C%5CnI%20%5C%5Cn2%202%20%5C%5CnXX%20%5C%5CnXI%20%5C%5Cn2%202%20%5C%5CnXI%20%5C%5CnIX%20%5C%5Cn3%203%20%5C%5CnIII%20%5C%5CnIXI%20%5C%5CnIII%20%5C%5Cn2%202%20%5C%5CnIO%20%5C%5CnOO%20%5C%5Cn0%200%22%2C%22Tie%204%5C%5CnMartin%204%5C%5CnTie%2010%5C%5CnTie%2018%5C%5CnFernando%204%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B24890%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F10571%22%2C%22id%22%3A%2210571%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP10571%22%2C%22title%22%3A%22SOCCERCH%20-%20Soccer%20Challenge%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22SOCCERCH%20-%20Soccer%20Challenge%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>SOCCERCH - Soccer Challenge</h1>
<h2>题目描述</h2>
<div>A soccer field is divided into squared plots, like a grid of N rows and M columns. The length of a plot
side is equal to 1. Fernando likes to practice running only through the boundaries of the plots, he
does not like to go inside the plots.
Some of the plots are muddy, and some others have been selected by Fernando as target plots. A
plot may neither be muddy nor a target one.
Starting at the top left corner, he would like to go through the field and return back to the starting
point. All plots that lie inside the cycle of his path are considered to be inspected. To make things
more interesting he would like his path not to intersect with itself in any point different than the
starting point. Luckily, the plots boundaries are so wide that Fernando can go along the same
boundary multiple times without intersecting his own path.
Fernando would like to inspect all target plots, but not any muddy plots. Martin, who plays in the
opposing team, challenged Fernando that he could do a shortest path starting from the lower right
corner. Can you help Fernando to get his shortest path, and decide weather it is shorter than the one</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Input consist of many test cases.
First line of input starts with two integers R and C (1<=R,C<=50), which defines the rows and
columns the soccer field has been divided into.
Next, the soccer field is described in R rows, each containing C characters. Chars I, X, and O,
represents target plots (to inspect), muddy plots, and common plots respectively. The quantity of
target plots plus the quantity of muddy plots will not exceed 10.
There will be not spaces between the C characters of each line describing the soccer field.
End of the input is indicated by a line containing two zeros, and should not be processed.</div>
<h3>输出格式</h3>
<br />
<div>The output of each test case should be a separate line consisting of the name of the player who has
the shortest path to inspect the target plots but not the muddy plots, or the word “Tie” in case of a tie,
followed by a number representing the length of the shortest path for that player. The examples may
clarify the format.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1 1 \nI \n2 2 \nXX \nXI \n2 2 \nXI \nIX \n3 3 \nIII \nIXI \nIII \n2 2 \nIO \nOO \n0 0</code></pre>
<h3>输出样例 #1</h3>
<pre><code>Tie 4\nMartin 4\nTie 10\nTie 18\nFernando 4</code></pre>
</article>
</div>
</div>
</body>
</html>
