<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>HACKERS - Hackers - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450039:muSCyn2NWArp4/vVF3HjJq16B7ebbWpi2TLh487kJE0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20network%20of%20your%20office%20is%20composed%20of%20several%20computers%20and%20bidirectional%20links.%20Each%20%20%5Cnlink%20connects%20a%20given%20pair%20of%20computers%20and%20has%20an%20access%20value.%20Each%20user%20in%20the%20network%20%20%5Cnhas%20an%20access%20privilege%2C%20and%20is%20able%20to%20use%20any%20link%20with%20access%20value%20not%20exceeding%20his%20%20%5Cnaccess%20privilege.%20%20%5CnEverything%20was%20fine%20until%20suddenly%20you%20notice%20that%20a%20bunch%20of%20hackers%20are%20accessing%20the%20%20%5Cnnetwork.%20You%20know%20that%20if%20there%20is%20a%20link%20between%20computers%20A%20and%20B%2C%20with%20access%20value%20%20%5CnV%20%2C%20and%20a%20hacker%20with%20access%20privilege%20of%20at%20least%20V%20controls%20A%2C%20then%20he%20can%20control%20B.%20%20%5CnHackers%20wish%20to%20control%20the%20most%20important%20computers%20by%20exploiting%20problems%20in%20the%20%20%5Cnnetwork.%20They%20are%20trying%20to%20increase%20their%20access%20privileges%20in%20order%20to%20use%20the%20links%2C%20and%20%20%5Cnyour%20task%20is%20to%20measure%20how%20safe%20the%20network%20is.%20%20%5CnGiven%20the%20description%20of%20the%20network%2C%20the%20computer%20each%20hacker%20currently%20controls%20and%20%20%5Cnthe%20target%20computer%20each%20hacker%20wishes%20to%20control%2C%20you%20need%20to%20calculate%20the%20minimum%20%20%5Cnaccess%20privilege%20each%20hacker%20needs%20to%20get%20in%20order%20to%20control%20his%20target%20computer.%20%20%5CnHackers%20act%20independently%2C%20neither%20they%20collaborate%20nor%20interfere%20with%20each%20other.%20This%20%20%5Cnmeans%20that%20each%20hacker%20may%20control%20each%20computer%20and%20use%20each%20link%20independently%20of%20%20%5Cnwhat%20the%20other%20hackers%20do.%22%2C%22inputFormat%22%3A%22Each%20test%20case%20is%20described%20using%20several%20lines.%20The%20first%20line%20contains%20three%20integers%20%20%5CnC%2C%20L%20and%20H%2C%20indicating%20the%20number%20of%20computers%2C%20links%20and%20hackers%20in%20the%20network%2C%20%20%5Cnrespectively%20%282%20number%20between%201%20and%20C.%20Each%20of%20the%20next%20L%20lines%20describes%20a%20different%20bidirectional%20link%20%20%5Cnusing%20three%20integers%20A%2C%20B%20and%20V%20%3B%20the%20numbers%20A%20and%20B%20identify%20two%20distinct%20computers%20%20%5Cnthat%20are%20the%20endpoints%20of%20the%20link%20%281%20of%20the%20link%2C%20that%20is%2C%20any%20hacker%20must%20have%20an%20access%20privilege%20of%20at%20least%20V%20to%20use%20the%20%20%5Cnlink%20%281%20distinct%20integers%20S%20and%20T%20that%20identify%20the%20computer%20that%20the%20hacker%20currently%20controls%20%20%5Cnand%20the%20computer%20that%20the%20hacker%20wishes%20to%20control%2C%20respectively%20%281%20may%20assume%20that%20within%20each%20test%20case%20no%20two%20links%20connect%20the%20same%20pair%20of%20computers%2C%20%20%5Cnand%20that%20for%20any%20pair%20of%20computers%20there%20is%20at%20least%20one%20sequence%20of%20links%20that%20allow%20to%20%20%5Cnreach%20one%20computer%20starting%20from%20the%20other.%20The%20end%20of%20input%20is%20indicated%20with%20a%20line%20%20%5Cncontaining%20the%20number%20%5Cu22121%20three%20times.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20output%20a%20single%20line%20with%20H%20integers%20representing%20the%20minimum%20access%20%20%5Cnprivilege%20each%20hacker%20needs%20to%20achieve%20its%20goal.%20The%20result%20for%20each%20hacker%20must%20appear%20%20%5Cnin%20the%20same%20order%20that%20the%20hackers%20are%20described%20in%20the%20input.%22%2C%22samples%22%3A%5B%5B%22%5C%5Cn5%206%204%5C%5Cn1%202%204%5C%5Cn1%203%205%5C%5Cn2%204%203%5C%5Cn2%205%201%5C%5Cn3%204%202%5C%5Cn4%205%202%5C%5Cn3%202%5C%5Cn2%204%5C%5Cn1%205%5C%5Cn3%201%5C%5Cn2%201%201%5C%5Cn1%202%201%5C%5Cn2%201%5C%5Cn2%201%203%5C%5Cn1%202%201000000000%5C%5Cn2%201%5C%5Cn2%201%5C%5Cn1%202%5C%5Cn-1%20-1%20-1%5Cr%5Cn%5C%5Cn%22%2C%22%5C%5Cn2%202%204%204%5C%5Cn1%5C%5Cn1000000000%201000000000%201000000000%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5157%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F7425%22%2C%22id%22%3A%227425%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP7425%22%2C%22title%22%3A%22HACKERS%20-%20Hackers%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22HACKERS%20-%20Hackers%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>HACKERS - Hackers</h1>
<h2>题目描述</h2>
<div>The network of your office is composed of several computers and bidirectional links. Each
link connects a given pair of computers and has an access value. Each user in the network
has an access privilege, and is able to use any link with access value not exceeding his
access privilege.
Everything was fine until suddenly you notice that a bunch of hackers are accessing the
network. You know that if there is a link between computers A and B, with access value
V , and a hacker with access privilege of at least V controls A, then he can control B.
Hackers wish to control the most important computers by exploiting problems in the
network. They are trying to increase their access privileges in order to use the links, and
your task is to measure how safe the network is.
Given the description of the network, the computer each hacker currently controls and
the target computer each hacker wishes to control, you need to calculate the minimum
access privilege each hacker needs to get in order to control his target computer.
Hackers act independently, neither they collaborate nor interfere with each other. This
means that each hacker may control each computer and use each link independently of
what the other hackers do.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Each test case is described using several lines. The first line contains three integers
C, L and H, indicating the number of computers, links and hackers in the network,
respectively (2 number between 1 and C. Each of the next L lines describes a different bidirectional link
using three integers A, B and V ; the numbers A and B identify two distinct computers
that are the endpoints of the link (1 of the link, that is, any hacker must have an access privilege of at least V to use the
link (1 distinct integers S and T that identify the computer that the hacker currently controls
and the computer that the hacker wishes to control, respectively (1 may assume that within each test case no two links connect the same pair of computers,
and that for any pair of computers there is at least one sequence of links that allow to
reach one computer starting from the other. The end of input is indicated with a line
containing the number −1 three times.</div>
<h3>输出格式</h3>
<br />
<div>For each test case, output a single line with H integers representing the minimum access
privilege each hacker needs to achieve its goal. The result for each hacker must appear
in the same order that the hackers are described in the input.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>\n5 6 4\n1 2 4\n1 3 5\n2 4 3\n2 5 1\n3 4 2\n4 5 2\n3 2\n2 4\n1 5\n3 1\n2 1 1\n1 2 1\n2 1\n2 1 3\n1 2 1000000000\n2 1\n2 1\n1 2\n-1 -1 -1
\n</code></pre>
<h3>输出样例 #1</h3>
<pre><code>\n2 2 4 4\n1\n1000000000 1000000000 1000000000</code></pre>
</article>
</div>
</div>
</body>
</html>
