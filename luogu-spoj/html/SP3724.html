<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>RAINBOW - Rainbow Ride - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449819:WgoZCreXBVaMd8qjvnpyEEk+56eO79zb8U0FGp6mQqs=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Mr.Raju%20and%20his%20extended%20family%20are%20on%20vacation%20in%20Chennai.%20They%20visit%20MGM%20and%20see%20the%20Rainbow%20ride.%20They%20want%20to%20enjoy%20the%20ride.%20However%2C%20there%20are%20some%20problems.%5Cn%5Cn%20Each%20person%20in%20the%20family%20likes%20some%20other%20people%20in%20the%20family.%20Each%20person%20insists%20that%20he%20or%20she%20will%20go%20on%20the%20ride%20only%20if%20all%20the%20people%20whom%20that%20person%20likes%20and%20all%20the%20people%20who%20like%20that%20person%20also%20go%20on%20the%20ride.%20If%20someone%20doesn%27t%20like%20anyone%20and%20no%20one%20likes%20him%2C%20he%20may%20come%20for%20the%20ride.%5Cn%5Cn%20You%20have%20been%20roped%20in%20to%20solve%20this%20dilemma.%20Given%20the%20weight%20of%20the%20each%20person%20in%20the%20family%2C%20and%20the%20list%20of%20people%20they%20like%2C%20and%20the%20maximum%20weight%20that%20the%20Rainbow%20can%20bear%20safely%2C%20calculate%20the%20maximum%20number%20of%20people%20in%20the%20family%20who%20can%20go%20on%20the%20rainbow.%22%2C%22inputFormat%22%3A%22%20There%20will%20be%20multiple%20test%20cases%20in%20the%20input.%20For%20our%20convenience%20the%20family%20members%20are%20numbered%20from%201%20to%20n.%20Each%20test%20case%20begins%20with%20a%20line%20containing%20two%20integers%20%2A%2An%2A%2A%20%28%201%20%5Cu2264%20n%20%5Cu2264%201000%20%29%20and%20%2A%2AC%2A%2A%20%28%200%20%5Cu2264%20C%20%5Cu2264%201000%20%29%2C%20where%20n%20is%20the%20number%20of%20people%20in%20the%20family%20and%20C%20the%20maximum%20capacity%20of%20the%20ride%20in%20kilograms.%5Cn%5Cn%20The%20next%20line%20contains%20n%20space%20separated%20integers%20with%20the%20%2A%2Ai%2A%2Ath%20integer%20giving%20the%20weight%20of%20the%20%2A%2Ai%2A%2A%20th%20family%20member.%20These%20weights%20are%20positive%20and%20less%20than%20or%20equal%20to%20200%20kilograms.%20Then%20n%20lines%20follow.%20Each%20line%20contains%20a%20sequence%20of%20integers%20separated%20by%20spaces.%20The%20first%20integer%20%2A%2Ak%20%24%20_%7Bi%7D%20%24%2A%2A%20%20gives%20the%20number%20of%20people%20in%20the%20family%20person%20%2A%2Ai%2A%2A%20likes%2C%20followed%20by%20the%20persons%20%2A%2Ai%2A%2A%20likes.%20An%20empty%20line%20separates%20each%20test%20case.%20The%20end%20of%20input%20is%20indicated%20by%20n%3D0%20and%20C%3D0%20and%20it%20should%20not%20be%20processed.There%20are%20atmost%2050%20test%20cases.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%20output%20on%20a%20separate%20line%20the%20maximum%20number%20of%20persons%20that%20can%20take%20the%20ride%20under%20the%20given%20conditions.%22%2C%22samples%22%3A%5B%5B%225%20200%5Cr%5Cn50%2050%2050%2050%2050%5Cr%5Cn1%202%5Cr%5Cn1%203%5Cr%5Cn0%5Cr%5Cn1%205%5Cr%5Cn1%204%5Cr%5Cn%5Cr%5Cn3%20200%5Cr%5Cn100%20100%20100%5Cr%5Cn1%202%5Cr%5Cn1%203%5Cr%5Cn1%201%5Cr%5Cn%5Cr%5Cn0%200%22%2C%223%5Cr%5Cn0%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B828%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F3724%22%2C%22id%22%3A%223724%22%7D%2C%22translation%22%3A%22Mr.Raju%5Cu548c%5Cu4ed6%5Cu7684%5Cu5927%5Cu5bb6%5Cu5ead%5Cu6b63%5Cu5728Chennai%5Cu5ea6%5Cu5047%5Cu3002%5Cu4ed6%5Cu4eec%5Cu53c2%5Cu89c2%5Cu4e86MGM%5Cuff08%5Cu7c73%5Cu9ad8%5Cu6885%5Cuff09%5Cuff0c%5Cu770b%5Cu5230%5Cu4e86%5Cu5f69%5Cu8679%5Cu4e4b%5Cu65c5%5Cu3002%5Cu4ed6%5Cu4eec%5Cu5e0c%5Cu671b%5Cu53ef%5Cu4ee5%5Cu4eab%5Cu53d7%5Cu8fd9%5Cu6b21%5Cu65c5%5Cu884c%5Cu3002%5Cu4f46%5Cu662f%5Cuff0c%5Cu8fd9%5Cu5176%5Cu4e2d%5Cu4e5f%5Cu5b58%5Cu5728%5Cu4e00%5Cu4e9b%5Cu95ee%5Cu9898%5Cu3002%5Cu6bcf%5Cu4e2a%5Cu5bb6%5Cu5ead%5Cu6210%5Cu5458%5Cu90fd%5Cu559c%5Cu6b22%5Cu53e6%5Cu4e00%5Cu4e2a%5Cu5bb6%5Cu5ead%5Cu6210%5Cu5458%5Cuff0c%5Cu6bcf%5Cu4e2a%5Cu4eba%5Cu90fd%5Cu575a%5Cu6301%5Cu8ba4%5Cu4e3a%5Cuff0c%5Cu53ea%5Cu6709%5Cu5f53%5Cu90a3%5Cu4e2a%5Cu4eba%5Cu559c%5Cu6b22%5Cu7684%5Cu4eba%5Cu548c%5Cu559c%5Cu6b22%5Cu90a3%5Cu4e2a%5Cu4eba%5Cu7684%5Cu4eba%5Cu90fd%5Cu4e0a%5Cu8f66%5Cu65f6%5Cuff0cTa%5Cu624d%5Cu4f1a%5Cu4e0a%5Cu8f66%5Cu3002%5Cu5982%5Cu679c%5Cu6709%5Cu4eba%5Cu4e0d%5Cu559c%5Cu6b22%5Cu4efb%5Cu4f55%5Cu4eba%5Cuff0c%5Cu6ca1%5Cu6709%5Cu4eba%5Cu559c%5Cu6b22%5Cu4ed6%5Cuff0c%5Cu4ed6%5Cu53ef%5Cu80fd%5Cu4f1a%5Cu6765%5Cu515c%5Cu98ce%5Cu3002%5Cr%5Cn%5Cu4f60%5Cu88ab%5Cu62c9%5Cu8fdb%5Cu53bb%5Cu89e3%5Cu51b3%5Cu8fd9%5Cu4e2a%5Cu96be%5Cu9898%5Cu3002%5Cu7ed9%5Cu51fa%5Cu5bb6%5Cu5ead%5Cu4e2d%5Cu6bcf%5Cu4e2a%5Cu4eba%5Cu7684%5Cu4f53%5Cu91cd%5Cuff0c%5Cu4ee5%5Cu53ca%5Cu4ed6%5Cu4eec%5Cu559c%5Cu6b22%5Cu7684%5Cu4eba%5Cu7684%5Cu5217%5Cu8868%5Cuff0c%5Cu4ee5%5Cu53ca%5Cu5f69%5Cu8679%5Cu80fd%5Cu591f%5Cu5b89%5Cu5168%5Cu627f%5Cu53d7%5Cu7684%5Cu6700%5Cu5927%5Cu91cd%5Cu91cf%5Cuff0c%5Cu8ba1%5Cu7b97%5Cu5bb6%5Cu5ead%5Cu4e2d%5Cu80fd%5Cu591f%5Cu4e0a%5Cu5f69%5Cu8679%5Cu7684%5Cu6700%5Cu5927%5Cu4eba%5Cu6570%5Cu3002%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A70%2C%22totalAccepted%22%3A26%2C%22pid%22%3A%22SP3724%22%2C%22title%22%3A%22RAINBOW%20-%20Rainbow%20Ride%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P2652%22%2C%22title%22%3A%22%5Cu540c%5Cu82b1%5Cu987a%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P2880%22%2C%22title%22%3A%22%5BUSACO07JAN%5D%5Cu5e73%5Cu8861%5Cu7684%5Cu9635%5Cu5bb9Balanced%20Lineup%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4145%22%2C%22title%22%3A%22%5Cu4e0a%5Cu5e1d%5Cu9020%5Cu9898%5Cu7684%5Cu4e03%5Cu5206%5Cu949f2%20%5C%2F%20%5Cu82b1%5Cu795e%5Cu6e38%5Cu5386%5Cu5404%5Cu56fd%22%2C%22difficulty%22%3A5%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22UVA1185%22%2C%22title%22%3A%22Big%20Number%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22UVA%22%7D%2C%7B%22pid%22%3A%22P5587%22%2C%22title%22%3A%22%5Cu6253%5Cu5b57%5Cu7ec3%5Cu4e60%22%2C%22difficulty%22%3A3%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22RAINBOW%20-%20Rainbow%20Ride%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>RAINBOW - Rainbow Ride</h1>
<h2>题意翻译</h2>
<div>Mr.Raju和他的大家庭正在Chennai度假。他们参观了MGM（米高梅），看到了彩虹之旅。他们希望可以享受这次旅行。但是，这其中也存在一些问题。每个家庭成员都喜欢另一个家庭成员，每个人都坚持认为，只有当那个人喜欢的人和喜欢那个人的人都上车时，Ta才会上车。如果有人不喜欢任何人，没有人喜欢他，他可能会来兜风。
你被拉进去解决这个难题。给出家庭中每个人的体重，以及他们喜欢的人的列表，以及彩虹能够安全承受的最大重量，计算家庭中能够上彩虹的最大人数。</div>
<h2>题目描述</h2>
<div>Mr.Raju and his extended family are on vacation in Chennai. They visit MGM and see the Rainbow ride. They want to enjoy the ride. However, there are some problems.
Each person in the family likes some other people in the family. Each person insists that he or she will go on the ride only if all the people whom that person likes and all the people who like that person also go on the ride. If someone doesn't like anyone and no one likes him, he may come for the ride.
You have been roped in to solve this dilemma. Given the weight of the each person in the family, and the list of people they like, and the maximum weight that the Rainbow can bear safely, calculate the maximum number of people in the family who can go on the rainbow.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div> There will be multiple test cases in the input. For our convenience the family members are numbered from 1 to n. Each test case begins with a line containing two integers **n** ( 1 ≤ n ≤ 1000 ) and **C** ( 0 ≤ C ≤ 1000 ), where n is the number of people in the family and C the maximum capacity of the ride in kilograms.
The next line contains n space separated integers with the **i**th integer giving the weight of the **i** th family member. These weights are positive and less than or equal to 200 kilograms. Then n lines follow. Each line contains a sequence of integers separated by spaces. The first integer **k $ _{i} $** gives the number of people in the family person **i** likes, followed by the persons **i** likes. An empty line separates each test case. The end of input is indicated by n=0 and C=0 and it should not be processed.There are atmost 50 test cases.</div>
<h3>输出格式</h3>
<br />
<div>For each test case output on a separate line the maximum number of persons that can take the ride under the given conditions.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 200
50 50 50 50 50
1 2
1 3
0
1 5
1 4

3 200
100 100 100
1 2
1 3
1 1

0 0</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3
0</code></pre>
</article>
</div>
</div>
</body>
</html>
