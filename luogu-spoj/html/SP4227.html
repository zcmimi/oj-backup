<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>MSE06I - &quot;Shortest&quot; pair of paths - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449867:JEZPJbZ3C0Wni1iDE5OjVSOqL6g5DhMi3wfPz3jEcqU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22%5BEnglish%5D%28%257B%24base%257Dproblems%5C%2F%257B%24code%257D%5C%2Fen%5C%2F%29%20%20%5Cn%20%5BVietnamese%5D%28%257B%24base%257Dproblems%5C%2F%257B%24code%257D%5C%2Fvn%5C%2F%29%20%20%5Cn%20A%20chemical%20company%20has%20an%20unusual%20shortest%20path%20problem.%20There%20are%20N%20depots%20%28vertices%29%20where%20chemicals%20can%20be%20stored.%20There%20are%20M%20individual%20shipping%20methods%20%28edges%29%20connecting%20pairs%20of%20depots.%20Each%20individual%20shipping%20method%20has%20a%20cost.%20In%20the%20usual%20problem%2C%20the%20company%20would%20need%20to%20find%20a%20way%20to%20route%20a%20single%20shipment%20from%20the%20first%20depot%20%280%29%20to%20the%20last%20%28N%20-%201%29.%20That%27s%20easy.%20The%20problem%20they%20have%20seems%20harder.%20They%20have%20to%20ship%20two%20chemicals%20from%20the%20first%20depot%20%280%29%20to%20the%20last%20%28N%20-%201%29.%20The%20chemicals%20are%20dangerous%20and%20cannot%20safely%20be%20placed%20together.%20The%20regulations%20say%20the%20company%20cannot%20use%20the%20same%20shipping%20method%20for%20both%20chemicals.%20Further%2C%20the%20company%20cannot%20place%20the%20two%20chemicals%20in%20same%20depot%20%28for%20any%20length%20of%20time%29%20without%20special%20storage%20handling%20---%20available%20only%20at%20the%20first%20and%20last%20depots.%5Cn%5Cn%20To%20begin%2C%20they%20need%20to%20know%20if%20it%27s%20possible%20to%20ship%20both%20chemicals%20under%20these%20constraints.%20Next%2C%20they%20need%20to%20find%20the%20least%20cost%20of%20shipping%20both%20chemicals%20from%20first%20depot%20to%20the%20last%20depot.%20In%20brief%2C%20they%20need%20two%20completely%20separate%20paths%20%28from%20the%20first%20depot%20to%20the%20last%29%20where%20the%20overall%20cost%20of%20both%20is%20minimal.%20Your%20program%20must%20simply%20determine%20the%20minimum%20cost%20or%2C%20if%20it%27s%20not%20possible%2C%20conclusively%20state%20that%20the%20shipment%20cannot%20be%20made.%5Cn%5CnThe%20input%20will%20consist%20of%20multiple%20cases.%20The%20first%20line%20of%20each%20input%20will%20contain%20N%20and%20M%20where%20N%20is%20the%20number%20of%20depots%20and%20M%20is%20the%20number%20of%20individual%20shipping%20methods.%20You%20may%20assume%20that%20N%20is%20less%20than%2020%20and%20that%20M%20is%20less%20than%20200.%20The%20next%20M%20lines%20will%20contain%20three%20values%2C%20i%2C%20j%2C%20and%20v.%20Each%20line%20corresponds%20a%20single%2C%20unique%20shipping%20method.%20The%20values%20i%20and%20j%20are%20the%20indices%20of%20two%20depots%2C%20and%20v%20is%20the%20cost%20of%20getting%20from%20i%20to%20j.%20Note%20that%20these%20shipping%20methods%20are%20directed.%20If%20something%20can%20be%20shipped%20from%20i%20to%20j%20with%20cost%2010%2C%20that%20says%20nothing%20about%20shipping%20from%20j%20to%20i.%20Also%2C%20there%20may%20be%20more%20than%20one%20way%20to%20ship%20between%20any%20pair%20of%20depots%2C%20and%20that%20may%20be%20important%20here.%5Cn%5CnA%20line%20containing%20two%20zeroes%20signals%20the%20end%20of%20data%20and%20should%20not%20be%20processed.%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B280%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F4227%22%2C%22id%22%3A%224227%22%7D%2C%22translation%22%3A%22%5Cu73b0%5Cu5728%5Cu6709%5Cu4e00%5Cu5bb6%5Cu516c%5Cu53f8%5Cuff0c%5Cu8fd9%5Cu5bb6%5Cu516c%5Cu53f8%5Cu6709%5Cu4e00%5Cu4e2a%5Cu5173%5Cu4e8e%5Cu6700%5Cu77ed%5Cu8def%5Cu5f84%5Cu7684%5Cu95ee%5Cu9898%5Cu3002%5Cn%5Cn%5Cu73b0%5Cu5728%5Cu6709n%5Cu4e2a%5Cu4ed3%5Cu5e93%5Cuff08%5Cu4e5f%5Cu5c31%5Cu662f%5Cu9876%5Cu70b9%5Cuff0c%5Cu7f16%5Cu53f7%5Cu4ece0%5Cu5230n-1%5Cuff09%5Cu53ef%5Cu4ee5%5Cu5b58%5Cu50a8%5Cu8d27%5Cu7269%5Cu3002%5Cu6709m%5Cu8fd0%5Cu8f93%5Cu65b9%5Cu6cd5%5Cuff08%5Cu4e5f%5Cu5c31%5Cu662f%5Cu8fb9%5Cuff09%5Cu8fde%5Cu63a5%5Cu6210%5Cu5bf9%5Cu7684%5Cu4ed3%5Cu5e93%5Cu3002%5Cu6bcf%5Cu79cd%5Cu8fd0%5Cu8f93%5Cu65b9%5Cu5f0f%5Cu90fd%5Cu6709%5Cu6210%5Cu672c%5Cu3002%5Cn%5Cn%5Cu6240%5Cu4ee5%5Cuff0c%5Cu516c%5Cu53f8%5Cu9700%5Cu8981%5Cu627e%5Cu5230%5Cu4e00%5Cu79cd%5Cu65b9%5Cu6cd5%5Cuff0c%5Cu5c06%5Cu4e00%5Cu6279%5Cu8d27%5Cu7269%5Cu4ece%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu4ed3%5Cu5e93%5Cuff08%5Cu7f16%5Cu53f7%5Cu4e3a0%5Cuff09%5Cu8fd0%5Cu9001%5Cu5230%5Cu6700%5Cu540e%5Cu4e00%5Cu4e2a%5Cu4ed3%5Cu5e93%5Cuff08%5Cu7f16%5Cu53f7%5Cu4e3an-1%5Cuff09%5Cu3002%5Cn%5Cn%5Cu4ed6%5Cu4eec%5Cu5fc5%5Cu987b%5Cu4ece%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu4ed3%5Cu5e93%5Cu5230%5Cu6700%5Cu540e%5Cu4e00%5Cu4e2a%5Cu4ed3%5Cu5e93%5Cu8fd0%5Cu9001%5Cu4e24%5Cu79cd%5Cu4e1c%5Cu897f%5Cu3002%5Cu8fd9%5Cu4e9b%5Cu4e1c%5Cu897f%5Cu7531%5Cu4e8e%5Cu5f88%5Cu5371%5Cu9669%5Cuff0c%5Cu4e0d%5Cu80fd%5Cu5b89%5Cu5168%5Cu5730%5Cu653e%5Cu5728%5Cu4e00%5Cu8d77%5Cu3002%5Cn%5Cn%5Cu6240%5Cu4ee5%5Cu6211%5Cu4eec%5Cu89c4%5Cu5b9a%5Cuff0c%5Cu516c%5Cu53f8%5Cu4e0d%5Cu80fd%5Cu5bf9%5Cu4e24%5Cu79cd%5Cu4e1c%5Cu897f%5Cu4f7f%5Cu7528%5Cu76f8%5Cu540c%5Cu7684%5Cu8fd0%5Cu8f93%5Cu65b9%5Cu6cd5%5Cu3002%5Cu6b64%5Cu5916%5Cuff0c%5Cu516c%5Cu53f8%5Cu4e0d%5Cu80fd%5Cu5c06%5Cu4e24%5Cu79cd%5Cu4e1c%5Cu897f%5Cu653e%5Cu7f6e%5Cu5728%5Cu540c%5Cu4e00%5Cu4ed3%5Cu5e93%5Cuff08%5Cu4efb%5Cu4f55%5Cu65f6%5Cu95f4%5Cu6bb5%5Cu90fd%5Cu4e0d%5Cu53ef%5Cu4ee5%5Cuff09%5Cuff0c%5Cu800c%5Cu5728%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu548c%5Cu6700%5Cu540e%5Cu4e00%5Cu4e2a%5Cu4ed3%5Cu5e93%5Cu4e0d%5Cu53d7%5Cu7ea6%5Cu675f%5Cu3002%5Cn%5Cn%5Cn%5Cu9996%5Cu5148%5Cuff0c%5Cu4ed6%5Cu4eec%5Cu60f3%5Cu77e5%5Cu9053%5Cu6709%5Cu6ca1%5Cu6709%5Cu53ef%5Cu80fd%5Cu5728%5Cu8fd9%5Cu4e9b%5Cu9650%5Cu5236%5Cu4e0b%5Cu8fd0%5Cu8f93%5Cu8fd9%5Cu4e24%5Cu79cd%5Cu4e1c%5Cu897f%5Cu3002%5Cn%5Cn%5Cu63a5%5Cu4e0b%5Cu6765%5Cuff0c%5Cu4ed6%5Cu4eec%5Cu9700%5Cu8981%5Cu627e%5Cu5230%5Cu4ece%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu4ed3%5Cu5e93%5Cu5230%5Cu6700%5Cu540e%5Cu4e00%5Cu4e2a%5Cu4ed3%5Cu5e93%5Cu8fd0%5Cu8f93%5Cu8fd9%5Cu4e24%5Cu79cd%5Cu4e1c%5Cu897f%5Cu7684%5Cu6700%5Cu4f4e%5Cu6210%5Cu672c%5Cu3002%5Cn%5Cn%5Cu7b80%5Cu800c%5Cu8a00%5Cu4e4b%5Cuff0c%5Cu4ed6%5Cu4eec%5Cu9700%5Cu8981%5Cu4e24%5Cu6761%5Cu5b8c%5Cu5168%5Cu72ec%5Cu7acb%5Cu7684%5Cu8def%5Cu5f84%5Cuff08%5Cu4ece%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu4ed3%5Cu5e93%5Cu5230%5Cu6700%5Cu540e%5Cu4e00%5Cu4e2a%5Cu4ed3%5Cu5e93%5Cuff09%5Cuff0c%5Cu4e24%5Cu8005%5Cu7684%5Cu603b%5Cu6210%5Cu672c%5Cu6700%5Cu4f4e%5Cu3002%5Cn%5Cn%5Cu73b0%5Cu5728%5Cu8bf7%5Cu7ed9%5Cu51fa%5Cu6700%5Cu4f4e%5Cu6210%5Cu672c%5Cuff0c%5Cu5982%5Cu679c%5Cu4e0d%5Cu53ef%5Cu80fd%5Cuff0c%5Cu5219%5Cu65e0%5Cu89e3%5Cu3002%5Cn%5Cn%5Cu8f93%5Cu5165%5Cu5c06%5Cu7531%5Cu591a%5Cu4e2a%5Cu6837%5Cu4f8b%5Cu7ec4%5Cu6210%5Cu3002%5Cu6bcf%5Cu4e2a%5Cu8f93%5Cu5165%5Cu7684%5Cu7b2c%5Cu4e00%5Cu884c%5Cu5c06%5Cu5305%5Cu542bn%5Cu548cm%5Cuff0c%5Cu5176%5Cu4e2dn%5Cu662f%5Cu4ed3%5Cu5e93%5Cu6570%5Cu91cf%5Cuff0cm%5Cu662f%5Cu5355%5Cu72ec%5Cu88c5%5Cu8fd0%5Cu65b9%5Cu6cd5%5Cu7684%5Cu6570%5Cu91cf%5Cu3002%28n%3C20%5Cuff0cm%3C200%29%5Cu3002%5Cu63a5%5Cu4e0b%5Cu6765%5Cu7684M%5Cu884c%5Cu5c06%5Cu5305%5Cu542b%5Cu4e09%5Cu4e2a%5Cu503ci%5Cu3001j%5Cu548cv%5Cu3002%5Cu6bcf%5Cu4e00%5Cu884c%5Cu5bf9%5Cu5e94%5Cu4e00%5Cu4e2a%5Cu552f%5Cu4e00%5Cu7684%5Cu8fd0%5Cu8f93%5Cu65b9%5Cu6cd5%5Cu3002i%5Cu548cj%5Cu662f%5Cu4e24%5Cu4e2a%5Cu4ed3%5Cu5e93%5Cu7684%5Cu6307%5Cu6807%5Cuff0cv%5Cu662f%5Cu4ecei%5Cu5230j%5Cu7684%5Cu6210%5Cu672c%5Cn%5Cn%5Cu6ce8%5Cu610f%5Cuff1a%5Cu6bcf%5Cu4e00%5Cu6761%5Cu8def%5Cu5f84%5Cu662f%5Cu5355%5Cu5411%5Cu8fb9%5Cu3002%5Cu800c%5Cu4e14%5Cuff0c%5Cu5728%5Cu4efb%5Cu4f55%5Cu4e00%5Cu5bf9%5Cu4ed3%5Cu5e93%5Cu4e4b%5Cu95f4%5Cu53ef%5Cu80fd%5Cu6709%5Cu4e0d%5Cu6b62%5Cu4e00%5Cu79cd%5Cu8fd0%5Cu8f93%5Cu65b9%5Cu5f0f%5Cu3002%5Cn%5Cn%5Cu5982%5Cu679c%5Cu8f93%5Cu5165%5Cu4e24%5Cu4e2a%5Cu96f6%5Cu5c31%5Cu8868%5Cu793a%5Cu6570%5Cu636e%5Cu7ed3%5Cu675f%5Cu3002%5Cn%5Cn%5Cu611f%5Cu8c22%20%40%5Cu5fa1%5Cu00b7Dragon%20%5Cu63d0%5Cu4f9b%5Cu7684%5Cu7ffb%5Cu8bd1%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A9%2C%22totalAccepted%22%3A6%2C%22pid%22%3A%22SP4227%22%2C%22title%22%3A%22MSE06I%20-%20%5C%22Shortest%5C%22%20pair%20of%20paths%20%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22MSE06I%20-%20%5C%22Shortest%5C%22%20pair%20of%20paths%20%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>MSE06I - &quot;Shortest&quot; pair of paths </h1>
<h2>题意翻译</h2>
<div>现在有一家公司，这家公司有一个关于最短路径的问题。
现在有n个仓库（也就是顶点，编号从0到n-1）可以存储货物。有m运输方法（也就是边）连接成对的仓库。每种运输方式都有成本。
所以，公司需要找到一种方法，将一批货物从第一个仓库（编号为0）运送到最后一个仓库（编号为n-1）。
他们必须从第一个仓库到最后一个仓库运送两种东西。这些东西由于很危险，不能安全地放在一起。
所以我们规定，公司不能对两种东西使用相同的运输方法。此外，公司不能将两种东西放置在同一仓库（任何时间段都不可以），而在第一个和最后一个仓库不受约束。
首先，他们想知道有没有可能在这些限制下运输这两种东西。
接下来，他们需要找到从第一个仓库到最后一个仓库运输这两种东西的最低成本。
简而言之，他们需要两条完全独立的路径（从第一个仓库到最后一个仓库），两者的总成本最低。
现在请给出最低成本，如果不可能，则无解。
输入将由多个样例组成。每个输入的第一行将包含n和m，其中n是仓库数量，m是单独装运方法的数量。(n<20，m<200)。接下来的M行将包含三个值i、j和v。每一行对应一个唯一的运输方法。i和j是两个仓库的指标，v是从i到j的成本
注意：每一条路径是单向边。而且，在任何一对仓库之间可能有不止一种运输方式。
如果输入两个零就表示数据结束。
感谢 @御·Dragon 提供的翻译</div>
<h2>题目描述</h2>
<div>[English](%7B$base%7Dproblems/%7B$code%7D/en/)
[Vietnamese](%7B$base%7Dproblems/%7B$code%7D/vn/)
A chemical company has an unusual shortest path problem. There are N depots (vertices) where chemicals can be stored. There are M individual shipping methods (edges) connecting pairs of depots. Each individual shipping method has a cost. In the usual problem, the company would need to find a way to route a single shipment from the first depot (0) to the last (N - 1). That's easy. The problem they have seems harder. They have to ship two chemicals from the first depot (0) to the last (N - 1). The chemicals are dangerous and cannot safely be placed together. The regulations say the company cannot use the same shipping method for both chemicals. Further, the company cannot place the two chemicals in same depot (for any length of time) without special storage handling --- available only at the first and last depots.
To begin, they need to know if it's possible to ship both chemicals under these constraints. Next, they need to find the least cost of shipping both chemicals from first depot to the last depot. In brief, they need two completely separate paths (from the first depot to the last) where the overall cost of both is minimal. Your program must simply determine the minimum cost or, if it's not possible, conclusively state that the shipment cannot be made.
The input will consist of multiple cases. The first line of each input will contain N and M where N is the number of depots and M is the number of individual shipping methods. You may assume that N is less than 20 and that M is less than 200. The next M lines will contain three values, i, j, and v. Each line corresponds a single, unique shipping method. The values i and j are the indices of two depots, and v is the cost of getting from i to j. Note that these shipping methods are directed. If something can be shipped from i to j with cost 10, that says nothing about shipping from j to i. Also, there may be more than one way to ship between any pair of depots, and that may be important here.
A line containing two zeroes signals the end of data and should not be processed.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
