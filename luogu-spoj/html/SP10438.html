<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>IOPC1203 - Crazy texting - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450216:ZU+2LO+USsd8oj+4ayBTNo95WjP+L1ZvasUW6+KXCY0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20must%20be%20familiar%20with%20the%20use%20of%20numeric%20keys%20to%20enter%20alphabets%20in%20mobile%20phones.%20A%20single%20numeric%20key%20when%20pressed%20gives%20a%20character.%20When%20pressed%20again%2C%20it%20changes%20to%20another%20and%20so%20on.%20Once%20the%20set%20of%20characters%20mapped%20to%20the%20key%20is%20exhausted%2C%20the%20key%20wraps%20around%20to%20the%20original%20character.%5Cn%5CnThe%20key%20mapping%20in%20this%20problem%20is%20the%20T9%20mapping%2C%20restricted%20to%20lowercase%20english%20characters.%20The%20characters%20corresponding%20to%20the%20individual%20keys%20are%3A%5Cn%5Cn-%202%3A%20a%2Cb%2Cc%5Cn-%203%3A%20d%2Ce%2Cf%5Cn-%204%3A%20g%2Ch%2Ci%5Cn-%205%3A%20j%2Ck%2Cl%5Cn-%206%3A%20m%2Cn%2Co%5Cn-%207%3A%20p%2Cq%2Cr%2Cs%5Cn-%208%3A%20t%2Cu%2Cv%5Cn-%209%3A%20w%2Cx%2Cy%2Cz%5Cn%5CnFor%20example%2C%20if%20you%20press%20the%20key%202%20once%2C%20it%20prints%20the%20character%20%27a%27.%20On%20pressing%20it%20again%2C%20it%20becomes%20%27b%27%2C%20then%20%27c%27%2C%20then%20back%20to%20%27a%27%20and%20so%20on.%5Cn%5CnConsider%20a%20string%20made%20of%20lowercase%20letters%20only.%20To%20enter%20this%20string%20into%20a%20mobile%20phone%2C%20a%20certain%20key%20sequence%20has%20to%20be%20entered%20with%20sufficient%20gaps%20in%20between.%20Suppose%20that%20the%20key%20sequence%20entered%20is%20correct%20but%20the%20gaps%20between%20keypresses%20are%20made%20arbitrarily.%20This%20can%20result%20in%20very%20different%20strings%20being%20printed.%5Cn%5CnFor%20example%2C%20let%20the%20string%20to%20be%20input%20be%20%5C%22mod%5C%22.%20The%20key%20sequence%20corresponding%20to%20this%20is%206%5C%5C_6663%20where%20%27%5C%5C_%27%20denotes%20a%20gap%20between%20the%20keypresses.%20Suppose%20the%20keys%20are%20pressed%20in%20the%20same%20order%2C%20but%20with%20gaps%20between%20keypresses%20arbitrary.%20This%20can%20result%20in%208%20different%20strings%3A%20%5C%22mod%5C%22%2C%20%5C%22nnd%5C%22%2C%20%5C%22omd%5C%22%2C%20%5C%22mmmmd%5C%22%2C%20%5C%22mnmd%5C%22%2C%20%5C%22mmnd%5C%22%2C%20%5C%22nmmd%5C%22%20and%20%5C%22md%5C%22.%5Cn%5CnGiven%20an%20input%20string%2C%20Find%20the%20number%20of%20possible%20strings%20printed%20by%20the%20key%20sequence%20corresponding%20to%20it.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20the%20input%20consists%20of%20T%2C%20the%20number%20of%20testcases%20%281%22%2C%22outputFormat%22%3A%22For%20each%20string%2C%20output%20the%20number%20of%20strings%20corresponding%20to%20its%20key%20sequence.%20Since%20the%20answer%20can%20be%20very%20big%2C%20output%20it%20modulo%20100000007%22%2C%22samples%22%3A%5B%5B%222%5Cr%5Cnmod%5Cr%5Cniopc%22%2C%228%5Cr%5Cn64%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B112%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F10438%22%2C%22id%22%3A%2210438%22%7D%2C%22translation%22%3A%22%5Cu4f7f%5Cu7528%5Cu6570%5Cu5b57%5Cu952e%5Cu5728%5Cu7535%5Cu8bdd%5Cu4e2d%5Cu8f93%5Cu5165%5Cu5b57%5Cu6bcd%5Cu65f6%5Cu3002%5Cu6bcf%5Cu6309%5Cu4e0b%5Cu4e00%5Cu4e2a%5Cu6570%5Cu5b57%5Cu952e%5Cu90fd%5Cu4f1a%5Cu663e%5Cu793a%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu3002%5Cu5f53%5Cu518d%5Cu6b21%5Cu6309%5Cu4e0b%5Cu540c%5Cu4e00%5Cu4e2a%5Cu6570%5Cu5b57%5Cu952e%5Cu65f6%5Cuff0c%5Cu5b83%5Cu53d8%5Cu4e3a%5Cu53e6%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu5f53%5Cu6570%5Cu5b57%5Cu952e%5Cu6309%5Cu4e86%5Cu4e00%5Cu5b9a%5Cu6b21%5Cu6570%5Cu540e%5Cuff0c%5Cu663e%5Cu793a%5Cu7684%5Cu5b57%5Cu7b26%5Cu53c8%5Cu4f1a%5Cu5faa%5Cu73af%5Cu5230%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu663e%5Cu793a%5Cu7684%5Cu5b57%5Cu7b26%5Cu3002%5Cuff08%5Cu663e%5Cu793a%5Cu7684%5Cu5b57%5Cu7b26%5Cu90fd%5Cu662f%5Cu5c0f%5Cu5199%5Cu82f1%5Cu6587%5Cu5b57%5Cu7b26%5Cu3002%5Cuff09%5Cr%5Cn%5Cr%5Cn%5Cu4e0e%5Cu5404%5Cu4e2a%5Cu6570%5Cu5b57%5Cu952e%5Cu5bf9%5Cu5e94%5Cu7684%5Cu5b57%5Cu7b26%5Cu662f%3A%5Cr%5Cn%5Cr%5Cn2%3Aa%2Cb%2Cc%20%20%20%203%3Ad%2Ce%2Cf%5Cr%5Cn%5Cr%5Cn4%3Ag%2Ch%2Ci%20%20%20%205%3Aj%2Ck%2Cl%5Cr%5Cn%5Cr%5Cn6%3Am%2Cn%2Co%20%20%20%207%3Ap%2Cq%2Cr%2Cs%5Cr%5Cn%5Cr%5Cn8%3At%2Cu%2Cv%20%20%20%209%3Aw%2Cx%2Cy%2Cz%5Cr%5Cn%5Cr%5Cn%5Cu4f8b%5Cu5982%5Cuff0c%5Cu5982%5Cu679c%5Cu6309%5Cu4e00%5Cu6b212%5Cuff0c%5Cu5b83%5Cu5c06%5Cu663e%5Cu793a%5Cu5b57%5Cu7b26%27a%27%5Cu3002%5Cu518d%5Cu6309%5Cu4e00%5Cu6b212%5Cuff0c%5Cu663e%5Cu793a%5Cu7684%5Cu5b57%5Cu7b26%5Cu5c06%5Cu4f1a%5Cu53d8%5Cu4e3a%27b%27%5Cuff0c%5Cu7136%5Cu540e%5Cu53d8%5Cu4e3a%27c%27%5Cuff0c%5Cu7136%5Cu540e%5Cu53d8%5Cu56de%27a%27%5Cuff0c%5Cu4f9d%5Cu6b64%5Cu7c7b%5Cu63a8%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8003%5Cu8651%5Cu4e00%5Cu4e2a%5Cu4ec5%5Cu7531%5Cu5c0f%5Cu5199%5Cu5b57%5Cu6bcd%5Cu7ec4%5Cu6210%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu3002%5Cu8981%5Cu5c06%5Cu6b64%5Cu5b57%5Cu7b26%5Cu4e32%5Cu8f93%5Cu5165%5Cu5230%5Cu79fb%5Cu52a8%5Cu7535%5Cu8bdd%5Cu4e2d%5Cuff0c%5Cu5fc5%5Cu987b%5Cu8f93%5Cu5165%5Cu5177%5Cu6709%5Cu8db3%5Cu591f%5Cu95f4%5Cu9699%5Cu7684%5Cu7279%5Cu5b9a%5Cu952e%5Cu5e8f%5Cu5217%5Cu3002%5Cu5047%5Cu8bbe%5Cu8f93%5Cu5165%5Cu7684%5Cu952e%5Cu5e8f%5Cu5217%5Cu662f%5Cu6b63%5Cu786e%5Cu7684%5Cuff0c%5Cu4f46%5Cu662f%5Cu6309%5Cu952e%5Cu4e4b%5Cu95f4%5Cu7684%5Cu95f4%5Cu9699%5Cu662f%5Cu4efb%5Cu610f%5Cu7684%5Cu3002%5Cu8fd9%5Cu4f1a%5Cu5bfc%5Cu81f4%5Cu6253%5Cu5370%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu975e%5Cu5e38%5Cu4e0d%5Cu540c%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu4f8b%5Cu5982%5Cuff0c%5Cu8ba9%5Cu8981%5Cu8f93%5Cu5165%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu4e3a%5C%22mod%5C%22%5Cu3002%5Cu4e0e%5Cu6b64%5Cu5bf9%5Cu5e94%5Cu7684%5Cu952e%5Cu5e8f%5Cu5217%5Cu662f6_666_3%5Cuff0c%5Cu5176%5Cu4e2d%27_%27%5Cu8868%5Cu793a%5Cu6309%5Cu952e%5Cu4e4b%5Cu95f4%5Cu7684%5Cu95f4%5Cu9699%5Cu3002%5Cu5047%5Cu8bbe%5Cu6309%5Cu952e%5Cu987a%5Cu5e8f%5Cu76f8%5Cu540c%5Cuff0c%5Cu4f46%5Cu6309%5Cu952e%5Cu4e4b%5Cu95f4%5Cu7684%5Cu95f4%5Cu9699%5Cu662f%5Cu4efb%5Cu610f%5Cu7684%5Cu3002%5Cu8fd9%5Cu53ef%5Cu80fd%5Cu5bfc%5Cu81f48%5Cu4e2a%5Cu4e0d%5Cu540c%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%3A%5C%22mod%5C%22%5Cu3001%5C%22nnd%5C%22%5Cu3001%5C%22omd%5C%22%5Cu3001%5C%22mmmmd%5C%22%5Cu3001%5C%22mnmd%5C%22%5Cu3001%5C%22mmnd%5C%22%5Cu3001%5C%22nmmd%5C%22%5Cu548c%5C%22md%5C%22%5Cu3002%20%5Cr%5Cn%5Cr%5Cn%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu8f93%5Cu5165%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu627e%5Cu51fa%5Cu4e0e%5Cu4e4b%5Cu5bf9%5Cu5e94%5Cu7684%5Cu952e%5Cu5e8f%5Cu5217%5Cu6240%5Cu6253%5Cu5370%5Cu7684%5Cu53ef%5Cu80fd%5Cu5b57%5Cu7b26%5Cu4e32%5Cu7684%5Cu6570%5Cu76ee%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu8f93%5Cu5165T%5Cuff0c%5Cu8868%5Cu793a%5Cu6709T%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu3002%5Cu63a5%5Cu4e0b%5Cu6765T%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu8f93%5Cu5165%5Cu4e00%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cu3002%20%5Cr%5Cn%5Cr%5Cn%5Cu5bf9%5Cu4e8e%5Cu6bcf%5Cu4e2a%5Cu5b57%5Cu7b26%5Cu4e32%5Cuff0c%5Cu8f93%5Cu51fa%5Cu4e0e%5Cu5176%5Cu952e%5Cu5e8f%5Cu5217%5Cu5bf9%5Cu5e94%5Cu7684%5Cu5b57%5Cu7b26%5Cu4e32%5Cu6570%5Cu3002%5Cu56e0%5Cu4e3a%5Cu7b54%5Cu6848%5Cu53ef%5Cu80fd%5Cu5f88%5Cu5927%5Cuff0c%5Cu6240%5Cu4ee5%5Cu4f60%5Cu53ea%5Cu9700%5Cu8f93%5Cu51fa%5Cu7b54%5Cu6848%5Cu5bf910000007%5Cu53d6%5Cu6a21%5Cu7684%5Cu503c%5Cu3002%20%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A2%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP10438%22%2C%22title%22%3A%22IOPC1203%20-%20Crazy%20texting%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22IOPC1203%20-%20Crazy%20texting%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>IOPC1203 - Crazy texting</h1>
<h2>题意翻译</h2>
<div>使用数字键在电话中输入字母时。每按下一个数字键都会显示一个字符。当再次按下同一个数字键时，它变为另一个字符。
当数字键按了一定次数后，显示的字符又会循环到第一个显示的字符。（显示的字符都是小写英文字符。）
与各个数字键对应的字符是:
2:a,b,c 3:d,e,f
4:g,h,i 5:j,k,l
6:m,n,o 7:p,q,r,s
8:t,u,v 9:w,x,y,z
例如，如果按一次2，它将显示字符'a'。再按一次2，显示的字符将会变为'b'，然后变为'c'，然后变回'a'，依此类推。
考虑一个仅由小写字母组成的字符串。要将此字符串输入到移动电话中，必须输入具有足够间隙的特定键序列。假设输入的键序列是正确的，但是按键之间的间隙是任意的。这会导致打印的字符串非常不同。
例如，让要输入的字符串为"mod"。与此对应的键序列是6_666_3，其中'_'表示按键之间的间隙。假设按键顺序相同，但按键之间的间隙是任意的。这可能导致8个不同的字符串:"mod"、"nnd"、"omd"、"mmmmd"、"mnmd"、"mmnd"、"nmmd"和"md"。
给定一个输入字符串，找出与之对应的键序列所打印的可能字符串的数目。
第一行输入T，表示有T个字符串。接下来T行，每行输入一个字符串。
对于每个字符串，输出与其键序列对应的字符串数。因为答案可能很大，所以你只需输出答案对10000007取模的值。 </div>
<h2>题目描述</h2>
<div>You must be familiar with the use of numeric keys to enter alphabets in mobile phones. A single numeric key when pressed gives a character. When pressed again, it changes to another and so on. Once the set of characters mapped to the key is exhausted, the key wraps around to the original character.
The key mapping in this problem is the T9 mapping, restricted to lowercase english characters. The characters corresponding to the individual keys are:
- 2: a,b,c
- 3: d,e,f
- 4: g,h,i
- 5: j,k,l
- 6: m,n,o
- 7: p,q,r,s
- 8: t,u,v
- 9: w,x,y,z
For example, if you press the key 2 once, it prints the character 'a'. On pressing it again, it becomes 'b', then 'c', then back to 'a' and so on.
Consider a string made of lowercase letters only. To enter this string into a mobile phone, a certain key sequence has to be entered with sufficient gaps in between. Suppose that the key sequence entered is correct but the gaps between keypresses are made arbitrarily. This can result in very different strings being printed.
For example, let the string to be input be "mod". The key sequence corresponding to this is 6\_6663 where '\_' denotes a gap between the keypresses. Suppose the keys are pressed in the same order, but with gaps between keypresses arbitrary. This can result in 8 different strings: "mod", "nnd", "omd", "mmmmd", "mnmd", "mmnd", "nmmd" and "md".
Given an input string, Find the number of possible strings printed by the key sequence corresponding to it.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of the input consists of T, the number of testcases (1</div>
<h3>输出格式</h3>
<br />
<div>For each string, output the number of strings corresponding to its key sequence. Since the answer can be very big, output it modulo 100000007</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2
mod
iopc</code></pre>
<h3>输出样例 #1</h3>
<pre><code>8
64</code></pre>
</article>
</div>
</div>
</body>
</html>
