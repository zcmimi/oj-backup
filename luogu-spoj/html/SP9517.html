<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>UNLOCK - Unlock the Cellphone - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450157:BaDaqLXT6yir8afznyKqifDnGzj0iWOLydf7X6salRg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Modern%20high-tech%20cell%20phones%20use%20unlock%20patterns%20to%20unlock%20the%20system.%20The%20pattern%20is%20usually%20a%203%5C%5C%2A3%20dot%20array.%20By%20moving%20your%20finger%20over%20there%20dots%2C%20you%20can%20generate%20your%20personal%20unlock%20pattern.%20More%20specifically%2C%20press%20your%20finger%20over%20any%20starting%20dot%2C%20then%20slide%20all%20the%20way%20to%20the%20next%20dot%2C%20touch%20it%2C%20and%20so%20on.%20Jumping%20is%20not%20allowed.%20For%20example%2C%20starting%20from%20dot%201%2C%20you%20can%20slide%20to%20touch%20dot%202%2C%20dot%204%20and%20dot%205%2C%20but%20sliding%20directly%20to%20dot%203%2C%20dot%207%20or%20dot%209%20are%20not%20allowed.%20Note%20that%20sliding%20from%201%20to%206%20and%208%20is%20also%20allowed%20because%20they%20are%20not%20considered%20as%20jumping%20over%20any%20dot.%20However%2C%20you%20can%20jump%20a%20dot%20if%20it%20has%20been%20touched%20before.%20For%20example%2C%20staring%20with%201-5-9-6%2C%20you%20can%20slide%20directly%20to%20dot%204.%5Cn%5Cn%20%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP9517%5C%2F2b6157892c5b77348dd5c4f9c264e9704ead70bb.png%29Here%20is%20a%20very%20particular%20cell%20phone.%20It%20has%20a%20dot%20array%20of%20size%20%2A%2An%2A%2A%5C%5C%2A%2A%2Am%2A%2A.%20Some%20of%20the%20dots%20are%20ordinary%20ones%3A%20you%20can%20touch%2C%20and%20slide%20over%20them%20when%20touched%20before%3B%20some%20are%20forbidden%20ones%3A%20you%20cannot%20touch%20or%20slide%20over%20them%3B%20some%20are%20inactive%20ones%3A%20you%20cannot%20touch%20them%2C%20but%20can%20slide%20over%20them.%20Each%20dot%20can%20only%20be%20touched%20once.%20You%20are%20required%20to%20calculate%20how%20many%20different%20unlock%20patterns%20passing%20through%20all%20the%20ordinary%20dots.%22%2C%22inputFormat%22%3A%22The%20input%20contains%20several%20test%20cases.%20Each%20test%20case%20begins%20with%20a%20line%20containing%20two%20integers%20%2A%2An%2A%2A%20and%20%2A%2Am%2A%2A%20%281%20%3C%3D%20%2A%2An%2A%2A%2C%20%2A%2Am%2A%2A%20%3C%3D%205%29%2C%20indicating%20the%20row%20and%20column%20number%20of%20the%20lock%20keypad.%20The%20following%20%2A%2An%2A%2A%20lines%20each%20contains%20%2A%2Am%2A%2A%20integers%20%2A%2AK%20%24%20_%7Bi%2Cj%7D%20%24%2A%2A%20%20indicating%20the%20properties%20of%20each%20key%2C%20%2A%2AK%20%24%20_%7Bi%2Cj%7D%20%24%2A%2A%20%3D0%20stands%20for%20an%20ordinary%20key%2C%20%2A%2AK%20%24%20_%7Bi%2Cj%7D%20%24%2A%2A%20%3D1%20stands%20for%20a%20forbidden%20key%3B%20and%20%2A%2AK%20%24%20_%7Bi%2Cj%7D%20%24%2A%2A%20%3D2%20stands%20for%20an%20inactive%20key.%20The%20number%20of%20ordinary%20keys%20is%20greater%20than%20zero%20and%20no%20more%20than%2016.%5Cn%5CnInput%20terminates%20by%20EOF.%22%2C%22outputFormat%22%3A%22For%20each%20test%2C%20output%20an%20integer%20indicating%20the%20number%20of%20different%20lock%20patterns.%22%2C%22samples%22%3A%5B%5B%222%202%5Cr%5Cn0%200%5Cr%5Cn0%200%5Cr%5Cn3%203%5Cr%5Cn0%200%200%5Cr%5Cn0%202%201%5Cr%5Cn0%200%200%22%2C%2224%5Cr%5Cn2140%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F9517%22%2C%22id%22%3A%229517%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP9517%22%2C%22title%22%3A%22UNLOCK%20-%20Unlock%20the%20Cellphone%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22UNLOCK%20-%20Unlock%20the%20Cellphone%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>UNLOCK - Unlock the Cellphone</h1>
<h2>题目描述</h2>
<div>Modern high-tech cell phones use unlock patterns to unlock the system. The pattern is usually a 3\*3 dot array. By moving your finger over there dots, you can generate your personal unlock pattern. More specifically, press your finger over any starting dot, then slide all the way to the next dot, touch it, and so on. Jumping is not allowed. For example, starting from dot 1, you can slide to touch dot 2, dot 4 and dot 5, but sliding directly to dot 3, dot 7 or dot 9 are not allowed. Note that sliding from 1 to 6 and 8 is also allowed because they are not considered as jumping over any dot. However, you can jump a dot if it has been touched before. For example, staring with 1-5-9-6, you can slide directly to dot 4.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/SP9517/2b6157892c5b77348dd5c4f9c264e9704ead70bb.png)Here is a very particular cell phone. It has a dot array of size **n**\***m**. Some of the dots are ordinary ones: you can touch, and slide over them when touched before; some are forbidden ones: you cannot touch or slide over them; some are inactive ones: you cannot touch them, but can slide over them. Each dot can only be touched once. You are required to calculate how many different unlock patterns passing through all the ordinary dots.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The input contains several test cases. Each test case begins with a line containing two integers **n** and **m** (1 <= **n**, **m** <= 5), indicating the row and column number of the lock keypad. The following **n** lines each contains **m** integers **K $ _{i,j} $** indicating the properties of each key, **K $ _{i,j} $** =0 stands for an ordinary key, **K $ _{i,j} $** =1 stands for a forbidden key; and **K $ _{i,j} $** =2 stands for an inactive key. The number of ordinary keys is greater than zero and no more than 16.
Input terminates by EOF.</div>
<h3>输出格式</h3>
<br />
<div>For each test, output an integer indicating the number of different lock patterns.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2 2
0 0
0 0
3 3
0 0 0
0 2 1
0 0 0</code></pre>
<h3>输出样例 #1</h3>
<pre><code>24
2140</code></pre>
</article>
</div>
</div>
</body>
</html>
