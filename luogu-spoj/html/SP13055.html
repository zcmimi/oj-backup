<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>IZHONYT - New Year Train - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450341:WCv32H52hidPVzYKSJC8WkvjA7fWnUO4JxsjIvJNupQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22On%20the%20New%20Year%20Eve%2C%20a%20government%20of%20one%20country%20decided%20to%20send%20a%20train%20with%20gifts%20to%20each%20of%20its%20towns.%20For%20each%20of%20the%20N%20towns%20exactly%20one%20wagon%20with%20gifts%20was%20sent.%20The%20route%20was%20organized%20in%20such%20way%20that%20at%20each%20place%20the%20last%20wagon%20would%20be%20detached%20and%20train%20would%20continue%20on%20it%27s%20way%2C%20until%20all%20gifts%20were%20delivered.%20Just%20before%20the%20departure%20it%20turned%20out%20that%20the%20loading%20workers%20did%20not%20pay%20attention%20to%20numeration%20of%20the%20wagons%20and%20loaded%20the%20gifts%20in%20random%20order.%20It%20was%20impossible%20to%20detach%20a%20wagon%20from%20the%20middle%20of%20the%20train%20and%20there%20was%20no%20time%20to%20rearrange%20gifts.%20Luckily%2C%20there%20was%20a%20depot%20with%20parallel%20tracks.%20At%20the%20entrance%20of%20the%20depot%20each%20wagon%20could%20be%20directed%20to%20any%20of%20the%20tracks%20and%20wagons%20could%20leave%20the%20depot%20from%20the%20other%20side%20in%20the%20right%20sequences%201%2C%202%2C%203%2C%204%2C%20and%20so%20on.%20Note%20that%20we%20will%20then%20be%20leaving%20presents%20in%20towns%20in%20the%20reversed%20order%20%28...%2C%204%2C%203%2C%202%2C%201%29.%5Cn%5CnFor%20example%2C%20let%27s%20say%20we%20have%20a%20train%20with%20wagons%20in%20the%20following%20order%3A%202%2C%205%2C%201%2C%204%2C%206%2C%203.%20Wagons%202%2C%205%2C%206%20could%20be%20directed%20to%20the%20first%20track%3B%20wagons%201%2C%204%20to%20the%20second%20one%20and%20wagon%203%20to%20the%20third.%20In%20this%20case%20wagons%20could%20leave%20the%20depot%20in%20the%20right%20order.%20Fortunately%2C%20there%20were%20enough%20tracks%20in%20the%20depot%20to%20rearrange%20the%20train.%22%2C%22inputFormat%22%3A%22First%20line%20of%20the%20input%20contains%20two%20integers%20N%20and%20M%3A%20the%20number%20of%20wagons%20in%20the%20train%20and%20the%20number%20of%20tracks%20in%20the%20depot%20respectively%20%281%20%3C%3D%20N%20%3C%3D%20800%20000%2C%201%20%3C%3D%20M%20%3C%3D%20100%20000%2C%20M%20%3C%3D%20N%29.%20Second%20line%20contains%20N%20integers%3A%20sequence%20of%20wagons%20before%20the%20entrance%20to%20the%20depot.%20It%27s%20guaranteed%20that%20solution%20always%20exists.%22%2C%22outputFormat%22%3A%22First%20line%20of%20the%20output%20must%20contain%20N%20integers%3A%20number%20of%20track%20that%20should%20be%20chosen%20for%20each%20wagon%20from%20input%20sequence%20%28tracts%20are%20numbered%20from%201%20to%20M%29.%20On%20the%20second%20line%20print%20the%20number%20of%20tracks%20in%20order%20the%20wagons%20should%20leave%20the%20depot%20to%20result%20in%20the%20sequence%201%2C%202%2C%203%2C%20and%20so%20on.%20If%20multiple%20solutions%20exists%2C%20print%20the%20one%20that%20results%20in%20lexicographically%20smallest%20sequence%20in%20the%20first%20line%20of%20the%20output.%22%2C%22samples%22%3A%5B%5B%226%203%5Cr%5Cn2%205%201%204%206%203%22%2C%221%201%202%202%201%203%5Cr%5Cn2%201%203%202%201%201%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F13055%22%2C%22id%22%3A%2213055%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP13055%22%2C%22title%22%3A%22IZHONYT%20-%20New%20Year%20Train%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22IZHONYT%20-%20New%20Year%20Train%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>IZHONYT - New Year Train</h1>
<h2>题目描述</h2>
<div>On the New Year Eve, a government of one country decided to send a train with gifts to each of its towns. For each of the N towns exactly one wagon with gifts was sent. The route was organized in such way that at each place the last wagon would be detached and train would continue on it's way, until all gifts were delivered. Just before the departure it turned out that the loading workers did not pay attention to numeration of the wagons and loaded the gifts in random order. It was impossible to detach a wagon from the middle of the train and there was no time to rearrange gifts. Luckily, there was a depot with parallel tracks. At the entrance of the depot each wagon could be directed to any of the tracks and wagons could leave the depot from the other side in the right sequences 1, 2, 3, 4, and so on. Note that we will then be leaving presents in towns in the reversed order (..., 4, 3, 2, 1).
For example, let's say we have a train with wagons in the following order: 2, 5, 1, 4, 6, 3. Wagons 2, 5, 6 could be directed to the first track; wagons 1, 4 to the second one and wagon 3 to the third. In this case wagons could leave the depot in the right order. Fortunately, there were enough tracks in the depot to rearrange the train.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>First line of the input contains two integers N and M: the number of wagons in the train and the number of tracks in the depot respectively (1 <= N <= 800 000, 1 <= M <= 100 000, M <= N). Second line contains N integers: sequence of wagons before the entrance to the depot. It's guaranteed that solution always exists.</div>
<h3>输出格式</h3>
<br />
<div>First line of the output must contain N integers: number of track that should be chosen for each wagon from input sequence (tracts are numbered from 1 to M). On the second line print the number of tracks in order the wagons should leave the depot to result in the sequence 1, 2, 3, and so on. If multiple solutions exists, print the one that results in lexicographically smallest sequence in the first line of the output.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>6 3
2 5 1 4 6 3</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1 1 2 2 1 3
2 1 3 2 1 1</code></pre>
</article>
</div>
</div>
</body>
</html>
