<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>CHEFJUL - Happy Days - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450033:rct1tpeHX/Jm/IQ7LuD+PqP+GlDsk1PJf705rLhhEEg=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Johnny%20has%20a%20pool%20in%20his%20garden.%20There%20are%20several%20islands%20in%20the%20pool.%20Some%20islands%20are%20connected%20by%20bridges.%20Any%20bridge%20can%20be%20removed.%20Every%20day%20Johnny%20removes%20some%20bridges%20so%20that%20there%20is%20only%20one%20way%20from%20any%20island%20to%20any%20other.%20In%20the%20evening%20he%20returns%20removed%20bridges%20to%20their%20places.%20Also%20he%20has%20some%20favorite%20bridges%20which%20he%20never%20removes.%20Johnny%20will%20be%20happy%20if%20he%20is%20able%20to%20make%20a%20configuration%20of%20bridges%20on%20the%20given%20day%20which%20he%20has%20never%20made%20before.%20You%20have%20to%20count%20the%20amount%20of%20days%20he%20will%20be%20happy.%20Of%20course%2C%20if%20the%20favorite%20bridges%20themselves%20don%27t%20satisfy%20the%20happiness%20condition%20Johnny%20will%20not%20be%20happy%20for%20even%20single%20day.%22%2C%22inputFormat%22%3A%22The%20first%20line%20of%20input%20file%20contains%20number%20t%20the%20number%20of%20test%20cases.%20Then%20the%20description%20of%20each%20test%20case%20follows.%20The%20first%20line%20of%20each%20test%20case%20contains%20number%20n%20the%20number%20of%20islands.%20Islands%20are%20numbered%20with%20integers%20from%201%20to%20n.%20Then%20n%20lines%20follow%20each%20containing%20n%20characters%20defining%20the%20connectivity%20matrix%20of%20those%20islands.%20Character%20in%20column%20x%20of%20line%20y%20will%20be%201%20if%20the%20islands%20with%20numbers%20x%20and%20y%20are%20connected%20and%200%20otherwise.%20The%20next%20line%20is%20number%20p%20the%20number%20of%20favorite%20bridges.%20The%20next%20p%20lines%20contain%20the%20pairs%20of%20islands%20that%20are%20conected%20by%20favorite%20bridges.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%20print%20the%20number%20of%20days%20Johnny%20will%20be%20happy%20in%20this%20situation.%22%2C%22samples%22%3A%5B%5B%221%5Cr%5Cn4%5Cr%5Cn0111%5Cr%5Cn1011%5Cr%5Cn1101%5Cr%5Cn1110%5Cr%5Cn2%5Cr%5Cn1%202%5Cr%5Cn3%204%22%2C%224%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B730%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F7323%22%2C%22id%22%3A%227323%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP7323%22%2C%22title%22%3A%22CHEFJUL%20-%20Happy%20Days%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22CHEFJUL%20-%20Happy%20Days%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>CHEFJUL - Happy Days</h1>
<h2>题目描述</h2>
<div>Johnny has a pool in his garden. There are several islands in the pool. Some islands are connected by bridges. Any bridge can be removed. Every day Johnny removes some bridges so that there is only one way from any island to any other. In the evening he returns removed bridges to their places. Also he has some favorite bridges which he never removes. Johnny will be happy if he is able to make a configuration of bridges on the given day which he has never made before. You have to count the amount of days he will be happy. Of course, if the favorite bridges themselves don't satisfy the happiness condition Johnny will not be happy for even single day.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line of input file contains number t the number of test cases. Then the description of each test case follows. The first line of each test case contains number n the number of islands. Islands are numbered with integers from 1 to n. Then n lines follow each containing n characters defining the connectivity matrix of those islands. Character in column x of line y will be 1 if the islands with numbers x and y are connected and 0 otherwise. The next line is number p the number of favorite bridges. The next p lines contain the pairs of islands that are conected by favorite bridges.</div>
<h3>输出格式</h3>
<br />
<div>For each test case print the number of days Johnny will be happy in this situation.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1
4
0111
1011
1101
1110
2
1 2
3 4</code></pre>
<h3>输出样例 #1</h3>
<pre><code>4</code></pre>
</article>
</div>
</div>
</body>
</html>
