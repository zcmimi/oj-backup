<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>AR2015PC - Terrorists - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450667:jy1HafCnnl/XssmD0kkg3N9bUiwfjfjwVjZBwnOj+7A=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Terrorists%21%20There%20are%20terrorists%20everywhere%21%21%21%20I%20was%20shouting%20out%20loud%20after%20I%20had%20watched%20a%20few%20news%20%20%5Cnreports%20about%20terrorism%20acts%20that%20had%20happened%20around%20my%20neighborhoods.%20I%20started%20to%20think%20that%20hiding%20at%20%20%5Cnhome%20wasn%5Cu2019t%20a%20good%20way%20to%20go.%20%20%5CnI%20went%20to%20police%20stations%20and%20asked%20around%20if%20I%20could%20help%20them%20prevent%20these%20issues.%20The%20police%20%20%5Cngave%20me%20pieces%20of%20information%20about%20terrorists%5Cu2019%20plans.%20I%20ended%20up%20lying%20on%20my%20bed%20and%20figuring%20way%20to%20%20%5Cnutilize%20this%20information.%20That%20is%20why%20I%20come%20to%20you.%20%20%5CnOur%20neighborhoods%20could%20be%20illustrated%20with%20intersections%20and%20roads.%20Terrorists%20usually%20meet%20up%20at%20%20%5Cnone%20intersection%20before%20moving%20to%20another%20intersection%20to%20perform%20an%20illegal%20act.%20The%20given%20information%20%20%5Cntells%20us%20where%20they%20will%20meet%20and%20where%20they%20will%20go.%20Unfortunately%2C%20the%20certain%20schedules%20of%20those%20plans%20%20%5Cnare%20not%20available%20and%20too%20few%20policemen%20are%20available%20lately.%20So%2C%20the%20police%20will%20not%20be%20able%20to%20set%20up%20%20%5Cnefficient%20defenses%20to%20all%20of%20those%20acts.%20What%20they%20could%20do%20is%20set%20up%20surveillance%20cameras%20to%20all%20meet%20up%20%20%5Cnintersections.%20Once%20a%20meet%20up%20is%20detected%2C%20policemen%20will%20go%20to%20that%20meet%20up%5Cu2019s%20destination%20to%20catch%20the%20%20%5Cnterrorists.%20The%20policemen%20rarely%20accomplish%20it%20because%20they%20spend%20too%20long%20time%20travelling%20between%20places.%20%20%5CnBecause%20terrorists%20are%20smart%2C%20they%20always%20use%20shortest%20route%20to%20travel%20between%20intersections.%20%20%5CnBecause%20the%20policemen%20aren%5Cu2019t%20that%20smart%2C%20they%20need%20our%20help.%20For%20each%20terrorist%20plan%2C%20the%20police%20want%20us%20to%20%20%5Cncompute%20the%20shortest%20distance%20between%20the%20meet%20up%20place%20and%20the%20destination.%20If%20the%20distance%20is%20too%20short%2C%20%20%5Cnthey%20will%20not%20spend%20their%20efforts%20for%20free.%20%20%5Cn%2A%2AInput%2A%2A%20%20%5CnThe%20first%20line%20of%20the%20input%20contains%20an%20integer%20%2A%2AT%2A%2A%2C%20the%20number%20of%20test%20sets%20%2A%2A%281%20%3C%3D%20T%20%3C%3D%205%29%2A%2A.%20%20%5CnEach%20test%20case%20consists%20of%20many%20lines.%20The%20first%20line%20contains%20%2A%2A3%2A%2A%20integers%20%2A%2AN%2C%20M%2C%20Q%2A%2A%20which%20are%20the%20%20%5Cnnumber%20of%20intersections%2C%20the%20number%20of%20roads%2C%20and%20the%20number%20of%20terrorists%5Cu2019%20plans%20in%20respective%20order.%20%20%5Cn%2A%2A1%20%3C%3D%20N%20%3C%3D%20100%20000%2C%20N%20-%201%20%3C%3D%20M%20%3C%3D%20N%20%2B%2050%2C%201%20%3C%3D%20Q%20%3C%3D%2050%20000%2A%2A%20%20%5CnThen%20the%20next%20%2A%2AM%2A%2A%20lines%20describe%20the%20roads%20in%20our%20neighborhoods.%20A%20road%20is%20described%20by%20%2A%2A3%2A%2A%20%20%5Cnintegers%3A%20%2A%2AU%2C%20V%2C%20D%2A%2A.%20%2A%2AU%2A%2A%2A%2Ai%2A%2A%20and%20%2A%2AV%2A%2A%2A%2Ai%2A%2A%20represent%20%2A%2A2%2A%2A%20ends%20of%20the%20road%20_%2A%2Ai%2A%2A_.%20%2A%2ADi%2A%2A%20represents%20distance%20of%20that%20road.%20%20%5Cn%2A%2A1%20%3C%3D%20Ui%2C%20Vi%20%3C%3D%20N%2C%201%20%3C%3D%20Di%20%3C%3D%2010%20000%2A%2A.%20It%20is%20possible%20that%20many%20roads%20might%20exist%20between%20a%20pair%20of%20%20%5Cnintersection.%20%20%5CnFinally%20the%20next%20%2A%2AQ%2A%2A%20lines%20are%20the%20terrorism%20plans.%20A%20plan%20_%2A%2Aj%2A%2A_%20is%20described%20by%20%2A%2A2%2A%2A%20integers%3A%20%2A%2ASj%2A%2A%20and%20%2A%2AEj%2A%2A%20%20%5Cnwhich%20are%20the%20meet-up%20intersection%20and%20the%20destination%20intersection%20respectively.%20%2A%2A1%20%3C%3D%20Sj%2C%20Ej%20%3C%3D%20N%2A%2A.%20%20%5Cn%2A%2AOutput%2A%2A%20%20%5CnFor%20each%20test%20set%2C%20print%20out%20%2A%2A%5Cu201cCase%20_x_%3A%5Cu201d%2A%2A%20where%20_%2A%2Ax%2A%2A_%20is%20a%20case%20number%20beginning%20with%20%2A%2A1%2A%2A%2C%20and%20then%20%20%5Cnfollowed%20by%20%2A%2AQ%2A%2A%20lines.%20For%20each%20terrorism%20plan%2C%20output%20the%20shortest%20distance%20between%20the%20meet-up%20%20%5Cnintersection%20and%20the%20destination%20of%20the%20plan.%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5B%221%5C%5Cn7%209%205%5C%5Cn7%206%206114%5C%5Cn5%203%205473%5C%5Cn2%204%202601%5C%5Cn5%204%208525%5C%5Cn7%203%20291%5C%5Cn2%207%203363%5C%5Cn1%206%20399%5C%5Cn6%204%204477%5C%5Cn1%207%203075%5C%5Cn6%203%5C%5Cn4%204%5C%5Cn3%201%5C%5Cn2%203%5C%5Cn7%203%22%2C%22Case%201%3A%5C%5Cn3765%5C%5Cn0%5C%5Cn3366%5C%5Cn3654%5C%5Cn291%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F27340%22%2C%22id%22%3A%2227340%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP27340%22%2C%22title%22%3A%22AR2015PC%20-%20Terrorists%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22AR2015PC%20-%20Terrorists%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>AR2015PC - Terrorists</h1>
<h2>题目描述</h2>
<div>Terrorists! There are terrorists everywhere!!! I was shouting out loud after I had watched a few news
reports about terrorism acts that had happened around my neighborhoods. I started to think that hiding at
home wasn’t a good way to go.
I went to police stations and asked around if I could help them prevent these issues. The police
gave me pieces of information about terrorists’ plans. I ended up lying on my bed and figuring way to
utilize this information. That is why I come to you.
Our neighborhoods could be illustrated with intersections and roads. Terrorists usually meet up at
one intersection before moving to another intersection to perform an illegal act. The given information
tells us where they will meet and where they will go. Unfortunately, the certain schedules of those plans
are not available and too few policemen are available lately. So, the police will not be able to set up
efficient defenses to all of those acts. What they could do is set up surveillance cameras to all meet up
intersections. Once a meet up is detected, policemen will go to that meet up’s destination to catch the
terrorists. The policemen rarely accomplish it because they spend too long time travelling between places.
Because terrorists are smart, they always use shortest route to travel between intersections.
Because the policemen aren’t that smart, they need our help. For each terrorist plan, the police want us to
compute the shortest distance between the meet up place and the destination. If the distance is too short,
they will not spend their efforts for free.
**Input**
The first line of the input contains an integer **T**, the number of test sets **(1 <= T <= 5)**.
Each test case consists of many lines. The first line contains **3** integers **N, M, Q** which are the
number of intersections, the number of roads, and the number of terrorists’ plans in respective order.
**1 <= N <= 100 000, N - 1 <= M <= N + 50, 1 <= Q <= 50 000**
Then the next **M** lines describe the roads in our neighborhoods. A road is described by **3**
integers: **U, V, D**. **U****i** and **V****i** represent **2** ends of the road _**i**_. **Di** represents distance of that road.
**1 <= Ui, Vi <= N, 1 <= Di <= 10 000**. It is possible that many roads might exist between a pair of
intersection.
Finally the next **Q** lines are the terrorism plans. A plan _**j**_ is described by **2** integers: **Sj** and **Ej**
which are the meet-up intersection and the destination intersection respectively. **1 <= Sj, Ej <= N**.
**Output**
For each test set, print out **“Case _x_:”** where _**x**_ is a case number beginning with **1**, and then
followed by **Q** lines. For each terrorism plan, output the shortest distance between the meet-up
intersection and the destination of the plan.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1\n7 9 5\n7 6 6114\n5 3 5473\n2 4 2601\n5 4 8525\n7 3 291\n2 7 3363\n1 6 399\n6 4 4477\n1 7 3075\n6 3\n4 4\n3 1\n2 3\n7 3</code></pre>
<h3>输出样例 #1</h3>
<pre><code>Case 1:\n3765\n0\n3366\n3654\n291</code></pre>
</article>
</div>
</div>
</body>
</html>
