<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>CHEATCON - Cheating on the contest - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450229:Ut2YaINKI/RxscxB3D7wL2VL6+PilGfsjFpeCxOelXY=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22For%20the%20first%20time%20the%20Skyrim%20Free%20School%20of%20Mathematics%2C%20Philosophy%20and%20Linguistics%20will%20host%20%20%5Cnthe%20Regular%20Expressions%20%28regex%29%20Contest%20%28RegExCon%29.%20The%20contest%20happens%20this%20way%3A%20participants%20%20%5Cncompete%20always%20against%201%20opponent.%20One%20wins%20one%20loses.%20Only%20one%20will%20remain%2C%20the%20champion.%20In%20one%20%20%5Cndispute%20both%20participants%20receive%20a%20list%20with%20several%20regular%20expressions%20and%20for%20each%20regex%20the%20%20%5Cnparticipants%20must%20calculate%20if%20several%20given%20words%20are%20recognized%20or%20not%20by%20the%20regex.%20As%20a%20member%20of%20%20%5Cnthe%20School%20you%20are%20participating%2C%20and%20want%20to%20win.%20%20%5CnSo%2C%20to%20guarantee%20your%20victory%2C%20you%20have%20to%20write%20a%20program%20to%20solve%20the%20problem%20and%20let%20it%20%20%5Cnexecuting%20in%20your%20Cool%20Stuff%20Calculator%20Machine%20at%20home.%20As%20a%20mage%2C%20expert%20in%20Alteration%20and%20Illusion%2C%20%20%5Cnyou%20can%20easily%20control%20your%20machine%20with%20your%20mind%2C%20so%20you%20can%20use%20your%20program%20while%20in%20the%20contest.%20%20%5CnIt%27s%20forbidden%20to%20use%20magic%20in%20the%20contest%2C%20but%20coincidentally%20the%20Winterhold%20School%20will%20host%20some%20%20%5CnMage%20Congress%2C%20so%20you%20don%27t%20need%20to%20worry%2C%20use%20your%20magic.%20%20%5CnA%20regular%20expression%20is%20used%20to%20describe%20a%20language%20%28a%20set%20of%20words%29.%20Consider%20that%20the%20alphabet%20%20%5Cnof%20all%20languages%20in%20this%20problem%20is%20%7Ba%2C%20b%7D.%20%20%5CnA%20regex%20R%20is%20valid%20if%3A%20%20%5Cn1%5C%5C%29%20R%20is%20%5Cu201ca%5Cu201d%20or%20%5Cu201cb%5Cu201d%3B%20%20%5Cn2%5C%5C%29%20R%20is%20%5Cu201c%28P.S%29%5Cu201d%20where%20P%20and%20S%20are%20regular%20expressions%3B%20%20%5Cn3%5C%5C%29%20R%20is%20%5Cu201c%28P%7CS%29%5Cu201d%20where%20P%20and%20S%20are%20regular%20expressions%3B%20%20%5Cn4%5C%5C%29%20R%20is%20%5Cu201c%28P%5C%5C%2A%29%5Cu201d%20where%20P%20is%20a%20regular%20expression%3B%20%20%5CnRegular%20expressions%20can%20be%20nested.%20There%20is%20no%20ternary%20operation%20with%20operators%20%5Cu201c.%5Cu201d%20and%20%5Cu201c%7C%5Cu201d%2C%20%20%5Cnneither%20binary%20operation%20with%20operator%20%5Cu201c%5C%5C%2A%5Cu201d.%20Words%20always%20start%20with%20%5Cu201c%28%5Cu201c%20and%20finish%20with%20%5Cu201c%29%5Cu201d.%20%20%5CnSet%20L%20of%20words%20recognized%20by%20R%20is%20formed%20following%20next%20rules%3A%20%20%5Cn1%5C%5C%29%20If%20R%20is%20%5Cu201c%28a%29%5Cu201d%2C%20L%20%3D%20%7Ba%7D%3B%20%20%5Cn2%5C%5C%29%20If%20R%20is%20%5Cu201c%28b%29%5Cu201d%2C%20L%20%3D%20%7Bb%7D%3B%20%20%5Cn3%5C%5C%29%20If%20R%20is%20%5Cu201c%28P.S%29%5Cu201d%2C%20L%20%3D%20all%20words%20that%20can%20be%20obtained%20from%20a%20concatenation%20of%20words%20p%20and%20s%2C%20%20%5Cnwhere%20p%20is%20recognized%20by%20P%20and%20s%20by%20S%3B%20%20%5Cn4%5C%5C%29%20If%20R%20is%20%5Cu201c%28P%7CS%29%5Cu201d%2C%20L%20%3D%20union%20of%20the%20sets%20of%20words%20recognized%20by%20P%20and%20S%3B%20%20%5Cn5%5C%5C%29%20If%20R%20is%20%5Cu201c%28P%5C%5C%2A%29%5Cu201d%2C%20R%20recognizes%20the%20concatenation%20of%200%20or%20more%20words%20recognized%20by%20P.%22%2C%22inputFormat%22%3A%22Input%20file%20contains%20several%20test%20cases.%20First%20line%20of%20a%20test%20case%20contains%20a%20regex%20%28defined%20before%2C%20between%201%20and%20150%29.%20Next%20line%20%20%5Cncontain%20an%20integer%20P%20%281%20that%20represents%20the%20following%20question%3A%20%5Cu201cIs%20this%20word%20recognized%20by%20the%20given%20regex%3F%5Cu201d.%22%2C%22outputFormat%22%3A%22For%20each%20question%20described%20before%2C%20answer%20%5Cu201cY%5Cu201d%20%28no%20quotes%29%20if%20the%20answer%20is%20%5Cu201cyes%5Cu201d%20or%20%5Cu201cN%5Cu201d%20%28no%20quotes%29%20if%20%20%5Cnthe%20answer%20is%20%5Cu201cnot%5Cu201d.%20At%20the%20end%20of%20each%20test%20case%20print%20a%20blank%20line.%22%2C%22samples%22%3A%5B%5B%22%28a%29%5C%5Cn3%5C%5Cna%5C%5Cnb%5C%5Cnaa%5C%5Cn%28a.b%29%5C%5Cn3%5C%5Cna%5C%5Cnab%5C%5Cnb%5C%5Cn%28a%7Cb%29%5C%5Cn4%5C%5Cna%5C%5Cnb%5C%5Cnab%5C%5Cnba%5C%5Cn%28a%2A%29%5C%5Cn3%5C%5Cna%5C%5Cnaaaaaaaaaaa%5C%5Cnaaaaabaaaaa%5C%5Cn%28%28a%2A%29.%28b%2A%29%29%5C%5Cn3%5C%5Cnbbbaaa%5C%5Cnaaabbb%5C%5Cnbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb%22%2C%22Y%5C%5CnN%5C%5CnN%5C%5CnN%5C%5CnY%5C%5CnN%5C%5CnY%5C%5CnY%5C%5CnN%5C%5CnN%5C%5CnY%5C%5CnY%5C%5CnN%5C%5CnN%5C%5CnY%5C%5CnY%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B995%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F10572%22%2C%22id%22%3A%2210572%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP10572%22%2C%22title%22%3A%22CHEATCON%20-%20Cheating%20on%20the%20contest%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22CHEATCON%20-%20Cheating%20on%20the%20contest%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>CHEATCON - Cheating on the contest</h1>
<h2>题目描述</h2>
<div>For the first time the Skyrim Free School of Mathematics, Philosophy and Linguistics will host
the Regular Expressions (regex) Contest (RegExCon). The contest happens this way: participants
compete always against 1 opponent. One wins one loses. Only one will remain, the champion. In one
dispute both participants receive a list with several regular expressions and for each regex the
participants must calculate if several given words are recognized or not by the regex. As a member of
the School you are participating, and want to win.
So, to guarantee your victory, you have to write a program to solve the problem and let it
executing in your Cool Stuff Calculator Machine at home. As a mage, expert in Alteration and Illusion,
you can easily control your machine with your mind, so you can use your program while in the contest.
It's forbidden to use magic in the contest, but coincidentally the Winterhold School will host some
Mage Congress, so you don't need to worry, use your magic.
A regular expression is used to describe a language (a set of words). Consider that the alphabet
of all languages in this problem is {a, b}.
A regex R is valid if:
1\) R is “a” or “b”;
2\) R is “(P.S)” where P and S are regular expressions;
3\) R is “(P|S)” where P and S are regular expressions;
4\) R is “(P\*)” where P is a regular expression;
Regular expressions can be nested. There is no ternary operation with operators “.” and “|”,
neither binary operation with operator “\*”. Words always start with “(“ and finish with “)”.
Set L of words recognized by R is formed following next rules:
1\) If R is “(a)”, L = {a};
2\) If R is “(b)”, L = {b};
3\) If R is “(P.S)”, L = all words that can be obtained from a concatenation of words p and s,
where p is recognized by P and s by S;
4\) If R is “(P|S)”, L = union of the sets of words recognized by P and S;
5\) If R is “(P\*)”, R recognizes the concatenation of 0 or more words recognized by P.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Input file contains several test cases. First line of a test case contains a regex (defined before, between 1 and 150). Next line
contain an integer P (1 that represents the following question: “Is this word recognized by the given regex?”.</div>
<h3>输出格式</h3>
<br />
<div>For each question described before, answer “Y” (no quotes) if the answer is “yes” or “N” (no quotes) if
the answer is “not”. At the end of each test case print a blank line.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>(a)\n3\na\nb\naa\n(a.b)\n3\na\nab\nb\n(a|b)\n4\na\nb\nab\nba\n(a*)\n3\na\naaaaaaaaaaa\naaaaabaaaaa\n((a*).(b*))\n3\nbbbaaa\naaabbb\nbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb</code></pre>
<h3>输出样例 #1</h3>
<pre><code>Y\nN\nN\nN\nY\nN\nY\nY\nN\nN\nY\nY\nN\nN\nY\nY</code></pre>
</article>
</div>
</div>
</body>
</html>
