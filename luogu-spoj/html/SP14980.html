<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>UOFTBE - MVP - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450406:fkSeKwwhqhRy3KtFZSLwjksB0EhiLhfUJwyjfpl6xuk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22It%27s%20down%20to%20the%20final%20match%20in%20the%20world%27s%20biggest%20SC2%20%24%20%5E1%20%24%20tournament%21%20You%27re%20the%20MVP%20%24%20%5E2%20%24%20of%20MVP%20%24%20%5E3%20%24%20%2C%20and%20you%27re%20going%20up%20against%20MVP%20%24%20%5E4%20%24%20.%20There%20are%20%24%20G%20%24%20%28%20%24%201%20%5C%5Cleq%20G%20%5C%5Cleq%2020%20%24%20%29%20games%20in%20the%20series%2C%20with%20a%20winner%20decided%20after%20all%20have%20been%20played.%20Being%20a%20Protoss%20%24%20%5E5%20%24%20player%2C%20you%20know%20the%20perfect%20way%20to%20win%20against%20that%20Terran%20%24%20%5E6%20%24%20scum%20-%20with%20a%20cannon%20rush%20%24%20%5E7%20%24%20every%20single%20game.%20Now%20you%20just%20have%20to%20execute%20it%20perfectly%2C%20by%20quickly%20getting%20your%20probe%20%24%20%5E%7B10%7D%20%24%20to%20the%20correct%20location%2C%20and%20the%20prize%20money%27s%20sure%20to%20be%20yours.%5Cn%5CnEach%20game%20will%20take%20place%20on%20a%20map%20which%20can%20be%20represented%20as%20a%20grid%20with%20%24%20H%20%24%20%28%20%24%202%20%5C%5Cleq%20H%20%5C%5Cleq%201000%20%24%20%29%20rows%20of%20%24%20W%20%24%20%28%20%24%202%20%5C%5Cleq%20W%20%5C%5Cleq%201000%20%24%20%29%20cells%20each.%20Each%20cell%20contains%20either%20empty%20space%20%28represented%20by%20%5C%22E%5C%22%29%2C%20water%20%28%5C%22W%5C%22%29%2C%20a%20unit%20%28%5C%22U%5C%22%29%2C%20one%20of%20exactly%20two%20mineral%20patches%20%28%5C%22M%5C%22%29%2C%20the%20probe%20%28%5C%22P%5C%22%29%2C%20or%20the%20cannon%20rush%20site%20%28%5C%22C%5C%22%29.%20Every%20second%2C%20your%20probe%20can%20move%20to%20a%20horizontally-%20or%20vertically-adjacent%20cell%20within%20the%20grid%2C%20with%20the%20goal%20of%20reaching%20the%20cannon%20rush%20site%20in%20as%20little%20time%20as%20possible.%20It%20can%20move%20freely%20from%20an%20empty%20cell%20to%20another%20empty%20cell%20%28including%20its%20initial%20position%20and%20destination%29%2C%20while%20cells%20containing%20water%20or%20minerals%20may%20never%20be%20traversed.%5Cn%5CnNormally%2C%20the%20probe%20may%20also%20not%20pass%20through%20units.%20However%2C%20it%20_can_%20if%20it%20is%20travelling%20towards%20a%20mineral%20patch.%20Specifically%2C%20the%20probe%20can%20only%20leave%20or%20enter%20a%20cell%20containing%20a%20unit%20if%2C%20for%20at%20least%20one%20of%20the%20two%20mineral%20patches%20on%20the%20map%2C%20the%20cell%20which%20the%20probe%20is%20entering%20is%20closer%20to%20that%20patch%20than%20the%20cell%20which%20the%20probe%20is%20leaving.%20Closeness%20is%20defined%20according%20to%20the%20minimum%20amount%20of%20time%20it%20would%20take%20to%20reach%20the%20mineral%20patch%20from%20the%20given%20cell%2C%20assuming%20the%20ability%20to%20pass%20through%20all%20units%20on%20the%20way.%5Cn%5CnFor%20each%20game%2C%20you%27d%20like%20to%20determine%20whether%20or%20not%20you%20can%20be%20successful%20in%20your%20strategy%2C%20and%2C%20if%20so%2C%20how%20quickly%20you%20can%20execute%20the%20cannon%20rush.%20Of%20course%2C%20the%20point%20of%20this%20is%20to%20help%20prepare%20the%20correct%20BM%20%24%20%5E%7B11%7D%20%24%20for%20the%20end%20of%20the%20game.%22%2C%22inputFormat%22%3A%22First%20line%3A%201%20integer%2C%20%24%20G%20%24%5Cn%5CnFor%20each%20game%3A%5Cn%5CnFirst%20line%3A%202%20integers%2C%20%24%20H%20%24%20and%20%24%20W%20%24%5Cn%5CnNext%20%24%20H%20%24%20lines%3A%20%24%20W%20%24%20characters%2C%20representing%20the%20%24%20i%20%24%20th%20row%20of%20the%20map%2C%20for%20%24%20i%20%3D%201..H%20%24%22%2C%22outputFormat%22%3A%22For%20each%20game%3A%5Cn%5CnThe%20BM%20to%20be%20typed%20at%20the%20conclusion%20of%20the%20game.%20Namely%2C%20if%20the%20probe%20can%20reach%20the%20cannon%20rush%20site%2C%20the%20string%20%5C%22pwned%20you%20in%20%24%20X%20%24%20seconds%20eZ%20%24%20%5E%7B12%7D%20%24%20%2C%20learn%20to%20play%20n00b%20%24%20%5E%7B13%7D%20%24%20%5C%22%20%28without%20the%20quotes%20and%20glossary%20numbers%29%2C%20where%20%24%20X%20%24%20is%20the%20minimum%20number%20of%20seconds%20for%20it%20to%20do%20so%20-%20otherwise%2C%20the%20string%20%5C%22terran%20so%20broken%2C%20apologize%20for%20playing%20this%20race%5C%22.%22%2C%22samples%22%3A%5B%5B%222%5C%5Cn4%205%5C%5CnWWEMC%5C%5CnEEEUE%5C%5CnPUWWU%5C%5CnMEEEE%5C%5Cn5%204%5C%5CnEWEM%5C%5CnECUE%5C%5CnEEWE%5C%5CnEWEE%5C%5CnEUPM%22%2C%22%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F14980%22%2C%22id%22%3A%2214980%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP14980%22%2C%22title%22%3A%22UOFTBE%20-%20MVP%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22UOFTBE%20-%20MVP%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>UOFTBE - MVP</h1>
<h2>题目描述</h2>
<div>It's down to the final match in the world's biggest SC2 $ ^1 $ tournament! You're the MVP $ ^2 $ of MVP $ ^3 $ , and you're going up against MVP $ ^4 $ . There are $ G $ ( $ 1 \leq G \leq 20 $ ) games in the series, with a winner decided after all have been played. Being a Protoss $ ^5 $ player, you know the perfect way to win against that Terran $ ^6 $ scum - with a cannon rush $ ^7 $ every single game. Now you just have to execute it perfectly, by quickly getting your probe $ ^{10} $ to the correct location, and the prize money's sure to be yours.
Each game will take place on a map which can be represented as a grid with $ H $ ( $ 2 \leq H \leq 1000 $ ) rows of $ W $ ( $ 2 \leq W \leq 1000 $ ) cells each. Each cell contains either empty space (represented by "E"), water ("W"), a unit ("U"), one of exactly two mineral patches ("M"), the probe ("P"), or the cannon rush site ("C"). Every second, your probe can move to a horizontally- or vertically-adjacent cell within the grid, with the goal of reaching the cannon rush site in as little time as possible. It can move freely from an empty cell to another empty cell (including its initial position and destination), while cells containing water or minerals may never be traversed.
Normally, the probe may also not pass through units. However, it _can_ if it is travelling towards a mineral patch. Specifically, the probe can only leave or enter a cell containing a unit if, for at least one of the two mineral patches on the map, the cell which the probe is entering is closer to that patch than the cell which the probe is leaving. Closeness is defined according to the minimum amount of time it would take to reach the mineral patch from the given cell, assuming the ability to pass through all units on the way.
For each game, you'd like to determine whether or not you can be successful in your strategy, and, if so, how quickly you can execute the cannon rush. Of course, the point of this is to help prepare the correct BM $ ^{11} $ for the end of the game.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>First line: 1 integer, $ G $
For each game:
First line: 2 integers, $ H $ and $ W $
Next $ H $ lines: $ W $ characters, representing the $ i $ th row of the map, for $ i = 1..H $</div>
<h3>输出格式</h3>
<br />
<div>For each game:
The BM to be typed at the conclusion of the game. Namely, if the probe can reach the cannon rush site, the string "pwned you in $ X $ seconds eZ $ ^{12} $ , learn to play n00b $ ^{13} $ " (without the quotes and glossary numbers), where $ X $ is the minimum number of seconds for it to do so - otherwise, the string "terran so broken, apologize for playing this race".</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2\n4 5\nWWEMC\nEEEUE\nPUWWU\nMEEEE\n5 4\nEWEM\nECUE\nEEWE\nEWEE\nEUPM</code></pre>
<h3>输出样例 #1</h3>
<pre><code></code></pre>
</article>
</div>
</div>
</body>
</html>
