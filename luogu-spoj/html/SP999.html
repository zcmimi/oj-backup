<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>MATRIOSH - Generalized Matrioshkas - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449627:oG8AJuE0oWRq3Aa9kG9lmR3ZOM4YEVL9fDVnAsRblOk=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Vladimir%20worked%20for%20years%20making%20matrioshkas%2C%20those%20nesting%20dolls%20that%20certainly%20represent%20truly%20Russian%20craft.%20A%20matrioshka%20is%20a%20doll%20that%20may%20be%20opened%20in%20two%20halves%2C%20so%20that%20one%20finds%20another%20doll%20inside.%20Then%20this%20doll%20may%20be%20opened%20to%20find%20another%20one%20inside%20it.%20This%20can%20be%20repeated%20several%20times%2C%20till%20a%20final%20doll%20-that%20cannot%20be%20opened-%20is%20reached.%5Cn%5Cn%20%20%5CnRecently%2C%20Vladimir%20realized%20that%20the%20idea%20of%20nesting%20dolls%20might%20be%20generalized%20to%20nesting%20toys.%20Indeed%2C%20he%20has%20designed%20toys%20that%20contain%20toys%20but%20in%20a%20more%20general%20sense.%20One%20of%20these%20toys%20may%20be%20opened%20in%20two%20halves%20and%20it%20may%20have%20more%20than%20one%20toy%20inside%20it.%20That%20is%20the%20new%20feature%20that%20Vladimir%20wants%20to%20introduce%20in%20his%20new%20line%20of%20toys.%5Cn%5Cn%20%20%5CnVladimir%20has%20developed%20a%20notation%20to%20describe%20how%20nesting%20toys%20should%20be%20constructed.%20A%20toy%20is%20represented%20with%20a%20positive%20integer%2C%20according%20to%20its%20size.%20More%20precisely%3A%20if%20when%20opening%20the%20toy%20represented%20by%20m%20we%20find%20the%20toys%20represented%20by%20n1%2C%20n2%2C%20.%20.%20.%2C%20nr%2C%20it%20must%20be%20true%20that%20n1%20%2Bn2%20%2B.%20.%20.%2Bnr%20%3C%20m.%20And%20if%20this%20is%20the%20case%2C%20we%20say%20that%20toy%20m%20contains%20directly%20the%20toys%20n1%2C%20n2%2C%20.%20.%20.%2C%20nr%20.%20It%20should%20be%20clear%20that%20toys%20that%20may%20be%20contained%20in%20any%20of%20the%20toys%20n1%2C%20n2%2C%20.%20.%20.%2C%20nr%20are%20not%20considered%20as%20directly%20contained%20in%20the%20toy%20m.%5Cn%5Cn%20%20%5CnA%20generalized%20matrioshka%20is%20denoted%20with%20a%20non-empty%20sequence%20of%20non%20zero%20integers%20of%20the%20form%3A%20a1%20a2%20.%20.%20.%20aN%20such%20that%20toy%20k%20is%20represented%20in%20the%20sequence%20with%20two%20integers%20%5Cu2212k%20and%20k%2C%20with%20the%20negative%20one%20occurring%20in%20the%20sequence%20first%20that%20the%20positive%20one.%5Cn%5Cn%20%20%5CnFor%20example%2C%20the%20sequence%5Cn%5Cn%5Cu22129%20%5Cu22127%20%5Cu22122%202%20%5Cu22123%20%5Cu22122%20%5Cu22121%201%202%203%207%209%20%20%5Cnrepresents%20a%20generalized%20matrioshka%20conformed%20by%20six%20toys%2C%20namely%2C%201%2C%202%20%28twice%29%2C%203%2C%207%20and%209.%20%20%20%5CnNote%20that%20toy%207%20contains%20directly%20toys%202%20and%203.%20Note%20that%20the%20first%20copy%20of%20toy%202%20occurs%20left%20from%20the%20second%20one%20and%20that%20the%20second%20copy%20contains%20directly%20a%20toy%201.%20It%20would%20be%20wrong%20to%20understand%20that%20the%20first%20%5Cu22122%20and%20the%20last%202%20should%20be%20paired.%5Cn%5Cn%20%20%5CnOn%20the%20other%20hand%2C%20the%20following%20sequences%20do%20not%20describe%20generalized%20matrioshkas%3A%5Cn%5Cn%5Cu22129%20%5Cu22127%20%5Cu22122%202%20%5Cu22123%20%5Cu22121%20%5Cu22122%202%201%203%207%209%20%20%5Cnbecause%20toy%202%20is%20bigger%20than%20toy%201%20and%20cannot%20be%20allocated%20inside%20it.%5Cn%5Cn%5Cu22129%20%5Cu22127%20%5Cu22122%202%20%5Cu22123%20%5Cu22122%20%5Cu22121%201%202%203%207%20%5Cu22122%202%209%20%20%5Cnbecause%207%20and%202%20may%20not%20be%20allocated%20together%20inside%209.%22%2C%22inputFormat%22%3A%22The%20input%20file%20contains%20several%20test%20cases%2C%20each%20one%20of%20them%20in%20a%20separate%20line.%20Each%20test%20case%20is%20a%20sequence%20of%20non%20zero%20integers%2C%20each%20one%20with%20an%20absolute%20value%20less%20than%2010%5E7.%22%2C%22outputFormat%22%3A%22Output%20texts%20for%20each%20input%20case%20are%20presented%20in%20the%20same%20order%20that%20input%20is%20read.%20For%20each%20test%20case%20the%20answer%20must%20be%20a%20line%20of%20the%20form%5Cn%5Cn%20%20%5Cn%3A-%29%20Matrioshka%21%5Cn%5Cn%20%20%5Cnif%20the%20design%20describes%20a%20generalized%20matrioshka.%20In%20other%20case%2C%20the%20answer%20should%20be%20of%20the%20form%5Cn%5Cn%20%20%5Cn%3A-%28%20Try%20again.%22%2C%22samples%22%3A%5B%5B%22-9%20-7%20-2%202%20-3%20-2%20-1%201%202%203%207%209%5Cr%5Cn-9%20-7%20-2%202%20-3%20-1%20-2%202%201%203%207%209%5Cr%5Cn-9%20-7%20-2%202%20-3%20-1%20-2%203%202%201%207%209%5Cr%5Cn-100%20-50%20-6%206%2050%20100%5Cr%5Cn-100%20-50%20-6%206%2045%20100%5Cr%5Cn-10%20-5%20-2%202%205%20-4%20-3%203%204%2010%5Cr%5Cn-9%20-5%20-2%202%205%20-4%20-3%203%204%209%22%2C%22%3A-%29%20Matrioshka%21%5Cr%5Cn%3A-%28%20Try%20again.%5Cr%5Cn%3A-%28%20Try%20again.%5Cr%5Cn%3A-%29%20Matrioshka%21%5Cr%5Cn%3A-%28%20Try%20again.%5Cr%5Cn%3A-%29%20Matrioshka%21%5Cr%5Cn%3A-%28%20Try%20again.%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B691%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F999%22%2C%22id%22%3A%22999%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP999%22%2C%22title%22%3A%22MATRIOSH%20-%20Generalized%20Matrioshkas%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22MATRIOSH%20-%20Generalized%20Matrioshkas%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>MATRIOSH - Generalized Matrioshkas</h1>
<h2>题目描述</h2>
<div>Vladimir worked for years making matrioshkas, those nesting dolls that certainly represent truly Russian craft. A matrioshka is a doll that may be opened in two halves, so that one finds another doll inside. Then this doll may be opened to find another one inside it. This can be repeated several times, till a final doll -that cannot be opened- is reached.
Recently, Vladimir realized that the idea of nesting dolls might be generalized to nesting toys. Indeed, he has designed toys that contain toys but in a more general sense. One of these toys may be opened in two halves and it may have more than one toy inside it. That is the new feature that Vladimir wants to introduce in his new line of toys.
Vladimir has developed a notation to describe how nesting toys should be constructed. A toy is represented with a positive integer, according to its size. More precisely: if when opening the toy represented by m we find the toys represented by n1, n2, . . ., nr, it must be true that n1 +n2 +. . .+nr < m. And if this is the case, we say that toy m contains directly the toys n1, n2, . . ., nr . It should be clear that toys that may be contained in any of the toys n1, n2, . . ., nr are not considered as directly contained in the toy m.
A generalized matrioshka is denoted with a non-empty sequence of non zero integers of the form: a1 a2 . . . aN such that toy k is represented in the sequence with two integers −k and k, with the negative one occurring in the sequence first that the positive one.
For example, the sequence
−9 −7 −2 2 −3 −2 −1 1 2 3 7 9
represents a generalized matrioshka conformed by six toys, namely, 1, 2 (twice), 3, 7 and 9.
Note that toy 7 contains directly toys 2 and 3. Note that the first copy of toy 2 occurs left from the second one and that the second copy contains directly a toy 1. It would be wrong to understand that the first −2 and the last 2 should be paired.
On the other hand, the following sequences do not describe generalized matrioshkas:
−9 −7 −2 2 −3 −1 −2 2 1 3 7 9
because toy 2 is bigger than toy 1 and cannot be allocated inside it.
−9 −7 −2 2 −3 −2 −1 1 2 3 7 −2 2 9
because 7 and 2 may not be allocated together inside 9.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The input file contains several test cases, each one of them in a separate line. Each test case is a sequence of non zero integers, each one with an absolute value less than 10^7.</div>
<h3>输出格式</h3>
<br />
<div>Output texts for each input case are presented in the same order that input is read. For each test case the answer must be a line of the form
:-) Matrioshka!
if the design describes a generalized matrioshka. In other case, the answer should be of the form
:-( Try again.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>-9 -7 -2 2 -3 -2 -1 1 2 3 7 9
-9 -7 -2 2 -3 -1 -2 2 1 3 7 9
-9 -7 -2 2 -3 -1 -2 3 2 1 7 9
-100 -50 -6 6 50 100
-100 -50 -6 6 45 100
-10 -5 -2 2 5 -4 -3 3 4 10
-9 -5 -2 2 5 -4 -3 3 4 9</code></pre>
<h3>输出样例 #1</h3>
<pre><code>:-) Matrioshka!
:-( Try again.
:-( Try again.
:-) Matrioshka!
:-( Try again.
:-) Matrioshka!
:-( Try again.</code></pre>
</article>
</div>
</div>
</body>
</html>
