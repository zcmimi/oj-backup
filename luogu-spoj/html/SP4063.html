<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>MPIGS - Sell Pigs - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449853:i8Bmx18mYGS4bqEhoBLR8lWksSP41L5rx+mE1kUgJQM=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%5BEnglish%5D%28%5C%2Fproblems%5C%2FMPIGS%5C%2Fen%5C%2F%29%20%5BVietnamese%5D%28%5C%2Fproblems%5C%2FMPIGS%5C%2Fvn%5C%2F%29%20%60%60%60%5Cn%5CnMirko%20works%20on%20a%20pig%20farm%20that%20consists%20of%20M%20%20locked%20pig-houses%20%5Cnand%20Mirko%20%20can%27t%20unlock%20any%20pig-house%20because%20he%20doesn%27t%20have%20the%20keys.%20%5CnCustomers%20come%20to%20the%20farm%20one%20after%20another.%20Each%20of%20them%20has%20keys%20%5Cnto%20some%20pig-houses%20and%20wants%20to%20buy%20a%20certain%20number%20of%20pigs.%20%5CnAll%20data%20concerning%20customers%20planning%20to%20visit%20the%20farm%20on%20that%20%5Cnparticular%20day%20are%20available%20to%20Mirko%20early%20in%20the%20morning%20so%20that%20%5Cnhe%20can%20make%20a%20sales-plan%20in%20order%20to%20maximize%20the%20number%20of%20pigs%20sold.%20%5CnMore%20precisely%2C%20the%20procedure%20is%20as%20following%3A%20the%20customer%20arives%2C%20%5Cnopens%20all%20pig-houses%20to%20which%20he%20has%20the%20key%2C%20Mirko%20sells%20a%20certain%20number%20%5Cnof%20pigs%20from%20all%20the%20unlocked%20pig-houses%20to%20him%2C%20and%2C%20if%20Mirko%20wants%2C%20%5Cnhe%20can%20redistribute%20the%20remaining%20pigs%20across%20the%20unlocked%20pig-houses.%20%5CnAn%20unlimited%20number%20of%20pigs%20can%20be%20placed%20in%20every%20pig-house.%20%5CnWrite%20a%20program%20that%20will%20find%20the%20maximum%20number%20of%20pigs%20that%20he%20can%20%5Cnsell%20on%20that%20day%5Cn%60%60%60%22%2C%22inputFormat%22%3A%22%60%60%60%5Cn%5CnThe%20first%20line%20of%20input%20file%20contains%20two%20integers%20M%20and%20N%2C%201%20%5Cu2264%20M%20%5Cu2264%201000%2C%5Cn1%20%5Cu2264%20N%20%5Cu2264%20100%2C%20number%20of%20pig-houses%20and%20%20number%20of%20customers.%20Pig%20%5Cnhouses%20are%20numbered%20from%201%20to%20M%20and%20customers%20are%20numbered%20%5Cnfrom%201%20to%20N.%20%5CnThe%20next%20line%20contains%20M%20integeres%2C%20for%20each%20pig-house%20initial%20number%5Cnof%20pigs.%20The%20number%20of%20pigs%20in%20each%20pig-house%20is%20greater%20or%20equal%20to%20%5Cn0%20and%20less%20or%20equal%20to%201000.%20%5CnThe%20next%20N%20lines%20contains%20records%20about%20the%20customers%20in%20the%20following%20%5Cnform%20%28%20record%20about%20the%20i-th%20customer%20is%20written%20in%20the%20%28i%2B2%29-th%20line%29%3A%20%5CnA%20K1%20K2%20...%20KA%20B%20%5CnIt%20means%20that%20this%20customer%20has%20key%20to%20the%20pig-houses%20marked%20with%20%5Cnthe%20numbers%20K1%2C%20K2%2C%20...%2C%20KA%20%5Cn%28sorted%20nondecreasingly%20%29%20and%20that%20he%20wants%20to%20buy%20B%20pigs.%20Numbers%20%5CnA%20and%20B%20can%20be%20equal%20to%200.%20%5Cn%60%60%60%22%2C%22outputFormat%22%3A%22%60%60%60%5Cn%5CnThe%20first%20and%20only%20line%20of%20the%20output%20file%20should%20contain%20the%20number%20of%20%5Cnsold%20pigs.%20%5Cn%60%60%60%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B190%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F4063%22%2C%22id%22%3A%224063%22%7D%2C%22translation%22%3A%22Mirko%5Cu5728%5Cu4e00%5Cu4e2a%5Cu517b%5Cu732a%5Cu573a%5Cu5de5%5Cu4f5c%5Cuff0c%5Cu517b%5Cu732a%5Cu573a%5Cu6709M%5Cu4e2a%5Cu5173%5Cu7740%5Cu7684%5Cu732a%5Cu5708%5Cuff0cMirko%5Cu4e0d%5Cu80fd%5Cu6253%5Cu5f00%5Cu4efb%5Cu4f55%5Cu732a%5Cu5708%5Cuff0c%5Cu56e0%5Cu4e3a%5Cu4ed6%5Cu6ca1%5Cu94a5%5Cu5319%5Cu3002%5Cu987e%5Cu5ba2%5Cu4e00%5Cu4e2a%5Cu63a5%5Cu4e00%5Cu4e2a%5Cu5730%5Cu6765%5Cu5230%5Cu517b%5Cu732a%5Cu573a%5Cuff0c%5Cu4ed6%5Cu4eec%5Cu5404%5Cu62e5%5Cu6709%5Cu4e00%5Cu4e9b%5Cu732a%5Cu5708%5Cu7684%5Cu94a5%5Cu5319%5Cuff0c%5Cu60f3%5Cu4e70%5Cu82e5%5Cu5e72%5Cu732a%5Cu3002Mirko%5Cu65e9%5Cu5c31%5Cu77e5%5Cu9053%5Cu5173%5Cu4e8e%5Cu90a3%5Cu5929%5Cu6765%5Cu519c%5Cu573a%5Cu987e%5Cu5ba2%5Cu7684%5Cu6240%5Cu6709%5Cu6570%5Cu636e%5Cuff0c%5Cu4ed6%5Cu53ef%5Cu4ee5%5Cu5236%5Cu5b9a%5Cu4e00%5Cu4e2a%5Cu9500%5Cu552e%5Cu8ba1%5Cu5212%5Cuff0c%5Cu4ee5%5Cu4fbf%5Cu5c3d%5Cu53ef%5Cu80fd%5Cu589e%5Cu52a0%5Cu51fa%5Cu552e%5Cu7684%5Cu732a%5Cu7684%5Cu6570%5Cu91cf%5Cu3002%5Cu66f4%5Cu660e%5Cu786e%5Cu5730%5Cuff0c%5Cu6574%5Cu4e2a%5Cu8fc7%5Cu7a0b%5Cu5982%5Cu4e0b%5Cuff1a%5Cu987e%5Cu5ba2%5Cu6765%5Cu5566%5Cuff0c%5Cu987e%5Cu5ba2%5Cu7528%5Cu624b%5Cu91cc%5Cu7684%5Cu94a5%5Cu5319%5Cu6253%5Cu5f00%5Cu732a%5Cu5708%5Cu5566%5Cuff0cMirko%5Cu628a%5Cu4ed6%5Cu8981%5Cu7684%5Cu732a%28%5Cu4ece%5Cu6240%5Cu6709%5Cu6253%5Cu5f00%5Cu7740%5Cu7684%5Cu732a%5Cu5708%29%5Cu5356%5Cu7ed9%5Cu4ed6%5Cu5566%5Cuff0c%28%5Cu5982%5Cu679cMirko%5Cu60f3%5Cu8fd9%5Cu4e48%5Cu5e72%29%5Cu91cd%5Cu6392%5Cuff08%5Cu5f00%5Cu7740%5Cu7684%5Cu732a%5Cu5708%5Cu4e2d%5Cu7684%5Cuff09%5Cu5269%5Cu4f59%5Cu7684%5Cu732a%5Cu5566%5Cuff0c%5Cu5566%5Cuff0c%5Cu5566%5Cu3002%5Cu3002%5Cu3002%5Cu3002%5Cu6ce8%5Cu610f%5Cuff0c%5Cu732a%5Cu5708%5Cu7684%5Cu5bb9%5Cu91cf%5Cu65e0%5Cu7a77%5Cu5927%5Cu3002%5Cu8bf7%5Cu5c3d%5Cu53ef%5Cu80fd%5Cu6700%5Cu5927%5Cu5316%5Cu4ed6%5Cu80fd%5Cu5356%5Cu51fa%5Cu7684%5Cu732a%5Cu7684%5Cu6570%5Cu91cf%5Cu3002%20%20%5Cr%5Cn%24%5C%5Ccolor%7Bred%7D%20%5C%5Ctext%7B%5Cu6ce8%5Cu610f%3A%7D%24%5Cu987e%5Cu5ba2%5Cu6765%5Cu7684%5Cu987a%5Cu5e8f%5Cu4e0d%5Cu53ef%5Cu6539%5Cu53d8%5Cuff0c%5Cu987e%5Cu5ba2%5Cu6765%5Cu540e%5Cu3001%5Cu8c03%5Cu6574%5Cu5b8c%5Cu540e%5Cu732a%5Cu5708%5Cu95e8%5Cu4f1a%5Cu5173%5Cu95ed%5Cu3002%5Cr%5Cn%5Cr%5Cn%23%23%23%20%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570M%5Cu3001N%28%241%5C%5Cle%20M%20%5C%5Cle%201000%2C1%5C%5Cle%20N%5C%5Cle100%5Cu200b%24%29%5Cuff0c%5Cu5206%5Cu522b%5Cu8868%5Cu793a%5Cu732a%5Cu7a9d%5Cu6570%5Cu4e0e%5Cu987e%5Cu5ba2%5Cu6570%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu6709M%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu6bcf%5Cu4e2a%5Cu732a%5Cu5708%5Cu7684%5Cu521d%5Cu59cb%5Cu732a%5Cu7684%5Cu6570%5Cu91cf%28%5Cu4e0d%5Cu5c0f%5Cu4e8e0%5Cuff0c%5Cu4e0d%5Cu5927%5Cu4e8e1000%29%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu63a5%5Cu4e0b%5Cu6765N%5Cu884c%5Cuff0c%5Cu7b2c%5Cu4e00%5Cu4e2a%5Cu6570A%5Cu8868%5Cu793a%5Cu4ed6%5Cu6709%5Cu7684%5Cu94a5%5Cu5319%5Cu6570%5Cuff0c%5Cu63a5%5Cu4e0b%5Cu6765A%5Cu4e2a%5Cu6570%5Cu8868%5Cu793a%5Cu6709%5Cu54ea%5Cu4e9b%5Cu732a%5Cu5708%5Cu7684%5Cu94a5%5Cu5319%5Cuff0c%5Cu6700%5Cu540e%5Cu4e00%5Cu4e2a%5Cu6570B%5Cu8868%5Cu793a%5Cu4ed6%5Cu5bf9%5Cu732a%5Cu7684%5Cu9700%5Cu6c42%5Cu91cf%5Cu3002%5Cr%5Cn%5Cr%5Cn%5Cu8f93%5Cu51fa%5Cu53ea%5Cu6709%5Cu4e00%5Cu4e2a%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu6700%5Cu591a%5Cu80fd%5Cu5356%5Cu51fa%5Cu7684%5Cu732a%5Cu7684%5Cu6570%5Cu91cf%5Cu3002%5Cr%5Cn%5Cr%5Cn%23%23%23%20%5Cu6837%5Cu4f8b%5Cu8f93%5Cu5165%5Cu8f93%5Cu51fa%5Cr%5Cn%5Cr%5CnP.S.%5Cu6d1b%5Cu8c37%5Cu9898%5Cu9762%5Cu6ca1%5Cu7ed9%5Cu6837%5Cu4f8b%5Cu3002%5Cu3002%5Cu3002%5Cu5230SPOJ%5Cu4e0a%5Cu642c%5Cu8fc7%5Cu6765%5Cu7684%5Cu3002%5Cu3002%5Cu3002%5Cr%5Cn%5Cr%5Cn%2A%2A%5Cu8f93%5Cu5165%5Cu6837%5Cu4f8b%231%5Cuff1a%2A%2A%5Cr%5Cn%5Cr%5Cn%60%60%60%5Cr%5Cn3%203%5Cr%5Cn3%201%2010%5Cr%5Cn2%201%202%202%5Cr%5Cn2%201%203%203%5Cr%5Cn1%202%206%5Cr%5Cn%60%60%60%5Cr%5Cn%5Cr%5Cn%2A%2A%5Cu8f93%5Cu51fa%5Cu6837%5Cu4f8b%231%5Cuff1a%2A%2A%5Cr%5Cn%5Cr%5Cn%60%60%60%5Cr%5Cn7%5Cr%5Cn%60%60%60%5Cr%5Cn%5Cr%5Cn%2A%2A%5Cu8f93%5Cu5165%5Cu6837%5Cu4f8b%232%5Cuff1a%2A%2A%5Cr%5Cn%5Cr%5Cn%60%60%60%5Cr%5Cn6%206%5Cr%5Cn6%203%202%200%201%203%5Cr%5Cn2%201%202%200%5Cr%5Cn1%203%203%5Cr%5Cn1%201%201%5Cr%5Cn2%202%203%208%5Cr%5Cn2%204%205%202%5Cr%5Cn2%204%206%206%5Cr%5Cn%60%60%60%5Cr%5Cn%5Cr%5Cn%2A%2A%5Cu8f93%5Cu51fa%5Cu6837%5Cu4f8b%232%5Cuff1a%2A%2A%5Cr%5Cn%5Cr%5Cn%60%60%60%5Cr%5Cn15%5Cr%5Cn%60%60%60%5Cr%5Cn%5Cr%5Cn%2A%2A%5Cu8f93%5Cu5165%5Cu6837%5Cu4f8b%233%5Cuff1a%2A%2A%5Cr%5Cn%5Cr%5Cn%60%60%60%5Cr%5Cn11%205%5Cr%5Cn1%202%202%201%200%202%204%201%201%201%202%5Cr%5Cn5%201%202%203%204%205%203%5Cr%5Cn4%201%202%206%207%205%5Cr%5Cn2%203%208%201%5Cr%5Cn3%203%206%2011%205%5Cr%5Cn3%208%209%2010%203%5Cr%5Cn%60%60%60%5Cr%5Cn%5Cr%5Cn%2A%2A%5Cu8f93%5Cu51fa%5Cu6837%5Cu4f8b%233%5Cuff1a%2A%2A%5Cr%5Cn%5Cr%5Cn%60%60%60%5Cr%5Cn17%20%5Cr%5Cn%60%60%60%22%2C%22tags%22%3A%5B156%2C157%2C194%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A236%2C%22totalAccepted%22%3A134%2C%22pid%22%3A%22SP4063%22%2C%22title%22%3A%22MPIGS%20-%20Sell%20Pigs%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A107132%2C%22title%22%3A%22%5Cu53ef%5Cu6076%22%2C%22forum%22%3A%7B%22id%22%3A14018%2C%22name%22%3A%22SP4063%20MPIGS%20-%20Sell%20Pigs%22%2C%22slug%22%3A%22SP4063%22%7D%7D%2C%7B%22id%22%3A106944%2C%22title%22%3A%22%5Cu53ef%5Cu601c%5Cu53ef%5Cu601c%5Cu6211%20%20%20%20%5Cu849f%5Cu84bbqz%22%2C%22forum%22%3A%7B%22id%22%3A14018%2C%22name%22%3A%22SP4063%20MPIGS%20-%20Sell%20Pigs%22%2C%22slug%22%3A%22SP4063%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%7B%22pid%22%3A%22P1251%22%2C%22title%22%3A%22%5Cu9910%5Cu5dfe%5Cu8ba1%5Cu5212%5Cu95ee%5Cu9898%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P3355%22%2C%22title%22%3A%22%5Cu9a91%5Cu58eb%5Cu5171%5Cu5b58%5Cu95ee%5Cu9898%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4001%22%2C%22title%22%3A%22%5BICPC-Beijing%202006%5D%5Cu72fc%5Cu6293%5Cu5154%5Cu5b50%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4003%22%2C%22title%22%3A%22%5Cu65e0%5Cu9650%5Cu4e4b%5Cu73af%22%2C%22difficulty%22%3A7%2C%22type%22%3A%22P%22%7D%2C%7B%22pid%22%3A%22P4134%22%2C%22title%22%3A%22%5BBJOI2012%5D%5Cu8fde%5Cu8fde%5Cu770b%22%2C%22difficulty%22%3A6%2C%22type%22%3A%22P%22%7D%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22MPIGS%20-%20Sell%20Pigs%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>MPIGS - Sell Pigs</h1>
<h2>题意翻译</h2>
<div>Mirko在一个养猪场工作，养猪场有M个关着的猪圈，Mirko不能打开任何猪圈，因为他没钥匙。顾客一个接一个地来到养猪场，他们各拥有一些猪圈的钥匙，想买若干猪。Mirko早就知道关于那天来农场顾客的所有数据，他可以制定一个销售计划，以便尽可能增加出售的猪的数量。更明确地，整个过程如下：顾客来啦，顾客用手里的钥匙打开猪圈啦，Mirko把他要的猪(从所有打开着的猪圈)卖给他啦，(如果Mirko想这么干)重排（开着的猪圈中的）剩余的猪啦，啦，啦。。。。注意，猪圈的容量无穷大。请尽可能最大化他能卖出的猪的数量。
$\color{red} \text{注意:}$顾客来的顺序不可改变，顾客来后、调整完后猪圈门会关闭。
### 输入输出格式
第一行两个整数M、N($1\le M \le 1000,1\le N\le100​$)，分别表示猪窝数与顾客数。
第二行有M个整数，表示每个猪圈的初始猪的数量(不小于0，不大于1000)。
接下来N行，第一个数A表示他有的钥匙数，接下来A个数表示有哪些猪圈的钥匙，最后一个数B表示他对猪的需求量。
输出只有一个数，表示最多能卖出的猪的数量。
### 样例输入输出
P.S.洛谷题面没给样例。。。到SPOJ上搬过来的。。。
**输入样例#1：**
```
3 3
3 1 10
2 1 2 2
2 1 3 3
1 2 6
```
**输出样例#1：**
```
7
```
**输入样例#2：**
```
6 6
6 3 2 0 1 3
2 1 2 0
1 3 3
1 1 1
2 2 3 8
2 4 5 2
2 4 6 6
```
**输出样例#2：**
```
15
```
**输入样例#3：**
```
11 5
1 2 2 1 0 2 4 1 1 1 2
5 1 2 3 4 5 3
4 1 2 6 7 5
2 3 8 1
3 3 6 11 5
3 8 9 10 3
```
**输出样例#3：**
```
17
```</div>
<h2>题目描述</h2>
<div>[English](/problems/MPIGS/en/) [Vietnamese](/problems/MPIGS/vn/) ```
Mirko works on a pig farm that consists of M locked pig-houses
and Mirko can't unlock any pig-house because he doesn't have the keys.
Customers come to the farm one after another. Each of them has keys
to some pig-houses and wants to buy a certain number of pigs.
All data concerning customers planning to visit the farm on that
particular day are available to Mirko early in the morning so that
he can make a sales-plan in order to maximize the number of pigs sold.
More precisely, the procedure is as following: the customer arives,
opens all pig-houses to which he has the key, Mirko sells a certain number
of pigs from all the unlocked pig-houses to him, and, if Mirko wants,
he can redistribute the remaining pigs across the unlocked pig-houses.
An unlimited number of pigs can be placed in every pig-house.
Write a program that will find the maximum number of pigs that he can
sell on that day
```</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>```
The first line of input file contains two integers M and N, 1 ≤ M ≤ 1000,
1 ≤ N ≤ 100, number of pig-houses and number of customers. Pig
houses are numbered from 1 to M and customers are numbered
from 1 to N.
The next line contains M integeres, for each pig-house initial number
of pigs. The number of pigs in each pig-house is greater or equal to
0 and less or equal to 1000.
The next N lines contains records about the customers in the following
form ( record about the i-th customer is written in the (i+2)-th line):
A K1 K2 ... KA B
It means that this customer has key to the pig-houses marked with
the numbers K1, K2, ..., KA
(sorted nondecreasingly ) and that he wants to buy B pigs. Numbers
A and B can be equal to 0.
```</div>
<h3>输出格式</h3>
<br />
<div>```
The first and only line of the output file should contain the number of
sold pigs.
```</div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
