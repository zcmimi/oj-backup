<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>CAPRICA - Caprica Cities - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450219:tsd9zXn3ZI1a228b2UIV1ZTGejFfzsXzvDMOcFtz79k=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Caprica%20is%20one%20of%20the%2012%20colonial%20planets%2C%20but%20it%20was%20completely%20destroyed%20by%20the%20cylons%2C%20robots%20made%20%20%5Cnby%20humans%20that%20had%20rebelled.%20Before%20the%20attack%2C%20Doctor%20Gaius%20Baltar%20had%20the%20following%20problem.%20%20%5CnCaprica%20has%20N%20cities%2C%20numbered%20from%200%20to%20N%20%5Cu2212%201%2C%20and%20M%20bidirectional%20roads%20connecting%20them%2C%20in%20%20%5Cna%20way%20that%20exists%20a%20path%20between%20every%20pair%20of%20cities.%20Let%20X%20and%20Y%20be%20two%20disjoint%20and%20non-empty%20%20%5Cnsubsets%20of%20this%20N%20cities.%20The%20problem%20is%20to%20find%20the%20smallest%20path%20length%20between%20any%20cities%20x%20and%20y%20%20%5Cnwhere%20x%20%5Cu2208%20X%20and%20y%20%5Cu2208%20Y%20.%20A%20path%20length%20is%20the%20sum%20of%20the%20distance%20of%20each%20road%20in%20this%20path.%22%2C%22inputFormat%22%3A%22Each%20test%20case%20is%20described%20using%20several%20lines.%20The%20first%20line%20contains%20four%20integers%20N%20%2C%20M%20%2C%20A%20and%20B%20%20%5Cnrepresenting%20respectively%20the%20number%20of%20cities%20%282%20the%20number%20of%20cities%20in%20X%20%282%20A%20%2B%20B%20The%20second%20line%20contains%20A%20integers%20and%20the%20third%20line%20contains%20B%20integers%2C%20representing%20the%20cities%20%20%5Cnin%20X%20and%20Y%20respectively.%20Each%20of%20the%20next%20M%20lines%20describes%20a%20road%20using%20three%20integers%2C%20u%2C%20v%2C%20and%20d%2C%20%20%5Cnindicating%20that%20there%20is%20a%20road%20between%20the%20cities%20u%20and%20v%20with%20distance%20d%20%281%20The%20last%20test%20case%20is%20followed%20by%20a%20line%20containing%20four%20zeros.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%20output%2C%20in%20a%20single%20line%2C%20the%20integer%20representing%20the%20smallest%20path%20length%20between%20%20%5Cnx%20and%20y%20where%20x%20%5Cu2208%20X%20and%20y%20%5Cu2208%20Y%20.%22%2C%22samples%22%3A%5B%5B%224%204%202%202%5C%5Cn0%201%5C%5Cn2%203%5C%5Cn0%201%2010%5C%5Cn0%202%2020%5C%5Cn1%203%2010%5C%5Cn2%203%2010%5C%5Cn0%200%200%200%5C%5Cn%5C%5Cn%22%2C%2210%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B202%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F10452%22%2C%22id%22%3A%2210452%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP10452%22%2C%22title%22%3A%22CAPRICA%20-%20Caprica%20Cities%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22CAPRICA%20-%20Caprica%20Cities%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>CAPRICA - Caprica Cities</h1>
<h2>题目描述</h2>
<div>Caprica is one of the 12 colonial planets, but it was completely destroyed by the cylons, robots made
by humans that had rebelled. Before the attack, Doctor Gaius Baltar had the following problem.
Caprica has N cities, numbered from 0 to N − 1, and M bidirectional roads connecting them, in
a way that exists a path between every pair of cities. Let X and Y be two disjoint and non-empty
subsets of this N cities. The problem is to find the smallest path length between any cities x and y
where x ∈ X and y ∈ Y . A path length is the sum of the distance of each road in this path.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Each test case is described using several lines. The first line contains four integers N , M , A and B
representing respectively the number of cities (2 the number of cities in X (2 A + B The second line contains A integers and the third line contains B integers, representing the cities
in X and Y respectively. Each of the next M lines describes a road using three integers, u, v, and d,
indicating that there is a road between the cities u and v with distance d (1 The last test case is followed by a line containing four zeros.</div>
<h3>输出格式</h3>
<br />
<div>For each test case output, in a single line, the integer representing the smallest path length between
x and y where x ∈ X and y ∈ Y .</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4 4 2 2\n0 1\n2 3\n0 1 10\n0 2 20\n1 3 10\n2 3 10\n0 0 0 0\n\n</code></pre>
<h3>输出样例 #1</h3>
<pre><code>10</code></pre>
</article>
</div>
</div>
</body>
</html>
