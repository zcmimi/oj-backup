<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>BUILD - Building Beacons - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449736:lCciJKxHNgG+fqjqaZ9+ggcwluh2gdS2+y0KSfzStNQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22A%20Millionaire%20Eccentric%20Mathematician%20purchases%20a%20small%20Island%2C%20to%20build%20his%20residence.%20In%20order%20to%20keep%20away%20Trespassers%2C%20he%20decides%20to%20Build%20some%20Beacons%20%28Towers%29%20on%20the%20perimeter%20of%20the%20Island.%20To%20build%20these%20Beacons%2C%20he%20visits%20the%20Mainland%20to%20purchase%20Stone.%20%20%20%5Cn%20%20%5CnBeing%20obsessed%20with%20Prime%20Numbers%2C%20the%20stone%20blocks%20he%20orders%20are%20all%20Regular%20Tridecagons%20%2813%20Sides%29.%20However%2C%20their%20heights%20are%20variable.%20On%20delivery%20of%20the%20Blocks%2C%20he%20orders%20them%20to%20be%20flattened%20perfectly%20from%20the%20top%20and%20the%20bottom%2C%20so%20that%20the%20Tridecagonal%20shape%20is%20viewable%20from%20the%20Top%20%28or%20Bottom%29%2C%20in%20such%20a%20way%20that%20the%20Height%20of%20each%20block%20measures%20to%20a%20power%20of%202.%20The%20stones%2C%20procured%20from%20various%20sources%2C%20are%20of%20Variable%20strength.%20He%20intends%20to%20build%20the%20Beacons%20by%20placing%20Stone%20Blocks%20one%20over%20the%20other.%20The%20heights%20of%20the%20Towers%20are%20specified%20by%20the%20Mathematician%2C%20and%20they%20are%20also%20Prime%20Numbers.%20He%20instructs%20the%20Architect%20to%20make%20sure%20that%20once%20the%20Beacons%20are%20complete%2C%20the%20strengths%20of%20the%20used%20stones%20add%20up%20to%20the%20Maximum%20Possible%20Number.%20%20%5Cn%20%20%5Cn%20The%20Architect%2C%20not%20knowing%20how%20the%20job%20can%20be%20done%2C%20or%20even%20whether%20it%20CAN%20be%20done%2C%20with%20such%20complicated%20restrictions%2C%20approaches%20you%20to%20find%20this%20out%20for%20him.%22%2C%22inputFormat%22%3A%22First%20line%20of%20input%20contains%20a%20positive%20integer%20T%2C%20the%20number%20of%20test%20cases.%20The%20first%20line%20of%20each%20test%20case%20contains%20a%20positive%20integer%20K%2C%20equal%20to%20the%20total%20number%20of%20stones%20available.%20This%20line%20is%20followed%20by%20K%20lines%2C%20each%20containing%20a%20pair%20of%20positive%20integers%20X%2CY.%20Here%20X%20denotes%20the%20height%20of%20that%20stone%20%28here%20the%20height%20would%20be%202%20%24%20%5E%7BX%7D%20%24%20%29%20and%20Y%20denotes%20its%20value.%20Followed%20is%20a%20line%20containing%20an%20integer%20N%2C%20the%20number%20of%20towers.%20Each%20of%20the%20next%20N%20lines%20contain%20a%20single%20positive%20number%2C%20which%20is%20the%20height%20H%20of%20the%20corresponding%20tower%20the%20mathematician%20wants%20to%20build.%22%2C%22outputFormat%22%3A%22Output%20contains%20T%20lines%2C%20one%20for%20each%20test%20case%2C%20containing%20a%20number%20denoting%20the%20maximum%20sum%20total%20of%20strengths%20of%20rocks%20used%20to%20construct%20the%20Beacons%20if%20solution%20is%20possible%2C%20else%20the%20message%20%5C%22Plan%20Failed%21%5C%22.%22%2C%22samples%22%3A%5B%5B%221%5Cr%5Cn2%5Cr%5Cn2%203%5Cr%5Cn0%204%5Cr%5Cn1%5Cr%5Cn5%22%2C%227%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2158%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F2413%22%2C%22id%22%3A%222413%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP2413%22%2C%22title%22%3A%22BUILD%20-%20Building%20Beacons%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22BUILD%20-%20Building%20Beacons%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>BUILD - Building Beacons</h1>
<h2>题目描述</h2>
<div>A Millionaire Eccentric Mathematician purchases a small Island, to build his residence. In order to keep away Trespassers, he decides to Build some Beacons (Towers) on the perimeter of the Island. To build these Beacons, he visits the Mainland to purchase Stone.
Being obsessed with Prime Numbers, the stone blocks he orders are all Regular Tridecagons (13 Sides). However, their heights are variable. On delivery of the Blocks, he orders them to be flattened perfectly from the top and the bottom, so that the Tridecagonal shape is viewable from the Top (or Bottom), in such a way that the Height of each block measures to a power of 2. The stones, procured from various sources, are of Variable strength. He intends to build the Beacons by placing Stone Blocks one over the other. The heights of the Towers are specified by the Mathematician, and they are also Prime Numbers. He instructs the Architect to make sure that once the Beacons are complete, the strengths of the used stones add up to the Maximum Possible Number.
The Architect, not knowing how the job can be done, or even whether it CAN be done, with such complicated restrictions, approaches you to find this out for him.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>First line of input contains a positive integer T, the number of test cases. The first line of each test case contains a positive integer K, equal to the total number of stones available. This line is followed by K lines, each containing a pair of positive integers X,Y. Here X denotes the height of that stone (here the height would be 2 $ ^{X} $ ) and Y denotes its value. Followed is a line containing an integer N, the number of towers. Each of the next N lines contain a single positive number, which is the height H of the corresponding tower the mathematician wants to build.</div>
<h3>输出格式</h3>
<br />
<div>Output contains T lines, one for each test case, containing a number denoting the maximum sum total of strengths of rocks used to construct the Beacons if solution is possible, else the message "Plan Failed!".</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1
2
2 3
0 4
1
5</code></pre>
<h3>输出样例 #1</h3>
<pre><code>7</code></pre>
</article>
</div>
</div>
</body>
</html>
