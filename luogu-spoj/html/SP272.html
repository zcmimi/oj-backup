<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>CAVE - Cave Exploration - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449563:aJ++aVkfLYdnvxYpwqCrmFUFgWxBWtE/F2t4DUdEzrQ=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22A%20long%20time%20ago%20one%20man%20said%20that%20he%20had%20explored%20the%20corridors%20of%20one%20cave.%20This%20means%20that%20he%20was%20in%20all%20corridors%20of%20the%20cave.%20Corridors%20are%20really%20horizontal%20or%20vertical%20segments.%20A%20corridor%20is%20treated%20as%20visited%20if%20he%20was%20in%20at%20least%20one%20point%20of%20the%20corridor.%5Cn%5CnNow%20you%20want%20to%20know%20if%20this%20is%20true.%20You%20have%20a%20map%20of%20the%20cave%2C%20and%20you%20know%20that%20the%20explorer%20used%20the%20following%20algorithm%3A%20he%20turns%20left%20if%20he%20can%2C%20if%20he%20can%27t%20he%20goes%20straight%2C%20if%20he%20can%27t%20he%20turns%20right%2C%20if%20he%20can%27t%20he%20turns%20back.%20Exploration%20ends%20when%20the%20man%20reaches%20the%20entry%20point%20for%20the%20second%20time.%20Your%20task%20to%20count%20how%20many%20corridors%20weren%27t%20visited%20by%20explorer.%22%2C%22inputFormat%22%3A%22In%20the%20first%20line%20there%20is%20an%20integer%20%2A%2AT%20%28T%20%3C%3D%2020%29%2A%2A%20-%20the%20number%20of%20different%20maps.%20For%20each%20map%20in%20the%20first%20line%20there%20is%20an%20integer%20%2A%2AN%20%28N%20%3C%3D%201000%29%2A%2A%20-%20the%20number%20of%20corridors.%20It%20is%20known%20that%20no%20two%20vertical%20corridors%20have%20a%20common%20point%20and%20no%20two%20horizontal%20corridors%20have%20a%20common%20point.%20The%20next%20%2A%2AN%2A%2A%20lines%20contain%20the%20following%20information%3A%20the%20line%20starts%20with%20one%20of%20the%20characters%20%27V%27%20or%20%27H%27%20-%20vertical%20or%20horizontal%20corridor.%20Then%20one%20Y-coordinate%20and%20two%20X-coordinates%20are%20given%20for%20a%20horizontal%20corridor%20or%20one%20X-coordinate%20and%20two%20Y-coordinates%20for%20a%20vertical%20corridor.%20The%20last%20line%20for%20each%20map%20contains%20the%20X%20and%20Y%20coordinates%20of%20the%20entry%20point%20%28start%20and%20end%20point%20of%20travel%29%20and%20the%20direction%20%28%27W%27%20-%20left%2C%20%27E%27%20-%20right%2C%20%27N%27%20-%20up%20and%20%27S%27%20-%20down%29.%20You%20may%20assume%20that%3A%20the%20entry%20point%20is%20not%20located%20at%20the%20cross-point%20of%20two%20corridors%2C%20and%20the%20explorer%20can%20always%20move%20forward%20in%20the%20direction%20given%20in%20the%20input.%20All%20coordinates%20are%20integers%20and%20do%20not%20exceed%20_32767_%20by%20absolute%20value%20and%20there%20are%20no%20more%20than%20_500_%20vertical%20corridors%20and%20no%20more%20than%20_500_%20horizontal%20corridors.%22%2C%22outputFormat%22%3A%22For%20each%20map%20the%20program%20has%20to%20print%20the%20number%20of%20unvisited%20corridors%20%28in%20a%20separate%20line%29.%22%2C%22samples%22%3A%5B%5B%222%5Cr%5Cn6%5Cr%5CnH%200%206%200%5Cr%5CnH%202%201%206%5Cr%5CnV%201%200%204%5Cr%5CnV%205%203%200%5Cr%5CnV%203%200%202%5Cr%5CnH%201%202%204%5Cr%5Cn6%200%20W%5Cr%5Cn1%5Cr%5CnV%200%20%26%238211%3B5%205%5Cr%5Cn0%200%20S%22%2C%221%5Cr%5Cn0%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F272%22%2C%22id%22%3A%22272%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP272%22%2C%22title%22%3A%22CAVE%20-%20Cave%20Exploration%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22CAVE%20-%20Cave%20Exploration%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>CAVE - Cave Exploration</h1>
<h2>题目描述</h2>
<div>A long time ago one man said that he had explored the corridors of one cave. This means that he was in all corridors of the cave. Corridors are really horizontal or vertical segments. A corridor is treated as visited if he was in at least one point of the corridor.
Now you want to know if this is true. You have a map of the cave, and you know that the explorer used the following algorithm: he turns left if he can, if he can't he goes straight, if he can't he turns right, if he can't he turns back. Exploration ends when the man reaches the entry point for the second time. Your task to count how many corridors weren't visited by explorer.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>In the first line there is an integer **T (T <= 20)** - the number of different maps. For each map in the first line there is an integer **N (N <= 1000)** - the number of corridors. It is known that no two vertical corridors have a common point and no two horizontal corridors have a common point. The next **N** lines contain the following information: the line starts with one of the characters 'V' or 'H' - vertical or horizontal corridor. Then one Y-coordinate and two X-coordinates are given for a horizontal corridor or one X-coordinate and two Y-coordinates for a vertical corridor. The last line for each map contains the X and Y coordinates of the entry point (start and end point of travel) and the direction ('W' - left, 'E' - right, 'N' - up and 'S' - down). You may assume that: the entry point is not located at the cross-point of two corridors, and the explorer can always move forward in the direction given in the input. All coordinates are integers and do not exceed _32767_ by absolute value and there are no more than _500_ vertical corridors and no more than _500_ horizontal corridors.</div>
<h3>输出格式</h3>
<br />
<div>For each map the program has to print the number of unvisited corridors (in a separate line).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2
6
H 0 6 0
H 2 1 6
V 1 0 4
V 5 3 0
V 3 0 2
H 1 2 4
6 0 W
1
V 0 &amp;#8211;5 5
0 0 S</code></pre>
<h3>输出样例 #1</h3>
<pre><code>1
0</code></pre>
</article>
</div>
</div>
</body>
</html>
