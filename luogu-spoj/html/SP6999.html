<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>AVOIDSOS - Avoiding SOS Grids - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450011:ZzAbNvCt4jXZWjsjrf4xWabLqTEhWOfjFrIc8iiYz2s=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22You%20are%20given%20a%20grid%20having%20N%20rows%20and%20M%20columns.%20Some%20squares%20are%20contain%20letters%20%27S%27%20or%20%27O%27%2C%20whereas%20the%20other%20squares%20are%20unfilled.%20A%20filled%20grid%20is%20called%20%5C%22Avoiding%20SOS%5C%22%20if%20there%20is%20no%20occurance%20of%20the%20string%20%5C%22SOS%5C%22%20in%20the%20grid%20either%20vertically%20or%20horizontally.%20In%20how%20many%20ways%20can%20the%20grid%20be%20completed%20by%20filling%20the%20unfilled%20squares%20with%20either%20%27S%27%20or%20%27O%27%20such%20that%20the%20resultant%20grid%20is%20%5C%22Avoiding%20SOS%5C%22%20%3F%20%20%5Cn%20%20%5Cn%20%20%5CnInput%20%3A%20%20%5CnThe%20first%20line%20contains%20T%20the%20number%20of%20test%20cases.%20T%20test%20cases%20follow.%20The%20first%20line%20for%20the%20test%20case%20contains%20N%20and%20M%2C%20the%20number%20of%20rows%20and%20columns%20in%20the%20grid%20respectively.%20N%20lines%20follow%2C%20each%20containing%20M%20characters.%20The%20jth%20character%20in%20the%20ith%20line%20is%20a%20%27.%27%20if%20the%20corresponding%20square%20in%20the%20grid%20is%20unfilled%2C%20otherwise%20it%20contains%20either%20the%20letter%20%27S%27%20or%20the%20letter%20%27O%27.%20A%20blank%20line%20seperates%20two%20test%20cases.%20%20%5Cn%20%20%5CnOutput%20%3A%20%20%5CnOutput%20T%20lines%2C%20one%20for%20each%20test%20case%2C%20containing%20the%20desired%20answer%20for%20the%20corresponding%20test%20case.%20Output%20each%20result%20modulo%201000000007.%20%20%5Cn%20%20%5CnSample%20Input%20%3A%20%20%5Cn5%20%20%5Cn2%203%20%20%5Cn...%20%20%5Cn...%20%20%5Cn%20%20%5Cn1%204%20%20%5Cn....%20%20%5Cn%20%20%5Cn3%203%20%20%5Cn.O.%20%20%5CnS.S%20%20%5Cn.O.%20%20%5Cn%20%20%5Cn1%203%20%20%5CnSOS%20%20%5Cn%20%20%5Cn1%203%20%20%5CnSOO%20%20%5Cn%20%20%5CnSample%20Output%20%3A%20%20%5Cn49%20%20%5Cn12%20%20%5Cn9%20%20%5Cn0%20%20%5Cn1%20%20%5Cn%20%20%5CnConstraints%20%3A%20%20%5Cn1%20%3C%3D%20T%20%3C%3D%20100%20%20%5Cn1%20%3C%3D%20N%2CM%20%3C%3D%208%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B490%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F6999%22%2C%22id%22%3A%226999%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP6999%22%2C%22title%22%3A%22AVOIDSOS%20-%20Avoiding%20SOS%20Grids%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22AVOIDSOS%20-%20Avoiding%20SOS%20Grids%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>AVOIDSOS - Avoiding SOS Grids</h1>
<h2>题目描述</h2>
<div>You are given a grid having N rows and M columns. Some squares are contain letters 'S' or 'O', whereas the other squares are unfilled. A filled grid is called "Avoiding SOS" if there is no occurance of the string "SOS" in the grid either vertically or horizontally. In how many ways can the grid be completed by filling the unfilled squares with either 'S' or 'O' such that the resultant grid is "Avoiding SOS" ?
Input :
The first line contains T the number of test cases. T test cases follow. The first line for the test case contains N and M, the number of rows and columns in the grid respectively. N lines follow, each containing M characters. The jth character in the ith line is a '.' if the corresponding square in the grid is unfilled, otherwise it contains either the letter 'S' or the letter 'O'. A blank line seperates two test cases.
Output :
Output T lines, one for each test case, containing the desired answer for the corresponding test case. Output each result modulo 1000000007.
Sample Input :
5
2 3
...
...
1 4
....
3 3
.O.
S.S
.O.
1 3
SOS
1 3
SOO
Sample Output :
49
12
9
0
1
Constraints :
1 <= T <= 100
1 <= N,M <= 8</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
