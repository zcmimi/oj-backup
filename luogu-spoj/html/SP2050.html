<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>CERC07B - Strange Billboard - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449707:K1WjkKOLoZ44eARWqc2fGr1fz4a7IbhIy/dP12HSGNA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20marketing%20and%20public-relations%20department%20of%20the%20Czech%20Technical%20University%20has%20designed%20a%20new%20reconfigurable%20mechanical%20Flip-Flop%20Bill-Board%20%28FFBB%29.%20The%20billboard%20is%20a%20regular%20two-%20dimensional%20grid%20of%20R%20%5Cu00d7%20C%20square%20tiles%20made%20of%20plastic.%20Each%20plastic%20tile%20is%20white%20on%20one%20side%20and%20black%20on%20the%20other.%20The%20idea%20of%20the%20billboard%20is%20that%20you%20can%20create%20various%20pictures%20by%20flipping%20individual%20tiles%20over.%20Such%20billboards%20will%20hang%20above%20all%20entrances%20to%20the%20university%20and%20will%20be%20used%20to%20display%20simple%20pictures%20and%20advertise%20upcoming%20academic%20events.%20To%20change%20pictures%2C%20each%20billboard%20is%20equipped%20with%20a%20%5C%22reconfiguration%20device%5C%22.%20The%20device%20is%20just%20an%20ordinary%20long%20wooden%20stick%20that%20is%20used%20to%20tap%20the%20tiles.%20If%20you%20tap%20a%20tile%2C%20it%20flips%20over%20to%20the%20other%20side%2C%20i.e.%2C%20it%20changes%20from%20white%20to%20black%20or%20vice%20versa.%20Do%20you%20agree%20this%20idea%20is%20very%20clever%3F%5Cn%5CnUnfortunately%2C%20the%20billboard%20makers%20did%20not%20realize%20one%20thing.%20The%20tiles%20are%20very%20close%20to%20each%20other%20and%20their%20sides%20touch.%20Whenever%20a%20tile%20is%20tapped%2C%20it%20takes%20all%20neighboring%20tiles%20with%20it%20and%20all%20of%20them%20flip%20over%20together.%20Therefore%2C%20if%20you%20want%20to%20change%20the%20color%20of%20a%20tile%2C%20all%20neighboring%20tiles%20change%20their%20color%20too.%20Neighboring%20tiles%20are%20those%20that%20touch%20each%20other%20with%20the%20whole%20side.%20All%20inner%20tiles%20have%204%20neighbors%2C%20which%20means%205%20tiles%20are%20flipped%20over%20when%20tapped.%20Border%20tiles%20have%20less%20neighbors%2C%20of%20course.%5Cn%5Cn%21%5Bexample%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP2050%5C%2F5a38ca03f07410ff3b584a8028d874fd14cd66b6.png%29For%20example%2C%20if%20you%20have%20the%20billboard%20configuration%20shown%20in%20the%20left%20picture%20above%20and%20tap%20the%20tile%20marked%20with%20the%20cross%2C%20you%20will%20get%20the%20picture%20on%20the%20right.%20As%20you%20can%20see%2C%20the%20billboard%20reconfiguration%20is%20not%20so%20easy%20under%20these%20conditions.%20Your%20task%20is%20to%20find%20the%20fastest%20way%20to%20%5C%22clear%5C%22%20the%20billboard%2C%20i.e.%2C%20to%20flip%20all%20tiles%20to%20their%20white%20side.%22%2C%22inputFormat%22%3A%22The%20input%20consists%20of%20several%20billboard%20descriptions.%20Each%20description%20begins%20with%20a%20line%20containing%20two%20integer%20numbers%20R%20and%20C%20%281%20%3C%3D%20R%2CC%20%3C%3D%2016%29%20specifying%20the%20billboard%20size.%20Then%20there%20are%20R%20lines%2C%20each%20containing%20C%20characters.%20The%20characters%20can%20be%20either%20an%20uppercase%20letter%20%5C%22X%5C%22%20%28black%29%20or%20a%20dot%20%5C%22.%5C%22%20%28white%29.%20There%20is%20one%20empty%20line%20after%20each%20map.%20The%20input%20is%20terminated%20by%20two%20zeros%20in%20place%20of%20the%20board%20size.%22%2C%22outputFormat%22%3A%22For%20each%20billboard%2C%20print%20one%20line%20containing%20the%20sentence%20%5C%22You%20have%20to%20tap%20T%20tiles.%5C%22%2C%20where%20T%20is%20the%20minimal%20possible%20number%20of%20taps%20needed%20to%20make%20all%20squares%20white.%20If%20the%20situation%20cannot%20be%20solved%2C%20output%20the%20string%20%5C%22Damaged%20billboard.%5C%22instead.%22%2C%22samples%22%3A%5B%5B%225%205%5Cr%5CnXX.XX%5Cr%5CnX.X.X%5Cr%5Cn.XXX.%5Cr%5CnX.X.X%5Cr%5CnXX.XX%5Cr%5Cn%5Cr%5Cn5%205%5Cr%5Cn.XX.X%5Cr%5Cn.....%5Cr%5Cn..XXX%5Cr%5Cn..X.X%5Cr%5Cn..X..%5Cr%5Cn%5Cr%5Cn1%205%5Cr%5Cn...XX%5Cr%5Cn%5Cr%5Cn5%205%5Cr%5Cn...X.%5Cr%5Cn...XX%5Cr%5Cn.XX..%5Cr%5Cn..X..%5Cr%5Cn.....%5Cr%5Cn%5Cr%5Cn8%209%5Cr%5Cn..XXXXX..%5Cr%5Cn.X.....X.%5Cr%5CnX..X.X..X%5Cr%5CnX.......X%5Cr%5CnX.X...X.X%5Cr%5CnX..XXX..X%5Cr%5Cn.X.....X.%5Cr%5Cn..XXXXX..%5Cr%5Cn%5Cr%5Cn0%200%22%2C%22You%20have%20to%20tap%205%20tiles.%5Cr%5CnDamaged%20billboard.%5Cr%5CnYou%20have%20to%20tap%201%20tiles.%5Cr%5CnYou%20have%20to%20tap%202%20tiles.%5Cr%5CnYou%20have%20to%20tap%2025%20tiles.%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3601%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F2050%22%2C%22id%22%3A%222050%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP2050%22%2C%22title%22%3A%22CERC07B%20-%20Strange%20Billboard%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22CERC07B%20-%20Strange%20Billboard%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>CERC07B - Strange Billboard</h1>
<h2>题目描述</h2>
<div>The marketing and public-relations department of the Czech Technical University has designed a new reconfigurable mechanical Flip-Flop Bill-Board (FFBB). The billboard is a regular two- dimensional grid of R × C square tiles made of plastic. Each plastic tile is white on one side and black on the other. The idea of the billboard is that you can create various pictures by flipping individual tiles over. Such billboards will hang above all entrances to the university and will be used to display simple pictures and advertise upcoming academic events. To change pictures, each billboard is equipped with a "reconfiguration device". The device is just an ordinary long wooden stick that is used to tap the tiles. If you tap a tile, it flips over to the other side, i.e., it changes from white to black or vice versa. Do you agree this idea is very clever?
Unfortunately, the billboard makers did not realize one thing. The tiles are very close to each other and their sides touch. Whenever a tile is tapped, it takes all neighboring tiles with it and all of them flip over together. Therefore, if you want to change the color of a tile, all neighboring tiles change their color too. Neighboring tiles are those that touch each other with the whole side. All inner tiles have 4 neighbors, which means 5 tiles are flipped over when tapped. Border tiles have less neighbors, of course.
![example](https://cdn.luogu.com.cn/upload/vjudge_pic/SP2050/5a38ca03f07410ff3b584a8028d874fd14cd66b6.png)For example, if you have the billboard configuration shown in the left picture above and tap the tile marked with the cross, you will get the picture on the right. As you can see, the billboard reconfiguration is not so easy under these conditions. Your task is to find the fastest way to "clear" the billboard, i.e., to flip all tiles to their white side.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The input consists of several billboard descriptions. Each description begins with a line containing two integer numbers R and C (1 <= R,C <= 16) specifying the billboard size. Then there are R lines, each containing C characters. The characters can be either an uppercase letter "X" (black) or a dot "." (white). There is one empty line after each map. The input is terminated by two zeros in place of the board size.</div>
<h3>输出格式</h3>
<br />
<div>For each billboard, print one line containing the sentence "You have to tap T tiles.", where T is the minimal possible number of taps needed to make all squares white. If the situation cannot be solved, output the string "Damaged billboard."instead.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 5
XX.XX
X.X.X
.XXX.
X.X.X
XX.XX

5 5
.XX.X
.....
..XXX
..X.X
..X..

1 5
...XX

5 5
...X.
...XX
.XX..
..X..
.....

8 9
..XXXXX..
.X.....X.
X..X.X..X
X.......X
X.X...X.X
X..XXX..X
.X.....X.
..XXXXX..

0 0</code></pre>
<h3>输出样例 #1</h3>
<pre><code>You have to tap 5 tiles.
Damaged billboard.
You have to tap 1 tiles.
You have to tap 2 tiles.
You have to tap 25 tiles.</code></pre>
</article>
</div>
</div>
</body>
</html>
