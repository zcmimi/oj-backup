<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>MIB - Spelling Lists - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449878:aj02ORnryzSrvYEElGrvhGxoWdszbp97sZeiRuEdwPc=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22J%2C%20of%20the%20Men%20In%20Black%2C%20has%20been%20learning%20an%20alien%20language%20and%20has%20has%20a%20spelling%20test%20tomorrow.%20J%2C%20however%2C%20is%20bored%20of%20studying%20the%20nonsensical%20%28and%20often%20unpronouncable%29%20words.%5Cn%5CnInstead%2C%20he%20is%20seeing%20how%20many%20ways%20he%20can%20reorder%20his%20spelling%20list.%20After%20making%20all%20possible%20permutations%20of%20word%20on%20his%20list%2C%20he%20sorts%20the%20rearranged%20lists%20lexiographically%20%28by%20the%20first%20word%2C%20then%20the%20second...%29.%20After%20the%20sort%2C%20in%20what%20position%2C%20with%20the%20lexiographically%20first%20list%20being%20in%20position%201%2C%20is%20his%20original%20spelling%20list%3F%22%2C%22inputFormat%22%3A%22The%20first%20line%20is%20the%20number%20of%20spelling%20lists%20%28no%20more%20than%2010%29.%5Cn%5CnFor%20each%20spelling%20list%2C%20a%20line%20with%20the%20number%20of%20words%20%28no%20more%20than%201000%29%20is%20given%2C%20followed%20by%20the%20original%20list%20on%20the%20next%20line.%5Cn%5CnAll%20words%20within%20a%20spelling%20list%20are%20unique.%20Each%20word%20is%20composed%20of%20the%20letters%20a-z%2C%20is%20fewer%20than%20100%20characters%2C%20and%20is%20followed%20by%20a%20single%20space.%22%2C%22outputFormat%22%3A%22On%20separate%20lines%2C%20give%20the%20positions%20of%20the%20original%20lists.%22%2C%22samples%22%3A%5B%5B%22%5C%5Cn4%5C%5Cn4%5C%5Cna%20b%20c%20d%20%5C%5Cn4%5C%5Cnd%20c%20b%20a%20%5C%5Cn1%5C%5Cnmrsmith%20%5C%5Cn6%5C%5Cna%20aaaaaa%20aaaaa%20aaaa%20b%20bb%20%5C%5Cn%5C%5Cn%22%2C%22%5C%5Cn1%5C%5Cn24%5C%5Cn1%5C%5Cn55%5C%5Cn%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B310%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F4429%22%2C%22id%22%3A%224429%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP4429%22%2C%22title%22%3A%22MIB%20-%20Spelling%20Lists%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22MIB%20-%20Spelling%20Lists%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>MIB - Spelling Lists</h1>
<h2>题目描述</h2>
<div>J, of the Men In Black, has been learning an alien language and has has a spelling test tomorrow. J, however, is bored of studying the nonsensical (and often unpronouncable) words.
Instead, he is seeing how many ways he can reorder his spelling list. After making all possible permutations of word on his list, he sorts the rearranged lists lexiographically (by the first word, then the second...). After the sort, in what position, with the lexiographically first list being in position 1, is his original spelling list?</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line is the number of spelling lists (no more than 10).
For each spelling list, a line with the number of words (no more than 1000) is given, followed by the original list on the next line.
All words within a spelling list are unique. Each word is composed of the letters a-z, is fewer than 100 characters, and is followed by a single space.</div>
<h3>输出格式</h3>
<br />
<div>On separate lines, give the positions of the original lists.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>\n4\n4\na b c d \n4\nd c b a \n1\nmrsmith \n6\na aaaaaa aaaaa aaaa b bb \n\n</code></pre>
<h3>输出样例 #1</h3>
<pre><code>\n1\n24\n1\n55\n</code></pre>
</article>
</div>
</div>
</body>
</html>
