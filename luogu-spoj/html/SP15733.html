<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>ULM2H - Hall of Fountains - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450440:zEOSKH9AKO/Lbr6oXwJ2x7ziZa2AfFN5aR/iYuHo4h0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20Museum%20of%20Modern%20Art%20has%20a%20really%20exciting%20exhibition%3A%20a%20kind%20of%20a%20longish%20hall%20composed%20of%20a%20sequence%20of%20quadratic-shaped%20rooms.%20Each%20room%20is%20equipped%20with%20a%20water%20fountain.%20Each%20fountain%20is%20characterized%20by%20a%20number%20_p_%20and%20acts%20independent%20of%20the%20others.%20It%20will%20be%20turned%20on%20for%20exactly%20_p_%20seconds%2C%20then%20it%20will%20be%20turned%20off%20for%20exactly%20_p_%20seconds%2C%20then%20on%20again%2C%20then%20off%20again%2C%20and%20so%20on%20for%20good.%20However%2C%20different%20fountains%20may%20have%20different%20values%20of%20_p_.%20And%20even%20if%20they%20share%20the%20same%20value%2C%20they%20still%20may%20perform%20not%20identically%2C%20for%20they%20might%20have%20been%20started%20at%20different%20times.%5Cn%5CnYou%20stand%20in%20front%20of%20the%20first%20room%2C%20and%20want%20to%20cross%20the%20hall%20to%20the%20other%20end.%20Each%20of%20your%20steps%20takes%20exactly%201%20second.%20You%20are%20able%20to%20move%20one%20room%20forward%20%28unless%20you%20already%20reached%20the%20other%20end%29%2C%20one%20room%20backward%20%28unless%20you%20are%20at%20the%20beginning%29%2C%20or%20just%20stay%20at%20your%20current%20position.%20Calculate%20the%20shortest%20time%20to%20reach%20the%20other%20end%2C%20if%20it%20is%20possible%20at%20all.%5Cn%5CnSince%20you%20do%20not%20want%20to%20get%20wet%2C%20you%20can%20only%20move%20into%20a%20room%20where%20the%20water%20fountain%20will%20be%20off%20during%20the%20second%20after%20your%20step.%20For%20example%2C%20suppose%20that%20the%20fountain%20in%20the%20next%20room%20behaves%20so%2C%20that%20it%20is%20on%20at%20times%200%2C%201%2C%202%2C%20then%20off%20at%20times%203%2C%204%2C%205%2C%206%2C%20then%20on%20at%20times%207%2C%208%2C%209%2C%2010%2C%20then%20off%20again%20%28which%20indicates%20_p%3D4_%20with%20an%20offset%20of%207%29.%20Then%2C%20you%20can%20move%20at%20time%202%20into%20the%20room%2C%20arriving%20there%20at%20time%203%2C%20when%20the%20fountain%20is%20off.%20But%20you%20cannot%20move%20at%20time%206%20into%20the%20room%2C%20because%20at%20time%207%20it%20will%20be%20on.%5Cn%5Cn%2A%2AInput%20Specification%2A%2A%5Cn%5CnThe%20input%20contains%20several%20test%20cases.%20Each%20test%20case%20starts%20with%20the%20number%20of%20fountains%20_n_.%20Input%20is%20terminated%20by%20_n%3D0_.%20Otherwise%2C%20_1.%20Then%20follow%20_n_%20numbers%20_p%20%24%20_%7Bi%7D%20%24_%20%20denoting%20the%20time%20each%20fountain%20is%20on%20and%20off%2C%20where%20_0.%20A%20value%20of%200%20for%20_p%20%24%20_%7Bi%7D%20%24_%20%20indicates%20that%20fountain%20_i_%20is%20out%20of%20order%20%28i.e.%20constantly%20off%29.%20Then%20follow%20_n_%20numbers%20_q%20%24%20_%7Bi%7D%20%24_%20%20denoting%20the%20offset%20of%20each%20fountain%2C%20where%20_0%2C%20unless%20the%20fountain%20is%20out%20of%20order%2C%20in%20which%20case%20_q%20%24%20_%7Bi%7D%20%24_%20%20is%20meaningless.%20Otherwise%20it%20means%20that%20fountain%20_i_%20will%20be%20on%20at%20time%20_q%20%24%20_%7Bi%7D%20%24_%20%2C%20but%20off%20just%20one%20second%20before.___%5Cn%5Cn%2A%2AOutput%20Specification%2A%2A%5Cn%5CnFor%20each%20test%20case%20output%20on%20a%20line%20a%20single%20number%20_t_%20denoting%20the%20shortest%20time%20needed%20to%20reach%20the%20end%20of%20the%20hall%20%28i.e.%20to%20enter%20the%20place%20after%20the%20last%20room%29.%20Assume%2C%20that%20you%20are%20in%20front%20of%20the%20first%20room%20at%20time%200%20%28i.e.%20you%20can%20enter%20the%20first%20room%20at%20time%20_1_%2C%20if%20the%20fountain%20is%20off%20at%20time%20_1_%29.%20If%20it%20is%20impossible%20to%20go%20through%20the%20hall%20of%20fountains%2C%20print%200%20instead.%5Cn%5Cn%20%2A%2ASample%20Input%2A%2A%5Cn%5Cn%20%60%60%60%5Cn3%5Cn0%200%200%5Cn0%200%200%5Cn4%5Cn6%203%203%204%5Cn2%203%200%204%5Cn2%5Cn1%201%5Cn0%200%5Cn0%5Cn%60%60%60%5Cn%20%20%2A%2ASample%20Output%2A%2A%5Cn%5Cn%20%60%60%60%5Cn4%5Cn11%5Cn0%5Cn%60%60%60%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B158%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F15733%22%2C%22id%22%3A%2215733%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP15733%22%2C%22title%22%3A%22ULM2H%20-%20Hall%20of%20Fountains%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22ULM2H%20-%20Hall%20of%20Fountains%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>ULM2H - Hall of Fountains</h1>
<h2>题目描述</h2>
<div>The Museum of Modern Art has a really exciting exhibition: a kind of a longish hall composed of a sequence of quadratic-shaped rooms. Each room is equipped with a water fountain. Each fountain is characterized by a number _p_ and acts independent of the others. It will be turned on for exactly _p_ seconds, then it will be turned off for exactly _p_ seconds, then on again, then off again, and so on for good. However, different fountains may have different values of _p_. And even if they share the same value, they still may perform not identically, for they might have been started at different times.
You stand in front of the first room, and want to cross the hall to the other end. Each of your steps takes exactly 1 second. You are able to move one room forward (unless you already reached the other end), one room backward (unless you are at the beginning), or just stay at your current position. Calculate the shortest time to reach the other end, if it is possible at all.
Since you do not want to get wet, you can only move into a room where the water fountain will be off during the second after your step. For example, suppose that the fountain in the next room behaves so, that it is on at times 0, 1, 2, then off at times 3, 4, 5, 6, then on at times 7, 8, 9, 10, then off again (which indicates _p=4_ with an offset of 7). Then, you can move at time 2 into the room, arriving there at time 3, when the fountain is off. But you cannot move at time 6 into the room, because at time 7 it will be on.
**Input Specification**
The input contains several test cases. Each test case starts with the number of fountains _n_. Input is terminated by _n=0_. Otherwise, _1. Then follow _n_ numbers _p $ _{i} $_ denoting the time each fountain is on and off, where _0. A value of 0 for _p $ _{i} $_ indicates that fountain _i_ is out of order (i.e. constantly off). Then follow _n_ numbers _q $ _{i} $_ denoting the offset of each fountain, where _0, unless the fountain is out of order, in which case _q $ _{i} $_ is meaningless. Otherwise it means that fountain _i_ will be on at time _q $ _{i} $_ , but off just one second before.___
**Output Specification**
For each test case output on a line a single number _t_ denoting the shortest time needed to reach the end of the hall (i.e. to enter the place after the last room). Assume, that you are in front of the first room at time 0 (i.e. you can enter the first room at time _1_, if the fountain is off at time _1_). If it is impossible to go through the hall of fountains, print 0 instead.
**Sample Input**
```
3
0 0 0
0 0 0
4
6 3 3 4
2 3 0 4
2
1 1
0 0
0
```
**Sample Output**
```
4
11
0
```</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
