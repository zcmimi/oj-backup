<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>FN16ASGN - Branch Assignment - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450657:iFzOVqzNJ0iZy6pWeA1eLxJCoDqAyGvBp3G3f0VhtY0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22The%20Innovative%20Consumer%20Products%20Company%20%28ICPC%29%20is%20planning%20to%20start%20a%20top-secret%20project.%20This%20project%20consists%20of%20%24%20s%20%24%20subprojects.%20There%20will%20be%20%24%20b%20%5C%5Cge%20s%20%24%20branches%20of%20ICPC%20involved%20in%20this%20project%20and%20ICPC%20wants%20to%20assign%20each%20branch%20to%20one%20of%20the%20subprojects.%20In%20other%20words%2C%20the%20branches%20will%20form%20%24%20s%20%24%20disjoint%20groups%2C%20with%20each%20group%20in%20charge%20of%20a%20subproject.%5Cn%5CnAt%20the%20end%20of%20each%20month%2C%20each%20branch%20will%20send%20a%20message%20to%20every%20other%20branch%20in%20its%20group%20%28a%20different%20message%20to%20each%20branch%29.%20ICPC%20has%20a%20particular%20protocol%20for%20its%20communications.%20Each%20branch%20%24%20i%20%24%20has%20a%20secret%20key%20%24%20k_%20i%20%24%20known%20only%20to%20the%20branch%20and%20the%20ICPC%20headquarters.%20Assume%20branch%20%24%20i%20%24%20wants%20to%20send%20a%20message%20to%20branch%20%24%20j%20%24%20.%20Branch%20%24%20i%20%24%20encrypts%20its%20message%20with%20its%20key%20%24%20k_%20%20%20%20%20i%20%24%20.%20A%20trusted%20courier%20picks%20up%20this%20message%20from%20this%20branch%20and%20delivers%20it%20to%20the%20ICPC%20headquarters.%20Headquarters%20decrypts%20the%20message%20with%20key%20%24%20k_%20%20%20%20%20i%20%24%20and%20re-encrypts%20it%20with%20key%20%24%20k_%20j%20%24%20.%20The%20courier%20then%20delivers%20this%20newly%20encrypted%20message%20to%20branch%20%24%20j%20%24%20%2C%20which%20decrypts%20it%20with%20its%20own%20key%20%24%20k_%20j%20%24%20.%20For%20security%20reasons%2C%20a%20courier%20can%20carry%20only%20one%20message%20at%20a%20time.%5Cn%5CnGiven%20a%20road%20network%20and%20the%20locations%20of%20branches%20and%20the%20headquarters%20in%20this%20network%2C%20your%20task%20is%20to%20determine%20the%20minimum%20total%20distance%20that%20the%20couriers%20will%20need%20to%20travel%20to%20deliver%20all%20the%20end-of-month%20messages%2C%20over%20all%20possible%20assignments%20of%20branches%20to%20subprojects.%22%2C%22inputFormat%22%3A%22Multiple%20test%20cases.%20Please%20process%20until%20EOF%20is%20reached.%20For%20each%20test%20case%3A%5Cn%5CnThe%20first%20line%20of%20input%20contains%20four%20integers%20%24%20n%20%24%20%2C%20%24%20b%20%24%20%2C%20%24%20s%20%24%20%2C%20and%20%24%20r%20%24%20%2C%20where%20%24%20n%20%24%20%28%20%24%202%20%20%20%20%20%5C%5Cle%20n%20%5C%5Cle%205%5C%5C%2C%20000%20%24%20%29%20is%20the%20number%20of%20intersections%2C%20%24%20b%20%24%20%28%20%24%201%20%5C%5Cle%20b%20%5C%5Cle%20n-1%20%24%20%29%20is%20the%20number%20of%20branches%2C%20%24%20s%20%24%20%28%20%24%201%20%5C%5Cle%20s%20%5C%5Cle%20b%20%24%20%29%20is%20the%20number%20of%20subprojects%2C%20and%20%24%20r%20%24%20%28%20%24%201%20%20%20%20%20%5C%5Cle%20r%20%5C%5Cle%2050%5C%5C%2C%20000%20%24%20%29%20is%20the%20number%20of%20roads.%20The%20intersections%20are%20numbered%20from%20%24%201%20%24%20through%20%24%20n%20%24%20.%20The%20branches%20are%20at%20intersections%20%24%201%20%24%20through%20%24%20b%20%24%20%2C%20and%20the%20headquarters%20is%20at%20intersection%20%24%20b%20%2B%201%20%24%20.%20Each%20of%20the%20next%20%24%20r%20%24%20lines%20contains%20three%20integers%20%24%20u%20%24%20%2C%20%24%20v%20%24%20%2C%20and%20%24%20%5C%5Cell%20%24%20%2C%20indicating%20a%20one-way%20road%20from%20intersection%20%24%20u%20%24%20to%20a%20different%20intersection%20%24%20v%20%24%20%28%20%24%201%20%5C%5Cleq%20u%2Cv%20%5C%5Cleq%20n%20%24%20%29%20of%20length%20%24%20%5C%5Cell%20%24%20%28%20%24%200%20%5C%5Cleq%20%5C%5Cell%20%5C%5Cleq%2010%5C%5C%2C%20%20%20%20%20000%20%24%20%29.%20No%20ordered%20pair%20%24%20%28u%2Cv%29%20%24%20appears%20more%20than%20once%2C%20and%20from%20any%20intersection%20it%20is%20possible%20to%20reach%20every%20other%20intersection.%22%2C%22outputFormat%22%3A%22For%20each%20test%20case%2C%20display%20the%20minimum%20total%20distance%20that%20the%20couriers%20will%20need%20to%20travel.%22%2C%22samples%22%3A%5B%5B%225%204%202%2010%5Cr%5Cn5%202%201%5Cr%5Cn2%205%201%5Cr%5Cn3%205%205%5Cr%5Cn4%205%200%5Cr%5Cn1%205%201%5Cr%5Cn2%203%201%5Cr%5Cn3%202%205%5Cr%5Cn2%204%205%5Cr%5Cn2%201%201%5Cr%5Cn3%204%202%5Cr%5Cn5%204%202%2010%5Cr%5Cn5%202%201%5Cr%5Cn2%205%201%5Cr%5Cn3%205%205%5Cr%5Cn4%205%2010%5Cr%5Cn1%205%201%5Cr%5Cn2%203%201%5Cr%5Cn3%202%205%5Cr%5Cn2%204%205%5Cr%5Cn2%201%201%5Cr%5Cn3%204%202%22%2C%2213%5Cr%5Cn24%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B60000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F27093%22%2C%22id%22%3A%2227093%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A8%2C%22totalAccepted%22%3A2%2C%22pid%22%3A%22SP27093%22%2C%22title%22%3A%22FN16ASGN%20-%20Branch%20Assignment%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22FN16ASGN%20-%20Branch%20Assignment%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>FN16ASGN - Branch Assignment</h1>
<h2>题目描述</h2>
<div>The Innovative Consumer Products Company (ICPC) is planning to start a top-secret project. This project consists of $ s $ subprojects. There will be $ b \ge s $ branches of ICPC involved in this project and ICPC wants to assign each branch to one of the subprojects. In other words, the branches will form $ s $ disjoint groups, with each group in charge of a subproject.
At the end of each month, each branch will send a message to every other branch in its group (a different message to each branch). ICPC has a particular protocol for its communications. Each branch $ i $ has a secret key $ k_ i $ known only to the branch and the ICPC headquarters. Assume branch $ i $ wants to send a message to branch $ j $ . Branch $ i $ encrypts its message with its key $ k_ i $ . A trusted courier picks up this message from this branch and delivers it to the ICPC headquarters. Headquarters decrypts the message with key $ k_ i $ and re-encrypts it with key $ k_ j $ . The courier then delivers this newly encrypted message to branch $ j $ , which decrypts it with its own key $ k_ j $ . For security reasons, a courier can carry only one message at a time.
Given a road network and the locations of branches and the headquarters in this network, your task is to determine the minimum total distance that the couriers will need to travel to deliver all the end-of-month messages, over all possible assignments of branches to subprojects.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>Multiple test cases. Please process until EOF is reached. For each test case:
The first line of input contains four integers $ n $ , $ b $ , $ s $ , and $ r $ , where $ n $ ( $ 2 \le n \le 5\, 000 $ ) is the number of intersections, $ b $ ( $ 1 \le b \le n-1 $ ) is the number of branches, $ s $ ( $ 1 \le s \le b $ ) is the number of subprojects, and $ r $ ( $ 1 \le r \le 50\, 000 $ ) is the number of roads. The intersections are numbered from $ 1 $ through $ n $ . The branches are at intersections $ 1 $ through $ b $ , and the headquarters is at intersection $ b + 1 $ . Each of the next $ r $ lines contains three integers $ u $ , $ v $ , and $ \ell $ , indicating a one-way road from intersection $ u $ to a different intersection $ v $ ( $ 1 \leq u,v \leq n $ ) of length $ \ell $ ( $ 0 \leq \ell \leq 10\, 000 $ ). No ordered pair $ (u,v) $ appears more than once, and from any intersection it is possible to reach every other intersection.</div>
<h3>输出格式</h3>
<br />
<div>For each test case, display the minimum total distance that the couriers will need to travel.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>5 4 2 10
5 2 1
2 5 1
3 5 5
4 5 0
1 5 1
2 3 1
3 2 5
2 4 5
2 1 1
3 4 2
5 4 2 10
5 2 1
2 5 1
3 5 5
4 5 10
1 5 1
2 3 1
3 2 5
2 4 5
2 1 1
3 4 2</code></pre>
<h3>输出样例 #1</h3>
<pre><code>13
24</code></pre>
</article>
</div>
</div>
</body>
</html>
