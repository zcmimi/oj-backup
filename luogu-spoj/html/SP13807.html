<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>RDRUG - Rage Drug - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450365:4js+ybD11DsX+32AOvFI4IssMnj/DM+aCHhsfEBSQlA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Dr.%20Banner%20%28a.k.a.%20The%20Hulk%29%20is%20synthesizing%20a%20drug%20that%20will%20help%20him%20control%20his%20rage.%20There%20are%20a%20total%20of%20N%20atoms%20of%20various%20atomic%20masses.%20%20%20%5Cn%20Banner%20knows%20that%20to%20create%20a%20bond%20between%20two%20atoms%20the%20energy%20required%20is%20equal%20to%20the%20sum%20of%20the%20atomic%20masses%20of%20the%20two%20atoms.%20%20%20%5Cn%20Currently%20some%20of%20the%20atoms%20are%20connected%20to%20one%20another%20forming%20compounds.%20%20%20%5Cn%20Banner%20wants%20to%20join%20all%20separate%20atoms%20and%20compounds%20into%20a%20single%20compound%20by%20creating%20chemical%20bonds.%20Each%20atom%20can%20form%20at%20max%20one%20more%20bond.%20Help%20Dr.%20Banner%20to%20find%20out%20the%20minimum%20energy%20required%20to%20synthesize%20his%20drug.%5Cn%5Cn%20%20%20%5Cn%23%23%23%23%20INPUT%5Cn%5CnInput%20starts%20with%20an%20integer%20T%2C%20the%20number%20of%20test%20cases.%20Each%20test%20case%20starts%20with%20a%20line%20containing%20integers%20N%2C%20M%20denoting%20the%20number%20of%20atoms%20and%20the%20number%20of%20bonds%20already%20formed%20respectively.%20M%20lines%20contain%202%20integers%20i%20and%20j%20denoting%20a%20chemical%20bond%20between%20the%20ith%20and%20the%20jth%20atom.%20The%20next%20N%20lines%20contains%20one%20integer%20each%20where%20the%20integer%20on%20ith%20line%20denotes%20the%20atomic%20mass%20of%20the%20ith%20atom.%5Cn%5Cn%20%20%20%5Cn%23%23%23%23%20OUTPUT%5Cn%5CnPrint%20T%20lines%2C%20where%20the%20ith%20line%20is%20the%20answer%20to%20the%20ith%20test%20case.%20If%20it%20is%20not%20possible%20to%20link%20the%20atoms%20print%20-1%3B%20%20%20%5Cn%20PS%3A%20If%20you%20mislead%20Dr.%20Banner%2C%20he%20might%20lose%20his%20temper%20and%20SMASH%20you%20to%20bits.%5Cn%5Cn%20%20%20%5Cn%23%23%23%23%20CONSTRAINTS%5Cn%5Cn1%20%3C%3D%20T%20%3C%3D%2012%20%20%20%5Cn%201%20%3C%3D%20N%20%3C%3D%20100000%20%20%20%5Cn%201%20%3C%3D%20AtomicMass%20%3C%3D%2010000%20%20%20%5Cn%201%20%3C%3D%20M%20%3C%3D%2010%5E6%20%281000000%29%20%20%20%5Cn%201%20%3C%3D%20i%2C%20j%20%3C%3D%20N%5Cn%5Cn%20%20%20%5Cn%23%23%23%23%20Sample%20Input%3A%5Cn%5Cn%20%60%60%60%5Cn2%5Cn6%206%5Cn1%202%5Cn2%203%5Cn1%203%5Cn4%205%5Cn5%206%5Cn4%206%5Cn1%5Cn3%5Cn5%5Cn2%5Cn4%5Cn6%5Cn4%200%5Cn1%5Cn2%5Cn3%20%20%20%5Cn4%5Cn%5Cn%5Cn%60%60%60%5Cn%20%20%20%5Cn%23%23%23%23%20Sample%20Output%3A%5Cn%5Cn3%20%20%20%5Cn%20-1%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F13807%22%2C%22id%22%3A%2213807%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP13807%22%2C%22title%22%3A%22RDRUG%20-%20Rage%20Drug%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22RDRUG%20-%20Rage%20Drug%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>RDRUG - Rage Drug</h1>
<h2>题目描述</h2>
<div>Dr. Banner (a.k.a. The Hulk) is synthesizing a drug that will help him control his rage. There are a total of N atoms of various atomic masses.
Banner knows that to create a bond between two atoms the energy required is equal to the sum of the atomic masses of the two atoms.
Currently some of the atoms are connected to one another forming compounds.
Banner wants to join all separate atoms and compounds into a single compound by creating chemical bonds. Each atom can form at max one more bond. Help Dr. Banner to find out the minimum energy required to synthesize his drug.
#### INPUT
Input starts with an integer T, the number of test cases. Each test case starts with a line containing integers N, M denoting the number of atoms and the number of bonds already formed respectively. M lines contain 2 integers i and j denoting a chemical bond between the ith and the jth atom. The next N lines contains one integer each where the integer on ith line denotes the atomic mass of the ith atom.
#### OUTPUT
Print T lines, where the ith line is the answer to the ith test case. If it is not possible to link the atoms print -1;
PS: If you mislead Dr. Banner, he might lose his temper and SMASH you to bits.
#### CONSTRAINTS
1 <= T <= 12
1 <= N <= 100000
1 <= AtomicMass <= 10000
1 <= M <= 10^6 (1000000)
1 <= i, j <= N
#### Sample Input:
```
2
6 6
1 2
2 3
1 3
4 5
5 6
4 6
1
3
5
2
4
6
4 0
1
2
3
4
```
#### Sample Output:
3
-1</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
