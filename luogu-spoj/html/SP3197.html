<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>TREECST - Tree Construction - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449783:H0Td2SSU3R9G4vkXLCpZ4jWdCJXdl2OpDu+XHBM8CPA=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3A%22%22%2C%22description%22%3A%22%5BEnglish%5D%28%5C%2Fproblems%5C%2F%5Cn%5CnTREECST%5C%2Fen%5C%2F%29%20%5BVietnamese%5D%28%5C%2Fproblems%5C%2F%5Cn%5CnTREECST%5C%2Fvn%5C%2F%29Moles%20are%20tidy%20and%20hard-working%20animals.%20Our%20mole%20likes%20to%20keep%20its%20underground%20residence%20in%20utmost%20order%2C%20so%20that%20everyone%20living%20there%20knows%20where%20to%20find%20things.%5Cn%5CnTo%20achieve%20this%2C%20the%20mole%20connected%20rooms%20with%20tunnels%20so%20that%20there%20is%20a%20single%20unique%20way%20to%20get%20from%20one%20room%20to%20any%20other%20room.%20The%20distance%20between%20two%20rooms%20is%20the%20number%20of%20halls%20passed%20on%20the%20way%20from%20one%20to%20the%20other.%5Cn%5CnDespite%20all%20the%20effort%2C%20some%20of%20the%20mole%27s%20guests%20are%20complaining%20that%20it%20takes%20too%20long%20to%20walk%20between%20certain%20pairs%20of%20rooms.%5Cn%5CnThe%20mole%20decided%20to%20reconstruct%20her%20residence%2C%20closing%20one%20tunnel%20and%20opening%20a%20new%20one%2C%20so%20that%20the%20distance%20between%20the%20farthest%20two%20rooms%20is%20the%20smallest%20possible%2C%20but%20so%20that%20it%20is%20still%20possible%20to%20reach%20every%20room%20from%20every%20other%20room.%5Cn%5CnWrite%20a%20program%20which%20determines%20the%20distance%20between%20the%20farthest%20two%20rooms%20after%20reconstruction%2C%20which%20tunnel%20to%20close%20and%20which%20to%20open.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20an%20integer%20N%20%281%20%5Cu2264%20N%20%5Cu2264%20300%20000%29%2C%20the%20number%20of%20rooms.%20The%20rooms%20are%20numbered%201%20to%20N.%5Cn%5CnEach%20of%20the%20next%20N%5Cu22121%20lines%20contains%20two%20integers%2C%20the%20numbers%20of%20rooms%20a%20tunnel%20connects.%22%2C%22outputFormat%22%3A%22Output%20on%20separate%20lines%2C%20in%20order%3A%5Cn%5Cn-%20The%20distance%20between%20the%20two%20farthest%20rooms%20after%20reconstruction.%5Cn-%20A%20pair%20of%20integers%20representing%20a%20previously%20existing%20tunnel%2C%20which%20should%20be%20closed.%5Cn-%20A%20pair%20of%20integers%2C%20the%20rooms%20between%20which%20a%20new%20tunnel%20should%20be%20opened.%5Cn%5CnNote%3A%20The%20solution%20will%20not%20necessarily%20be%20unique.%20Output%20any%20reconstruction%20plan%20which%20achieves%20the%20smallest%20distance%20between%20the%20farthest%20two%20rooms.%22%2C%22samples%22%3A%5B%5B%224%5Cn1%202%5Cn2%203%5Cn3%204%22%2C%222%5Cn3%204%5Cn4%202%5Cn%22%5D%2C%5B%227%5Cn1%203%5Cn2%203%5Cn2%207%5Cn4%203%5Cn7%205%5Cn3%206%22%2C%223%5Cn2%203%5Cn7%203%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B3000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F3197%22%2C%22id%22%3A%223197%22%7D%2C%22translation%22%3A%22%23%23%23%20%5Cu9898%5Cu76ee%5Cu5927%5Cu610f%5Cr%5Cn%5Cr%5Cn%5Cu7ed9%5Cu5b9a%5Cu4e00%5Cu68f5%5Cu6811%5Cuff0c%5Cu73b0%5Cu5728%5Cu8981%5Cu53bb%5Cu6389%5Cu4e00%5Cu6761%5Cu8fb9%5Cu518d%5Cu52a0%5Cu4e0a%5Cu4e00%5Cu6761%5Cu8fb9%5Cuff0c%5Cu8981%5Cu6c42%5Cu5f62%5Cu6210%5Cu7684%5Cu4ecd%5Cu662f%5Cu4e00%5Cu68f5%5Cu6811%5Cuff0c%5Cu6c42%5Cu65b0%5Cu751f%5Cu6210%5Cu7684%5Cu6811%5Cu4e0a%5Cu6700%5Cu8fdc%5Cu7684%5Cu4e00%5Cu5bf9%5Cu70b9%5Cu7684%5Cu8ddd%5Cu79bb%5Cr%5Cn%5Cr%5Cn%23%23%23%20%5Cu8f93%5Cu5165%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%24n%24%5Cuff0c%5Cu8868%5Cu793a%5Cu6709%24n%24%5Cu4e2a%5Cu70b9%5Cr%5Cn%5Cr%5Cn%5Cu4ee5%5Cu4e0b%24n-1%24%5Cu884c%5Cuff0c%5Cu6bcf%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu4e00%5Cu6761%5Cu8fb9%5Cr%5Cn%5Cr%5Cn%23%23%23%20%5Cu8f93%5Cu51fa%5Cu683c%5Cu5f0f%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e00%5Cu884c%5Cu4e00%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu65b0%5Cu751f%5Cu6210%5Cu7684%5Cu6811%5Cu4e0a%5Cu6700%5Cu8fdc%5Cu7684%5Cu4e00%5Cu5bf9%5Cu70b9%5Cu7684%5Cu8ddd%5Cu79bb%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e8c%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu53bb%5Cu6389%5Cu7684%5Cu8fb9%5Cu7684%5Cu4e24%5Cu4e2a%5Cu7aef%5Cu70b9%5Cr%5Cn%5Cr%5Cn%5Cu7b2c%5Cu4e09%5Cu884c%5Cu4e24%5Cu4e2a%5Cu6574%5Cu6570%5Cuff0c%5Cu8868%5Cu793a%5Cu52a0%5Cu4e0a%5Cu7684%5Cu8fb9%5Cu7684%5Cu4e24%5Cu4e2a%5Cu7aef%5Cu70b9%22%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Afalse%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP3197%22%2C%22title%22%3A%22TREECST%20-%20Tree%20Construction%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%7B%22id%22%3A72678%2C%22title%22%3A%22%5Cu6837%5Cu4f8b%5Cu683c%5Cu5f0f%5Cu51fa%5Cu9519%5Cu4e86%22%2C%22forum%22%3A%7B%22id%22%3A13815%2C%22name%22%3A%22SP3197%20TREECST%20-%20Tree%20Construction%22%2C%22slug%22%3A%22SP3197%22%7D%7D%2C%7B%22id%22%3A68740%2C%22title%22%3A%22%5Cu9898%5Cu610f%5Cu7b80%5Cu8ff0%22%2C%22forum%22%3A%7B%22id%22%3A13815%2C%22name%22%3A%22SP3197%20TREECST%20-%20Tree%20Construction%22%2C%22slug%22%3A%22SP3197%22%7D%7D%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22TREECST%20-%20Tree%20Construction%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>TREECST - Tree Construction</h1>
<h2>题意翻译</h2>
<div>### 题目大意
给定一棵树，现在要去掉一条边再加上一条边，要求形成的仍是一棵树，求新生成的树上最远的一对点的距离
### 输入格式
第一行一个整数$n$，表示有$n$个点
以下$n-1$行，每行两个整数，表示一条边
### 输出格式
第一行一个整数，表示新生成的树上最远的一对点的距离
第二行两个整数，表示去掉的边的两个端点
第三行两个整数，表示加上的边的两个端点</div>
<h2>题目描述</h2>
<div>[English](/problems/
TREECST/en/) [Vietnamese](/problems/
TREECST/vn/)Moles are tidy and hard-working animals. Our mole likes to keep its underground residence in utmost order, so that everyone living there knows where to find things.
To achieve this, the mole connected rooms with tunnels so that there is a single unique way to get from one room to any other room. The distance between two rooms is the number of halls passed on the way from one to the other.
Despite all the effort, some of the mole's guests are complaining that it takes too long to walk between certain pairs of rooms.
The mole decided to reconstruct her residence, closing one tunnel and opening a new one, so that the distance between the farthest two rooms is the smallest possible, but so that it is still possible to reach every room from every other room.
Write a program which determines the distance between the farthest two rooms after reconstruction, which tunnel to close and which to open.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains an integer N (1 ≤ N ≤ 300 000), the number of rooms. The rooms are numbered 1 to N.
Each of the next N−1 lines contains two integers, the numbers of rooms a tunnel connects.</div>
<h3>输出格式</h3>
<br />
<div>Output on separate lines, in order:
- The distance between the two farthest rooms after reconstruction.
- A pair of integers representing a previously existing tunnel, which should be closed.
- A pair of integers, the rooms between which a new tunnel should be opened.
Note: The solution will not necessarily be unique. Output any reconstruction plan which achieves the smallest distance between the farthest two rooms.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4
1 2
2 3
3 4</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2
3 4
4 2
</code></pre>
<h3>输入样例 #2</h3>
<pre><code>7
1 3
2 3
2 7
4 3
7 5
3 6</code></pre>
<h3>输出样例 #2</h3>
<pre><code>3
2 3
7 3</code></pre>
</article>
</div>
</div>
</body>
</html>
