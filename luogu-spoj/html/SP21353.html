<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>CLZDOUGH - Avantgarde and Doughnut - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450567:F+inECXW+GWDVglYClD2jB7Xmy6YZEfnhneRWPVhBow=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Recently%20Mr.Avantgarde%20has%20been%20assigned%20the%20task%20of%20delivering%20doughnuts%20.He%20borrowed%20an%20electric%20car%20for%20this%20task.There%20are%20N%20houses%20and%20each%20house%20has%20a%20charging%20station.%20There%20is%20at%20least%20one%20path%20of%20roads%20connecting%20each%20pair%20of%20houses.%20A%20trip%20from%20one%20house%20to%20any%20other%20must%20be%20completed%20using%20at%20most%20C%20rechargings.%20Car%20should%20always%20be%20recharged%20at%20the%20beginning%20of%20each%20trip%28this%20counts%20as%20one%20of%20the%20C%20rechargings%29.As%20you%20know%20that%20Mr.Avantgarde%20is%20a%20lazy%20guy%2C%20Given%20the%20road%20network%20and%20C%2C%20compute%20the%20minimum%20range%20required%20of%20the%20electric%20car.%5Cn%5CnNote%3A%20With%20one%20recharging%2C%20the%20car%20can%20travel%20a%20distance%20equal%20to%20its%20range.%5Cn%5CnInput%5Cn%5CnInput%20begins%20with%20one%20integer%20T%20%280%20%3C%20T%3C%206%29%20denoting%20the%20number%20of%20test%20cases.%20Each%20test%20case%20begins%20with%20a%20line%20containing%20three%20integers%20N%2C%20C%2C%20and%20M%20%281%20%3C%20N%20%3C%20101%2C%200%20%3C%20C%20%3C%20101%29%2C%20where%20N%20and%20C%20are%20number%20of%20houses%20and%20number%20of%20rechargings.%20Next%20follow%20M%20lines%20each%20with%20three%20integers%20u%2C%20v%20and%20d%20%280%20%3C%3D%20u%2Cv%20%3C%20N%2C%20u%20%21%3D%20v%2C1%20%3C%3D%20d%20%3C%3D%2010%5E9%29%20indicating%20that%20house%20u%20and%20v%20%280-indexed%29%20are%20connected%20bidirectionally%20with%20distance%20d.%5Cn%5CnOutput%5Cn%5CnFor%20each%20test%20case%2C%20output%20minimum%20range%20required%20in%20each%20line.%5Cn%5CnSample%20Input%5Cn%5Cn2%5Cn%5Cn4%202%204%5Cn%5Cn0%201%20100%5Cn%5Cn1%202%20200%5Cn%5Cn2%203%20300%5Cn%5Cn3%200%20400%5Cn%5Cn10%202%2015%5Cn%5Cn0%201%20113%5Cn%5Cn1%202%20314%5Cn%5Cn2%203%20271%5Cn%5Cn3%204%20141%5Cn%5Cn4%200%20173%5Cn%5Cn5%207%20235%5Cn%5Cn7%209%20979%5Cn%5Cn9%206%20402%5Cn%5Cn6%208%20431%5Cn%5Cn8%205%20462%5Cn%5Cn0%205%20411%5Cn%5Cn1%206%20855%5Cn%5Cn2%207%20921%5Cn%5Cn3%208%20355%5Cn%5Cn4%209%20113%5Cn%5CnSample%20Output%5Cn%5Cn300%5Cn%5Cn688%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F21353%22%2C%22id%22%3A%2221353%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP21353%22%2C%22title%22%3A%22CLZDOUGH%20-%20Avantgarde%20and%20Doughnut%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22CLZDOUGH%20-%20Avantgarde%20and%20Doughnut%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>CLZDOUGH - Avantgarde and Doughnut</h1>
<h2>题目描述</h2>
<div>Recently Mr.Avantgarde has been assigned the task of delivering doughnuts .He borrowed an electric car for this task.There are N houses and each house has a charging station. There is at least one path of roads connecting each pair of houses. A trip from one house to any other must be completed using at most C rechargings. Car should always be recharged at the beginning of each trip(this counts as one of the C rechargings).As you know that Mr.Avantgarde is a lazy guy, Given the road network and C, compute the minimum range required of the electric car.
Note: With one recharging, the car can travel a distance equal to its range.
Input
Input begins with one integer T (0 < T< 6) denoting the number of test cases. Each test case begins with a line containing three integers N, C, and M (1 < N < 101, 0 < C < 101), where N and C are number of houses and number of rechargings. Next follow M lines each with three integers u, v and d (0 <= u,v < N, u != v,1 <= d <= 10^9) indicating that house u and v (0-indexed) are connected bidirectionally with distance d.
Output
For each test case, output minimum range required in each line.
Sample Input
2
4 2 4
0 1 100
1 2 200
2 3 300
3 0 400
10 2 15
0 1 113
1 2 314
2 3 271
3 4 141
4 0 173
5 7 235
7 9 979
9 6 402
6 8 431
8 5 462
0 5 411
1 6 855
2 7 921
3 8 355
4 9 113
Sample Output
300
688</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
