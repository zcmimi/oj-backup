<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>JC15E - Laser Beam 2.0 - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450637:Nf3d+jJtlNVmXLNwZNx98b0+J3QOb3infOVnJ9SOLrw=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%2A%2ALaser%20Beam%202.0%2A%2A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP26183%5C%2Fc44be50eb32d785c2f10f2f069cf24ab5c88ab29.png%29%5Cn%5CnLaser%20is%20a%20beam%20of%20light%20that%20can%20bounce%20if%20it%20hit%20a%20mirror%2C%20Satria%20who%20love%20beauty%20of%20nature%20make%20an%20experiment%20with%20grid%20of%20mirror%20and%20some%20laser%2C%20this%20is%20the%20second%20time%20Satria%20playing%20with%20laser%2C%20so%20he%20named%20his%20experiment%20%5C%22Laser%20Beam%202.0%5C%22.%20The%20experiment%20is%20so%20great%2C%20many%20people%20like%20with%20Satria%27s%20experiment%20because%20that%20bouncing%20laser%20can%20make%20a%20beautiful%20pattern.%5Cn%5CnGunawan%20who%20curious%20about%20beautiful%20pattern%20secretly%20experimenting%20with%20Satria%27s%20laser%20and%20mirror%20when%20Satria%20not%20home%2C%20but%20something%20terible%20happen%2C%20he%20accidentally%20crossed%20two%20different%20charged%20laser%2C%20so%20it%20break%20all%20the%20mirror%20and%20destroying%20Satria%27s%20experiment.%5Cn%5CnFortunately%2C%20the%20blueprint%20of%20Satria%27s%20laser%20input%5C%2Foutput%20is%20intact%2C%20but%20the%20blueprint%20of%20how%20the%20mirror%20is%20placed%20is%20burned%20so%20it%27s%20unreadable.%20Satria%20is%20sad%2C%20he%20should%20build%20the%20experiment%20from%20the%20beginning.%5Cn%5CnTjandra%20who%20hear%20the%20tragedy%20come%20to%20Satria%27s%20house%20and%20know%20the%20condition.%20He%20suggest%20that%20no%20need%20for%20Satria%20to%20experiment%20from%20the%20beginning%20because%20the%20blueprint%20of%20Satria%27s%20laser%20input%20is%20intact.%5Cn%5CnSatria%20said%3A%20%5C%22Is%20it%20possible%20to%20recover%20my%20experimet%3F%20The%20mirror%20blueprint%20is%20gone%2C%20even%20if%20we%20have%20the%20laser%20input%5C%2Foutput%2C%20we%20don%27t%20know%20how%20to%20dirrect%20the%20input%20laser%20to%20output%20laser%5C%22%20%20%5CnTjandra%20replied%3A%20%5C%22Maybe%20that%27s%20not%20true%2C%20it%20depend%20on%20how%20your%20blueprint%20is%20designed%20can%20I%20know%20more%20about%20your%20experiment%20and%20your%20blueprint%3F%5C%22%20%20%5CnSatria%20replied%3A%20%5C%22_My%20experiment%20consiting%20of%202D%20grid%20of%20mirror%20and%20an%20array%20of%20lasers%20on%20each%20side%20%28there%20are%204%20sides%29%20and%20each%20laser%20is%20shoot%20to%20inside%20of%20the%20grid%2C%20there%20are%20two%20kind%20of%20mirror%2C%20diagonal%20up%20%27%5C%2F%27%20and%20diagonal%20down%20%27%5C%5C%5C%5C%27%2C%20based%20on%20my%20observation%2C%20diagonal%20up%20%27%5C%2F%27%20mirror%20will%20bounce%20the%20laser%20with%20this%20rule%3A%20%7Bfrom%20left%20to%20up%3B%20from%20up%20to%20left%3B%20from%20right%20to%20down%3B%20and%20from%20down%20to%20right%7D%2C%20and%20diagonal%20down%20%27%5C%5C%5C%5C%27%20mirror%20will%20bounce%20the%20laser%20with%20this%20rule%3A%20%7Bfrom%20left%20to%20down%3B%20from%20down%20to%20left%3B%20from%20right%20to%20up%3B%20and%20from%20up%20to%20right%7D.%20The%20blueprint%20tells%20about%20how%20laser%20are%20connected%2C%20after%20bouncing%20so%20many%20times%2C%20eventually%20the%20laser%20will%20go%20outside%20the%20grid%20and%20hit%20another%20laser%2C%20in%20that%20phenomena%20I%20call%20that%20two%20laser%20is%20%27connected%27.%20In%20the%20blueprint%20each%20number%20appear%20exactly%202%20times%20that%27s%20mean%20the%20laser%20with%20the%20same%20number%20are%20%27connected%27%20each%20other._%20That%27s%20my%20experiment%20and%20how%20the%20input%5C%2Foutput%20blueprint%20work.%20So%2C%20is%20it%20possible%20using%20input%5C%2Foutput%20blueprint%20to%20re-create%20missing%20mirror%20blueprint%3F%5C%22%20%20%5CnTjandra%20replied%3A%20%5C%22Yes%2C%20it%27s%20possible%2C%20but%20the%20result%20will%20probably%20be%20not%20the%20same%20as%20the%20old%20one%20because%20the%20mirror%20blueprint%20that%20satisfy%20your%20input%5C%2Foutput%20blueprint%20is%20not%20unique%5C%22%20%20%5CnSatria%20replied%3A%20%5C%22That%27s%20okay%2C%20if%20it%20satisfy%20the%20input%5C%2Foutput%20blueprint%2C%20It%27ll%20always%20be%20as%20beautiful%20as%20original%20one%5C%22%20%20%5CnTjandra%20replied%3A%20%5C%22I%27m%20glad%20to%20hear%20that.%20Okay%2C%20I%20know%20someone%20who%20is%20genious%20in%20programming%2C%20I%27ll%20call%20him%20to%20help%20you%20recover%20your%20experiment%5C%22%5Cn%5CnNow%20Tjandra%20call%20you%20using%20his%20old%20phone%20for%20help%2C%20because%20he%20believe%20that%20you%27re%20so%20promising%20to%20recover%20Satria%27s%20experiment.%20Can%20you%20help%20them%3F%5Cn%5Cn%2A%2AInput%2A%2A%5Cn%5CnThe%20first%20line%20there%20are%20two%20integers%20X%20and%20Y%20denoting%20number%20of%20rows%20and%20number%20of%20colums%20respectively%20of%20Satria%27s%20mirror%20grid.%20%20%5CnOn%20the%20second%20line%20there%20are%20Y%20integers%20denoting%20array%20of%20laser%20on%20top%20of%20that%20grid%20that%20is%20initially%20shoot%20in%20down%20direction.%20%20%5CnEach%20of%20next%20X%20lines%20there%20are%20two%20integers%20A%20%24%20_%7Bi%7D%20%24%20and%20B%20%24%20_%7Bi%7D%20%24%20%3A%5Cn%5Cn-%20A%20%24%20_%7Bi%7D%20%24%20means%20i-th%20laser%20%28counting%20from%20top%20to%20bottom%29%20on%20left%20of%20that%20grid%20that%20is%20initially%20shoot%20in%20right%20direction.%5Cn-%20B%20%24%20_%7Bi%7D%20%24%20means%20i-th%20laser%20%28counting%20from%20top%20to%20bottom%29%20on%20right%20of%20that%20grid%20that%20is%20initially%20shoot%20in%20left%20direction.%5Cn%5CnThe%20last%20line%20there%20are%20Y%20integers%20denoting%20array%20of%20laser%20on%20bottom%20of%20that%20grid%20that%20is%20initially%20shoot%20in%20up%20direction.%5Cn%5Cn%2A%2AOutput%2A%2A%5Cn%5CnIf%20it%27s%20impossible%20to%20re-create%20Satria%27s%20mirror%20blueprint%2C%20print%20%5C%22-1%5C%22%20without%20the%20quotes.%5Cn%5CnOtherwise%20print%20X%20rows%20and%20Y%20collums%20of%20mirror%20blueprint%2C%20character%20%27%5C%5C%5C%5C%27%20ASCII%2892%29%20denoting%20diagonal%20down%20mirror%2C%20and%20character%20%27%5C%2F%27%20denoting%20diagonal%20up%20mirror.%5Cn%5Cn%2A%2AConstraint%2A%2A%5Cn%5Cn1%5Cn%5Cn1%5Cn%5Cn1%5Cn%5CnEach%20numbers%20in%20the%20input%20%28except%20X%20and%20Y%29%20will%20appear%20excactly%20twice.%5Cn%5Cn%2A%2ASample%201%2A%2A%5Cn%5CnInput%5Cn%5Cn%20%60%60%60%5Cn1%201%5Cn1%5Cn1%202%5Cn2%5Cn%60%60%60%5CnOutput%5Cn%5Cn%20%60%5C%2F%60%2A%2ASample%202%2A%2A%5Cn%5CnInput%5Cn%5Cn%20%60%60%60%5Cn1%201%5Cn1%5Cn2%201%5Cn2%5Cn%60%60%60%5CnOutput%5Cn%5Cn%20%60%5C%5C%60%2A%2ASample%203%2A%2A%5Cn%5CnInput%5Cn%5Cn%20%60%60%60%5Cn3%201%5Cn1%5Cn1%203%5Cn2%202%5Cn3%204%5Cn4%5Cn%60%60%60%5CnOutput%5Cn%5Cn%20%60-1%60%2A%2ASample%204%2A%2A%5Cn%5CnInput%5Cn%5Cn%20%60%60%60%5Cn3%201%5Cn1%5Cn1%202%5Cn3%202%5Cn3%204%5Cn4%5Cn%60%60%60%5CnOutput%5Cn%5Cn%20%60%60%60%5Cn%5C%2F%5Cn%5C%5C%5Cn%5C%2F%5Cn%60%60%60%5Cn%2A%2ASample%205%2A%2A%5Cn%5CnInput%5Cn%5Cn%20%60%60%60%5Cn4%207%5Cn7%207%208%209%2010%2010%202%5Cn1%202%5Cn1%203%5Cn4%203%5Cn5%206%5Cn5%204%208%209%2011%2011%206%5Cn%60%60%60%5CnOutput%5Cn%5Cn%20%60%60%60%5Cn%5C%5C%5C%2F%5C%5C%5C%5C%5C%5C%5C%2F%5C%5C%5Cn%5C%2F%5C%2F%5C%2F%5C%2F%5C%5C%5C%2F%5C%2F%5Cn%5C%2F%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5Cn%5C%2F%5C%2F%5C%2F%5C%2F%5C%2F%5C%5C%5C%2F%5Cn%60%60%60%5Cn%2A%2ASample%205%20Explanation%2A%2A%5Cn%5CnIf%20all%20pair%20of%20identical%20number%20on%20input%20is%20connected%2C%20then%20it%27ll%20satisfy%20Satria%27s%20input%5C%2Foutput%20blueprint.%20Here%20is%20an%20image%20that%20show%20the%20correctness%20of%20sample%205%20output.%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP26183%5C%2F4be5a6635483c74f233f41883477bf163a0362fc.png%29%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F26183%22%2C%22id%22%3A%2226183%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP26183%22%2C%22title%22%3A%22JC15E%20-%20Laser%20Beam%202.0%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22JC15E%20-%20Laser%20Beam%202.0%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>JC15E - Laser Beam 2.0</h1>
<h2>题目描述</h2>
<div>**Laser Beam 2.0**
![](https://cdn.luogu.com.cn/upload/vjudge_pic/SP26183/c44be50eb32d785c2f10f2f069cf24ab5c88ab29.png)
Laser is a beam of light that can bounce if it hit a mirror, Satria who love beauty of nature make an experiment with grid of mirror and some laser, this is the second time Satria playing with laser, so he named his experiment "Laser Beam 2.0". The experiment is so great, many people like with Satria's experiment because that bouncing laser can make a beautiful pattern.
Gunawan who curious about beautiful pattern secretly experimenting with Satria's laser and mirror when Satria not home, but something terible happen, he accidentally crossed two different charged laser, so it break all the mirror and destroying Satria's experiment.
Fortunately, the blueprint of Satria's laser input/output is intact, but the blueprint of how the mirror is placed is burned so it's unreadable. Satria is sad, he should build the experiment from the beginning.
Tjandra who hear the tragedy come to Satria's house and know the condition. He suggest that no need for Satria to experiment from the beginning because the blueprint of Satria's laser input is intact.
Satria said: "Is it possible to recover my experimet? The mirror blueprint is gone, even if we have the laser input/output, we don't know how to dirrect the input laser to output laser"
Tjandra replied: "Maybe that's not true, it depend on how your blueprint is designed can I know more about your experiment and your blueprint?"
Satria replied: "_My experiment consiting of 2D grid of mirror and an array of lasers on each side (there are 4 sides) and each laser is shoot to inside of the grid, there are two kind of mirror, diagonal up '/' and diagonal down '\\', based on my observation, diagonal up '/' mirror will bounce the laser with this rule: {from left to up; from up to left; from right to down; and from down to right}, and diagonal down '\\' mirror will bounce the laser with this rule: {from left to down; from down to left; from right to up; and from up to right}. The blueprint tells about how laser are connected, after bouncing so many times, eventually the laser will go outside the grid and hit another laser, in that phenomena I call that two laser is 'connected'. In the blueprint each number appear exactly 2 times that's mean the laser with the same number are 'connected' each other._ That's my experiment and how the input/output blueprint work. So, is it possible using input/output blueprint to re-create missing mirror blueprint?"
Tjandra replied: "Yes, it's possible, but the result will probably be not the same as the old one because the mirror blueprint that satisfy your input/output blueprint is not unique"
Satria replied: "That's okay, if it satisfy the input/output blueprint, It'll always be as beautiful as original one"
Tjandra replied: "I'm glad to hear that. Okay, I know someone who is genious in programming, I'll call him to help you recover your experiment"
Now Tjandra call you using his old phone for help, because he believe that you're so promising to recover Satria's experiment. Can you help them?
**Input**
The first line there are two integers X and Y denoting number of rows and number of colums respectively of Satria's mirror grid.
On the second line there are Y integers denoting array of laser on top of that grid that is initially shoot in down direction.
Each of next X lines there are two integers A $ _{i} $ and B $ _{i} $ :
- A $ _{i} $ means i-th laser (counting from top to bottom) on left of that grid that is initially shoot in right direction.
- B $ _{i} $ means i-th laser (counting from top to bottom) on right of that grid that is initially shoot in left direction.
The last line there are Y integers denoting array of laser on bottom of that grid that is initially shoot in up direction.
**Output**
If it's impossible to re-create Satria's mirror blueprint, print "-1" without the quotes.
Otherwise print X rows and Y collums of mirror blueprint, character '\\' ASCII(92) denoting diagonal down mirror, and character '/' denoting diagonal up mirror.
**Constraint**
1
1
1
Each numbers in the input (except X and Y) will appear excactly twice.
**Sample 1**
Input
```
1 1
1
1 2
2
```
Output
`/`**Sample 2**
Input
```
1 1
1
2 1
2
```
Output
`\`**Sample 3**
Input
```
3 1
1
1 3
2 2
3 4
4
```
Output
`-1`**Sample 4**
Input
```
3 1
1
1 2
3 2
3 4
4
```
Output
```
/
\
/
```
**Sample 5**
Input
```
4 7
7 7 8 9 10 10 2
1 2
1 3
4 3
5 6
5 4 8 9 11 11 6
```
Output
```
\/\\\/\
////\//
/\\\\\\
/////\/
```
**Sample 5 Explanation**
If all pair of identical number on input is connected, then it'll satisfy Satria's input/output blueprint. Here is an image that show the correctness of sample 5 output.
![](https://cdn.luogu.com.cn/upload/vjudge_pic/SP26183/4be5a6635483c74f233f41883477bf163a0362fc.png)</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
