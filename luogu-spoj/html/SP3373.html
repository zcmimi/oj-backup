<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>PERMCODE - Permutation Code - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449793:hoz8GN8pq0giv3numMldZgJzUWrRYQA2f75e012Sh+c=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22As%20the%20owner%20of%20a%20computer%20forensics%20company%2C%20you%20have%20just%20been%20given%20the%20following%20note%20by%20a%20new%20client%3A%5Cn%5Cn%20I%2C%20Albert%20Charles%20Montgomery%2C%20have%20just%20discovered%20the%20most%20amazing%20cypher%20for%20encrypting%20messages.%20Let%20me%20tell%20you%20about%20it.%5Cn%5CnTo%20begin%2C%20you%20will%20need%20to%20decide%20on%20a%20set%20of%20symbols%2C%20call%20it%20S%2C%20perhaps%20with%20the%20letters%20RATE.%20The%20size%20of%20this%20set%20must%20be%20a%20power%20of%202%20and%20the%20order%20of%20the%20symbols%20in%20S%20is%20important.%20You%20must%20note%20that%20R%20is%20at%20position%200%2C%20A%20at%201%2C%20T%20at%202%2C%20and%20E%20at%203.%20You%20will%20also%20need%20one%20permutation%20P%20of%20all%20those%20symbols%2C%20say%20TEAR.%20Finally%20you%20will%20need%20an%20integer%2C%20call%20it%20x.%20Together%2C%20these%20make%20up%20the%20key.%20Given%20a%20key%2C%20you%20are%20now%20ready%20to%20convert%20a%20plaintext%20message%20M%20of%20length%20n%20%28M%5C%5C%5B0%5C%5C%5D%2C%20M%5C%5C%5B1%5C%5C%5D...%20M%5C%5C%5Bn-1%5C%5C%5D%29%2C%20that%20has%20some%20but%20not%20necessarily%20all%20of%20the%20symbols%20in%20S%2C%20into%20a%20cyphertext%20string%20C%2C%20also%20of%20length%20n%20%28C%5C%5C%5B0%5C%5C%5D%2C%20C%5C%5C%5B1%5C%5C%5D%2C...C%5C%5C%5Bn-1%5C%5C%5D%29%2C%20that%20has%20some%20but%20not%20necessarily%20all%20of%20the%20symbols%20in%20S.%5Cn%5CnThe%20encrypting%20algorithm%20computes%20C%20as%20follows%3A%5Cn%5Cn1.%20Calculate%20an%20integer%20d%20as%20the%20remainder%20after%20dividing%20the%20integer%20part%20of%20%28n%20%24%20%5E%7B1.5%7D%20%24%20%2B%20x%29%20by%20n.%20This%20can%20be%20expressed%20more%20succinctly%20as%20d%20%3D%20%28int%29%28n%20%24%20%5E%7B1.5%7D%20%24%20%2B%20x%29%20%25%20n%2C%20where%20%5C%22%25%5C%22%20is%20the%20remainder%20operator.%5Cn2.%20Set%20C%5C%5C%5Bd%5C%5C%5D%20to%20be%20the%20symbol%20in%20S%20whose%20position%20is%20the%20same%20as%20the%20position%20of%20M%5C%5C%5Bd%5C%5C%5D%20in%20P.%5Cn3.%20For%20each%20j%20%5Cu2260%20d%20in%200..n-1%2C%20set%20C%5C%5C%5Bj%5C%5C%5D%20to%20be%20the%20symbol%20in%20S%20whose%20position%20is%20the%20value%20obtained%20by%20xor-ing%20the%20position%20of%20M%5C%5C%5Bj%5C%5C%5D%20in%20P%20with%20the%20position%20of%20M%5C%5C%5B%28j%2B1%29%20%25%20n%5C%5C%5D%20in%20S.%20Note%20that%20the%20bitwise%20xor%20operator%20is%20%5C%22%5E%5C%22%20in%20C%2C%20C%2B%2B%2C%20and%20Java.%5Cn%5CnFor%20example%2C%20consider%20this%20scenario%20where%20S%3DRATE%2C%20P%3DTEAR%2C%20x%3D102%2C%20M%3DTEETER%2C%20and%20n%3D6.%20To%20compute%20d%2C%20first%20calculate%206%20%24%20%5E%7B1.5%7D%20%24%20%2B%20102%20%3D%20116.696938%2C%20then%20take%20the%20remainder%20after%20dividing%20by%206.%20So%20d%20%3D%20116%20%25%206%20%3D%202.%20The%20following%20table%20shows%20the%20steps%20in%20filling%20in%20the%20cyphertext%20C.%20Note%20that%20the%20order%20of%20the%20steps%20is%20not%20important.%5Cn%5Cn%20%20%20%5Cn%200%20%20%5Cn%201%20%20%5Cn%202%20%20%5Cn%203%20%20%5Cn%204%20%20%5Cn%205%20%20%5Cn%20%20%20%5Cn%20S%20%3D%20%20%5Cn%20R%20%20%5Cn%20A%20%20%5Cn%20T%20%20%5Cn%20E%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20P%20%3D%20%20%20%5Cn%20T%20%20%5Cn%20E%20%20%5Cn%20A%20%20%5Cn%20R%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20M%20%3D%20%20%5Cn%20T%20%20%5Cn%20E%20%20%5Cn%20E%20%20%5Cn%20T%20%20%5Cn%20E%20%20%5Cn%20R%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20C%20%3D%20%20%20%5Cn%20E%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20M%5C%5C%5B0%5C%5C%5D%20is%20T%2C%20T%20is%20at%20P%5C%5C%5B0%5C%5C%5D.%20M%5C%5C%5B1%5C%5C%5D%20is%20E%2C%20E%20is%20at%20S%5C%5C%5B3%5C%5C%5D.%20C%5C%5C%5B0%5C%5C%5D%20%3D%20S%5C%5C%5B0%20xor%203%5C%5C%5D%20%3D%20S%5C%5C%5B3%5C%5C%5D%20%20%5Cn%20%20%20%5Cn%20E%20%20%5Cn%20T%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20M%5C%5C%5B1%5C%5C%5D%20is%20E%2C%20E%20is%20at%20P%5C%5C%5B1%5C%5C%5D.%20M%5C%5C%5B2%5C%5C%5D%20is%20E%2C%20E%20is%20at%20S%5C%5C%5B3%5C%5C%5D.%20C%5C%5C%5B1%5C%5C%5D%20%3D%20S%5C%5C%5B1%20xor%203%5C%5C%5D%20%3D%20S%5C%5C%5B2%5C%5C%5D%20%20%5Cn%20%20%20%5Cn%20E%20%20%5Cn%20T%20%20%5Cn%20A%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%202%20is%20d.%20M%5C%5C%5B2%5C%5C%5D%20is%20E%2C%20E%20is%20at%20P%5C%5C%5B1%5C%5C%5D%2C%20so%20C%5C%5C%5B2%5C%5C%5D%20%3D%20S%5C%5C%5B1%5C%5C%5D%20%20%5Cn%20%20%20%5Cn%20E%20%20%5Cn%20T%20%20%5Cn%20A%20%20%5Cn%20E%20%20%5Cn%20%20%20%5Cn%20%20%20%5Cn%20M%5C%5C%5B3%5C%5C%5D%20is%20T%2C%20T%20is%20at%20P%5C%5C%5B0%5C%5C%5D.%20M%5C%5C%5B4%5C%5C%5D%20is%20E%2C%20E%20is%20at%20S%5C%5C%5B3%5C%5C%5D.%20C%5C%5C%5B3%5C%5C%5D%20%3D%20S%5C%5C%5B0%20xor%203%5C%5C%5D%20%3D%20S%5C%5C%5B3%5C%5C%5D%20%20%5Cn%20%20%20%5Cn%20E%20%20%5Cn%20T%20%20%5Cn%20A%20%20%5Cn%20E%20%20%5Cn%20A%20%20%5Cn%20%20%20%5Cn%20M%5C%5C%5B4%5C%5C%5D%20is%20E%2C%20E%20is%20at%20P%5C%5C%5B1%5C%5C%5D.%20M%5C%5C%5B5%5C%5C%5D%20is%20R%2C%20R%20is%20at%20S%5C%5C%5B0%5C%5C%5D.%20C%5C%5C%5B4%5C%5C%5D%20%3D%20S%5C%5C%5B1%20xor%200%5C%5C%5D%20%3D%20S%5C%5C%5B1%5C%5C%5D%20%20%5Cn%20%20%20%5Cn%20E%20%20%5Cn%20T%20%20%5Cn%20A%20%20%5Cn%20E%20%20%5Cn%20A%20%20%5Cn%20A%20%20%5Cn%20M%5C%5C%5B5%5C%5C%5D%20is%20R%2C%20R%20is%20at%20P%5C%5C%5B3%5C%5C%5D.%20M%5C%5C%5B0%5C%5C%5D%20is%20T%2C%20T%20is%20at%20S%5C%5C%5B2%5C%5C%5D.%20C%5C%5C%5B5%5C%5C%5D%20%3D%20S%5C%5C%5B3%20xor%202%5C%5C%5D%20%3D%20S%5C%5C%5B1%5C%5C%5D%22%2C%22inputFormat%22%3A%22%20The%20input%20for%20the%20decoder%20consists%20of%20one%20or%20more%20sets%20of%20%7Bkey%2C%20encrypted%20message%7D%20pairs.%20The%20key%20is%20on%203%20separate%20lines.%20The%20first%20line%20contains%20the%20single%20integer%20x%2C%200%20%3C%20x%20%3C%2010%2C000%3B%20the%20second%20line%20contains%20the%20string%20S%3B%20and%20the%20third%20line%20contains%20the%20string%20P%2C%20which%20will%20be%20a%20permutation%20of%20_S_.%20The%20length%20of%20S%20%28and%20therefore%20P%29%20will%20always%20be%20one%20of%20the%20following%20powers%20of%20two%3A%202%2C%204%2C%208%2C%2016%2C%20or%2032.%20Following%20the%20key%20is%20a%20line%20containing%20the%20encrypted%20message%20string%20C%2C%20which%20will%20contain%20at%20least%20one%20and%20at%20most%20sixty%20characters.%20The%20strings%20S%2C%20P%2C%20and%20C%20will%20not%20contain%20whitespace%2C%20but%20may%20contain%20printable%20characters%20other%20than%20letters%20and%20digits.%20The%20end%20of%20the%20input%20is%20a%20line%20which%20contains%20the%20single%20integer%200.%22%2C%22outputFormat%22%3A%22For%20each%20input%20set%20print%20the%20decrypted%20string%20on%20a%20single%20line%2C%20as%20shown%20in%20the%20sample%20output.%22%2C%22samples%22%3A%5B%5B%22102%5Cr%5CnRATE%5Cr%5CnTEAR%5Cr%5CnETAEAA%5Cr%5Cn32%5Cr%5CnABCDEFGHIJKLMNOPQRSTUVWXYZ._%21%3F%2C%3B%5Cr%5Cn%3BABCDEFGHIJKLMNOPQRSTUVWXYZ._%21%3F%2C%5Cr%5CnMOMCUKZ%2CZPD%5Cr%5Cn1956%5Cr%5CnACEHINT_%5Cr%5CnACTN_IHE%5Cr%5CnCIANCTNAAIECIA_TAI%5Cr%5Cn0%22%2C%22TEETER%5Cr%5CnHELLO_WORLD%5Cr%5CnTHE_CAT_IN_THE_HAT%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B100%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F3373%22%2C%22id%22%3A%223373%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP3373%22%2C%22title%22%3A%22PERMCODE%20-%20Permutation%20Code%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22PERMCODE%20-%20Permutation%20Code%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>PERMCODE - Permutation Code</h1>
<h2>题目描述</h2>
<div>As the owner of a computer forensics company, you have just been given the following note by a new client:
I, Albert Charles Montgomery, have just discovered the most amazing cypher for encrypting messages. Let me tell you about it.
To begin, you will need to decide on a set of symbols, call it S, perhaps with the letters RATE. The size of this set must be a power of 2 and the order of the symbols in S is important. You must note that R is at position 0, A at 1, T at 2, and E at 3. You will also need one permutation P of all those symbols, say TEAR. Finally you will need an integer, call it x. Together, these make up the key. Given a key, you are now ready to convert a plaintext message M of length n (M\[0\], M\[1\]... M\[n-1\]), that has some but not necessarily all of the symbols in S, into a cyphertext string C, also of length n (C\[0\], C\[1\],...C\[n-1\]), that has some but not necessarily all of the symbols in S.
The encrypting algorithm computes C as follows:
1. Calculate an integer d as the remainder after dividing the integer part of (n $ ^{1.5} $ + x) by n. This can be expressed more succinctly as d = (int)(n $ ^{1.5} $ + x) % n, where "%" is the remainder operator.
2. Set C\[d\] to be the symbol in S whose position is the same as the position of M\[d\] in P.
3. For each j ≠ d in 0..n-1, set C\[j\] to be the symbol in S whose position is the value obtained by xor-ing the position of M\[j\] in P with the position of M\[(j+1) % n\] in S. Note that the bitwise xor operator is "^" in C, C++, and Java.
For example, consider this scenario where S=RATE, P=TEAR, x=102, M=TEETER, and n=6. To compute d, first calculate 6 $ ^{1.5} $ + 102 = 116.696938, then take the remainder after dividing by 6. So d = 116 % 6 = 2. The following table shows the steps in filling in the cyphertext C. Note that the order of the steps is not important.
0
1
2
3
4
5
S =
R
A
T
E
P =
T
E
A
R
M =
T
E
E
T
E
R
C =
E
M\[0\] is T, T is at P\[0\]. M\[1\] is E, E is at S\[3\]. C\[0\] = S\[0 xor 3\] = S\[3\]
E
T
M\[1\] is E, E is at P\[1\]. M\[2\] is E, E is at S\[3\]. C\[1\] = S\[1 xor 3\] = S\[2\]
E
T
A
2 is d. M\[2\] is E, E is at P\[1\], so C\[2\] = S\[1\]
E
T
A
E
M\[3\] is T, T is at P\[0\]. M\[4\] is E, E is at S\[3\]. C\[3\] = S\[0 xor 3\] = S\[3\]
E
T
A
E
A
M\[4\] is E, E is at P\[1\]. M\[5\] is R, R is at S\[0\]. C\[4\] = S\[1 xor 0\] = S\[1\]
E
T
A
E
A
A
M\[5\] is R, R is at P\[3\]. M\[0\] is T, T is at S\[2\]. C\[5\] = S\[3 xor 2\] = S\[1\]</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div> The input for the decoder consists of one or more sets of {key, encrypted message} pairs. The key is on 3 separate lines. The first line contains the single integer x, 0 < x < 10,000; the second line contains the string S; and the third line contains the string P, which will be a permutation of _S_. The length of S (and therefore P) will always be one of the following powers of two: 2, 4, 8, 16, or 32. Following the key is a line containing the encrypted message string C, which will contain at least one and at most sixty characters. The strings S, P, and C will not contain whitespace, but may contain printable characters other than letters and digits. The end of the input is a line which contains the single integer 0.</div>
<h3>输出格式</h3>
<br />
<div>For each input set print the decrypted string on a single line, as shown in the sample output.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>102
RATE
TEAR
ETAEAA
32
ABCDEFGHIJKLMNOPQRSTUVWXYZ._!?,;
;ABCDEFGHIJKLMNOPQRSTUVWXYZ._!?,
MOMCUKZ,ZPD
1956
ACEHINT_
ACTN_IHE
CIANCTNAAIECIA_TAI
0</code></pre>
<h3>输出样例 #1</h3>
<pre><code>TEETER
HELLO_WORLD
THE_CAT_IN_THE_HAT</code></pre>
</article>
</div>
</div>
</body>
</html>
