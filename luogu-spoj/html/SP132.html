<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>HELPR2D2 - Help R2-D2! - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449535:t+QinUZKUB/PipSzQuwOIXMob+/PkJbDvr3fao3kIVU=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%20In%20Episode%20III%20of%20Star%20Wars%20%28whose%20alleged%20title%20is%20%5C%22How%20I%20became%20Vader%5C%22%29%2C%20R2-D2%20%28Artoo-Detoo%29%20is%20again%20confronted%20to%20a%20tedious%20work.%20He%20is%20responsible%20for%20the%20loading%20of%20the%20republic%20transport%20starships%20in%20the%20fastest%20way.%20Imagine%20a%20huge%20space%20area%20where%20n%20starships%20are%20parked.%20Each%20starship%20has%20a%20capacity%20of%20K%20cubic%20femtoparsec.%20Containers%20C%20%24%20_%7Bi%7D%20%24%20arrive%20one%20at%20a%20time%20with%20some%20volume%20v%20%24%20_%7Bi%7D%20%24%20%28expressed%20in%20cubic%20femtoparsec%29.%20R2-D2%20wants%20to%20minimize%20the%20number%20of%20starships%20used%20for%20a%20given%20sequence%20of%20containers.%20%20%5Cn%20Smart%20as%20he%20is%2C%20R2-D2%20knows%20for%20sure%20that%20the%20problem%20is%20a%20hard%20one%2C%20even%20with%20the%20force%20being%20around.%20Here%20is%20the%20heuristics%20he%20selected%20to%20solve%20his%20problem.%20Start%20with%20all%20starships%20ready%20to%20load%2C%20and%20numbered%20S%20%24%20_%7B0%7D%20%24%20%2CS%20%24%20_%7B1%7D%20%24%20%2Cetc.%20When%20a%20container%20C%20%24%20_%7Bj%7D%20%24%20arrives%2C%20select%20the%20starship%20of%20minimal%20index%20i%20that%20can%20contain%20C%20%24%20_%7Bj%7D%20%24%20and%20put%20it%20in%20S%20%24%20_%7Bi%7D%20%24%20.%20In%20some%20sense%2C%20this%20heuristic%20minimizes%20the%20move%20of%20the%20container%20arriving%20before%20its%20loading.%20%20%5Cn%20At%20the%20end%20of%20the%20n%20arrivals%2C%20R2-D2%20counts%20the%20number%20s%20of%20starships%20used%20and%20he%20measures%20the%20total%20waste%20w%20of%20the%20sequence.%20For%20i%3D0..s-1%2C%20the%20waste%20in%20starship%20i%20is%20given%20by%20the%20unused%20volume.%20%20%5Cn%20Your%20task%20is%20to%20simulate%20the%20algorithm%20of%20R2-D2.%22%2C%22inputFormat%22%3A%22%20The%20first%20line%20of%20the%20input%20contains%20a%20number%20T%20%5Cu2264%2010%20that%20indicates%20the%20number%20of%20test%20cases%20to%20follow.%20Each%20test%20case%20begins%20with%20K%20on%20a%20line%20%28K%20%5Cu2264%201000%29%2C%20followed%20by%20the%20number%20of%20containers%20in%20the%20sequence%2C%20n%2C%20on%20the%20second%20line%20%281%20%5Cu2264%20n%20%5Cu2264%201000000%29.%20There%20are%20two%20possible%20formats%20for%20the%20remaining%20lines.%20If%20it%20contains%20one%20integer%2C%20then%20this%20is%20the%20next%20v%20%24%20_%7Bi%7D%20%24%20.%20If%20it%20begins%20with%20the%20character%20b%20%28for%20block%29%2C%20it%20is%20followed%20by%202%20integers%20r%20and%20v.%20This%20means%20that%20the%20r%20next%20containers%20arriving%20have%20volume%20v.%22%2C%22outputFormat%22%3A%22%20Your%20program%20must%20output%20the%20number%20s%20of%20starships%20used%2C%20followed%20by%20a%20blank%2C%20followed%20by%20the%20total%20waste%20w.%20%20%5Cn%20You%20can%20assume%2C%20that%20at%20most%20100000%20starships%20are%20needed%2C%20and%20R2-D2%20has%20to%20change%20the%20starships%20in%20which%20the%20next%20container%20is%20loaded%20at%20most%20100000%20times.%22%2C%22samples%22%3A%5B%5B%222%5Cr%5Cn100%5Cr%5Cn3%5Cr%5Cn50%5Cr%5Cn25%5Cr%5Cn70%5Cr%5Cn100%5Cr%5Cn4%5Cr%5Cn50%5Cr%5Cnb%202%2040%5Cr%5Cn20%22%2C%222%2055%5Cr%5Cn2%2050%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B7000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F132%22%2C%22id%22%3A%22132%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP132%22%2C%22title%22%3A%22HELPR2D2%20-%20Help%20R2-D2%21%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22HELPR2D2%20-%20Help%20R2-D2%21%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>HELPR2D2 - Help R2-D2!</h1>
<h2>题目描述</h2>
<div> In Episode III of Star Wars (whose alleged title is "How I became Vader"), R2-D2 (Artoo-Detoo) is again confronted to a tedious work. He is responsible for the loading of the republic transport starships in the fastest way. Imagine a huge space area where n starships are parked. Each starship has a capacity of K cubic femtoparsec. Containers C $ _{i} $ arrive one at a time with some volume v $ _{i} $ (expressed in cubic femtoparsec). R2-D2 wants to minimize the number of starships used for a given sequence of containers.
Smart as he is, R2-D2 knows for sure that the problem is a hard one, even with the force being around. Here is the heuristics he selected to solve his problem. Start with all starships ready to load, and numbered S $ _{0} $ ,S $ _{1} $ ,etc. When a container C $ _{j} $ arrives, select the starship of minimal index i that can contain C $ _{j} $ and put it in S $ _{i} $ . In some sense, this heuristic minimizes the move of the container arriving before its loading.
At the end of the n arrivals, R2-D2 counts the number s of starships used and he measures the total waste w of the sequence. For i=0..s-1, the waste in starship i is given by the unused volume.
Your task is to simulate the algorithm of R2-D2.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div> The first line of the input contains a number T ≤ 10 that indicates the number of test cases to follow. Each test case begins with K on a line (K ≤ 1000), followed by the number of containers in the sequence, n, on the second line (1 ≤ n ≤ 1000000). There are two possible formats for the remaining lines. If it contains one integer, then this is the next v $ _{i} $ . If it begins with the character b (for block), it is followed by 2 integers r and v. This means that the r next containers arriving have volume v.</div>
<h3>输出格式</h3>
<br />
<div> Your program must output the number s of starships used, followed by a blank, followed by the total waste w.
You can assume, that at most 100000 starships are needed, and R2-D2 has to change the starships in which the next container is loaded at most 100000 times.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2
100
3
50
25
70
100
4
50
b 2 40
20</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2 55
2 50</code></pre>
</article>
</div>
</div>
</body>
</html>
