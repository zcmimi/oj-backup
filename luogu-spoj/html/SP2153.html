<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>IMATCH - Internet is Faulty - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449720:xFKPxUiZqp6hGcy6Poc8P+Bwhc5H2ktvHLMmJq/WSiI=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22David%20has%20a%20problem.%20He%20wants%20to%20transfer%20a%20big%20file%20through%20the%20internet%20from%20his%20home%20computer%20to%20his%20computer%20at%20work.%20The%20size%20of%20his%20file%20is%20S%20kilobytes.%5Cn%5CnThe%20internet%20consists%20of%20N%20computers%2C%20numbered%20from%201%20to%20N.%20David%27s%20home%20computer%20has%20the%20number%201%20and%20his%20computer%20at%20work%20has%20the%20number%202.%20Some%20pairs%20of%20computers%20are%20connected%20by%20different%20types%20of%20links%20%28such%20as%20network%20cables%20or%20wi-fi%29.%20Some%20of%20these%20links%20%28e.g.%2C%20a%20satellite%20dish%29%20may%20be%20unidirectional%2C%20thus%20for%20simplicity%20we%20will%20assume%20that%20all%20links%20are%20unidirectional.%5Cn%5CnThe%20data%20are%20sent%20across%20the%20network%20in%20packets%2C%20each%20packet%20contains%20exactly%20one%20kilobyte%20of%20data.%20For%20each%20link%20David%20knows%20how%20faulty%20it%20is%2C%20i.e.%20the%20probability%20that%20a%20network%20packet%20gets%20from%20one%20computer%20to%20the%20other%20through%20the%20link.%20We%20assume%20that%20all%20transfers%20are%20independent%20from%20each%20other.%20That%20is%2C%20regardless%20of%20whether%20the%20previous%20packet%20was%20transferred%20successfully%20or%20not%2C%20the%20probability%20that%20the%20next%20one%20will%20pass%20through%20remains%20the%20same.%5Cn%5CnSince%20the%20network%20is%20faulty%20and%20the%20work%20computer%20might%20be%20many%20links%20away%20from%20the%20home%20computer%2C%20the%20transfer%20of%20David%27s%20file%20along%20even%20the%20best%20route%20between%20the%20two%20computers%20might%20take%20too%20long.%20Luckily%2C%20David%20has%20an%20account%20on%20some%20of%20the%20machines%20in%20the%20network.%20He%20may%20use%20these%20machines%20as%20temporary%20storage%2C%20and%20thus%20shorten%20the%20time%20of%20the%20transfer.%5Cn%5CnThe%20file%20transfer%20will%20consist%20of%20several%20steps.%20In%20each%20step%2C%20David%20selects%20a%20series%20of%20links%20starting%20with%20a%20computer%20that%20already%20has%20the%20file%20and%20ending%20with%20a%20computer%20David%20has%20an%20account%20on.%20Prior%20to%20the%20transfer%2C%20the%20file%20is%20split%20into%20S%20packets.%20Then%20the%20packets%20are%20sent%20one%20after%20another%20along%20the%20chosen%20route.%20The%20probability%20that%20a%20packet%20successfully%20arrives%20at%20the%20destination%20computer%20is%20the%20product%20of%20probabilities%20that%20it%20passes%20all%20the%20links.%20If%20the%20packet%20is%20lost%20it%20is%20resent%20immediately.%20Each%20attempt%20to%20send%20a%20packet%2C%20successful%20or%20unsuccessful%2C%20takes%20exactly%20one%20millisecond%2C%20regardless%20of%20the%20number%20of%20links%20on%20the%20route.%20After%20the%20entire%20file%20is%20transferred%2C%20David%20may%20start%20another%20transfer%20from%20the%20new%20machine%2C%20and%20so%20on.%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5B%222%5Cr%5Cn%5Cr%5Cn4%5Cr%5Cn0%200%2040%2066%5Cr%5Cn0%200%200%2030%5Cr%5Cn40%2047%200%2066%5Cr%5Cn0%2030%2066%200%5Cr%5Cn4%5Cr%5Cn1%202%203%204%5Cr%5Cn47%5Cr%5Cn%5Cr%5Cn5%5Cr%5Cn0%201%2020%200%200%5Cr%5Cn0%200%200%200%200%5Cr%5Cn0%200%200%2050%2090%5Cr%5Cn0%2020%200%200%200%5Cr%5Cn0%200%200%2090%200%5Cr%5Cn3%5Cr%5Cn1%202%205%5Cr%5Cn10%22%2C%22207.897153%5Cr%5Cn111.111111%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F2153%22%2C%22id%22%3A%222153%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A3%2C%22totalAccepted%22%3A1%2C%22pid%22%3A%22SP2153%22%2C%22title%22%3A%22IMATCH%20-%20Internet%20is%20Faulty%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22IMATCH%20-%20Internet%20is%20Faulty%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>IMATCH - Internet is Faulty</h1>
<h2>题目描述</h2>
<div>David has a problem. He wants to transfer a big file through the internet from his home computer to his computer at work. The size of his file is S kilobytes.
The internet consists of N computers, numbered from 1 to N. David's home computer has the number 1 and his computer at work has the number 2. Some pairs of computers are connected by different types of links (such as network cables or wi-fi). Some of these links (e.g., a satellite dish) may be unidirectional, thus for simplicity we will assume that all links are unidirectional.
The data are sent across the network in packets, each packet contains exactly one kilobyte of data. For each link David knows how faulty it is, i.e. the probability that a network packet gets from one computer to the other through the link. We assume that all transfers are independent from each other. That is, regardless of whether the previous packet was transferred successfully or not, the probability that the next one will pass through remains the same.
Since the network is faulty and the work computer might be many links away from the home computer, the transfer of David's file along even the best route between the two computers might take too long. Luckily, David has an account on some of the machines in the network. He may use these machines as temporary storage, and thus shorten the time of the transfer.
The file transfer will consist of several steps. In each step, David selects a series of links starting with a computer that already has the file and ending with a computer David has an account on. Prior to the transfer, the file is split into S packets. Then the packets are sent one after another along the chosen route. The probability that a packet successfully arrives at the destination computer is the product of probabilities that it passes all the links. If the packet is lost it is resent immediately. Each attempt to send a packet, successful or unsuccessful, takes exactly one millisecond, regardless of the number of links on the route. After the entire file is transferred, David may start another transfer from the new machine, and so on.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>2

4
0 0 40 66
0 0 0 30
40 47 0 66
0 30 66 0
4
1 2 3 4
47

5
0 1 20 0 0
0 0 0 0 0
0 0 0 50 90
0 20 0 0 0
0 0 0 90 0
3
1 2 5
10</code></pre>
<h3>输出样例 #1</h3>
<pre><code>207.897153
111.111111</code></pre>
</article>
</div>
</div>
</body>
</html>
