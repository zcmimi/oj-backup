<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>MOULDS - Moulds - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449517:oOG+INuURN9XbZXYeoXTKg+WpkfVPuI9jxTXxCTD8V8=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%20In%20a%20factory%2C%20moulds%20for%20casting%20metal%20objects%20are%20produced%20by%20a%20special%20cutting%20device.%20The%20device%20is%20equipped%20with%20cuboid-shaped%20blade%20of%20size%201%20mm%20x%201%20mm%20x%2030%20mm%20%28its%20height%29%20which%20operates%20with%20each%20of%20its%20sides%20thus%20producing%20the%20mould%20from%20cuboid%20of%20size%20250%20mm%20x%20250%20mm%20x%2030%20mm%20%28its%20height%29.%20The%20end%20of%20the%20blade%20newer%20lowers%20below%20the%20bottom%20surface%20of%20the%20cuboid.%20In%20any%20moment%20the%20distance%20between%20initial%20and%20current%20position%20doesn%27t%20exceed%201000.%5Cn%5Cn%20The%20machine%20understands%20special%20command%20language%20which%20has%20the%20following%20grammar%3A%5Cn%5Cn%60%60%60%5Cn%3Ccommand%20block%3E%20%3A%3A%3D%20%5B%20%3Ccommand%3E%20%3B%20%7B%3Ccommand%3E%20%3B%20%7D%20%5D%20%5Cn%3Ccommand%3E%20%20%20%20%20%20%20%3A%3A%3D%20%3Clift%3E%20%7C%20%3Cshift%3E%20%7C%20%3Ccommand%20block%3E%5Cn%3Clift%3E%20%20%20%20%20%20%20%20%20%20%3A%3A%3D%20%5E%20%3Cdistance%3E%5Cn%3Cshift%3E%20%20%20%20%20%20%20%20%20%3A%3A%3D%20%40%20%3Cdirection%3E%20%3Cdistance%3E%5Cn%3Cdirection%3E%20%20%20%20%20%3A%3A%3D%20N%20%7C%20S%20%7C%20W%20%7C%20E%20%5Cn%3Cdistance%3E%20%20%20%20%20%20%3A%3A%3D%20%3Csign%3E%20%3Cnumber%3E%20%7C%20%3Cnumber%3E%5Cn%3Cnumber%3E%20%20%20%20%20%20%20%20%3A%3A%3D%20%3Cdigit%3E%20%7B%3Cdigit%3E%7D%5Cn%3Csign%3E%20%20%20%20%20%20%20%20%20%20%3A%3A%3D%20-%20%7C%20%2B%20%5Cn%3Cdigit%3E%20%20%20%20%20%20%20%20%20%3A%3A%3D%200%20%7C%201%20%7C%202%20%7C%203%20%7C%204%20%7C%205%20%7C%206%20%7C%207%20%7C%208%20%7C%209%20%5Cn%60%60%60%5Cn%20where%20%7Bexp%7D%20means%20zero%20or%20more%20exps.%5Cn%5Cn%20The%20command%20%3Clift%3E%20causes%20moving%20the%20blade%20downwards%20when%20the%20distance%20is%20a%20positive%20number%20and%20upwards%20otherwise.%20The%20command%20%3Cshift%3E%20moves%20the%20blade%20in%20the%20appropriate%20direction%20%28N--north%2C%20S--south%2C%20W--west%2C%20E--east%29.%5Cn%5Cn%20%20%20%5Cn%23%23%23%20Task%5Cn%5Cn%20Write%20a%20program%20which%20for%20each%20data%20set%20from%20a%20sequence%20of%20several%20data%20sets%3A%5Cn%5Cn-%20reads%20a%20command%20block%20from%20input%2C%5Cn-%20computes%20the%20volume%20of%20hollows%20made%20by%20the%20machine%20commanded%20by%20a%20given%20command%20block%20%28assuming%20that%20before%20the%20execution%20the%20blade%20is%20located%201%20mm%20above%20the%20north-west%20corner%20of%20the%20virgin%20cuboid%29%2C%5Cn-%20writes%20the%20result%20to%20output.%22%2C%22inputFormat%22%3A%22%20The%20first%20line%20of%20the%20input%20file%20contains%20one%20integer%20d%2C%201%20%3C%3D%20d%20%3C%3D%2010%2C%20which%20is%20the%20number%20of%20data%20sets.%20The%20data%20sets%20follow.%20Each%20data%20set%20occupies%20one%20line%20of%20the%20input%20file%20and%20is%20a%20word%20derived%20from%20%3Ccommand%20block%3E%20of%20the%20above%20grammar%20of%20length%20not%20exceeding%2010000%20characters.%22%2C%22outputFormat%22%3A%22%20The%20i-th%20line%20of%20the%20output%20file%20should%20contain%20one%20integer%20--%20the%20volume%20%28in%20cubic%20mm%29%20of%20the%20hollows%20made%20by%20the%20machine%20controlled%20by%20the%20command%20block%20given%20in%20the%20i-th%20data%20set.%22%2C%22samples%22%3A%5B%5B%221%20%5Cr%5Cn%5B%5E2%3B%40S2%3B%5D%22%2C%223%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B5000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F69%22%2C%22id%22%3A%2269%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A1%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP69%22%2C%22title%22%3A%22MOULDS%20-%20Moulds%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22MOULDS%20-%20Moulds%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>MOULDS - Moulds</h1>
<h2>题目描述</h2>
<div> In a factory, moulds for casting metal objects are produced by a special cutting device. The device is equipped with cuboid-shaped blade of size 1 mm x 1 mm x 30 mm (its height) which operates with each of its sides thus producing the mould from cuboid of size 250 mm x 250 mm x 30 mm (its height). The end of the blade newer lowers below the bottom surface of the cuboid. In any moment the distance between initial and current position doesn't exceed 1000.
The machine understands special command language which has the following grammar:
```
<command block> ::= [ <command> ; {<command> ; } ]
<command> ::= <lift> | <shift> | <command block>
<lift> ::= ^ <distance>
<shift> ::= @ <direction> <distance>
<direction> ::= N | S | W | E
<distance> ::= <sign> <number> | <number>
<number> ::= <digit> {<digit>}
<sign> ::= - | +
<digit> ::= 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9
```
where {exp} means zero or more exps.
The command <lift> causes moving the blade downwards when the distance is a positive number and upwards otherwise. The command <shift> moves the blade in the appropriate direction (N--north, S--south, W--west, E--east).
### Task
Write a program which for each data set from a sequence of several data sets:
- reads a command block from input,
- computes the volume of hollows made by the machine commanded by a given command block (assuming that before the execution the blade is located 1 mm above the north-west corner of the virgin cuboid),
- writes the result to output.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div> The first line of the input file contains one integer d, 1 <= d <= 10, which is the number of data sets. The data sets follow. Each data set occupies one line of the input file and is a word derived from <command block> of the above grammar of length not exceeding 10000 characters.</div>
<h3>输出格式</h3>
<br />
<div> The i-th line of the output file should contain one integer -- the volume (in cubic mm) of the hollows made by the machine controlled by the command block given in the i-th data set.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>1 
[^2;@S2;]</code></pre>
<h3>输出样例 #1</h3>
<pre><code>3</code></pre>
</article>
</div>
</div>
</body>
</html>
