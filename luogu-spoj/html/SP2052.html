<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>CERC07H - Hexagonal Parcels - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449707:vZ7n3pUqnzlalGlEPXhhlHut5pu5Aa/D7yzPm7U9JJc=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22A%20civil%20engineer%20that%20has%20recently%20graduated%20from%20the%20Czech%20Technical%20University%20encountered%20an%20interesting%20problem%20and%20asked%20us%20for%20a%20help.%20The%20problem%20is%20more%20of%20economical%20than%20engineering%20nature.%20The%20engineer%20needs%20to%20connect%20several%20buildings%20with%20an%20infrastructure.%20Unfortunately%2C%20the%20investor%20is%20not%20the%20owner%20of%20all%20the%20land%20between%20these%20places.%20Therefore%2C%20some%20properties%20have%20to%20be%20bought%20first.%5Cn%5CnThe%20land%20is%20divided%20into%20a%20regular%20%5C%22grid%5C%22%20of%20hexagonal%20parcels%2C%20each%20of%20them%20forms%20an%20independent%20unit%20and%20has%20the%20same%20value.%20Some%20of%20the%20parcels%20belong%20to%20the%20investor.%20These%20parcels%20form%20four%20connected%20areas%2C%20each%20containing%20one%20building%20to%20be%20connected%20with%20the%20others.%20Your%20task%20is%20to%20find%20the%20minimal%20number%20of%20parcels%20that%20must%20be%20acquired%20to%20connect%20the%20four%20given%20areas.%5Cn%5Cn%21%5Bexample%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP2052%5C%2Ff35ad926f366e843585a8b112991946f808c07b9.png%29The%20whole%20land%20also%20has%20a%20hexagonal%20shape%20with%20six%20sides%2C%20each%20consisting%20of%20exactly%20H%20parcels.%20The%20above%20picture%20shows%20a%20land%20with%20H%20%3D%204%2C%20parcels%20with%20letters%20represent%20the%20four%20areas%20to%20be%20connected.%20In%20this%20case%2C%20it%20is%20necessary%20to%20buy%20four%20additional%20parcels.%20One%20of%20the%20possible%20solutions%20is%20marked%20by%20crosses.%22%2C%22inputFormat%22%3A%22The%20input%20contains%20several%20scenarios.%20Each%20scenario%20begins%20with%20an%20integer%20number%20H%2Cwhich%20specifies%20the%20size%20of%20the%20land%2C%202%20%3C%3D%20H%20%3C%3D%2020.%20Then%20there%20are%202.H%20-%201%20lines%20representing%20individual%20%5C%22rows%5C%22%20of%20the%20land%20%28always%20oriented%20as%20in%20the%20picture%29.%20The%20lines%20contain%20one%20non-space%20character%20for%20each%20parcel.%20It%20means%20the%20first%20line%20will%20contain%20H%20characters%2C%20the%20second%20line%20H%20%2B1%2C%20and%20so%20on.%20The%20longest%20line%20will%20be%20the%20middle%20one%2C%20with%202.H%20-%201%20characters.%20Then%20the%20%5C%22length%5C%22%20descends%20and%20the%20last%20line%20contains%20H%20parcels%2C%20again.%5Cn%5CnThe%20character%20representing%20a%20parcel%20will%20be%20either%20a%20dot%20%28%5C%22.%5C%22%29%20for%20the%20land%20that%20is%20not%20owned%20by%20the%20investor%2C%20or%20one%20of%20the%20uppercase%20letters%20%5C%22A%5C%22%2C%20%5C%22B%5C%22%2C%20%5C%22C%5C%22%2C%20or%20%5C%22D%5C%22.%20The%20areas%20of%20parcels%20occupied%20by%20the%20same%20letter%20will%20always%20be%20connected.%20It%20means%20that%20between%20any%20two%20parcels%20in%20the%20same%20area%2C%20there%20exists%20a%20path%20leading%20only%20through%20that%20area.%5Cn%5CnBeside%20the%20characters%20representing%20parcels%2C%20the%20lines%20may%20contain%20any%20number%20of%20spaces%20at%20any%20positions%20to%20improve%20%5C%22human%20readability%5C%22%20of%20the%20input.%20There%20is%20always%20at%20least%20one%20space%20between%20two%20letters%20%28or%20the%20dots%29.%20After%20the%20land%20description%2C%20there%20will%20be%20one%20empty%20line%20and%20then%20the%20next%20scenario%20begins.%20The%20last%20scenario%20is%20followed%20by%20a%20line%20containing%20zero.%22%2C%22outputFormat%22%3A%22For%20each%20scenario%2C%20output%20one%20line%20with%20the%20sentence%20%5C%22You%20have%20to%20buy%20P%20parcels.%5C%22%2C%20where%20P%20is%20the%20minimal%20number%20of%20parcels%20that%20must%20be%20acquired%20to%20make%20all%20four%20areas%20connected%20together.%5Cn%5CnAreas%20are%20considered%20connected%2C%20if%20it%20is%20possible%20to%20find%20a%20path%20between%20them%20that%20leads%20only%20through%20parcels%20that%20have%20been%20bought.%22%2C%22samples%22%3A%5B%5B%224%5Cr%5Cn%20%20%20B%20.%20.%20C%5Cr%5Cn%20%20.%20.%20.%20.%20C%5Cr%5Cn%20.%20A%20.%20.%20C%20.%5Cr%5Cn.%20A%20A%20.%20.%20.%20.%5Cr%5Cn%20.%20A%20.%20.%20.%20.%5Cr%5Cn%20%20.%20.%20.%20D%20D%5Cr%5Cn%20%20%20.%20.%20.%20.%5Cr%5Cn%5Cr%5Cn0%22%2C%22You%20have%20to%20buy%204%20parcels.%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B419%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F2052%22%2C%22id%22%3A%222052%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP2052%22%2C%22title%22%3A%22CERC07H%20-%20Hexagonal%20Parcels%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22CERC07H%20-%20Hexagonal%20Parcels%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>CERC07H - Hexagonal Parcels</h1>
<h2>题目描述</h2>
<div>A civil engineer that has recently graduated from the Czech Technical University encountered an interesting problem and asked us for a help. The problem is more of economical than engineering nature. The engineer needs to connect several buildings with an infrastructure. Unfortunately, the investor is not the owner of all the land between these places. Therefore, some properties have to be bought first.
The land is divided into a regular "grid" of hexagonal parcels, each of them forms an independent unit and has the same value. Some of the parcels belong to the investor. These parcels form four connected areas, each containing one building to be connected with the others. Your task is to find the minimal number of parcels that must be acquired to connect the four given areas.
![example](https://cdn.luogu.com.cn/upload/vjudge_pic/SP2052/f35ad926f366e843585a8b112991946f808c07b9.png)The whole land also has a hexagonal shape with six sides, each consisting of exactly H parcels. The above picture shows a land with H = 4, parcels with letters represent the four areas to be connected. In this case, it is necessary to buy four additional parcels. One of the possible solutions is marked by crosses.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The input contains several scenarios. Each scenario begins with an integer number H,which specifies the size of the land, 2 <= H <= 20. Then there are 2.H - 1 lines representing individual "rows" of the land (always oriented as in the picture). The lines contain one non-space character for each parcel. It means the first line will contain H characters, the second line H +1, and so on. The longest line will be the middle one, with 2.H - 1 characters. Then the "length" descends and the last line contains H parcels, again.
The character representing a parcel will be either a dot (".") for the land that is not owned by the investor, or one of the uppercase letters "A", "B", "C", or "D". The areas of parcels occupied by the same letter will always be connected. It means that between any two parcels in the same area, there exists a path leading only through that area.
Beside the characters representing parcels, the lines may contain any number of spaces at any positions to improve "human readability" of the input. There is always at least one space between two letters (or the dots). After the land description, there will be one empty line and then the next scenario begins. The last scenario is followed by a line containing zero.</div>
<h3>输出格式</h3>
<br />
<div>For each scenario, output one line with the sentence "You have to buy P parcels.", where P is the minimal number of parcels that must be acquired to make all four areas connected together.
Areas are considered connected, if it is possible to find a path between them that leads only through parcels that have been bought.</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>4
   B . . C
  . . . . C
 . A . . C .
. A A . . . .
 . A . . . .
  . . . D D
   . . . .

0</code></pre>
<h3>输出样例 #1</h3>
<pre><code>You have to buy 4 parcels.</code></pre>
</article>
</div>
</div>
</body>
</html>
