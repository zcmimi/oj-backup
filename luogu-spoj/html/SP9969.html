<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>RDNWK - Road Network - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450187:NejSFEf/3aU2Hz53/GbZNaCaXZBpwitCEdIjWErPFS0=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22In%20a%20country%20of%20N%20cities%2C%20the%20government%20would%20like%20to%20develop%20a%20new%20system%20that%20can%20answer%20drivers%5Cu2019%20queries%20to%20find%20the%20shortest%20path%20between%202%20cities%20in%20the%20country%20road%20network.%20However%2C%20some%20cities%20are%20more%20exciting%20than%20others%2C%20and%20drivers%20would%20prefer%20driving%20through%20them.%20Last%20month%2C%20a%20voting%20for%20the%20most%20exciting%20cities%20in%20the%20country%20was%20conducted%2C%20and%20a%20ranking%20of%20the%20P%20most%20exciting%20cities%20has%20been%20made.%20The%20government%20decided%20to%20utilize%20this%20ranking%20so%20that%20drivers%20can%20find%20the%20shortest%20path%20between%202%20cities%20that%20only%20goes%20through%20the%20first%20K%20cities%20of%20the%20ranking%20as%20intermediate%20cites%20on%20the%20road.%20Hence%2C%20the%20query%20is%20defined%20as%3A%20the%20source%20city%2C%20the%20destination%20city%2C%20and%20K%20for%20the%20first%20K%20cities%20from%20the%20ranking.%20%28Note%20that%20some%20cities%20may%20not%20be%20exciting%20at%20all%2C%20and%20so%20they%20will%20not%20be%20included%20in%20the%20ranking%2C%20i.e.%20P%20%3C%3D%20N%29%5Cn%5CnGiven%20undirected%20graph%20representing%20the%20country%20cities%2C%20and%20ranked%20list%20of%20exciting%20cities%2C%20you%20are%20to%20answer%20Q%20quires%2C%20each%20one%20asking%20for%20the%20shortest%20path%20between%202%20cities%20utilizing%20only%20the%20first%20K%20cities%20from%20the%20ranked%20list.%5Cn%5Cn%21%5B%5D%28data%3Aimage%5C%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAANEAAADRCAIAAADdWMC4AAAcNElEQVR4nO2d%2BU8j1%2BHAv39I%2B0Mr9YcqaqtGqipVTRWl2W3VbhM1m0pJWkVapVWTXRbwbfAFPrgMGDAGYw5jzA27y32F%2B1ru7LLcxy6w3DfYmMv2%2B%5C%2F7wui%5C%2FD2BxZm%5C%2FEMfp8fkJkZ22%5C%2FefPzu4%5C%2F8ABkMt%5C%2F%2BfrAGD8Duwchmqwcxiqwc5hqAY7h6Ea7ByGarBzGKrBzmGoBjuHoRrsHIZqsHMYqsHOYagGO4ehGuwchmqwcxiqwc5hqAY7h6Ea7ByGarBz7nE6nU6n89ILLr4G4xbsnHucTqfD4UD%5C%2F7u%5C%2Fvz87Ojo6Ovnz50mKxoOPEazBXBDt3CW1tbbGxsRKJRKFQqFQqhUIhlUrVanV7e7uvg8ZUsHPnMjY2JpVKZTJZQ0PD69evDw4OTk5OrFbrwsJCfX29VCqVSqXj4%2BO%2BDibzwM6dAeWVjY2NQUFB9fX1F1xcXV0dGBjY1NQEAMAFu6uDnTsDVKejo4PL5U5OTl56%5C%2Ffj4OIfD6e7uvv6g3Rywc2RWV1fZbPaLFy%2BAS00CAY9DQYeHhzkczsrKCtUBZSzYOTJ6vT4vLw%5C%2F9S2wQqa6unpmZAS4NJQUFBQaDAWevVwQ7d4bNzU0Wi7W3t0c86HQ6Z2ZmRCLRT37yk6qqKtd3ra%2BvSySS5eVlqoLJbLBzZ6ivr9dqta7Hh4eHg4ODf%5C%2FrTn9bU1AB3NYbU1NTm5mYqgsh8sHNn0Ol0LS0tpIPQsJ2dnQ8%5C%2FLC6uhq4c66mpsZsNhOvx5wHdu4MSqVyYmLC7an19fUPPvgAOudKf3%2B%5C%2FVquFFQ7s3MVg584gl8unpqbcnlpbW7vAucHBwaSkJNwVdhWwc2dISEg4r7Ftb2%5C%2Fvww8%5C%2FbGxsdHu2sbHRaDReY8huENi5Mzx58iQrK8v1%2BObmZnV19TvvvBMdHf3y5UvX9MxoNNbW1lISRsaDnTvD%5C%2FPw8l8s9OTkhHW9ubv7444%5C%2F8Ic%5C%2FOlPf9JoNKQLLBZLWFgYbLrDXAp2jkxkZOS3335LPOJ0Om022%5C%2Fr6%2Bvb29ubm5u7uLqmW0NjYqFarT09PqQ0pU8HOkZmamgoODl5bW0NHXHNSonMbGxs8Hu%2B82i7GFezcGaBMjx8%5C%2FVqlUu7u76CDq6UJ%5C%2F4Yvt7e3AwMDMzEzi2zEXg507A5RmdXX173%5C%2FO4fDmZ6evuDi8fFxmUzGYrHkcjnu%2BLo62Dky%2B%5C%2Fv7crm8qKiosrJSIBBkZmaOj4%5C%2FbbDZ0gdVqnZiYyMzM5PP5tbW1DoejqqoqNDR0bm4OXoBTu4vBzp3JOm02m0KhQC1ty8vLOTk5YWFhSqUyOTk5LS1Nq9WqVKrw8HCTyUQs89XW1vJ4PNie7CTgixuiO9i57wfJHR8fR0dHp6WloePwhcVimZiYaG9vr6%2Bvb29vn5ycRNNwiG41NjayWCw40hNrdwHYuf%5C%2FhcDiSkpI0Go3dbgdXk8Z5FgBAd3f3%5C%2Ffv34XhPAC6fsOif%2BLVzSAin06nX62NiYlBjL%5C%2FHUee91dQ4AMDAwEBgY2NPTc%5C%2FHb%5C%2FRn%5C%2FdY447txkMimVyoODA6988tDQEIvF6uzsRF%2BEEzwifu0cfFFcXCyTyVBrnIefCT92ZGSEy%2BWioXjYOSJ%2B6hySoLy8XCwWr6%2BvA2%5C%2Fkg8QkbWpqis%5C%2Fn19XVoVMefviNwb%2BcI6U39fX1PB5vaWkJeMkJ0oe8evVKIBBUVFQQz%2BI0z%2B%2BcQ2W4trY2Fou1sLBwTV8ExVpaWhIKhcXFxaTj%5C%2FozfOQdf9PX1BQYGXt%5C%2FoIydhAuz6%2BrpQKMzPz0en%5C%2FFw7f3GO%2BKSfPXsWHBw8MjICrq2YRWpD2d3dlUqlRqOR9HX%2BKZ9fOEd8%5C%2FBMTExwOp6%2Bvj8qvBgDs7u4qlcqMjAw4zA6mgti5Gwt6ui9fvuRyuR0dHeg4Nd8OC5EWiyUqKkqn08GWZ%5C%2F8UDviPcwCAxcXFkJCQhoYGir%2BdmKQdHBxoNJr4%2BHjiQBV%5C%2FgxnOkVoZrpIrkUpUm5ubQqEQNVv4BBiS4%2BPjpKSkqKgo1O3xgzJZ51muK6zXCcOc%2B0FvQU9lf38%5C%2FJCSkpKSE%2BGk%2BAX613W5PS0uTy%2BX7%2B%5C%2FsAAIfDgSq5l74Xvb7KW%2BgJk5yz2%2B3t7e0xMTFFRUVXz5ssFotMJsvJyUEf5asUgvTVRqNRJpNtbW2BqyV1DodjZ2dnenp6Z2cHnL9OGf1hknMHBwcJCQkqlerOnTupqannXUl8eDabLTo62mAwkM76yjlSCHNzc0UiEex5u5SdnR2BQPD5559%5C%2F8sknQ0NDgLG1EGY4B0FRnJqayuVyz7sGJQAnJyeJiYlarRY1T1AW1EtB91JSUiISiRYXF9Hx80yy2WyTk5OHh4dff%5C%2F21Wq0G2DnK2NjY%2BNe%5C%2FnXepHkknN1u1%2Bv18fHxh4eH6BR1obwMoltlZWUCgQBOp7i4lHZ8fKzVav%5C%2Fyl7%2BMjo4Cmt3R1WGYc%5C%2Fv7%2ByKR6LyMFRDyL6PRGBkZCYt9xMSPPhC1q62tvXSaGQDg9PS0paXl3%5C%2F%2BN%2BzAxc5dF0gXq9X64MGDTz%5C%2F9tLW1dXx8HOaYbtsO8vLy5HI5XC4THaTnE0Kham5uZrFYMAED7jJZm80Gm1cSEhIePnwI6HpHl8IY55xO58bGBofDCQoK4vP5BoOBmIYRn9Djx48FAsHm5ia4Wn2QPnR2dgYFBT1%5C%2Fhy4q1%2BPjY198803AQEBt2%5C%2Ffbm1tBdi5a4XUHOVwOOx2O2rfJ2VSwcHBGxsbgJmDwvv7%2B4ODg%5C%2Fv7%2B4HLD%2Bbw8HBgYKCsrAwV5uhWWrgizHAOuEuxiErBvzB7QmMwmegcAOD58%2BfE6RSQC%2B6dcTDGObcQI%5C%2F3p06doIxGGPgzE6Ogol8tFi2LDjgrfBsmLMNs5xHfffUfcSITpzgEAJiYmeDwemk6BnaMFSKzR0VEOhwOb5gHD8x0i8%5C%2FPzPB7Pt%2BMSrgPGOzc7O8vlcru6ukinGO0cCv%5C%2Fq6ippOgVzu%5C%2FYRDHYOALCxsREUFITWlWb6w3DL2tqaWCxGm09g53zJ2toai8WCJZ6bkQCcx%5C%2Fb2tkwmy8rKuhk3yFTntra2xGJxaWkp%5C%2FPcGOwdvymKxKJVKg8Hgur4242CYc%2BgBKBQK4u6D%5C%2FoDVao2JiUlOTkbTKRj6G2OYc%2BDNkLjMzEzYfHBTkze3HBwcxMfHx8bGHh8fA8aWXxnm3NHRkUajSU1NhdF9xVHdNwN4mycnJ8nJyZGRkWjdRcbBDOdQB5dOp9NoNPBXDhj7Q39rUDzo9XqlUgnXkmJcJssM5yAZGRkqlQqO52FWLHsdh8ORnZ0tkUigdszqpWCMc7m5uRKJBArnP%5C%2FmpW9C9FxQUhIaGwqW0GRQhzHCutLRUIBBYrVZwg7q23hri7cPpFGh1KUZECwOcq6qqCgkJWVlZ8XVAaEp5eblQKITTKRjxa6S7c83NzQKBYH5%2BHjDkR%2BwT6urqOBzO7OwsYEIs0dq5zs5OLpeLotLPi3FuQRECl3BE2wTQGdo5hyJxcHCQy%2BXCVeIALsZdgc7OTjabjcZ00RZ6OYesmpycfPjw4eDgIGBCZkEf4PqhMN4AXaOOXs5BZmdnHzx40NvbCxhSKKYDKKJGRkYCAwPRGns0hC7OIbHm5uZYLBacS0c6hbkY4sBpLpfb1NTkeooO0MI59BtdXl4WCoU1NTW%2BDhHjmZyc5HK59Nydgi7OgTdD4p48eUI8iHkLYNQtLCzw%2Bfzy8nJfB4cMLZwDAOzt7cnl8sLCQvgvbhbxhPOmU9AEWjh3eHgYGRmJdurFeA76xa6urpKWfPRdoP6HL51zvlk9U61Wp6SkwI1TMV5na2sLTqeA%5C%2FpcO585hwZdJiYmxsbGokG%5C%2FvgrPTQVG6cHBgVwu1%2Bv1dJhO4TXn0K%5C%2FH7c%2BIeJb42mAwREZGuu7Ui%5C%2FEWKErhdAqtVkvaneKCFtBr6vvxjnMwZJemUqQ%2BU7PZrFAo4AglDAW4nU5xFau8q53XnEPCHRwcDAwMFBcXJycnx8bGJiYm5ubmdnR0wAXCEcXFxWFhYdvb214JAOZSUOlZp9NFRkbCBSERVqu1r6%2BvqKgoOTlZrVZrtVqz2dzV1QXXaPcuXnMO%5C%2Fv3222%5C%2FlcnlERITJZGpubu7p6WlrayssLFSr1VKpFK2xX1FRIRKJ4ABXDDWg9MzhcBgMBqVSCX2y2%2B11dXVyuTwyMtJsNjc1NfX29sKnFhMTI5VKHz165N1dezxyjpjf7%2B%5C%2Fvq9VquVze399%5C%2FdHTkeuXk5GRSUpJYLM7OzpbJZHCVOKYwNzdXUlJSWlpaXV0NB%5C%2FMxGofDkZOTo1AoJiYmYmJiFArF0NAQXCuXdNno6Gh8fLxEIvHizsrecc5qtcpksrS0NLRI%2BXlUVlbeunWLtKAf%5C%2Fenr6%2BNyuUKh8IMPPkhMTPR1cDwCeZOTk3Pr1i2TyYTm0Z1HWVkZm81GGwp4iBecAwBoNJqUlBTSQSLEqkNTU5NUKmXK9ExiUfXw8PCrr77q7u72bZA8BOWwWq02Ozv74ivRU6uoqEBzoDzEU%2BfAm8GVMD8lVl2Pjo5QnZRU69bpdEVFRZ58NZWgmzIajVwu92Y0Ira3t4eHh7vmpyTQU3M6nbGxsWVlZaTjb4GndQiHwyEWiwcGBojhODg4UKvVd%2B7cuX37tkwmc62crqyshISEXHHPIZ8Db2plZeWf%5C%2Fwn3GyY6e2Ih4eHKpUKrpTtynlNrXNzc2w2GxaffOnc5OSkSCQitfSsrKwEBATo9Xq9Xv%2Bzn%5C%2F1MpVIR3wKvSUlJoX4r1bcDZq8ajYbP58NEjunOjY6ORkREuFb1iLi1SqVSPX369LyzV8RT5yorK1GZAJl3enqKOk8fPnz4ySefEN8CL2tqakpPT%5C%2Ffw2ynDarWqVCq4c8MNoKam5oKS3PPnzxMTE%2BEKASTq6ur0ej3wrXMZGRlomUsIMSinp6d%5C%2F%2B9vfeDye6wWjo6NqtdpqtdqZwPHxscVigftS3ACysrLq6%2BtJD8X5ZvjT3bt3f%5C%2Fe735Eas%2BDZ6enpsLAw1wf9g%5C%2FDUOa1WCxNbBLGKmpKS8otf%5C%2FALN3SKysLBw9%2B7d4ODgkJAQIRMQiURMCerF8Pn8jz%5C%2F%2BmFT7hs5tbGyIxeLk5OSvv%5C%2F6aNIkdlZpQAeOtucZ07tGjR7%5C%2F85S8fP35Megu8YGxsTKFQvHr1amlpaXFxcQlDFYuLi4mJiW4L0wkJCR999FFaWtr777%5C%2FvdufI6elpmUzmoTOeOldVVUUszyHhampq3nvvPVS1Bmdr3QCA5ubmzMxMD78d83bU1dWZTCbX4z09PdnZ2VFRUb%5C%2F97W9Jg9rhU6uvr4flOU%5C%2FwQr1VLBaj2hx8MTU19eMf%5C%2Fi9996Dy8VlZGRsb2%2BTnEtNTWVKvfXmQay3uhbLFhcXv%5C%2FrqqyV35bmIiAhSUeot8LRN2G63i8ViNPnZ%2BWbPBhaLdf%5C%2F%2B%5C%2Ff%5C%2F85z%5C%2F37t3j8Xirq6uAICWz2uduHjabTaVSkZ4aYm9vr7m52bWjiNg%2B5wle6IcYGBjg8%5C%2FmoH%2BK86sx5%5C%2FRBMb%2BtiHDDCW1tb5XI52gP3givR67i4ODQrzxM8zVthsOLi4tDe0W5vgChcS0uLRCJBPyPsHMXAZ2G325OSkkhzc0hdlMRHU1lZKRaLvTLA1jvOWSwWqVSanp5Oatp2Tberqqpu375NLBNg5ygGRXhBQcEf%5C%2FhHs9lMnBuAdsUlvqW8vJzNZr9%2B%5C%2FRp443l5xzkAwN7eHhyJNTg46Do2xul0Tk9PJyYmhoaGZmRkhIWFoeYf7Bz1OByOvLw8mUz24sWL6OhopVL57Nkzt%2BPnxsbGNBqNWCyGA5k86X5AeM05%2BLqhoQGOE87NzW1paenr6%2Bvo6CgqKoqLi5NIJIWFhXAwTHl5uUQiYdxCuDcDp9MJxwnD2QJ2u722tjY8PDwyMjIvLw8%2Btfb29uLiYji6u6SkhLiqrucB8P5cQzgfAo6sj42NTUhIMJvN7e3trvMhZDIZ6SDm%2BoC6nJycJCUluc6HsFgsPT09BQUFycnJMTExiYmJZrO5s7PzOiasUD2%5C%2F1UkYApmfnx8WFka6ecz1YbFYYmJi0AYbV0%2B3vJsXed85Ut0HuEylJJ41mUzh4eHeneKBccv29rZSqUxLS0PlNlIV1VVB1%2BflFa4lnftBQTQYDAqFAo0EvI7w%2BDPON2teiUQik8lEh0HOvl%2BvBACQmpqqVqtxandNLC4uCgSCR48e%2BTog%5C%2F8OXzsEd4gAAsH0yISGBDqtp3DCmpqb4fH5FRQX8F6dz3xcUjo6O4uPjdTqdHa%5C%2FO5DEoVsfGxlgsFnHveH93jgTcmNVgMNyMOQc%2BZ2BgICgoCI7NpFVk0sI59PuzWq0RERF4XJ3nwC1KvvvuO%5C%2FgvHZI3BF2cI%5C%2FahhYeHm81m3waJ0dTX1%5C%2FN4vNHRUfiv1xs7PIQWzpHY29sLDQ1l0KRrn0MsqFVUVHC53FevXvk0RBdBL%2BdQ3O3u7oaEhJSWlvo6RAyAmIwVFBTw%2BXzUkU2r5A1BL%2BcAQbu1tbWQkJDKykpfh4jWEMUyGo0ymWxzcxPQWDhAQ%2BcAoZK1sLAgEAjQtAnaRiL1kIZVnp6epqSkqFQq4kRo2kYXHZ0jMjc3x%2Bfz4TZCtI1EikF9oKiyr9FoYmNjmdJ%5C%2FSF%5C%2FnUO4wMzPD5XLb29t9HSIagSJnb28vKipKp9PBnntG7OVCX%2BcAIQbHx8cDAwPhmkgYxPb2dlhYWFZWFppKQ%2BdiHILWzhEZGxv75ptv6L8h7vVBUmptbU0oFBYUFKCzvgvaD4MZzsEIHR4eDgwMfPbsGWBUFHsR5NyrV694PB5xPz4GRQhjnINxCtf1RS3sfgWyampqisViofVEGFGGI8IM5wAhxjs7O3k83vT0NOn4TYU0WPfZs2fBwcFoG2qmlOGIMMY5Iq2trTweb2ZmBtx052CDCErJurq6OBwO09eXZaRzAICGhgaBQHADtmq4FNSR2tTUxOVyh4eHATOTNwTDnCNGdHV1NZvN9pPZilVVVTweb2pqClzb1BjKYJhzJOAYCtjDCJic3ZAgLeDw6NEjPp%2B%5C%2FsLAAmFZFdQuznQMAFBcXi0Qi1LHt6%2BB4B6JYZrM5NDR0Y2PDt0HyIgx2DpWs8%5C%2FPzw8PD3a7zzVBQz316enpERIRXdp%2BhD8xwjvi739nZIW2L4XQ6s7OzlUqld5fV8BUw8EdHR0lJSdHR0RMTE52dnfBgXV2dQCBg%2BrBCBjjnfLNA1fHxcVlZ2RdffOG2TTgjIyMqKgoua8e4ZlII%2BrXARR5SUlJGR0c%5C%2F%2B%2Byze%5C%2FfuAQCGh4f%5C%2F8Y9%5C%2FZGZmfvTRR729vYCxZQkGOAfePIzDw0Oj0fj%2B%2B%2B%2BjqSVE7Ha7Xq8nbcLMLGCYt7e3VSpVenq63W632Wzp6en%5C%2Fe9%5C%2FAQBms5nP5wMAlEqlWq0GzLxHwCDnYDOVxWJ58OABqacfJQ%5C%2FHx8dJSUnweTCUjY0NkUiUk5ODfOro6Hjw4AEAICUlJTw8HACg0WgkEokvQ%2BkZjHHO%2BWa42P379y%5C%2FYA%2Bnk5ARu7Y0mydI8MSC2tC0vL%5C%2FP5%5C%2FJKSEuIFbW1tDx8%2BBABkZ2eLRCIAQExMDNxCjea3dh4Mc255efnLL7%5C%2Fs6uo67zIAgMPhUKlUBoMBLglA8weDip6zs7NsNps0%5C%2F2N3dzcxMfGvf%5C%2F3r7Oxsb2%5C%2FvZ599VldX9%2BmnnzJ64DRjnAMAHBwc6PX6P%5C%2F5zxKJ5Lz2Knil1WqNjIzMysqiNJQe8OLFCzabDU0iMjMzEx0dLRaLa2pqjo6OsrOzAwICtFrt6empkx4LQbwFzHAOYrfbX79%2BPTc3Nzc3d94%2BkMRcWC6X5%2BXlweM0rMmi8PT19XE4HLRf%5C%2FMXhRDdO%5C%2F2LDeTDJuR%5C%2FKzs6OTCYrLCyE%5C%2F9LqCaHAtLW1sdlsvxr%5C%2FfGOdg%5C%2FnO%2Bvq6RCJx3eeOJtTX1%5C%2FP5%5C%2FLGxMV8HhFJusnMwLVlZWeHxeDScm11WViYQCGZnZwHN0uDr5sY6R2RlZSUoKAjtkuurB0ws9cNFHpaXl30SEt%5C%2FiF84BAJaWloir%5C%2FmkxocWFTUajWKxeGdnh%5C%2Fow0AG%5C%2FcA4mbNPT0zwer62tzYchOT4%2Bhos87O%5C%2FvAz%5C%2FLUhH%2B4hx8umNjYxwOB%2B02RllzA%5C%2FwWm80WHx%2Bv0Wi8slMbc%5C%2FEL54iMjIyw2ez%2B%5C%2Fn74LwXawc%5C%2Ff3d2NiopKSUnB63T7nXMAgMHBQQ6Hg%2BZmU5DUbW1twUUeGNpz4F38yzlkWE9PT0BAAJzSct1sbm7yeLyCggLUHUzBl9IZ%5C%2F3KOyNOnTwMCAlDzmNdTO%5C%2FiB8%5C%2FPzwcHB5eXl3v1wRuO%5C%2FzoE3%5C%2FU5obrbXtRsdHeVwOKhdEAPxa%2BcAAA0NDcRpfF785KGhIeKyef7ZLOIWf3cOAFBdXS0UCldXV%2BG%5C%2FXknwnj59yuVyiQvmYecQ2DkAACgvLxeJRFA7z0c9NTY2crncFy9eeCl0Nw3s3P8oLi6WSqVwW2ZPtKuoqODz%2BZOTk4DJQ9yuFezc97leXl6eRCKBW3q6unJ8fGy1WuGksvMoLS1ls9mvX79Gn4ydcwU7d4bs7OywsDBi39T09HRhYWFUVJRYLBYIBBKJJDo6urCwELXtoVY3k8nE4%5C%2FH8tuf%2B6mDnyBgMhqioKJvNtrS0pNVqxWJxZmZmd3f3%5C%2FPz85ubm%5C%2FPx8d3d3VlaWRCLR6XRLS0sAgJOTE4PBIJfL9%5C%2Fb2AG71vQzs3PegFCszM5PH4%5C%2FF4vPz8fFjCc2VnZ8dsNgsEgq6uLr1er1arGb2EAJVg584AdRkcHPz888%2BJw0%5C%2FA2VXfkFW9vb13794ViUSw5550FuMW7ByZ7e1toVCIFgQ5zyF0sKurSywWw1wVcxWwc2Ty8vJSU1Pha6Jz29vbw8PDaDVZoovp6eloUiPmUrBzZ7BYLMHBwevr6%2BBsc0lpaem77777q1%5C%2F96p133gkPD7fZbM43q0UBABYXF0Ui0U1alvBawc6doaWlJT4%2BnnTQ6XTW1NTk5%2BcvLCyYTKYf%5C%2FehHra2tpGu0Wi3ekeyKYOfOkJaWRhoGQlqiYXBw8De%5C%2F%2BQ2qXiAqKiry8%5C%2FOpCCLzwc6dISIiYmRkhHQQZqBbW1tisfjdd9%2BNjo4mWogGgep0OrQYFIVBZh7YuTOEh4e7Dh6G1YXd3d20tLQvvvjiyy%2B%5C%2FhGOf0FkAwODgYEJCAiNWgvI52LkzxMXFwVYSIkSH9vb2fv3rXxuNRtI1zc3NGRkZqCXvmoPJbLBzZygoKHAtljkcjpWVFfh6eXn55z%5C%2FudlsJl2Tm5uLB6BfEezcGaampgQCgWuHKZvNvnPnTkhIyO9%5C%2Ftbt24tLi4Szx4eHioUCrTUDU7nLgY7R0Ymk8F1PIk9XUNDQ1Kp9N69ewqFAg5VIjYXd3Z2RkRE4ImrVwQ7R2ZwcJDP56MRIhDSNUTh9vf3Q0JC0CRtzKVg574HmZSenh4XF4eGZ5J6XYmvj46OYmNjMzIyfBNiZoKdO4PzzR40Go0mOjp6bW2NeIrU37%2ByshIVFaXRaC4ePIwhgZ1zz%5C%2FHxsclkCg0NffTokesqccvLy0%2BePBEKhWazGW2BgqsOVwQ7dxEjIyM6nU4sFqtUKr1en52drdfrlUqlSCTS6XQTExPoSuzc1cHOuYco0MbGxsDAQHl5eUFBQWVl5eDgIHEICbQNDw%2B%2BOtg5DNVg5zBUg53DUA12DkM12DkM1WDnMFSDncNQDXYOQzXYOQzVYOcwVIOdw1ANdg5DNdg5DNVg5zBUg53DUA12DkM12DkM1WDnMFSDncNQDXYOQzXYOQzVYOcwVPP%5C%2FEY47Yz1wt7QAAAAASUVORK5CYII%3D%29%5Cn%5CnFor%20example%2C%20given%20the%20graph%20in%20the%20sample%20%284%20cities%20and%20ranked%20list%20%5C%5C%5B2%201%5C%5C%5D%29%5Cn%5Cn%201-%20Query%28k%3D0%2C%20Src%3D3%2C%20dest%3D4%29%3A%20means%20no%20cities%20to%20use%20as%20intermediate%2C%20hence%20only%20direct%20path%20allowed%20%5Cu00e0%203-4%20with%20%2A%2Acost%2010%2A%2A%5Cn%5Cn2-%20Query%28k%3D1%2C%20Src%3D3%2C%20dest%3D4%29%3A%20means%20we%20can%20use%20first%20city%20on%20list%20%282%29%2C%20hence%20we%20can%20choose%20between%20paths%20%283-4%2C%203-2-4%29%20%5Cu00e0%20path%203-2-4%20with%20%2A%2Acost%208%2A%2A%20is%20best%5Cn%5Cn3-%20Query%28k%3D2%2C%20Src%3D3%2C%20dest%3D4%29%3A%20means%20we%20can%20use%20first%202%20cities%20on%20list%20%281%2C%202%29%2C%20hence%20we%20can%20choose%20between%20paths%20%283-4%2C%203-2-4%2C%203-2-1-4%29%20%5Cu00e0%20path%203-2-1-4%20with%20%2A%2Acost%206%2A%2A%20is%20best%5Cn%5Cn%20%2A%2AInput%20Specification%3A%2A%2A%5Cn%5CnThe%20first%20line%20of%20input%20contains%20an%20integer%20T%20that%20represents%20the%20number%20of%20test%20cases%2C%20then%20follow%20T%20test%20cases%2C%20each%20in%20following%20format%3A%5Cn%5Cn%2A%2ALine%201%2A%2A%5Cn%5Cn%20N%20%281%5Cn%5Cn%2A%2AN-1%20lines%20follow%2C%2A%2A%20_where%20ith%20line%20represents%20ith-_%20city%20_connections%27%20costs%2C%20Ci%2Cj%20is%20the%20cost%20of%20edge%20%28i%2C%20j%29%2C%20if%20there%20is%20no%20edge%20between%20i%2C%20j%20then%20Ci%2C%20j%20%3D%20-1%20else%2C%201_%20%20Ci%2Cj%2010000%5Cn%5Cn%20C1%2C%202%20C1%2C%203%20...%20C1%2C%20N%5Cn%5Cn%20C2%2C%203%20C2%2C%204%20...%20C2%2C%20N%5Cn%5Cn%20...%5Cn%5Cn%20CN-1%2C%20N%5Cn%5Cn%2A%2ALine%20N%2B1%2A%2A%5Cn%5Cn%20P%20%280%5Cn%5Cn%2A%2ALine%20N%2B2%2A%2A%5Cn%5Cn%20P%20space-separated%20list%20of%20distinct%20cities%20ids%20%281%20%3C%3D%20city%20id%20%3C%3D%20N%29%5Cn%5Cn%2A%2ALine%20N%2B3%2A%2A%5Cn%5Cn%20Q%20%281%5Cn%5Cn%2A%2AQ%20lines%20follow%2A%2A%5Cn%5Cn%20K%20source%20destination%5Cn%5Cn....%5Cn%5CnNote%20that%3A%200%5Cn%5Cn%2A%2AOutput%20Specification%3A%2A%2A%5Cn%5CnFor%20each%20test%20case%2C%20output%20a%20single%20line%20of%20output%20in%20the%20form%20%2A%2A%5Cu201cCase%20K%3A%20A1%20A2%20%5Cu2026Aq%5Cu201d%2A%2A%20where%20K%20is%20the%20number%20of%20the%20test%20case%20and%20%5C%5C%5BA1%20A2%20%5Cu2026%20Aq%5C%5C%5D%20are%20the%20answers%20for%20the%20Q%20quires.%20Each%20answer%20is%20the%20shortest%20path%20cost%20between%20the%202%20given%20cities%20using%20the%20first%20only%20K%20cities%20of%20given%20list%20as%20intermediate%20cities.%20In%20case%20no%20path%20between%202%20cities%2C%20the%20answer%20is%20-1%5Cn%5Cn%2A%2ASample%20input%3A%2A%2A%5Cn%5Cn1%5Cn%5Cn4%5Cn%5Cn%2A%2A2%20-1%203%2A%2A%5Cn%5Cn%2A%2A1%207%2A%2A%5Cn%5Cn%2A%2A10%2A%2A%5Cn%5Cn2%5Cn%5Cn%2A%2A2%201%2A%2A%5Cn%5Cn3%5Cn%5Cn%2A%2A0%203%204%2A%2A%5Cn%5Cn%2A%2A1%203%204%2A%2A%5Cn%5Cn%2A%2A2%203%204%2A%2A%5Cn%5Cn%2A%2ASample%20Output%3A%2A%2A%5Cn%5CnCase%201%3A%2010%208%206%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B2426%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F9969%22%2C%22id%22%3A%229969%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP9969%22%2C%22title%22%3A%22RDNWK%20-%20Road%20Network%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22RDNWK%20-%20Road%20Network%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>RDNWK - Road Network</h1>
<h2>题目描述</h2>
<div>In a country of N cities, the government would like to develop a new system that can answer drivers’ queries to find the shortest path between 2 cities in the country road network. However, some cities are more exciting than others, and drivers would prefer driving through them. Last month, a voting for the most exciting cities in the country was conducted, and a ranking of the P most exciting cities has been made. The government decided to utilize this ranking so that drivers can find the shortest path between 2 cities that only goes through the first K cities of the ranking as intermediate cites on the road. Hence, the query is defined as: the source city, the destination city, and K for the first K cities from the ranking. (Note that some cities may not be exciting at all, and so they will not be included in the ranking, i.e. P <= N)
Given undirected graph representing the country cities, and ranked list of exciting cities, you are to answer Q quires, each one asking for the shortest path between 2 cities utilizing only the first K cities from the ranked list.
![](data:image/png;base64,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)
For example, given the graph in the sample (4 cities and ranked list \[2 1\])
1- Query(k=0, Src=3, dest=4): means no cities to use as intermediate, hence only direct path allowed à 3-4 with **cost 10**
2- Query(k=1, Src=3, dest=4): means we can use first city on list (2), hence we can choose between paths (3-4, 3-2-4) à path 3-2-4 with **cost 8** is best
3- Query(k=2, Src=3, dest=4): means we can use first 2 cities on list (1, 2), hence we can choose between paths (3-4, 3-2-4, 3-2-1-4) à path 3-2-1-4 with **cost 6** is best
**Input Specification:**
The first line of input contains an integer T that represents the number of test cases, then follow T test cases, each in following format:
**Line 1**
N (1
**N-1 lines follow,** _where ith line represents ith-_ city _connections' costs, Ci,j is the cost of edge (i, j), if there is no edge between i, j then Ci, j = -1 else, 1_ Ci,j 10000
C1, 2 C1, 3 ... C1, N
C2, 3 C2, 4 ... C2, N
...
CN-1, N
**Line N+1**
P (0
**Line N+2**
P space-separated list of distinct cities ids (1 <= city id <= N)
**Line N+3**
Q (1
**Q lines follow**
K source destination
....
Note that: 0
**Output Specification:**
For each test case, output a single line of output in the form **“Case K: A1 A2 …Aq”** where K is the number of the test case and \[A1 A2 … Aq\] are the answers for the Q quires. Each answer is the shortest path cost between the 2 given cities using the first only K cities of given list as intermediate cities. In case no path between 2 cities, the answer is -1
**Sample input:**
1
4
**2 -1 3**
**1 7**
**10**
2
**2 1**
3
**0 3 4**
**1 3 4**
**2 3 4**
**Sample Output:**
Case 1: 10 8 6</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
