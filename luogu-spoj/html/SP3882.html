<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>CIJEVI - Cijevi - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573449828:+Y05Xw3Q2JWIzi4S3ifrQLGGxg5PWsp43vnHOmUkMTo=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22%20%5BEnglish%5D%28%5C%2Fproblems%5C%2FCIJEVI%5C%2Fen%5C%2F%29%20%5BVietnamese%5D%28%5C%2Fproblems%5C%2FCIJEVI%5C%2Fvn%5C%2F%29To%20help%20design%20the%20new%20gas%20pipeline%20which%20will%20be%20used%20to%20deliver%20Russian%20gas%20to%20Croatia%2C%20Zagreb%20and%20Moscow%20are%20using%20the%20computer%20game%20Pipe%20Mania.%20In%20the%20game%2C%20Europe%20is%20divided%20into%20R%20rows%20and%20C%20columns.%20Each%20cell%20can%20be%20empty%20or%20contain%20one%20of%20the%20seven%20basic%20pipeline%20building%20blocks%3A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP3882%5C%2F678f6ebd902db14c54549869b81af41b0e76e108.png%29%5Cn%5CnGas%20flows%20from%20Moscow%20to%20Zagreb.%20Gas%20can%20flow%20in%20either%20direction%20through%20the%20building%20blocks.%20Block%20%27%2B%27%20is%20special%20in%20that%20gas%20must%20flow%20in%20two%20directions%20%28one%20vertical%2C%20one%20horizontal%29%2C%20as%20in%20the%20following%20example%3A%5Cn%5Cn%21%5B%5D%28https%3A%5C%2F%5C%2Fcdn.luogu.com.cn%5C%2Fupload%5C%2Fvjudge_pic%5C%2FSP3882%5C%2Fed558c8ede3b8c091a8e0b6d010d1a23c7e411a2.png%29%5Cn%5CnWork%20on%20the%20new%20pipeline%20had%20already%20started%20when%20it%20was%20found%20that%20malicious%20hackers%20got%20hold%20of%20the%20plan%20and%20erased%20exactly%20one%20building%20block%20from%20the%20plan%20i.e.%20replaced%20it%20with%20an%20empty%20cell.%5Cn%5CnWrite%20a%20program%20that%20determines%20where%20the%20block%20was%20erased%20from%20and%20what%20type%20it%20was.%22%2C%22inputFormat%22%3A%22The%20first%20line%20contains%20two%20integers%20R%20and%20C%2C%20the%20dimensions%20of%20Europe%20%281%5Cn%5CnThe%20following%20R%20lines%20contain%20the%20plan%2C%20each%20consisting%20of%20exactly%20C%20characters.%20The%20characters%20are%3A%5Cn%5Cn-%20Period%20%28%27.%27%29%2C%20representing%20an%20empty%20cell%3B%5Cn-%20The%20characters%20%27%7C%27%20%28ASCII%20124%29%2C%20%27-%27%2C%20%27%2B%27%2C%20%271%27%2C%20%272%27%2C%20%273%27%2C%20%274%27%2C%20representing%20the%20building%20block%20types%3B%5Cn-%20The%20letters%20%27M%27%20and%20%27Z%27%2C%20representing%20Moscow%20and%20Zagreb.%20Each%20of%20these%20will%20appear%20exactly%20once%20in%20the%20plan.%5Cn%5CnThe%20flow%20of%20gas%20will%20be%20uniquely%20determined%20in%20the%20input%3B%20exactly%20one%20building%20block%20will%20be%20adjacent%20to%20each%20of%20Moscow%20and%20Zagreb.%20Additionally%2C%20the%20plan%20will%20not%20have%20redundant%20blocks%20i.e.%20all%20blocks%20in%20the%20plan%20must%20be%20used%20after%20the%20missing%20block%20is%20added.%5Cn%5CnThe%20input%20will%20be%20such%20that%20a%20solution%20will%20exist%20and%20it%20will%20be%20unique.%22%2C%22outputFormat%22%3A%22Output%20the%20row%20and%20column%20of%20the%20erased%20block%2C%20and%20the%20type%20of%20the%20block%20%28one%20of%20the%20seven%20characters%20as%20in%20the%20input%29.%22%2C%22samples%22%3A%5B%5B%223%207%5Cr%5Cn.......%5Cr%5Cn.M-.-Z.%5Cr%5Cn.......%22%2C%222%204%20-%5Cr%5Cn%5Cr%5Cn%5Cr%5CnInput%5Cr%5Cn3%205%5Cr%5Cn..1-M%5Cr%5Cn1-%2B..%5Cr%5CnZ.23.%5Cr%5Cn%5Cr%5CnOutput%5Cr%5Cn2%204%204%5Cr%5Cn%5Cr%5Cn%5Cr%5CnInput%5Cr%5Cn6%2010%5Cr%5CnZ.1----4..%5Cr%5Cn%7C.%7C....%7C..%5Cr%5Cn%7C..14..M..%5Cr%5Cn2-%2B%2B%2B4....%5Cr%5Cn..2323....%5Cr%5Cn..........%5Cr%5Cn%5Cr%5CnOutput%5Cr%5Cn3%203%20%7C%22%5D%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B213%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F3882%22%2C%22id%22%3A%223882%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP3882%22%2C%22title%22%3A%22CIJEVI%20-%20Cijevi%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22CIJEVI%20-%20Cijevi%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>CIJEVI - Cijevi</h1>
<h2>题目描述</h2>
<div> [English](/problems/CIJEVI/en/) [Vietnamese](/problems/CIJEVI/vn/)To help design the new gas pipeline which will be used to deliver Russian gas to Croatia, Zagreb and Moscow are using the computer game Pipe Mania. In the game, Europe is divided into R rows and C columns. Each cell can be empty or contain one of the seven basic pipeline building blocks:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/SP3882/678f6ebd902db14c54549869b81af41b0e76e108.png)
Gas flows from Moscow to Zagreb. Gas can flow in either direction through the building blocks. Block '+' is special in that gas must flow in two directions (one vertical, one horizontal), as in the following example:
![](https://cdn.luogu.com.cn/upload/vjudge_pic/SP3882/ed558c8ede3b8c091a8e0b6d010d1a23c7e411a2.png)
Work on the new pipeline had already started when it was found that malicious hackers got hold of the plan and erased exactly one building block from the plan i.e. replaced it with an empty cell.
Write a program that determines where the block was erased from and what type it was.</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div>The first line contains two integers R and C, the dimensions of Europe (1
The following R lines contain the plan, each consisting of exactly C characters. The characters are:
- Period ('.'), representing an empty cell;
- The characters '|' (ASCII 124), '-', '+', '1', '2', '3', '4', representing the building block types;
- The letters 'M' and 'Z', representing Moscow and Zagreb. Each of these will appear exactly once in the plan.
The flow of gas will be uniquely determined in the input; exactly one building block will be adjacent to each of Moscow and Zagreb. Additionally, the plan will not have redundant blocks i.e. all blocks in the plan must be used after the missing block is added.
The input will be such that a solution will exist and it will be unique.</div>
<h3>输出格式</h3>
<br />
<div>Output the row and column of the erased block, and the type of the block (one of the seven characters as in the input).</div>
<h2>输入输出样例</h2>
<h3>输入样例 #1</h3>
<pre><code>3 7
.......
.M-.-Z.
.......</code></pre>
<h3>输出样例 #1</h3>
<pre><code>2 4 -


Input
3 5
..1-M
1-+..
Z.23.

Output
2 4 4


Input
6 10
Z.1----4..
|.|....|..
|..14..M..
2-+++4....
..2323....
..........

Output
3 3 |</code></pre>
</article>
</div>
</div>
</body>
</html>
