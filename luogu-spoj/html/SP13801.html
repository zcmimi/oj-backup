<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>DEXTER - Dexter Rank - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450364:+EnR1U+e6atF6Eo9Ch4ZbL3Uwki87bYaGczAEKkNQZ4=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Dexter%20just%20participated%20in%20a%20coding%20contest%20and%20is%20now%20waiting%20for%20judge%20to%20give%20final%20result%20.%20He%20is%20very%20bored%20of%20waiting%20every%20time%20for%20result%20and%20now%20wants%20to%20find%20his%20expected%20rank%20based%20on%20current%20scoreboard%20and%20chances%20of%20failure%20for%20problems.%20Formally%20there%20are%20M%20problems%20in%20the%20contest%20and%20there%20are%20N%20coders%20in%20the%20contest.%20Dexter%20knows%20that%20coder%20i%20has%20submitted%20problem%20j%20with%20penalty%20of%20penalty%5C%5C%5Bi%5C%5C%5D%5C%5C%5Bj%5C%5C%5D%20.%20Dexter%20knows%20that%20problem%20j%20will%20pass%20with%20probability%20prob%5C%5C%5Bj%5C%5C%5D%20%28%20this%20also%20applies%20for%20Dexter%20himself%20also%20%3A%29%20%29%20.%20This%20is%20independent%20for%20each%20coder%20and%20problem.%20Now%20Dexter%20wants%20to%20know%20what%20would%20be%20his%20expected%20rank%20after%20system%20test.%20%20%20%5Cn%20%20%5CnNote%3A%20Coders%20are%20ranked%20based%20on%20number%20of%20correct%20solution%2C%20then%20total%20penalty%20for%20correct%20solutions.%20If%20there%20is%20tie%20even%20after%20that%2C%20all%20coders%20with%20same%20problems%20and%20penalty%20are%20given%20same%20rank.%20%20%5Cn%20%20%5CnExample%20%3A%20After%20system%20test%20if%20scoreboard%20is%20like%20this%20%3A%20%20%5Cn%20%20%5CnCoder%201%20%3A%20300%20-1%20-1%20Score%20%3A%201%20Penalty%20%3A%20300%20%20%5CnCoder%202%20%3A%20100%20-1%20200%20Score%20%3A%202%20Penalty%20%3A%20300%20%20%5CnCoder%203%20%3A%20-1%20300%20-1%20Score%20%3A%201%20Penalty%20%3A%20300%20%20%5CnCoder%204%20%3A%20-1%20-1%20400%20Score%20%3A%201%20Penalty%20%3A%20400%20%20%5Cn%20%20%5CnRanks%20would%20be%20%3A%202%201%202%204%20%20%5Cn%20%20%5CnINPUT%20%3A%20%20%5CnThe%20first%20line%20of%20input%20contains%20a%20single%20line%20T%20%2C%20which%20represents%20the%20number%20of%20test%20cases.%20F%20%20%5CnFor%20each%20test%20case%20first%20line%20contains%20two%20space%20separated%20integers%20N%20and%20M%20.%20%20%5CnThen%20Next%20N%20lines%20contains%20M%20integers%20%2C%20j%5Cu2019th%20integer%20on%20i%5Cu2019th%20is%20penalty%5C%5C%5Bi%5C%5C%5D%5C%5C%5Bj%5C%5C%5D%20which%20means%20penalty%20for%20ith%20coder%20on%20problem%20j%20%2C%20if%20he%20submitted%20j%5Cu2019th%20problem%2C%20otherwise%20it%20is%20-1%20.%20%20%5CnDexter%20is%20first%20coder%20in%20the%20list%20.%20%20%5CnThen%20next%20line%20contains%20M%20space%20separated%20integers%2C%20where%20ith%20integer%20denotes%20probability%20of%20passing%20problem%20i%20in%20system%20test%2C%20if%20submitted.%20%20%5Cn%20%20%5Cn%20%20%5CnOUTPUT%3A%20%20%5CnPrint%20the%20expected%20rank%20of%20the%20Dexter%20after%20system%20test%20with%20exactly%204%20decimal%20places.%20%20%5Cn%20%20%5CnCONSTRAINTS%20%20%20%5Cn1%20%3C%3D%20T%20%3C%3D%2016%20%20%5Cn2%20%3C%3D%20N%20%3C%3D%20256%20%20%5Cn1%20%3C%3D%20M%20%3C%3D%2012%20%20%5Cn1%20%3C%3D%20penalty%5C%5C%5Bi%5C%5C%5D%5C%5C%5Bj%5C%5C%5D%20%3C%3D%201000000%20or%20penalty%5C%5C%5Bi%5C%5C%5D%5C%5C%5Bj%5C%5C%5D%20%3D%20-1%20%20%5Cn0%20%3C%3D%20prob%5C%5C%5Bi%5C%5C%5D%20%3C%3D%20100%20%20%5Cn%20%20%5Cn%20%20%20%5CnEXAMPLE%20%20%5Cn%20%20%5CnINPUT%3A%20%20%5Cn%20%20%5Cn3%20%20%5Cn2%201%20%20%5Cn100%20%20%5Cn150%20%20%5Cn50%20%20%5Cn2%202%20%20%5Cn-1%20-1%20%20%5Cn10%20-1%20%20%5Cn0%20100%20%20%5Cn3%202%20%20%5Cn100%20200%20%20%5Cn-1%20199%20%20%5Cn99%20-1%20%20%5Cn50%2050%20%20%5Cn%20%20%5Cn%20%20%5CnOUTPUT%3A%20%20%5Cn1.2500%20%20%5Cn1.0000%20%20%5Cn1.6250%20%20%5Cn%20%20%5Cn%20%20%5CnEXPLANATION%20%3A%20%20%5CnFor%20sample%20case%201%20%2C%20Dexter%20would%20have%20first%20rank%20if%20his%20solution%20passes%20or%20coder-2%5Cu2019s%20solution%20fails%20system%20test%20which%20has%20probability%200.75%20%2C%20otherwise%20he%20would%20have%20rank%202%20%20%5Cnanswer%20%3D%201%5C%5C%2A0.75%20%2B%200.25%5C%5C%2A2%20%3D%201.2500%20%20%5Cn%20%20%5CnFor%20sample%20case%202%20%2C%20All%20coders%20would%20be%20on%20rank%201%20with%200%20problem%20solved%20and%200%20penalty%20in%20all%20cases%20%2C%20so%20answer%20%3D%201.0000%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B4000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F13801%22%2C%22id%22%3A%2213801%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP13801%22%2C%22title%22%3A%22DEXTER%20-%20Dexter%20Rank%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22DEXTER%20-%20Dexter%20Rank%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1573363392;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>DEXTER - Dexter Rank</h1>
<h2>题目描述</h2>
<div>Dexter just participated in a coding contest and is now waiting for judge to give final result . He is very bored of waiting every time for result and now wants to find his expected rank based on current scoreboard and chances of failure for problems. Formally there are M problems in the contest and there are N coders in the contest. Dexter knows that coder i has submitted problem j with penalty of penalty\[i\]\[j\] . Dexter knows that problem j will pass with probability prob\[j\] ( this also applies for Dexter himself also :) ) . This is independent for each coder and problem. Now Dexter wants to know what would be his expected rank after system test.
Note: Coders are ranked based on number of correct solution, then total penalty for correct solutions. If there is tie even after that, all coders with same problems and penalty are given same rank.
Example : After system test if scoreboard is like this :
Coder 1 : 300 -1 -1 Score : 1 Penalty : 300
Coder 2 : 100 -1 200 Score : 2 Penalty : 300
Coder 3 : -1 300 -1 Score : 1 Penalty : 300
Coder 4 : -1 -1 400 Score : 1 Penalty : 400
Ranks would be : 2 1 2 4
INPUT :
The first line of input contains a single line T , which represents the number of test cases. F
For each test case first line contains two space separated integers N and M .
Then Next N lines contains M integers , j’th integer on i’th is penalty\[i\]\[j\] which means penalty for ith coder on problem j , if he submitted j’th problem, otherwise it is -1 .
Dexter is first coder in the list .
Then next line contains M space separated integers, where ith integer denotes probability of passing problem i in system test, if submitted.
OUTPUT:
Print the expected rank of the Dexter after system test with exactly 4 decimal places.
CONSTRAINTS
1 <= T <= 16
2 <= N <= 256
1 <= M <= 12
1 <= penalty\[i\]\[j\] <= 1000000 or penalty\[i\]\[j\] = -1
0 <= prob\[i\] <= 100
EXAMPLE
INPUT:
3
2 1
100
150
50
2 2
-1 -1
10 -1
0 100
3 2
100 200
-1 199
99 -1
50 50
OUTPUT:
1.2500
1.0000
1.6250
EXPLANATION :
For sample case 1 , Dexter would have first rank if his solution passes or coder-2’s solution fails system test which has probability 0.75 , otherwise he would have rank 2
answer = 1\*0.75 + 0.25\*2 = 1.2500
For sample case 2 , All coders would be on rank 1 with 0 problem solved and 0 penalty in all cases , so answer = 1.0000</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
