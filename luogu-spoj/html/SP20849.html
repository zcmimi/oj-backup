<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>IQUERY - Interesting queries - 洛谷</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta name="csrf-token" content="1573450550:80rWTxHji43PSlAtiJxns5NtHGGRXpHZQ0Ii4KdsPAw=">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" media="screen"/>
<link rel="stylesheet" href="https://cdn.luogu.com.cn/fe/loader.css?ver=20191106">
<script>window._feInjection = JSON.parse(decodeURIComponent("%7B%22code%22%3A200%2C%22currentTemplate%22%3A%22ProblemShow%22%2C%22currentData%22%3A%7B%22problem%22%3A%7B%22background%22%3Anull%2C%22description%22%3A%22Students%20of%20Computer%20Science%20department%20at%20NIT%20Durgapur%20were%20becoming%20extremely%20bored%20and%20frustrated%20due%20to%20too%20many%20classes%20%28%20weird%20but%20we%20had%20many%20classes%20%29.%20As%20semesters%20were%20approaching%20%2C%20students%20were%20preparing%20hard%20to%20get%20good%20grades.%20Everyone%20was%20nervous%20about%20the%20Algorithms%20exam%20which%20is%20going%20to%20be%20held%202%20days%20later.%20To%20add%20to%20their%20discomfort%2C%20one%20question%20came%20in%20the%20exam%20which%20took%20many%20one%20by%20surprise.%20The%20question%20was%20simple%20but%20everyone%20was%20told%20to%20optimize%20code%20as%20much%20as%20possible.%5Cn%5CnNow%20its%20your%20turn%2C%20and%20the%20question%20states%20that%20there%20is%20intially%20an%20array%20of%20N%20non-negative%20numbers%20%281-based%20indexing%29%20and%20based%20on%20that%20array%20we%20have%20to%20run%20Q%20queries.%20Now%20we%20can%20do%20three%20things%20in%20each%20query.%20We%20have%20to%20sometimes%20calculate%20sum%20of%20product%20of%20all%20subsets%20of%20a%20number%20within%20a%20range%2C%20sometimes%20to%20calculate%20sum%20of%20Bitwise%20AND%20of%20all%20subsets%20of%20a%20number%2C%20sometimes%20to%20update%20an%20element%20of%20an%20array.%20All%20the%20calculations%20are%20to%20be%20performed%20modulus%20%28109%2B7%29.%20If%20we%20have%20to%20do%20sum%20of%20products%20then%20the%20query%20is%20given%20%27M%27%2C%20if%20Bitwise%20AND%20then%20%27A%27%20else%20if%20update%20then%20%27U%27.%20For%20more%20details%20%2C%20see%20Explanation%20section%20.%5Cn%5Cn%2A%2ANote%20%3A%2A%2A%20Bitwise%20AND%20operator%20is%20defined%20as%20%26%20in%20C%20%2CC%2B%2B%20and%20in%20most%20of%20the%20languages.%20For%20other%20programming%20languages%20see%20your%20language%20documentation.%5Cn%5Cn%2A%2AInput%20Format%2A%2A%20%20%5CnFirst%20line%20contains%20N%2C%20which%20denotes%20the%20number%20of%20elements%20in%20an%20array.%20Next%20line%20contains%20N%20integers%20denoting%20the%20number%20of%20integers%20in%20the%20array.%20Then%20Q%20denoting%20the%20number%20of%20queries%20and%20after%20that%20each%20line%20consists%20of%203%20integers.%20If%20it%20is%20%27M%27%20then%20we%20have%20to%20do%20product%2C%20if%20%27A%27%20then%20Bitwise%20AND%20and%20if%20%27U%27%20then%20update.%20If%20it%20is%20%27M%27%20or%20%27A%27%20then%20it%20is%20followed%20by%20i%20and%20j%20which%20is%20the%20range%20of%20that%20array.%20If%20%27U%27%20then%20we%20have%20the%20positon%20and%20the%20value%20to%20be%20updated%20at%20that%20position.%5Cn%5Cn%2A%2AOutput%20Format%2A%2A%20%20%5CnCorresponding%20to%20each%20query%20we%20have%20an%20output%20only%20to%20query%20of%20%27M%27%20and%20%27A%27.%20For%20update%20you%20dont%20have%20to%20print%20anything.%5Cn%5Cn%2A%2AConstraints%2A%2A%20%20%5Cn1%205%20%20%5Cn1%205%20%20%5Cn1%205%20%20%5Cn1%205%20%20%5CnThe%20element%20to%20be%20updated%20is%20of%20maximum%20value%20of%20105.%5Cn%5Cn%2A%2ASample%20Input%2A%2A%20%20%5Cn3%20%20%5Cn1%202%203%20%20%5Cn5%20%20%5CnM%201%203%20%20%5CnA%201%203%20%20%5CnU%202%205%20%20%5CnM%201%203%20%20%5CnA%201%203%5Cn%5Cn%2A%2ASample%20Output%2A%2A%20%20%5Cn23%20%20%5Cn9%20%20%5Cn47%20%20%5Cn13%5Cn%5Cn%2A%2AExplanation%2A%2A%20%20%5CnFor%201st%20query%2C%20we%20do%201%20%2B%202%20%2B%203%20%2B%201%5C%5C%2A2%20%2B%201%5C%5C%2A3%20%2B%202%5C%5C%2A3%20%2B%201%5C%5C%2A2%5C%5C%2A3%20%3D23%20%20%5CnFor%202nd%20query%2C%20it%20is%201%20%2B%202%20%2B%203%20%2B%201%262%20%2B%201%263%20%2B%202%263%20%2B%201%262%263%20%3D%209%20%20%5CnFor%203rd%20query%2C%20it%20is%20update%20so%20array%20becomes%201%205%203%20%20%5CnFor%204th%20query%2C%20it%20is%201%20%2B%205%20%2B%203%20%2B%201%5C%5C%2A5%20%2B%201%5C%5C%2A3%20%2B%203%5C%5C%2A5%20%2B%201%5C%5C%2A3%5C%5C%2A5%20%3D%2047%20%20%5CnFor%205th%20query%2C%20it%20is%201%20%2B%205%20%2B%203%20%2B%201%265%20%2B%201%263%20%2B%203%265%20%2B%201%263%265%20%3D%2013%22%2C%22inputFormat%22%3A%22%22%2C%22outputFormat%22%3A%22%22%2C%22samples%22%3A%5B%5D%2C%22hint%22%3A%22%22%2C%22provider%22%3A%7B%22uid%22%3A3%2C%22name%22%3A%22%5Cu6d1b%5Cu8c37%22%2C%22slogan%22%3A%22%22%2C%22badge%22%3A%22%22%2C%22isAdmin%22%3Atrue%2C%22color%22%3A%22Purple%22%2C%22ccfLevel%22%3A0%7D%2C%22canEdit%22%3Afalse%2C%22limits%22%3A%7B%22time%22%3A%5B1000%5D%2C%22memory%22%3A%5B1536000%5D%7D%2C%22stdCode%22%3A%22%22%2C%22vjudge%22%3A%7B%22origin%22%3A%22SPOJ%22%2C%22link%22%3A%22%5C%2Fjump%5C%2Fspoj%5C%2F20849%22%2C%22id%22%3A%2220849%22%7D%2C%22tags%22%3A%5B%5D%2C%22wantsTranslation%22%3Atrue%2C%22totalSubmit%22%3A0%2C%22totalAccepted%22%3A0%2C%22pid%22%3A%22SP20849%22%2C%22title%22%3A%22IQUERY%20-%20Interesting%20queries%22%2C%22difficulty%22%3A0%2C%22type%22%3A%22SP%22%7D%2C%22contest%22%3Anull%2C%22discussions%22%3A%5B%5D%2C%22bookmarked%22%3Afalse%2C%22vjudgeUsername%22%3Anull%2C%22recommendations%22%3A%5B%5D%2C%22lastLanguage%22%3A%22%22%2C%22lastCode%22%3A%22%22%7D%2C%22currentTitle%22%3A%22IQUERY%20-%20Interesting%20queries%22%2C%22currentTheme%22%3Anull%7D"));window._feConfigVersion=1572920822;</script>
<script src="https://cdn.luogu.com.cn/fe/loader.js?ver=20191106" charset="utf-8" defer></script>
</head>
<body>
<div id="app">
<div class="lg-container">
<article>
<h1>IQUERY - Interesting queries</h1>
<h2>题目描述</h2>
<div>Students of Computer Science department at NIT Durgapur were becoming extremely bored and frustrated due to too many classes ( weird but we had many classes ). As semesters were approaching , students were preparing hard to get good grades. Everyone was nervous about the Algorithms exam which is going to be held 2 days later. To add to their discomfort, one question came in the exam which took many one by surprise. The question was simple but everyone was told to optimize code as much as possible.
Now its your turn, and the question states that there is intially an array of N non-negative numbers (1-based indexing) and based on that array we have to run Q queries. Now we can do three things in each query. We have to sometimes calculate sum of product of all subsets of a number within a range, sometimes to calculate sum of Bitwise AND of all subsets of a number, sometimes to update an element of an array. All the calculations are to be performed modulus (109+7). If we have to do sum of products then the query is given 'M', if Bitwise AND then 'A' else if update then 'U'. For more details , see Explanation section .
**Note :** Bitwise AND operator is defined as & in C ,C++ and in most of the languages. For other programming languages see your language documentation.
**Input Format**
First line contains N, which denotes the number of elements in an array. Next line contains N integers denoting the number of integers in the array. Then Q denoting the number of queries and after that each line consists of 3 integers. If it is 'M' then we have to do product, if 'A' then Bitwise AND and if 'U' then update. If it is 'M' or 'A' then it is followed by i and j which is the range of that array. If 'U' then we have the positon and the value to be updated at that position.
**Output Format**
Corresponding to each query we have an output only to query of 'M' and 'A'. For update you dont have to print anything.
**Constraints**
1 5
1 5
1 5
1 5
The element to be updated is of maximum value of 105.
**Sample Input**
3
1 2 3
5
M 1 3
A 1 3
U 2 5
M 1 3
A 1 3
**Sample Output**
23
9
47
13
**Explanation**
For 1st query, we do 1 + 2 + 3 + 1\*2 + 1\*3 + 2\*3 + 1\*2\*3 =23
For 2nd query, it is 1 + 2 + 3 + 1&2 + 1&3 + 2&3 + 1&2&3 = 9
For 3rd query, it is update so array becomes 1 5 3
For 4th query, it is 1 + 5 + 3 + 1\*5 + 1\*3 + 3\*5 + 1\*3\*5 = 47
For 5th query, it is 1 + 5 + 3 + 1&5 + 1&3 + 3&5 + 1&3&5 = 13</div>
<h2>输入输出格式</h2>
<h3>输入格式</h3>
<br />
<div></div>
<h3>输出格式</h3>
<br />
<div></div>
<h2>输入输出样例</h2>
<i>暂无测试点</i>
</article>
</div>
</div>
</body>
</html>
